{"version":3,"sources":["webpack:///./src/components/hooks/useRegisterHost.ts","webpack:///./src/components/hooks/useReadingAuxilliaryValue.ts","webpack:///./src/components/RegisterInput.tsx","webpack:///./src/components/hooks/useFireKey.ts","webpack:///./node_modules/@material-ui/core/esm/FormControlLabel/FormControlLabel.js","webpack:///./src/components/widgets/GaugeWidget.tsx","webpack:///./src/components/widgets/ValueWithUnitWidget.tsx","webpack:///./src/components/icons/HumidityIcon.tsx","webpack:///./src/components/hooks/useUnitIcon.tsx","webpack:///./src/components/fields/MemberInput.tsx","webpack:///./src/components/fields/MembersInput.tsx","webpack:///./src/components/widgets/ButtonWidget.tsx","webpack:///./src/components/widgets/PowerButton.tsx","webpack:///./src/components/hooks/useServiceHost.ts","webpack:///./src/components/widgets/svgutils.ts","webpack:///./src/components/hooks/useThrottledValue.ts","webpack:///./src/components/hooks/useSvgButtonProps.ts","webpack:///./src/components/widgets/useWidgetSize.ts","webpack:///./src/components/RegisterTrend.tsx","webpack:///./src/components/hooks/useAnimationFrame.ts"],"names":["useRegisterHost","register","host","useServiceHost","service","code","useReadingAuxilliaryValue","identifier","SystemReg","ReadingError","ReadingResolution","MaxReading","MinReading","StreamingInterval","StreamingPreferredInterval","reading","Reading","Value","auxilliaryRegister","undefined","useState","unpackedValue","value","setValue","useEffect","subscribe","REPORT_UPDATE","RegisterInput","props","showRegisterName","showDeviceName","showServiceName","hideMissingValues","showTrend","showDataType","variant","off","toggleOff","specification","device","fields","useContext","AppContext","setAppError","setError","working","setWorking","args","setArgs","hasSet","kind","hasData","data","color","minReading","maxReading","readingError","resolution","vs","handleRefresh","refresh","sendArgs","values","setValues","sendSetPackedAsync","packFormat","length","serviceName","name","toLocaleLowerCase","replace","registerName","map","f","ENTER_KEY","SPACE_KEY","keyCodeFromEvent","e","which","keyCode","useFireKey","handler","charCode","preventDefault","GaugeWidget","size","min","max","step","valueLabel","onChange","tabIndex","useWidgetTheme","background","active","textProps","sliderPathRef","useRef","w","h","m","roff","riff","sw","cx","cy","r","sa","ea","_step","displayValue","useThrottledValue","computeArc","v","mid","fraction","describeArc","va","db","dvalue","dactual","lineCap","tvalue","clickeable","handlePointerDown","ev","buttons","svg","current","ownerSVGElement","pos","svgPointerPoint","closest","closestPoint","pointerStyle","cursor","pathProps","onPointerDown","onPointerMove","style","handleSliderChange","newValue","ValueWithUnitWidget","secondaryLabel","icon","label","labelVariant","precision","Math","ceil","log10","hasValue","isNaN","valueText","roundWithPrecision","toLocaleString","valueTextLength","isSet","reduce","l","valueVariant","valueStyle","minWidth","unit","resolveUnit","runit","MemberInput","serviceSpecification","serviceMemberSpecification","error","showLoading","typicalMin","typicalMax","absoluteMin","absoluteMax","type","enumInfo","enums","disabled","errorText","setErrorText","textValue","setTextValue","valueString","memberValueToString","isWidget","widgetSize","useWidgetSize","unitIcon","useUnitIcon","minValue","pick","test","maxValue","errorValue","floor","prettyUnit","helperText","prettyMemberUnit","filter","join","inputId","useId","inputType","isSimpleType","isIntegerType","handleChecked","checked","handleChange","target","tryParseMemberValue","handleEnumChange","event","isFlags","flagsToValue","percentValueFormat","valueLabelFormat","percentValueLabelFormat","round","offFormat","isValueOrIntensity","valueToFlags","Object","keys","members","n","signed","storage","hasTypicalRange","marks","MembersInput","specifications","index","c","slice","field","fieldi","ButtonWidget","onDown","onUp","controlBackground","buttonProps","useSvgButtonProps","mo","ro","ri","rn","PowerButton","onClick","strokeWidth","borderStroke","a","d","btnlabel","iconStroke","userSelect","pointerEvents","useDeviceHost","serviceIndex","point","createSVGPoint","x","clientX","y","clientY","res","matrixTransform","getScreenCTM","inverse","pathNode","pathLength","getTotalLength","distance2","p","dx","dy","bestLength","bestDistance","Infinity","scanLength","scan","getPointAtLength","scanDistance","polarToCartesian","centerX","centerY","radius","angleInDegrees","angleInRadians","PI","cos","sin","startAngle","endAngle","large","start","end","largeArcFlag","maxRate","actual","setActual","animated","useAnimationFrame","time","dt","maxError","sign","abs","fireDownOnEnter","fireUpOnEnter","preventify","className","role","onPointerUp","onPointerLeave","onKeyDown","onKeyUp","widgetCount","mini","DEFAULT_HORIZON","DEFAULT_HEIGHT","RegisterTrend","horizon","height","interval","JacdacContext","bus","palette","useChartPalette","dataSet","FieldDataSet","create","useChange","addRow","REPORT_RECEIVE","id","setInterval","clearInterval","callback","deps","requestRef","previousTimeRef","animate","deltaTime","requestAnimationFrame","cancelAnimationFrame"],"mappings":"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","file":"e80b7f91084fbc7b4a7d2421cce2612e8cbd6f90-bd21f0485de277daa9e4.js","sourcesContent":["import { JDRegister } from \"../../../jacdac-ts/src/jdom/register\";\nimport useServiceHost from \"./useServiceHost\";\n\nexport default function useRegisterHost(register: JDRegister) {\n    const host = useServiceHost(register?.service);\n    return host?.register(register?.code);\n}","import { useEffect, useState } from \"react\";\nimport { REPORT_UPDATE, SystemReg } from \"../../../jacdac-ts/src/jdom/constants\";\nimport { JDRegister } from \"../../../jacdac-ts/src/jdom/register\";\n\n\nexport default function useReadingAuxilliaryValue(register: JDRegister, identifier: number =\n    SystemReg.ReadingError\n    | SystemReg.ReadingResolution\n    | SystemReg.MaxReading\n    | SystemReg.MinReading\n    | SystemReg.StreamingInterval\n    | SystemReg.StreamingPreferredInterval\n): number[] {\n    const { service, code } = register;\n    const reading = code === SystemReg.Reading || code === SystemReg.Value;\n    const auxilliaryRegister = reading ? service.register(identifier) : undefined;\n    const [value, setValue] = useState<number[]>(auxilliaryRegister?.unpackedValue);\n\n    useEffect(() => auxilliaryRegister?.subscribe(REPORT_UPDATE, () => {\n        setValue(auxilliaryRegister?.unpackedValue);\n    }), [register, auxilliaryRegister]);\n\n    return value;\n}\n","import { Box, Typography } from \"@material-ui/core\";\nimport DeviceName from \"./DeviceName\";\nimport Alert from \"./ui/Alert\";\nimport React, { useContext, useEffect, useState } from \"react\";\n// tslint:disable-next-line: no-submodule-imports\nimport { JDRegister } from \"../../jacdac-ts/src/jdom/register\";\nimport { REPORT_UPDATE, SystemReg } from \"../../jacdac-ts/src/jdom/constants\";\nimport AppContext from \"./AppContext\";\nimport MembersInput from \"./fields/MembersInput\";\nimport RegisterTrend from \"./RegisterTrend\";\nimport IconButtonWithProgress from \"./ui/IconButtonWithProgress\"\nimport useRegisterHost from \"./hooks/useRegisterHost\"\nimport useReadingAuxilliaryValue from \"./hooks/useReadingAuxilliaryValue\";\nimport { useRegisterUnpackedValue } from \"../jacdac/useRegisterValue\";\n\nexport type RegisterInputVariant = \"widget\" | \"\"\n\nexport default function RegisterInput(props: {\n    register: JDRegister,\n    showDeviceName?: boolean,\n    showServiceName?: boolean,\n    showRegisterName?: boolean,\n    hideMissingValues?: boolean,\n    showTrend?: boolean,\n    showDataType?: boolean,\n    variant?: RegisterInputVariant,\n    off?: boolean,\n    toggleOff?: () => void\n}) {\n    const { register, showRegisterName, showDeviceName, showServiceName,\n        hideMissingValues, showTrend, showDataType, variant,\n        off, toggleOff } = props;\n    const { service, specification } = register;\n    const { device } = service;\n    const { fields } = register;\n    const { setError: setAppError } = useContext(AppContext)\n    const [working, setWorking] = useState(false);\n    const [args, setArgs] = useState<any[]>(register.unpackedValue || [])\n    const host = useRegisterHost(register);\n    const hasSet = specification.kind === \"rw\" || (host && specification.kind !== \"const\");\n    const hasData = !!register.data;\n    const color = hasSet ? \"secondary\" : \"primary\"\n    const minReading = useReadingAuxilliaryValue(register, SystemReg.MinReading)\n    const maxReading = useReadingAuxilliaryValue(register, SystemReg.MaxReading)\n    const readingError = useReadingAuxilliaryValue(register, SystemReg.ReadingError);\n    const resolution = useReadingAuxilliaryValue(register, SystemReg.ReadingResolution);\n\n    useEffect(() => register.subscribe(REPORT_UPDATE, () => {\n        const vs = register.unpackedValue\n        if (vs !== undefined)\n            setArgs(vs);\n    }), [register]);\n    const handleRefresh = () => {\n        register.refresh(true);\n    }\n    const sendArgs = async (values: any[]) => {\n        if (working) return;\n        try {\n            setWorking(true)\n            if (host) {\n                host.setValues(values);\n                await register.refresh();\n            }\n            else\n                await register.sendSetPackedAsync(specification.packFormat, values, true);\n        }\n        catch (e) {\n            setAppError(e)\n        } finally {\n            setWorking(false)\n        }\n    }\n\n    if (!specification)\n        return <Alert severity=\"error\">{`Unknown member ${register.service}:${register.code}`}</Alert>\n\n    if (!fields.length)\n        return null; // nothing to see here\n\n    if (hideMissingValues && !hasData)\n        return null;\n\n    const serviceName = register.service.name.toLocaleLowerCase().replace(/_/g, ' ');\n    const registerName = specification.name.replace(/_/g, ' ');\n    return <>\n        {showDeviceName && <Typography component=\"span\" key=\"devicenamename\">\n            <DeviceName device={device} />/\n    </Typography>}\n        {showServiceName && specification && <Typography variant=\"caption\" key=\"servicename\" aria-label={serviceName}>\n            {serviceName}\n        </Typography>}\n        {showRegisterName && specification && serviceName !== registerName && <Typography variant=\"caption\" key=\"registername\" aria-label={registerName}>\n            {\" \" + registerName}\n        </Typography>}\n        {!hasData && <Box>\n            <IconButtonWithProgress title=\"refresh\" indeterminate={true} onClick={handleRefresh} />\n        </Box>}\n        {showTrend && hasData && <RegisterTrend register={register} mini={false} horizon={24} />}\n        {hasData && <MembersInput\n            color={color}\n            serviceSpecification={service.specification}\n            serviceMemberSpecification={specification}\n            specifications={fields.map(f => f.specification)}\n            values={args}\n            setValues={hasSet && sendArgs}\n            showDataType={showDataType}\n            variant={variant}\n            min={minReading}\n            max={maxReading}\n            resolution={resolution}\n            error={readingError}\n            off={off}\n            toggleOff={toggleOff}\n        />}\n    </>\n}\n","import React, { KeyboardEvent, PointerEvent } from \"react\"\n\nconst ENTER_KEY = 13;\nconst SPACE_KEY = 32;\n\nexport function keyCodeFromEvent(e: any) {\n    return (typeof e.which == \"number\") ? e.which : e.keyCode;\n}\n\nexport default function useFireKey<TElement extends Element>(handler: (ev?: PointerEvent<TElement>) => void): (e: KeyboardEvent<TElement>) => void {\n    if (!handler)\n        return undefined;\n    return (e: KeyboardEvent<Element>) => {\n        const charCode = keyCodeFromEvent(e);\n        if (charCode === ENTER_KEY || charCode === SPACE_KEY) {\n            e.preventDefault();\n            handler();\n        }\n    }\n}\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport { refType } from '@material-ui/utils';\nimport { useFormControl } from '../FormControl';\nimport withStyles from '../styles/withStyles';\nimport Typography from '../Typography';\nimport capitalize from '../utils/capitalize';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      display: 'inline-flex',\n      alignItems: 'center',\n      cursor: 'pointer',\n      // For correct alignment with the text.\n      verticalAlign: 'middle',\n      WebkitTapHighlightColor: 'transparent',\n      marginLeft: -11,\n      marginRight: 16,\n      // used for row presentation of radio/checkbox\n      '&$disabled': {\n        cursor: 'default'\n      }\n    },\n\n    /* Styles applied to the root element if `labelPlacement=\"start\"`. */\n    labelPlacementStart: {\n      flexDirection: 'row-reverse',\n      marginLeft: 16,\n      // used for row presentation of radio/checkbox\n      marginRight: -11\n    },\n\n    /* Styles applied to the root element if `labelPlacement=\"top\"`. */\n    labelPlacementTop: {\n      flexDirection: 'column-reverse',\n      marginLeft: 16\n    },\n\n    /* Styles applied to the root element if `labelPlacement=\"bottom\"`. */\n    labelPlacementBottom: {\n      flexDirection: 'column',\n      marginLeft: 16\n    },\n\n    /* Pseudo-class applied to the root element if `disabled={true}`. */\n    disabled: {},\n\n    /* Styles applied to the label's Typography component. */\n    label: {\n      '&$disabled': {\n        color: theme.palette.text.disabled\n      }\n    }\n  };\n};\n/**\n * Drop in replacement of the `Radio`, `Switch` and `Checkbox` component.\n * Use this component if you want to display an extra label.\n */\n\nvar FormControlLabel = /*#__PURE__*/React.forwardRef(function FormControlLabel(props, ref) {\n  var checked = props.checked,\n      classes = props.classes,\n      className = props.className,\n      control = props.control,\n      disabledProp = props.disabled,\n      inputRef = props.inputRef,\n      label = props.label,\n      _props$labelPlacement = props.labelPlacement,\n      labelPlacement = _props$labelPlacement === void 0 ? 'end' : _props$labelPlacement,\n      name = props.name,\n      onChange = props.onChange,\n      value = props.value,\n      other = _objectWithoutProperties(props, [\"checked\", \"classes\", \"className\", \"control\", \"disabled\", \"inputRef\", \"label\", \"labelPlacement\", \"name\", \"onChange\", \"value\"]);\n\n  var muiFormControl = useFormControl();\n  var disabled = disabledProp;\n\n  if (typeof disabled === 'undefined' && typeof control.props.disabled !== 'undefined') {\n    disabled = control.props.disabled;\n  }\n\n  if (typeof disabled === 'undefined' && muiFormControl) {\n    disabled = muiFormControl.disabled;\n  }\n\n  var controlProps = {\n    disabled: disabled\n  };\n  ['checked', 'name', 'onChange', 'value', 'inputRef'].forEach(function (key) {\n    if (typeof control.props[key] === 'undefined' && typeof props[key] !== 'undefined') {\n      controlProps[key] = props[key];\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"label\", _extends({\n    className: clsx(classes.root, className, labelPlacement !== 'end' && classes[\"labelPlacement\".concat(capitalize(labelPlacement))], disabled && classes.disabled),\n    ref: ref\n  }, other), /*#__PURE__*/React.cloneElement(control, controlProps), /*#__PURE__*/React.createElement(Typography, {\n    component: \"span\",\n    className: clsx(classes.label, disabled && classes.disabled)\n  }, label));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiFormControlLabel'\n})(FormControlLabel);","import React, { SVGAttributes, useRef } from \"react\";\nimport useWidgetTheme from \"./useWidgetTheme\";\nimport SvgWidget from \"./SvgWidget\";\nimport useThrottledValue from \"../hooks/useThrottledValue\"\nimport { closestPoint, describeArc, svgPointerPoint } from \"./svgutils\";\nimport { CSSProperties } from \"@material-ui/core/styles/withStyles\";\nimport PowerButton from \"./PowerButton\";\nimport { Grid, Slider } from \"@material-ui/core\";\n\nexport default function GaugeWidget(props: {\n    value: number,\n    min: number,\n    max: number,\n    step?: number,\n    label?: string,\n    color?: \"primary\" | \"secondary\",\n    size?: string,\n    variant?: \"fountain\",\n    tabIndex?: number,\n    valueLabel?: (v: number) => string,\n    onChange?: (ev: unknown, newValue: number) => void\n    off?: boolean,\n    toggleOff?: () => void\n}) {\n    const { value, color, size, min, max, step, variant, valueLabel,\n        off, toggleOff, onChange, tabIndex } = props;\n    const { background, active, textProps } = useWidgetTheme(color);\n\n    const sliderPathRef = useRef<SVGPathElement>();\n    const w = 120;\n    const h = 120;\n    const m = 8;\n    const roff = 30;\n    const riff = 10;\n    const sw = m << 1;\n    const cx = w >> 1;\n    const cy = h >> 1;\n    const r = (w >> 1) - m;\n    const sa = -135;\n    const ea = 135;\n    const _step = step || (max - min) / 10\n    const displayValue = useThrottledValue(value, (max - min) * 2);\n\n    const computeArc = (v: number) => {\n        if (variant === \"fountain\") {\n            const mid = (ea + sa) / 2;\n            const fraction = v / (max - min) * (ea - sa);\n            if (fraction < 0)\n                return describeArc(cx, cy, r, mid + fraction, mid);\n            else\n                return describeArc(cx, cy, r, mid, mid + fraction);\n        } else {\n            const fraction = (v - min) / (max - min);\n            const va = sa + fraction * (ea - sa);\n            return describeArc(cx, cy, r, sa, va);\n        }\n    }\n\n    const db = describeArc(cx, cy, r, sa, ea);\n    const dvalue = computeArc(value);\n    const dactual = computeArc(displayValue);\n    const lineCap = \"round\"\n    const tvalue = valueLabel(value);\n    const clickeable = !!onChange;\n\n    const handlePointerDown = (ev: React.PointerEvent<SVGPathElement>) => {\n        ev.preventDefault();\n        if (!ev.buttons) return;\n        const svg = sliderPathRef.current.ownerSVGElement\n        const pos = svgPointerPoint(svg, ev);\n        const closest = closestPoint(sliderPathRef.current, _step, pos);\n        onChange(ev, min + (1 - closest) * (max - min))\n    }\n    const pointerStyle: CSSProperties = clickeable && {\n        cursor: \"pointer\"\n    }\n    const pathProps: SVGAttributes<SVGPathElement> = {\n        onPointerDown: clickeable ? handlePointerDown : undefined,\n        onPointerMove: clickeable ? handlePointerDown : undefined,\n        style: clickeable ? pointerStyle : undefined\n    }\n    const handleSliderChange = (ev: unknown, newValue: number | number[]) => {\n        onChange(ev, newValue as number);\n    }\n\n    return <Grid container direction=\"column\">\n        <Grid item>\n            <SvgWidget tabIndex={tabIndex} width={w} height={h} size={size}>\n                <path ref={sliderPathRef} strokeWidth={sw} stroke={background} d={db} strokeLinecap={lineCap} fill=\"transparent\"\n                    {...pathProps}\n                />\n                {!off && <path strokeWidth={sw} stroke={active} strokeLinecap={lineCap} d={dvalue} opacity={0.2} fill=\"transparent\"\n                    {...pathProps}\n                />}\n                {!off && <path strokeWidth={sw} stroke={active} strokeLinecap={lineCap} d={dactual} fill=\"transparent\"\n                    {...pathProps}\n                />}\n                {off !== undefined\n                    ? <PowerButton off={off} label={tvalue} cx={cx} cy={cy} r={roff} ri={riff} color={color} onClick={toggleOff} />\n                    : <text {...textProps} x={cx} y={cy} aria-label={tvalue}>{tvalue}</text>}\n            </SvgWidget>\n        </Grid>\n        {clickeable && <Grid item>\n            <Slider\n                disabled={off}\n                color={color}\n                min={min} max={max} step={_step} valueLabelDisplay=\"off\"\n                value={value} onChange={handleSliderChange} />\n        </Grid>}\n    </Grid>\n\n}","import React from \"react\";\nimport { Grid, Slider, Typography } from \"@material-ui/core\";\nimport { isSet, roundWithPrecision } from \"../../../jacdac-ts/src/jdom/utils\";\nimport { CSSProperties } from \"@material-ui/core/styles/withStyles\";\n\nexport default function ValueWithUnitWidget(props: {\n    value: number,\n    min?: number,\n    max?: number,\n    step?: number,\n    icon?: JSX.Element,\n    label: string,\n    secondaryLabel?: string,\n    tabIndex?: number,\n    color?: \"primary\" | \"secondary\",\n    size?: string,\n    onChange?: (event: unknown, newValue: number | number[]) => void\n}) {\n    const { value, min, max, step, secondaryLabel, icon, label, tabIndex, onChange } = props;\n    const labelVariant = \"subtitle1\";\n    const precision = step === undefined ? 1 : step < 1 ? Math.ceil(-Math.log10(step)) : 0;\n    const hasValue = !isNaN(value);\n    const valueText = hasValue ? roundWithPrecision(value, precision).toLocaleString() : \"--\"\n    const valueTextLength = isSet(min) && isSet(max) ? [min, max, min + (min + max) / 3]\n        .map(v => roundWithPrecision(v, precision).toLocaleString().replace(/[,.]/, '').length)\n        .reduce((l, r) => Math.max(l, r), 0)\n        + precision : valueText.length;\n\n    //console.log({ min, max, step, precision })\n    const valueVariant = valueTextLength < 4 ? \"h1\"\n        : valueTextLength < 7 ? \"h2\"\n            : valueTextLength < 9 ? \"h3\"\n                : valueTextLength < 12 ? \"h4\"\n                    : \"h6\";\n    const valueStyle: CSSProperties = {\n        minWidth: `${Math.max(2, valueTextLength - 1)}em`\n    }\n\n    return <Grid container direction=\"column\" tabIndex={tabIndex} aria-label={`${valueText} ${label}`}>\n        <Grid item xs={12}>\n            <Grid container direction=\"row\" alignContent=\"flex-end\">\n                <Grid item>\n                    <Typography role=\"timer\" align=\"right\" variant={valueVariant}\n                        style={valueStyle}>{icon}{valueText}</Typography>\n                </Grid>\n                <Grid item>\n                    <Grid container direction=\"column\" alignContent=\"space-between\">\n                        <Grid item>\n                            <Typography variant={labelVariant}>{label}</Typography>\n                        </Grid>\n                        {secondaryLabel && <Grid item>\n                            <Typography variant={\"caption\"}>{secondaryLabel}</Typography>\n                        </Grid>}\n                    </Grid>\n                </Grid>\n            </Grid>\n        </Grid>\n        {onChange && value !== undefined && <Grid item xs={12}>\n            <Slider valueLabelDisplay=\"off\" color=\"secondary\"\n                min={min} max={max} step={step} value={value} onChange={onChange} />\n        </Grid>}\n    </Grid>;\n}","import { SvgIcon, SvgIconProps } from \"@material-ui/core\";\nimport React from \"react\";\n\nexport default (props: SvgIconProps) =>\n    <SvgIcon {...props}>\n        <path d=\"M8.8-.03A49.327 49.327 0 00.956 11.112a8.824 8.824 0 1015.693 0A49.327 49.327 0 008.801-.029zm0 3.132a47.244 47.244 0 015.995 8.962 6.74 6.74 0 11-11.986 0A47.243 47.243 0 018.8 3.102z\" />\n    </SvgIcon>\n","import React from \"react\";\nimport HumidityIcon from \"../icons/HumidityIcon\"\nimport { resolveUnit } from \"../../../jacdac-ts/jacdac-spec/spectool/jdspec\"\nimport { SvgIconProps } from \"@material-ui/core\";\n\nexport default (unit: string, props?: SvgIconProps) => {\n    const { unit: runit } = resolveUnit(unit) || {};\n    switch (runit) {\n        case \"%RH\": return <HumidityIcon {...props} />;\n        default: return null;\n    }\n}","import React, { useEffect, useState } from \"react\"\n// tslint:disable-next-line: no-submodule-imports\nimport { FormControlLabel, Slider } from \"@material-ui/core\"\nimport { MenuItem, Select, Switch, TextField } from \"@material-ui/core\"\nimport {\n    flagsToValue,\n    prettyMemberUnit,\n    prettyUnit,\n    valueToFlags,\n} from \"../../../jacdac-ts/src/jdom/pretty\"\nimport {\n    isIntegerType,\n    isValueOrIntensity,\n    memberValueToString,\n    tryParseMemberValue,\n} from \"../../../jacdac-ts/src/jdom/spec\"\nimport { isSet, pick, roundWithPrecision } from \"../../../jacdac-ts/src/jdom/utils\"\nimport { RegisterInputVariant } from \"../RegisterInput\"\nimport ButtonWidget from \"../widgets/ButtonWidget\"\nimport GaugeWidget from \"../widgets/GaugeWidget\"\nimport useWidgetSize from \"../widgets/useWidgetSize\"\nimport ValueWithUnitWidget from \"../widgets/ValueWithUnitWidget\"\nimport useUnitIcon from \"../hooks/useUnitIcon\"\nimport { PackedSimpleValue } from \"../../../jacdac-ts/src/jdom/pack\"\nimport { useId } from \"react-use-id-hook\"\nimport LoadingProgress from \"../ui/LoadingProgress\"\n\nexport default function MemberInput(props: {\n    specification: jdspec.PacketMember\n    serviceSpecification: jdspec.ServiceSpec\n    serviceMemberSpecification: jdspec.PacketInfo\n    value: PackedSimpleValue\n    setValue?: (v: PackedSimpleValue) => void\n    showDataType?: boolean\n    color?: \"primary\" | \"secondary\"\n    variant?: RegisterInputVariant\n    min?: number\n    max?: number\n    resolution?: number\n    error?: number\n    showLoading?: boolean\n    off?: boolean\n    toggleOff?: () => void\n}) {\n    const {\n        specification,\n        serviceSpecification,\n        serviceMemberSpecification,\n        value,\n        setValue,\n        showDataType,\n        color,\n        variant,\n        min,\n        max,\n        resolution,\n        error,\n        showLoading,\n        off,\n        toggleOff,\n    } = props\n    const {\n        typicalMin,\n        typicalMax,\n        absoluteMin,\n        absoluteMax,\n        type,\n    } = specification\n    const enumInfo = serviceSpecification.enums?.[specification.type]\n    const disabled = !setValue\n    const [errorText, setErrorText] = useState(\"\")\n    const [textValue, setTextValue] = useState(\"\")\n    const valueString = memberValueToString(value, specification)\n    const name =\n        specification.name === \"_\"\n            ? serviceMemberSpecification.name\n            : specification.name\n    const label = name\n    const isWidget = variant === \"widget\"\n    const widgetSize = useWidgetSize()\n    const unitIcon = useUnitIcon(specification.unit, { \"aria-label\": label })\n\n    const minValue = pick(\n        min,\n        typicalMin,\n        absoluteMin,\n        /^u/.test(type) ? 0 : undefined\n    )\n    const maxValue = pick(max, typicalMax, absoluteMax)\n    const errorValue = error\n        ? \"±\" +\n          roundWithPrecision(\n              error,\n              1 - Math.floor(Math.log10(error))\n          ).toLocaleString()\n        : undefined\n    const unit = prettyUnit(specification.unit)\n    const helperText =\n        errorText ||\n        [prettyMemberUnit(specification, showDataType), errorValue]\n            .filter(v => v !== undefined)\n            .join(\", \")\n    const inputId = useId()\n\n    const inputType =\n        specification.type === \"string\" || specification.type === \"string0\"\n            ? \"string\"\n            : specification.isSimpleType || isIntegerType(specification.type)\n            ? \"number\"\n            : \"\"\n\n    // update coming from device\n    useEffect(() => {\n        setTextValue(valueString)\n    }, [valueString])\n\n    const handleChecked = (ev, checked: boolean) => {\n        setValue(checked)\n    }\n    const handleChange = ev => {\n        const newValue = ev.target.value\n        setTextValue(newValue)\n        const r = tryParseMemberValue(newValue, specification)\n        if (r.value !== undefined) setValue(r.value)\n        setErrorText(r.error)\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const handleEnumChange = (event: React.ChangeEvent<{ value: any }>) => {\n        const v = enumInfo.isFlags\n            ? flagsToValue(event.target.value as number[])\n            : (event.target.value as number)\n        setValue(v)\n    }\n    const handleSliderChange = (\n        event: unknown,\n        newValue: number | number[]\n    ) => {\n        const v = newValue as number\n        setValue(v)\n    }\n    const percentValueFormat = (value: number) => {\n        // avoid super long floats\n        return ((value * 100) >> 0) + \"%\"\n    }\n\n    const valueLabelFormat = (value: number) => {\n        // avoid super long floats\n        return roundWithPrecision(value, 1) + (unit || \"\")\n    }\n    const percentValueLabelFormat = (v: number) => {\n        return `${Math.round(v * 100)}%`\n    }\n    const offFormat = () => \"off\"\n\n    // value hasn't been loaded yet\n    if (serviceMemberSpecification.kind !== \"command\" && value === undefined) {\n        if (showLoading)\n            return <LoadingProgress />\n        else return null\n    }\n\n    //\n    if (specification.type === \"pipe\") {\n        return (\n            <>\n                pipe <code>{specification.name}</code>\n            </>\n        )\n    } else if (specification.type === \"bool\") {\n        if (isWidget && !isValueOrIntensity(serviceMemberSpecification)) {\n            return (\n                <ButtonWidget\n                    label={!isWidget && label}\n                    checked={!!value}\n                    color={color}\n                    size={widgetSize}\n                />\n            )\n        }\n\n        return (\n            <FormControlLabel\n                control={\n                    <Switch\n                        checked={!!value}\n                        onChange={disabled ? undefined : handleChecked}\n                        color={color}\n                    />\n                }\n                label={label}\n            />\n        )\n    } else if (enumInfo !== undefined) {\n        return (\n            <Select\n                aria-label={label}\n                disabled={disabled}\n                multiple={enumInfo.isFlags}\n                value={\n                    enumInfo.isFlags\n                        ? valueToFlags(enumInfo, value as number)\n                        : value\n                }\n                onChange={handleEnumChange}\n            >\n                {Object.keys(enumInfo.members).map(n => (\n                    <MenuItem key={n} value={enumInfo.members[n]}>\n                        {n}\n                    </MenuItem>\n                ))}\n            </Select>\n        )\n    } else if (specification.unit === \"/\") {\n        const signed = specification.storage < 0\n        const min = signed ? -1 : 0\n        const max = 1\n        const step = resolution !== undefined ? resolution : 0.01\n        if (isWidget)\n            return (\n                <GaugeWidget\n                    tabIndex={0}\n                    label={label}\n                    value={value as number}\n                    color={color}\n                    variant={signed ? \"fountain\" : undefined}\n                    min={min}\n                    max={max}\n                    step={step}\n                    valueLabel={percentValueLabelFormat}\n                    onChange={disabled ? undefined : handleSliderChange}\n                    off={off}\n                    toggleOff={toggleOff}\n                />\n            )\n\n        return (\n            <Slider\n                aria-label={label}\n                color={color}\n                value={value as number}\n                valueLabelFormat={percentValueFormat}\n                onChange={disabled ? undefined : handleSliderChange}\n                min={min}\n                max={max}\n                step={step}\n                valueLabelDisplay=\"auto\"\n            />\n        )\n    } else if (isSet(minValue) && isSet(maxValue)) {\n        const hasTypicalRange = isSet(typicalMin) && isSet(typicalMax)\n        let step =\n            resolution !== undefined\n                ? resolution\n                : hasTypicalRange\n                ? (specification.typicalMax - specification.typicalMin) / 100\n                : (maxValue - minValue) / 100\n        if (step === 0 || isNaN(step))\n            // edge case\n            step = undefined\n        const marks =\n            hasTypicalRange &&\n            (typicalMin !== minValue || typicalMax !== maxValue)\n                ? [\n                      {\n                          value: typicalMin,\n                      },\n                      {\n                          value: typicalMax,\n                      },\n                  ]\n                : undefined\n        if (isWidget)\n            return (\n                <ValueWithUnitWidget\n                    tabIndex={0}\n                    label={specification.unit}\n                    value={value as number}\n                    min={minValue}\n                    max={maxValue}\n                    icon={unitIcon}\n                    step={step}\n                    secondaryLabel={errorValue}\n                    color={color}\n                    onChange={disabled ? undefined : handleSliderChange}\n                />\n            )\n\n        return (\n            <Slider\n                value={value as number}\n                color={color}\n                valueLabelFormat={off ? offFormat : valueLabelFormat}\n                onChange={disabled ? undefined : handleSliderChange}\n                min={minValue}\n                max={maxValue}\n                step={step}\n                marks={marks}\n                valueLabelDisplay=\"auto\"\n            />\n        )\n    } else if (specification.type === \"bytes\") {\n        return (\n            <TextField\n                id={inputId}\n                spellCheck={false}\n                value={textValue}\n                label={label}\n                inputProps={{ [\"aria-label\"]: label }}\n                helperText={helperText}\n                onChange={disabled ? undefined : handleChange}\n                required={value === undefined}\n                error={!!errorText}\n                type={\"text\"}\n            />\n        )\n    } else {\n        // numbers or string or uintarrays\n        if (isWidget)\n            // we need min/max to support a slider\n            return (\n                <ValueWithUnitWidget\n                    tabIndex={0}\n                    value={roundWithPrecision(value as number, 1)}\n                    label={specification.unit}\n                    color={color}\n                    size={widgetSize}\n                />\n            )\n\n        return (\n            <TextField\n                id={inputId}\n                spellCheck={false}\n                value={textValue}\n                label={label}\n                inputProps={{ [\"aria-label\"]: label }}\n                helperText={helperText}\n                onChange={disabled ? undefined : handleChange}\n                required={value === undefined}\n                error={!!errorText}\n                type={inputType}\n            />\n        )\n    }\n}\n","import { Grid } from \"@material-ui/core\";\nimport React from \"react\";\nimport { RegisterInputVariant } from \"../RegisterInput\";\nimport MemberInput from \"./MemberInput\";\n\nexport default function MembersInput(props: {\n    serviceSpecification: jdspec.ServiceSpec,\n    serviceMemberSpecification?: jdspec.PacketInfo,\n    specifications: jdspec.PacketMember[],\n    values?: any[],\n    setValues?: (values: any[]) => void,\n    showDataType?: boolean,\n    color?: \"primary\" | \"secondary\",\n    variant?: RegisterInputVariant,\n    min?: number[],\n    max?: number[],\n    resolution?: number[],\n    error?: number[],\n    off?: boolean,\n    toggleOff?: () => void\n}) {\n    const { serviceSpecification, serviceMemberSpecification, specifications,\n        values, setValues, showDataType, color, variant,\n        min, max, resolution, error, off, toggleOff } = props;\n    const setValue = (index: number) => (value: any) => {\n        const c = values.slice(0)\n        c[index] = value;\n        setValues(c)\n    }\n\n    return <Grid container spacing={1}>\n        {specifications.map((field, fieldi) => {\n            const value = values?.[fieldi];\n            return <Grid item key={fieldi} xs={12}>\n                <MemberInput\n                    serviceSpecification={serviceSpecification}\n                    serviceMemberSpecification={serviceMemberSpecification}\n                    specification={field}\n                    showDataType={showDataType}\n                    value={value}\n                    color={color}\n                    setValue={values && setValues && setValue(fieldi)}\n                    variant={variant}\n                    min={min?.[fieldi]}\n                    max={max?.[fieldi]}\n                    resolution={resolution?.[fieldi]}\n                    error={error?.[fieldi]}\n                    off={off}\n                    toggleOff={toggleOff}\n                />\n            </Grid>;\n        })}\n    </Grid>\n}\n","import React from \"react\";\nimport { useTheme } from \"@material-ui/core\";\nimport SvgWidget from \"./SvgWidget\";\nimport useWidgetTheme from \"./useWidgetTheme\";\nimport { useId } from \"react-use-id-hook\"\nimport useSvgButtonProps from \"../hooks/useSvgButtonProps\";\n\nexport default function ButtonWidget(props: {\n    checked?: boolean;\n    label?: string\n    color?: \"primary\" | \"secondary\",\n    size?: string,\n    onDown?: () => void,\n    onUp?: () => void\n}) {\n    const { checked, label, color, size, onDown, onUp } = props;\n    const { background, controlBackground, active } = useWidgetTheme(color);\n\n    const buttonProps = useSvgButtonProps<SVGCircleElement>(label, onDown, onUp)\n    const w = 64;\n    const mo = checked ? 3 : 5;\n    const r = w / 2;\n    const cx = r;\n    const cy = r;\n    const ro = r;\n    const ri = r - mo;\n    const rn = 8;\n    return <SvgWidget width={w} size={size}>\n        <rect x={0} y={0} rx={2} ry={2} width={w} height={w} fill={background} />\n        <circle cx={rn} cy={rn} r={rn >> 1} fill={controlBackground} />\n        <circle cx={w - rn} cy={rn} r={rn >> 1} fill={controlBackground} />\n        <circle cx={w - rn} cy={w - rn} r={rn >> 1} fill={controlBackground} />\n        <circle cx={rn} cy={w - rn} r={rn >> 1} fill={controlBackground} />\n        <circle cx={cx} cy={cy} r={ri}\n            aria-live=\"polite\"\n            fill={checked ? active : controlBackground}\n            {...buttonProps}\n        />\n    </SvgWidget>\n}","import React from \"react\"\nimport useSvgButtonProps from \"../hooks/useSvgButtonProps\";\nimport { describeArc } from \"./svgutils\";\nimport useWidgetTheme from \"./useWidgetTheme\";\n\nexport default function PowerButton(props: {\n    cx: number,\n    cy: number,\n    r: number,\n    ri: number,\n    strokeWidth?: number,\n    label?: string,\n    color?: \"primary\" | \"secondary\",\n    off?: boolean,\n    borderStroke?: string,\n    onClick?: () => void\n}) {\n    const { cx, cy, r, ri, onClick, off, color, label, strokeWidth, borderStroke } = props;\n    const { background, active, controlBackground, textProps } = useWidgetTheme(color);\n    const a = 135;\n    const d = describeArc(cx, cy, ri, -a, a, true);\n    const btnlabel = off ? \"turn on\" : \"turn off\";\n    const buttonProps = useSvgButtonProps<SVGCircleElement>(btnlabel, onClick)\n    const sw = strokeWidth || 3;\n    const disabled = !onClick;\n\n    const iconStroke = disabled || !off ? background : active;\n\n    return <g>\n        <title>{btnlabel}</title>\n        <circle cx={cx} cy={cy} r={r} fill={controlBackground}\n            strokeWidth={sw} stroke={borderStroke || background}\n            {...buttonProps} />\n        {(off || !label) && <g transform={`rotate(180, ${cx}, ${cy})`}>\n            <path d={d} strokeLinecap=\"round\" fill=\"none\"\n                strokeWidth={sw} stroke={iconStroke}\n                style={({ userSelect: \"none\", pointerEvents: \"none\" })} />\n            <line strokeLinecap=\"round\" x1={cx} y1={cy + ri / 4} x2={cx} y2={cy + ri}\n                stroke={iconStroke} strokeWidth={sw}\n                style={({ userSelect: \"none\", pointerEvents: \"none\" })} />\n        </g>}\n        {!off && label && <text aria-label={label} x={cx} y={cy} {...textProps}>{label}</text>}\n    </g>\n}","import { JDService } from \"../../../jacdac-ts/src/jdom/service\";\nimport ServiceHost from \"../../../jacdac-ts/src/jdom/servicehost\";\nimport useDeviceHost from \"./useDeviceHost\";\n\nexport default function useServiceHost<T extends ServiceHost>(service: JDService) {\n    const host = useDeviceHost(service.device);\n    return host?.service(service?.serviceIndex) as T;\n}","import React from \"react\"\n\nexport function svgPointerPoint(\n    svg: SVGSVGElement,\n    event: React.PointerEvent\n): DOMPoint {\n    const point = svg.createSVGPoint()\n    point.x = event.clientX\n    point.y = event.clientY\n    const res = point.matrixTransform(svg.getScreenCTM().inverse())\n    return res\n}\n\nexport function closestPoint(\n    pathNode: SVGPathElement,\n    step: number,\n    point: DOMPoint\n): number {\n    const pathLength = pathNode.getTotalLength()\n\n    const distance2 = (p: DOMPoint) => {\n        const dx = p.x - point.x\n        const dy = p.y - point.y\n        return dx * dx + dy * dy\n    }\n\n    let bestLength = 0\n    let bestDistance = Infinity\n    for (let scanLength = 0; scanLength <= pathLength; scanLength += step) {\n        const scan = pathNode.getPointAtLength(scanLength)\n        const scanDistance = distance2(scan)\n        if (scanDistance < bestDistance) {\n            bestLength = scanLength\n            bestDistance = scanDistance\n        }\n    }\n    return bestLength / pathLength\n}\n\nexport function polarToCartesian(\n    centerX: number,\n    centerY: number,\n    radius: number,\n    angleInDegrees: number\n) {\n    const angleInRadians = ((angleInDegrees - 90) * Math.PI) / 180.0\n\n    return {\n        x: centerX + radius * Math.cos(angleInRadians),\n        y: centerY + radius * Math.sin(angleInRadians),\n    }\n}\n\nexport function describeArc(\n    x: number,\n    y: number,\n    radius: number,\n    startAngle: number,\n    endAngle: number,\n    large?: boolean\n) {\n    const start = polarToCartesian(x, y, radius, endAngle)\n    const end = polarToCartesian(x, y, radius, startAngle)\n\n    const largeArcFlag =\n        large !== true && endAngle - startAngle <= 180 ? \"0\" : \"1\"\n\n    const d = [\n        \"M\",\n        start.x,\n        start.y,\n        \"A\",\n        radius,\n        radius,\n        0,\n        largeArcFlag,\n        0,\n        end.x,\n        end.y,\n    ].join(\" \")\n\n    return d\n}\n","import { useState } from \"react\";\nimport useAnimationFrame from \"./useAnimationFrame\";\n\nexport default function useThrottledValue(value: number, maxRate: number) {\n    const [actual, setActual] = useState<number>(value);\n\n    let animated = actual;\n    useAnimationFrame(time => {\n        // no valid rate\n        if (isNaN(maxRate) || isNaN(animated)) {\n            setActual(value);\n            return false;\n        }\n\n        // increment towards value\n        const dt = time / 1000; // s\n        const error = value - animated;\n        const maxError = maxRate * dt; // deg\n        let active = true;\n        animated += Math.sign(error) * Math.min(Math.abs(error), maxError)\n        if (Math.abs(value - animated) / maxRate < 0.01) {\n            animated = value;\n            active = false;\n        }\n        setActual(animated);\n        return active;\n    }, [value, maxRate]);\n\n    return actual;\n}","import { SVGProps } from \"react\";\nimport useFireKey from \"./useFireKey\";\n\nexport default function useSvgButtonProps<T extends SVGElement>(\n    label: string,\n    onDown?: (event: React.PointerEvent<T>) => void,\n    onUp?: (event: React.PointerEvent<T>) => void\n): SVGProps<T> {\n\n    const disabled = !onDown && !onUp;\n    const fireDownOnEnter = useFireKey(onDown);\n    const fireUpOnEnter = useFireKey(onUp);\n\n    const preventify = (handler: (event: React.PointerEvent<T>) => void) => {\n        if (handler)\n            return (event: React.PointerEvent<T>) => {\n                event.preventDefault();\n                handler(event);\n            }\n        else\n            return undefined;\n    }\n\n    return {\n        className: disabled ? undefined : \"clickeable\",\n        role: disabled ? undefined : \"button\",\n        tabIndex: disabled ? undefined : 0,\n        [\"aria-label\"]: label,\n        onPointerDown: preventify(onDown),\n        onPointerUp: preventify(onUp),\n        onPointerLeave: preventify(onUp),\n        onKeyDown: fireDownOnEnter,\n        onKeyUp: fireUpOnEnter\n    }\n}","import { useMediaQuery, useTheme } from \"@material-ui/core\";\n\nexport default function useWidgetSize(variant?: \"icon\" | \"\", widgetCount?: number) {\n    const icon = variant === \"icon\"\n\n    const mini = icon;\n    let widgetSize: string;\n    switch (widgetCount || 1) {\n        case 1:\n        case 2:\n            widgetSize = mini ? \"12em\" : \"16em\";\n            break;\n        case 3:\n        case 4:\n        case 5:\n        case 6:\n            widgetSize = mini ? \"10em\" : \"14em\";\n            break;\n        default:\n            widgetSize = mini ? \"4em\" : \"5em\";\n            break;\n    }\n    return widgetSize;\n}","import React, { useContext, useEffect, useRef } from \"react\";\nimport { REPORT_RECEIVE } from \"../../jacdac-ts/src/jdom/constants\";\nimport { JDRegister } from \"../../jacdac-ts/src/jdom/register\";\nimport JacdacContext, { JacdacContextProps } from \"../jacdac/Context\";\nimport FieldDataSet from \"./FieldDataSet\"\nimport Trend from \"./Trend\"\nimport useChartPalette from \"./useChartPalette\";\nimport useChange from \"../jacdac/useChange\"\n\nconst DEFAULT_HORIZON = 50\nconst DEFAULT_HEIGHT = 12\n\nexport default function RegisterTrend(props: {\n    register: JDRegister,\n    showName?: boolean,\n    horizon?: number,\n    height?: number,\n    mini?: boolean,\n    interval?: number,\n}) {\n    const { register, mini, horizon, height, interval } = props;\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const palette = useChartPalette()\n    const dataSet = useRef(FieldDataSet.create(bus, [register], \"output\", palette, 100));\n\n    useChange(dataSet.current);\n\n    const addRow = () => dataSet.current.addRow();\n    // register on change if no intervals\n    useEffect(() => interval ? undefined : register?.subscribe(REPORT_RECEIVE, addRow), [interval, register])\n    // keep logging\n    useEffect(() => {\n        const id = interval && setInterval(addRow, interval);\n        return () => id && clearInterval(id);\n    }, [interval])\n\n    return <Trend dataSet={dataSet.current}\n        horizon={horizon || DEFAULT_HORIZON}\n        gradient={true}\n        height={height || DEFAULT_HEIGHT} mini={mini} />\n}","import { DependencyList, useEffect, useRef } from \"react\";\n\nexport default function useAnimationFrame(callback: (time: number) => boolean, deps?: DependencyList) {\n    const requestRef = useRef<number>();\n    const previousTimeRef = useRef<number>();\n\n    const animate = (time: number) => {\n        let active = true;\n        if (previousTimeRef.current != undefined) {\n            const deltaTime = time - previousTimeRef.current;\n            active = callback(deltaTime)\n        }\n        previousTimeRef.current = time;\n        if (active)\n            requestRef.current = requestAnimationFrame(animate);\n        else // we're done\n            requestRef.current = undefined;\n    }\n\n    useEffect(() => {\n        previousTimeRef.current = undefined;\n        requestRef.current = requestAnimationFrame(animate);\n        return () => requestRef.current !== undefined\n            && cancelAnimationFrame(requestRef.current);\n    }, deps || []);\n}"],"sourceRoot":""}