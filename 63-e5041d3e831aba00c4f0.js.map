{"version":3,"sources":["webpack:///./node_modules/@material-ui/icons/FiberManualRecord.js","webpack:///./src/components/ui/ColorInput.tsx","webpack:///./src/components/widgets/LightWidget.tsx","webpack:///./src/components/dashboard/DashboardLEDPixel.tsx","webpack:///./node_modules/@material-ui/icons/Remove.js"],"names":["ColorInput","props","value","onChange","useState","picker","setPicker","handleClick","handleClose","handleChange","color","hex","colorStyle","background","rgbToHsl","r","g","b","r$","g$","b$","cMin","Math","min","cMax","max","cDelta","h","s","l","maxAndMin","floor","setRgb","el","radius","hsl","fill","setAttribute","undefined","nr","setRgbLeds","pixelsContainer","colors","pixels","children","pn","length","ci","i","pixel","item","LightStripWidget","lightVariant","numPixels","actualBrightness","host","widgetSize","useWidgetTheme","controlBackground","pathRef","useRef","pixelsRef","neoradius","neocircleradius","sw","isJewel","LedPixelVariant","Jewel","isRing","Ring","paint","current","useEffect","p","offset","getTotalLength","extra","step","pos","point","getPointAtLength","x","y","subscribe","RENDER","width","height","d","Stick","dx","Strip","side","ceil","sqrt","dir","tr","line","n","neoperimeter","margin","ringradius","PI","wm","alpha","opacity","Array","map","_","LightMatrixWidget","columns","rows","widgetRef","pw","ph","ps","pr","m","w","render","ledEls","row","col","index","label","push","LightWidget","service","useRegisterUnpackedValue","register","LedPixelReg","NumPixels","Variant","ActualBrightness","NumColumns","numColumns","useServiceHost","Matrix","lightCommands","name","args","description","valueDescription","LightCommand","sending","setSending","command","setCommand","setOffset","duration","setDuration","setColors","mode","setMode","dcolors","slice","encoded","useMemo","sargs","vargs","join","c","parseInt","unshift","some","v","isNaN","ms","src","filter","largs","lightEncode","sendCommand","sendCmdAsync","LedPixelCmd","Run","handleCommandChange","ev","newName","target","find","cmd","handleOffsetChange","handleModeChange","handleDurationChange","handleColorChange","cs","handleRemoveColor","pop","handleAddColor","DashboardLEDPixel","services","expanded"],"mappings":"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","file":"63-e5041d3e831aba00c4f0.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"circle\", {\n  cx: \"12\",\n  cy: \"12\",\n  r: \"8\"\n}), 'FiberManualRecord');\n\nexports.default = _default;","import { Dialog, DialogContent } from '@material-ui/core';\nimport React, { useState } from 'react'\nimport { CirclePicker } from \"react-color\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport FiberManualRecordIcon from '@material-ui/icons/FiberManualRecord';\nimport IconButtonWithTooltip from './IconButtonWithTooltip';\n\nexport default function ColorInput(props: { value: string, onChange: (color: string) => void }) {\n    const { value, onChange } = props;\n    const [picker, setPicker] = useState(false);\n    const handleClick = () => setPicker(!picker);\n    const handleClose = () => setPicker(false);\n    const handleChange = (color: { hex: string }) => {\n        setPicker(false);\n        onChange(color.hex);\n    }\n    const colorStyle = { background: value }\n\n    return (\n        <>\n            <IconButtonWithTooltip title=\"choose color\" style={colorStyle} onClick={handleClick}>\n                <FiberManualRecordIcon />\n            </IconButtonWithTooltip>\n            <Dialog open={picker} onClose={handleClose}>\n                <DialogContent>\n                    <CirclePicker color={value} onChangeComplete={handleChange} />\n                </DialogContent>\n            </Dialog>\n        </>\n    )\n}\n","\nimport React, { useEffect, useRef } from \"react\";\nimport { LedPixelReg, LedPixelVariant, RENDER } from \"../../../jacdac-ts/src/jdom/constants\";\nimport useServiceHost from \"../hooks/useServiceHost\";\nimport LedPixelServiceHost from \"../../../jacdac-ts/src/hosts/ledpixelservicehost\";\nimport SvgWidget from \"../widgets/SvgWidget\";\nimport useWidgetTheme from \"../widgets/useWidgetTheme\";\nimport { JDService } from \"../../../jacdac-ts/src/jdom/service\";\nimport { useRegisterUnpackedValue } from \"../../jacdac/useRegisterValue\"\nimport LoadingProgress from \"../ui/LoadingProgress\";\n\nfunction rgbToHsl(r: number, g: number, b: number): [number, number, number] {\n    const [r$, g$, b$] = [r / 255, g / 255, b / 255];\n    const cMin = Math.min(r$, g$, b$);\n    const cMax = Math.max(r$, g$, b$);\n    const cDelta = cMax - cMin;\n    let h: number;\n    let s: number;\n    let l: number;\n    const maxAndMin = cMax + cMin;\n\n    //lum\n    l = (maxAndMin / 2) * 100\n\n    if (cDelta === 0)\n        s = h = 0;\n    else {\n        //hue\n        if (cMax === r$)\n            h = 60 * (((g$ - b$) / cDelta) % 6);\n        else if (cMax === g$)\n            h = 60 * (((b$ - r$) / cDelta) + 2);\n        else if (cMax === b$)\n            h = 60 * (((r$ - g$) / cDelta) + 4);\n\n        //sat\n        if (l > 50)\n            s = 100 * (cDelta / (2 - maxAndMin));\n        else\n            s = 100 * (cDelta / maxAndMin);\n    }\n\n    // at least 60% luminosity\n    l = Math.max(l, 60);\n    return [Math.floor(h), Math.floor(s), Math.floor(l)];\n}\n\nfunction setRgb(el: SVGElement, r: number, g: number, b: number, radius?: number) {\n    const hsl = rgbToHsl(r, g, b);\n    const [h, s, l] = hsl;\n    const fill = `hsl(${h}, ${s}%, ${l}%)`;\n    el.setAttribute(\"fill\", fill);\n    if (radius !== undefined) {\n        const nr = radius * (1 + (l - 60) / 200);\n        el.setAttribute(\"r\", \"\" + nr);\n    }\n}\n\nfunction setRgbLeds(pixelsContainer: SVGElement, colors: Uint8Array, radius?: number) {\n    const pixels = pixelsContainer?.children;\n    if (!colors || !pixels)\n        return;\n\n    const pn = Math.min(pixels.length, colors.length / 3);\n    let ci = 0;\n    for (let i = 0; i < pn; ++i) {\n        const pixel = pixels.item(i) as SVGElement;\n        setRgb(pixel, colors[ci], colors[ci + 1], colors[ci + 2], radius);\n        ci += 3;\n    }\n}\n\nfunction LightStripWidget(props: {\n    lightVariant: LedPixelVariant,\n    numPixels: number,\n    actualBrightness: number,\n    host: LedPixelServiceHost,\n    widgetSize?: string,\n}) {\n    const { lightVariant, numPixels, actualBrightness, host, widgetSize } = props;\n    const { background, controlBackground } = useWidgetTheme()\n    const pathRef = useRef<SVGPathElement>(undefined)\n    const pixelsRef = useRef<SVGGElement>(undefined);\n    const neoradius = 6;\n    const neocircleradius = neoradius + 1;\n    const sw = neoradius * 2.8;\n    const isJewel = lightVariant === LedPixelVariant.Jewel;\n    const isRing = lightVariant === LedPixelVariant.Ring;\n\n    // paint svg via dom\n    const paint = () => setRgbLeds(pixelsRef.current, host?.colors, neocircleradius);\n\n    // reposition pixels along the path\n    useEffect(() => {\n        const p = pathRef.current;\n        const pixels = pixelsRef.current?.children;\n        if (!p || !pixels)\n            return;\n\n        const offset = isJewel ? 1 : 0;\n        const pn = pixels.length;\n        const length = p.getTotalLength();\n        const extra = isRing || isJewel ? 0 : 1;\n        const step = length / (pn - offset);\n\n        for (let i = offset; i < pn; ++i) {\n            const pixel = pixels.item(i) as SVGCircleElement;\n            const pos = i - offset;\n            const point = p.getPointAtLength(step * (pos + extra / 2.0));\n            pixel.setAttribute(\"cx\", \"\" + point.x);\n            pixel.setAttribute(\"cy\", \"\" + point.y);\n        }\n\n        paint();\n    }, [lightVariant, numPixels, pathRef.current, pixelsRef.current])\n\n    // render when new colors are in\n    useEffect(() => host?.subscribe(RENDER, paint), [host]);\n\n    let width: number;\n    let height: number;\n\n    let d = \"\";\n    if (lightVariant === LedPixelVariant.Stick) {\n        const dx = neoradius * 3\n        d = `M 0 ${dx}`\n        for (let i = 0; i < numPixels; ++i) {\n            d += ` h ${dx} 0`\n        }\n        width = numPixels * dx;\n        height = 2 * dx;\n    }\n    else if (lightVariant === LedPixelVariant.Strip) {\n        const side = Math.ceil(Math.sqrt(numPixels) * 1.6108)\n\n        let i = 0;\n        let dir = 1\n        const dx = neoradius * 3\n        const tr = neoradius * 6\n\n        let line = 1;\n        d = `M ${2 * tr} ${dx}`\n        while (i < numPixels) {\n            d += ` h ${dx * dir}`;\n            if ((i % side) === side - 1) {\n                // turn around\n                d += ` c ${tr * dir} 0, ${tr * dir} ${tr}, 0 ${tr}`\n                dir = -dir;\n                line++;\n            }\n            i++;\n        }\n\n        width = side * dx + 4 * tr;\n        height = line * tr + 2 * dx;\n    }\n    else {\n        const n = numPixels - (isJewel ? 1 : 0)\n        const neoperimeter = n * (2.7 * neoradius)\n        const margin = 2 * neoradius;\n        const ringradius = neoperimeter / (2 * Math.PI);\n        width = 2 * (margin + ringradius);\n        height = width;\n        const wm = width - 2 * margin;\n        d = `M ${margin},${height >> 1} a ${ringradius},${ringradius} 0 1,0 ${wm},0 a ${ringradius},${ringradius} 0 1,0 -${wm}, 0`\n    }\n\n    // tune opacity to account for global opacity\n    const alpha = 0.7;\n    const opacity = alpha + (1 - alpha) * ((actualBrightness || 0) / 0xff);\n\n    return <SvgWidget width={width} height={height} size={widgetSize}>\n        <>\n            <path ref={pathRef} d={d} fill=\"transparent\" stroke={background} strokeWidth={sw} />\n            <g ref={pixelsRef} opacity={opacity}>\n                {Array(numPixels).fill(0).map((_, i) => <circle key={\"pixel\" + i}\n                    r={neocircleradius}\n                    cx={width >> 1} cy={height >> 1}\n                    stroke={controlBackground}\n                    strokeWidth={1}\n                    aria-label={`pixel ${i}`}\n                >\n                    <title>pixel {i}</title>\n                </circle>)}\n            </g>\n        </>\n    </SvgWidget>\n}\n\n\nfunction LightMatrixWidget(props: {\n    lightVariant: LedPixelVariant,\n    actualBrightness: number,\n    host: LedPixelServiceHost,\n    widgetSize?: string,\n    columns: number,\n    rows: number,\n}) {\n    const { columns, rows, host, widgetSize } = props;\n    const { background, controlBackground } = useWidgetTheme()\n\n    const widgetRef = useRef<SVGGElement>();\n    // compute size\n    const pw = 8;\n    const ph = 8;\n    const ps = 0.5;\n    const pr = 1;\n    const m = 2;\n    const w = columns * pw + (columns + 1) * m;\n    const h = rows * ph + (rows + 1) * m;\n\n    // paint svg via dom\n    const paint = () => setRgbLeds(widgetRef.current, host?.colors);\n\n    // add leds\n    const render = () => {\n        const ledEls: JSX.Element[] = [];\n\n        let y = m;\n        for (let row = 0; row < rows; row++) {\n            let x = m;\n            for (let col = 0; col < columns; col++) {\n                const index = row * columns + col;\n                const label = `pixel ${index} at ${row},${col}`\n                ledEls.push(<rect key={`l${row}-${col}`}\n                    x={x} y={y} width={pw}\n                    height={ph} rx={pr} ry={pr}\n                    fill={controlBackground}\n                    stroke={\"none\"}\n                    strokeWidth={ps}\n                    aria-label={label}\n                >\n                    <title>{label}</title>\n                </rect>);\n                x += pw + m;\n            }\n            y += ph + m;\n        }\n        return ledEls\n    }\n\n    // render when DOM render\n    useEffect(paint, [columns, rows, widgetRef.current]);\n\n    // render when new colors are in\n    useEffect(() => host?.subscribe(RENDER, paint), [host]);\n\n    return <SvgWidget width={w} height={h} size={widgetSize}>\n        <rect x={0} y={0} width={w} height={h} rx={pr} ry={pr} fill={background} />\n        <g ref={widgetRef}>\n            {render()}\n        </g>\n    </SvgWidget>\n}\n\nexport default function LightWidget(props: { variant?: \"icon\" | \"\", service: JDService, widgetCount?: number }) {\n    const { service } = props;\n    const [numPixels] = useRegisterUnpackedValue<[number]>(service.register(LedPixelReg.NumPixels));\n    const [lightVariant] = useRegisterUnpackedValue<[LedPixelVariant]>(service.register(LedPixelReg.Variant));\n    const [actualBrightness] = useRegisterUnpackedValue<[number]>(service.register(LedPixelReg.ActualBrightness));\n    const [numColumns] = useRegisterUnpackedValue<[number]>(service.register(LedPixelReg.NumColumns))\n    const host = useServiceHost<LedPixelServiceHost>(service);\n\n    if (numPixels === undefined || actualBrightness === undefined)\n        return <LoadingProgress />; // nothing to render\n\n    if (!numPixels)\n        return null;\n\n    if (lightVariant === LedPixelVariant.Matrix) {\n        const columns = numColumns || Math.floor(Math.sqrt(numPixels));\n        const rows = Math.floor(numPixels / columns);\n        return <LightMatrixWidget\n            lightVariant={lightVariant}\n            actualBrightness={actualBrightness}\n            host={host}\n            columns={columns}\n            rows={rows}\n        />\n    }\n    else\n        return <LightStripWidget\n            numPixels={numPixels}\n            lightVariant={lightVariant}\n            actualBrightness={actualBrightness}\n            host={host}\n        />\n}\n","import { Grid, MenuItem, TextField, Typography } from \"@material-ui/core\";\nimport React, { ChangeEvent, useMemo, useState } from \"react\";\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\";\nimport { lightEncode } from \"../../../jacdac-ts/src/jdom/light\";\nimport ColorInput from \"../ui/ColorInput\";\nimport SelectWithLabel from \"../ui/SelectWithLabel\";\nimport { JDService } from \"../../../jacdac-ts/src/jdom/service\";\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport RemoveIcon from '@material-ui/icons/Remove';\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport AddIcon from '@material-ui/icons/Add';\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport IconButtonWithTooltip from \"../ui/IconButtonWithTooltip\";\nimport useServiceHost from \"../hooks/useServiceHost\";\nimport LedPixelServiceHost from \"../../../jacdac-ts/src/hosts/ledpixelservicehost\";\nimport LightWidget from \"../widgets/LightWidget\";\nimport { LedPixelCmd } from \"../../../jacdac-ts/src/jdom/constants\";\n/*\n0xD6: range P=0 N=length W=1 S=0- range from pixel P, Npixels long (currently unsupported: every Wpixels skip Spixels)\n*/\n\ninterface LightCommand {\n    name: string;\n    args: \"C+\" | \"K\" | \"M\";\n    description: string;\n}\n\nconst lightCommands = [\n    {\n        name: \"setall\",\n        args: \"C+\",\n        description: \"set all pixels in current range to given color pattern\"\n    },\n    {\n        name: \"fade\",\n        args: \"C+\",\n        description: \"set pixels in current range to colors between colors in sequence\"\n    },\n    {\n        name: \"rotfwd\",\n        args: \"K\",\n        description: \"rotate (shift) pixels away from the connector\",\n        valueDescription: \"pixel positions to rotate\"\n    },\n    {\n        name: \"rotback\",\n        args: \"K\",\n        description: \"rotate (shift) pixels towards the connector\",\n        valueDescription: \"pixel positions to rotate\"\n    },\n]\n\nfunction LightCommand(props: { service: JDService, expanded: boolean }) {\n    const { service } = props;\n    const [sending, setSending] = useState(false);\n\n    const [command, setCommand] = useState(lightCommands[1]);\n    const [offset, setOffset] = useState(\"1\");\n    const [duration, setDuration] = useState(\"100\");\n    const [colors, setColors] = useState([\"#0000ff\", \"#ff0000\"]);\n    const [mode, setMode] = useState(0);\n\n    const { name, args, description, valueDescription } = command;\n    const dcolors = args == \"PC\" ? colors.slice(0, 1) : colors;\n\n    const encoded = useMemo(() => {\n        let sargs = \"\";\n        let vargs = [];\n        switch (args) {\n            case \"C+\":\n                sargs = Array(colors.length).fill(\"#\").join(\" \");\n                vargs = colors.map(c => parseInt(c.slice(1), 16));\n                break;\n            case \"K\": {\n                sargs = \"%\";\n                vargs = [parseInt(offset)];\n                break;\n            }\n            case \"PC\": {\n                sargs = \"% #\";\n                vargs = [parseInt(offset), parseInt(colors[0].slice(1), 16)];\n                break;\n            }\n        }\n\n        if (mode)\n            vargs.unshift(mode);\n\n        if (vargs.some(v => v === undefined || isNaN(v)))\n            return undefined;\n\n        let ms = parseInt(duration);\n        if (isNaN(ms))\n            ms = 100;\n        const src = [\n            mode && `tmpmode %`,\n            `${name} ${sargs}`,\n            `show %`\n        ].filter(l => !!l).join('\\n');\n        const largs = [...vargs, ms];\n        const r = lightEncode(src, largs);\n        return r;\n    }, [command, colors, duration, offset, mode]);\n\n    const sendCommand = async () => {\n        if (!encoded) return;\n        try {\n            setSending(true);\n            await service.sendCmdAsync(LedPixelCmd.Run, encoded);\n        }\n        finally {\n            setSending(false)\n        }\n    }\n    const handleCommandChange = (ev: ChangeEvent<{ name?: string; value: unknown; }>) => {\n        const newName = ev.target.value as string;\n        setCommand(lightCommands.find(cmd => cmd.name === newName));\n    }\n    const handleOffsetChange = (ev: any) => {\n        setOffset(ev.target.value);\n    }\n    const handleModeChange = (ev: any) => {\n        setMode(ev.target.value);\n    }\n    const handleDurationChange = (ev: any) => {\n        setDuration(ev.target.value);\n    }\n    const handleColorChange = (index: number) => async (color: string) => {\n        const cs = colors.slice(0);\n        cs[index] = color;\n        setColors(cs);\n    }\n    const handleRemoveColor = () => {\n        const cs = colors.slice(0);\n        cs.pop();\n        setColors(cs);\n    }\n    const handleAddColor = () => {\n        const cs = colors.slice(0);\n        cs.push('#ff0000');\n        setColors(cs);\n    }\n\n    return <>\n        <Grid item>\n            <Grid container spacing={1} direction=\"row\" alignItems=\"center\" justify=\"flex-start\">\n                <Grid item key=\"descr\" xs={12}>\n                    <Typography variant=\"caption\">{description}</Typography>\n                </Grid>\n                <Grid item key=\"select\" xs={12}>\n                    <SelectWithLabel disabled={sending} fullWidth={true} label=\"command\" value={name} onChange={handleCommandChange}>\n                        {lightCommands.map(cmd => <MenuItem key={cmd.name} value={cmd.name}>{cmd.name}</MenuItem>)}\n                    </SelectWithLabel>\n                </Grid>\n                <Grid item key=\"time\" xs={6}>\n                    <TextField variant=\"outlined\" label={\"duration (milliseconds)\"} type=\"number\" value={duration} onChange={handleDurationChange} />\n                </Grid>\n                <Grid item key=\"mode\" xs={6}>\n                    <SelectWithLabel fullWidth={true} label=\"update mode\" value={mode + \"\"} onChange={handleModeChange}>\n                        <MenuItem value={0}>replace</MenuItem>\n                        <MenuItem value={1}>add</MenuItem>\n                        <MenuItem value={2}>substract</MenuItem>\n                        <MenuItem value={3}>multiply</MenuItem>\n                    </SelectWithLabel>\n                </Grid>\n            </Grid>\n        </Grid>\n        <Grid item>\n            <Grid container spacing={1} direction=\"row\"\n                alignItems=\"center\" alignContent=\"flex-start\"\n                justify=\"flex-start\">\n                {(args === \"K\" || args === \"PC\") && <Grid item key=\"K\">\n                    <TextField variant=\"outlined\" type=\"number\" helperText={valueDescription} value={offset} onChange={handleOffsetChange} />\n                </Grid>}\n                {(args === \"C+\" || args === \"PC\") && dcolors.map((c, i) => <Grid item xs key={i}>\n                    <ColorInput value={c} onChange={handleColorChange(i)} />\n                </Grid>)}\n                {args === \"C+\" && <Grid item xs key=\"minuscolor\">\n                    <IconButtonWithTooltip disabled={colors.length < 2} title={\"Remove color\"} onClick={handleRemoveColor}>\n                        <RemoveIcon />\n                    </IconButtonWithTooltip>\n                    <IconButtonWithTooltip disabled={colors.length > 4} title={\"Add color\"} onClick={handleAddColor}>\n                        <AddIcon />\n                    </IconButtonWithTooltip>\n                </Grid>}\n                <Grid item xs key=\"run\">\n                    <IconButtonWithTooltip disabled={!encoded} title={\"Run command\"} onClick={sendCommand}>\n                        <PlayArrowIcon />\n                    </IconButtonWithTooltip>\n                </Grid>\n            </Grid>\n        </Grid>\n    </>\n}\n\nexport default function DashboardLEDPixel(props: DashboardServiceProps) {\n    const { service, services, expanded } = props;\n    const host = useServiceHost<LedPixelServiceHost>(service);\n    return <>\n        {host && <LightWidget widgetCount={services.length} {...props} />}\n        {expanded &&\n            <LightCommand service={service} expanded={expanded} />}\n    </>\n}","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19 13H5v-2h14v2z\"\n}), 'Remove');\n\nexports.default = _default;"],"sourceRoot":""}