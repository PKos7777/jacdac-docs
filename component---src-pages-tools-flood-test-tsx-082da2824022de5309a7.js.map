{"version":3,"sources":["webpack://jacdac-docs/./src/components/alert/ConnectAlert.tsx","webpack://jacdac-docs/./src/components/ui/GridHeader.tsx","webpack://jacdac-docs/./src/pages/tools/flood-test.tsx"],"names":["useStyles","makeStyles","theme","createStyles","button","marginLeft","spacing","NoSsrConnectAlert","props","classes","serviceClass","useContext","JacdacContext","bus","transports","devices","useChange","b","ignoreSelf","spec","serviceSpecificationFromClassIdentifier","length","name","map","transport","type","ConnectAlert","hr","background","palette","text","disabled","marginBottom","start","width","GridHeader","title","count","variant","action","clsx","undefined","FloodCard","device","numResponses","startCounter","size","handleClick","service","data","jdpack","sendCmdAsync","ControlCmd","Page","useDevices","useState","setNumResponses","setStartCounter","setSize","handleChangeNumberResponses","ev","i","parseInt","target","value","isNaN","handleChangeStartCounter","Math","max","handleChangeSize","id"],"mappings":"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","file":"component---src-pages-tools-flood-test-tsx-082da2824022de5309a7.js","sourcesContent":["// tslint:disable-next-line: no-submodule-imports\nimport { Box, createStyles, makeStyles } from \"@material-ui/core\"\n// tslint:disable-next-line: no-submodule-imports\nimport Alert from \"../ui/Alert\"\nimport React, { useContext } from \"react\"\nimport { serviceSpecificationFromClassIdentifier } from \"../../../jacdac-ts/src/jdom/spec\"\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\"\nimport ConnectButton from \"../buttons/ConnectButton\"\nimport { NoSsr } from \"@material-ui/core\"\nimport useChange from \"../../jacdac/useChange\"\n\nconst useStyles = makeStyles(theme =>\n    createStyles({\n        button: {\n            marginLeft: theme.spacing(2),\n        },\n    })\n)\n\nfunction NoSsrConnectAlert(props: { serviceClass?: number }) {\n    const classes = useStyles()\n    const { serviceClass } = props\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const { transports } = bus\n    const devices = useChange(bus, b => b.devices({ serviceClass, ignoreSelf: true }))\n    const spec = serviceSpecificationFromClassIdentifier(serviceClass)\n\n    // don't show if no transport, some devices\n    if (!transports.length || devices?.length) return null\n\n    return (\n        <Box displayPrint=\"none\">\n            <Alert severity=\"info\" closeable={true}>\n                {!spec && <span>Did you connect your device?</span>}\n                {spec && <span>Did you connect a {spec.name} device?</span>}\n                {transports.map(transport => (\n                    <ConnectButton\n                        key={transport.type}\n                        transport={transport}\n                        className={classes.button}\n                        full={true}\n                        transparent={true}\n                    />\n                ))}\n            </Alert>\n        </Box>\n    )\n}\n\nexport default function ConnectAlert(props: { serviceClass?: number }) {\n    return (\n        <NoSsr>\n            <NoSsrConnectAlert {...props} />\n        </NoSsr>\n    )\n}\n","import { Box, Chip, createStyles, Grid, makeStyles, Typography, useTheme } from \"@material-ui/core\";\nimport React from \"react\";\nimport clsx from 'clsx';\n\nconst useStyles = makeStyles((theme) => createStyles({\n    hr: {\n        background: theme.palette.text.disabled,\n        marginBottom: \"unset\"\n    },\n    start: {\n        width: theme.spacing(2)\n    },\n}));\n\nexport default function GridHeader(props: {\n    title?: string,\n    count?: number,\n    variant?: \"subtitle1\" | \"caption\" | \"subtitle2\",\n    action?: JSX.Element\n}) {\n    const { title, count, variant, action } = props;\n    const classes = useStyles();\n    return <Grid item xs={12}>\n        <Grid container direction=\"row\" spacing={1} justify=\"center\" alignItems=\"center\">\n            <Grid item>\n                <hr className={clsx(classes.hr, classes.start)} />\n            </Grid>\n            <Grid item>\n                {action && <Box component=\"span\" mr={1}>{action}</Box>}\n                <Typography component=\"span\" variant={variant || \"subtitle1\"}>{title}</Typography>\n                {count !== undefined && <Box component=\"span\" ml={0.5}><Chip label={count} /></Box>}\n            </Grid>\n            <Grid item xs>\n                <hr className={classes.hr} />\n            </Grid>\n        </Grid>\n    </Grid>\n}\n","import {\n    Card,\n    CardActions,\n    CardContent,\n    CardHeader,\n    Grid,\n    TextField,\n} from \"@material-ui/core\"\nimport React, { ChangeEvent, useState } from \"react\"\nimport useDevices from \"../../components/hooks/useDevices\"\nimport DeviceCardHeader from \"../../components/DeviceCardHeader\"\nimport { JDDevice } from \"../../../jacdac-ts/src/jdom/device\"\nimport CmdButton from \"../../components/CmdButton\"\nimport { ControlCmd } from \"../../../jacdac-ts/jacdac-spec/dist/specconstants\"\nimport { jdpack } from \"../../../jacdac-ts/src/jdom/pack\"\nimport ConnectAlert from \"../../components/alert/ConnectAlert\"\nimport GridHeader from \"../../components/ui/GridHeader\"\nimport ConnectButtons from \"../../components/buttons/ConnectButtons\"\n\nfunction FloodCard(props: {\n    device: JDDevice\n    numResponses: number\n    startCounter: number\n    size: number\n}) {\n    const { device, numResponses, startCounter, size } = props\n    const handleClick = async () => {\n        const service = device.service(0)\n        const data = jdpack<[number, number, number]>(\"u32 u32 u8\", [\n            numResponses,\n            startCounter,\n            size,\n        ])\n        await service.sendCmdAsync(ControlCmd.FloodPing, data)\n    }\n    return (\n        <Card>\n            <DeviceCardHeader device={device} />\n            <CardActions>\n                <CmdButton onClick={handleClick}>Flood</CmdButton>\n            </CardActions>\n        </Card>\n    )\n}\n\nexport default function Page() {\n    const devices = useDevices({})\n    const [numResponses, setNumResponses] = useState(100)\n    const [startCounter, setStartCounter] = useState(0)\n    const [size, setSize] = useState(32)\n\n    const handleChangeNumberResponses = (ev: ChangeEvent<HTMLInputElement>) => {\n        const i = parseInt(ev.target.value)\n        if (!isNaN(i)) setNumResponses(i)\n    }\n    const handleChangeStartCounter = (ev: ChangeEvent<HTMLInputElement>) => {\n        const i = parseInt(ev.target.value)\n        if (!isNaN(i)) setStartCounter(Math.max(0, i))\n    }\n    const handleChangeSize = (ev: ChangeEvent<HTMLInputElement>) => {\n        const i = parseInt(ev.target.value)\n        if (!isNaN(i)) setSize(Math.max(1, i))\n    }\n\n    return (\n        <>\n            <h1>Flood Test</h1>\n            <Card>\n                <CardHeader title=\"Configuration\" />\n                <CardContent>\n                    <Grid container spacing={1}>\n                        <Grid item>\n                            <TextField\n                                label=\"number of responses\"\n                                value={numResponses}\n                                onChange={handleChangeNumberResponses}\n                                type=\"number\"\n                            />\n                        </Grid>\n                        <Grid item>\n                            <TextField\n                                label=\"start counter\"\n                                value={startCounter}\n                                onChange={handleChangeStartCounter}\n                                type=\"number\"\n                            />\n                        </Grid>\n                        <Grid item>\n                            <TextField\n                                label=\"size\"\n                                value={size}\n                                onChange={handleChangeSize}\n                                type=\"number\"\n                            />\n                        </Grid>\n                    </Grid>\n                </CardContent>\n            </Card>\n            <Grid container spacing={1}>\n                <GridHeader\n                    action={<ConnectButtons full={false} transparent={true} />}\n                    title={\"Devices\"}\n                />\n                {devices.map(device => (\n                    <Grid key={device.id} item>\n                        <FloodCard\n                            device={device}\n                            numResponses={numResponses}\n                            startCounter={startCounter}\n                            size={size}\n                        />\n                    </Grid>\n                ))}\n            </Grid>\n            <ConnectAlert />\n        </>\n    )\n}\n"],"sourceRoot":""}