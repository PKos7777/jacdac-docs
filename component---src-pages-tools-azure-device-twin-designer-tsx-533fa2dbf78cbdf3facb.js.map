{"version":3,"sources":["webpack://jacdac-docs/./node_modules/@material-ui/icons/Add.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/Delete.js","webpack://jacdac-docs/./src/components/AddServiceIconButton.tsx","webpack://jacdac-docs/./src/components/ServiceSpecificationSelect.tsx","webpack://jacdac-docs/./src/pages/tools/azure-device-twin-designer.tsx"],"names":["AddServiceIconButton","props","error","onAdd","children","serviceFilter","React","servicesAnchorEl","setServicesAnchorEl","servicesMenuId","useId","services","useMemo","serviceSpecifications","filter","srv","isInfrastructure","handleServiceAddClick","event","currentTarget","handleServiceAddClose","id","undefined","serviceSpecificationFromClassIdentifier","Boolean","map","classIdentifier","toString","name","useStyles","makeStyles","createStyles","root","minWidth","ServiceSpecificationSelect","label","serviceClass","setServiceClass","variant","fullWidth","useState","Math","random","labelId","classes","specs","spec","test","shortId","handleChange","parseInt","target","value","ComponentRow","component","onUpdate","twin","service","validateTwinComponent","nameError","serviceError","nameId","handleComponentNameChange","ev","escapeName","handleSetService","handleComponentDelete","components","splice","indexOf","count","c","length","AzureDeviceTwinDesigner","useLocalStorage","displayName","setTwin","dtdl","contents","serviceSpecificationToComponent","DTDL_CONTEXT","dtdlSource","JSON","stringify","update","clone","handleDisplayNameChange","handleAddService","names","push","uniqueName","i"],"mappings":";;;;;;;AAAa;;AAEb,6BAA6B,mBAAO,CAAC,IAA8C;;AAEnF,8BAA8B,mBAAO,CAAC,IAA+C;;AAErF,6BAA6C;AAC7C;AACA,CAAC,CAAC;AACF,SAAe;;AAEf,oCAAoC,mBAAO,CAAC,KAAO;;AAEnD,4CAA4C,mBAAO,CAAC,KAAuB;;AAE3E;AACA;AACA,CAAC;;AAED,SAAe,Y;;;;;;;;;ACnBF;;AAEb,6BAA6B,mBAAO,CAAC,IAA8C;;AAEnF,8BAA8B,mBAAO,CAAC,IAA+C;;AAErF,6BAA6C;AAC7C;AACA,CAAC,CAAC;AACF,SAAe;;AAEf,oCAAoC,mBAAO,CAAC,KAAO;;AAEnD,4CAA4C,mBAAO,CAAC,KAAuB;;AAE3E;AACA;AACA,CAAC;;AAED,SAAe,Y;;;;;;;;;;;;;;;;;;;ACnBf;AACA;CAEA;;CAEA;;AACA;AACA;AAEe,SAASA,oBAAT,CAA8BC,KAA9B,EAKZ;AACC,MAAQC,KAAR,GAAkDD,KAAlD,CAAQC,KAAR;AAAA,MAAeC,KAAf,GAAkDF,KAAlD,CAAeE,KAAf;AAAA,MAAsBC,QAAtB,GAAkDH,KAAlD,CAAsBG,QAAtB;AAAA,MAAgCC,aAAhC,GAAkDJ,KAAlD,CAAgCI,aAAhC;;AACA,wBAAgDC,2CAAA,CAAmC,IAAnC,CAAhD;AAAA,MAAOC,gBAAP;AAAA,MAAyBC,mBAAzB;;AACA,MAAMC,cAAc,GAAGC,kEAAK,EAA5B;AACA,MAAMC,QAAQ,GAAGC,8CAAO,CAAC;AAAA,WAAMC,yFAAqB,GAC/CC,MAD0B,CACnB,UAAAC,GAAG;AAAA,aAAI,CAACC,oFAAgB,CAACD,GAAD,CAArB;AAAA,KADgB,EAE1BD,MAF0B,CAEnB,UAAAC,GAAG;AAAA,aAAI,CAACV,aAAD,IAAkBA,aAAa,CAACU,GAAD,CAAnC;AAAA,KAFgB,CAAN;AAAA,GAAD,EAGlB,CAACV,aAAD,CAHkB,CAAxB;;AAKA,MAAMY,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACC,KAAD,EAAgD;AAC1EV,uBAAmB,CAACU,KAAK,CAACC,aAAP,CAAnB;AACH,GAFD;;AAGA,MAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAACC,EAAD;AAAA,WAAgB,YAAM;AAChDb,yBAAmB,CAAC,IAAD,CAAnB;;AACA,UAAIa,EAAE,KAAKC,SAAX,EAAsB;AAClB,YAAMP,GAAG,GAAGQ,2GAAuC,CAACF,EAAD,CAAnD;AACAlB,aAAK,CAACY,GAAD,CAAL;AACH;AACJ,KAN6B;AAAA,GAA9B;;AAQA,sBAAO,iHACH,iDAAC,uEAAD;AAAuB,SAAK,EAAC,eAA7B;AAA6C,qBAAeN,cAA5D;AAA4E,qBAAc,MAA1F;AAAiG,WAAO,EAAEQ;AAA1G,KACKb,QAAQ,iBAAI,iDAAC,oEAAD,OADjB,CADG,eAIH,iDAAC,+DAAD;AACI,MAAE,EAAEK,cADR;AAEI,YAAQ,EAAEF,gBAFd;AAGI,eAAW,MAHf;AAII,QAAI,EAAEiB,OAAO,CAACjB,gBAAD,CAJjB;AAKI,WAAO,EAAEa,qBAAqB,CAACE,SAAD;AALlC,KAOKX,QAAQ,CAACc,GAAT,CAAa,UAAAV,GAAG;AAAA,wBAAI,iDAAC,+DAAD;AAAU,SAAG,EAAEA,GAAG,CAACW,eAAnB;AAAoC,WAAK,EAAEX,GAAG,CAACW,eAAJ,CAAoBC,QAApB,CAA6B,EAA7B,CAA3C;AACjB,aAAO,EAAEP,qBAAqB,CAACL,GAAG,CAACW,eAAL;AADb,OAEhBX,GAAG,CAACa,IAFY,CAAJ;AAAA,GAAhB,CAPL,CAJG,eAgBH,iDAAC,+DAAD;AAAY,WAAO,EAAC,SAApB;AAA8B,SAAK,EAAE1B,KAAK,GAAG,OAAH,GAAa,SAAvD;AAAkE,aAAS,EAAC;AAA5E,KACKA,KAAK,IAAI,8BADd,CAhBG,CAAP;AAmBH,C;;;;;;;;;;;;;;;;;ACrDD;AACA;AACA;AAEA,IAAM2B,SAAS,GAAGC,mEAAU,CAAC;AAAA,SACzBC,mEAAY,CAAC;AACTC,QAAI,EAAE;AACFC,cAAQ,EAAE;AADR;AADG,GAAD,CADa;AAAA,CAAD,CAA5B;AAQe,SAASC,0BAAT,CAAoCjC,KAApC,EAOZ;AACC,MAAQkC,KAAR,GAA4ElC,KAA5E,CAAQkC,KAAR;AAAA,MAAeC,YAAf,GAA4EnC,KAA5E,CAAemC,YAAf;AAAA,MAA6BC,eAA7B,GAA4EpC,KAA5E,CAA6BoC,eAA7B;AAAA,MAA8CC,OAA9C,GAA4ErC,KAA5E,CAA8CqC,OAA9C;AAAA,MAAuDC,SAAvD,GAA4EtC,KAA5E,CAAuDsC,SAAvD;AAAA,MAAkErC,KAAlE,GAA4ED,KAA5E,CAAkEC,KAAlE;;AACA,kBAAkBsC,+CAAQ,CAAC,YAAYC,IAAI,CAACC,MAAL,EAAb,CAA1B;AAAA,MAAOC,OAAP;;AACA,MAAMC,OAAO,GAAGf,SAAS,EAAzB;AACA,MAAMgB,KAAK,GAAGhC,yFAAqB,GAAGC,MAAxB,CAA+B,UAAAgC,IAAI;AAAA,WAAI,CAAC,KAAKC,IAAL,CAAUD,IAAI,CAACE,OAAf,CAAL;AAAA,GAAnC,CAAd;;AAEA,MAAMC,YAAY,GAAG,SAAfA,YAAe,CAAC/B,KAAD;AAAA,WACjBmB,eAAe,CAACa,QAAQ,CAAChC,KAAK,CAACiC,MAAN,CAAaC,KAAd,CAAT,CADE;AAAA,GAArB;;AAGA,sBAAO,iDAAC,+DAAD;AACH,MAAE,EAAET,OADD;AAEH,aAAS,EAAEC,OAAO,CAACZ,IAFhB;AAGH,SAAK,EAAEG,KAHJ;AAIH,SAAK,EAAE,CAAC,CAACjC,KAJN;AAKH,cAAU,EAAEA,KALT;AAMH,SAAK,EAAEkC,YANJ;AAOH,UAAM,MAPH;AAQH,WAAO,EAAEE,OARN;AASH,aAAS,EAAEC,SATR;AAUH,YAAQ,EAAEU;AAVP,kBAWH,iDAAC,+DAAD;AAAU,OAAG,EAAC,MAAd;AAAqB,SAAK,EAAC;AAA3B,2BAXG,EAYFJ,KAAK,CAACpB,GAAN,CAAU,UAAAqB,IAAI;AAAA,wBAAI,iDAAC,+DAAD;AACf,SAAG,EAAEA,IAAI,CAACpB,eADK;AAEf,WAAK,EAAEoB,IAAI,CAACpB;AAFG,OAEeoB,IAAI,CAAClB,IAFpB,CAAJ;AAAA,GAAd,CAZE,CAAP;AAgBH,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5CD;AACA;AACA;CAEA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAYA,SAASyB,YAAT,CAAsBpD,KAAtB,EAIG;AACC,MAAQqD,SAAR,GAAsCrD,KAAtC,CAAQqD,SAAR;AAAA,MAAmBC,QAAnB,GAAsCtD,KAAtC,CAAmBsD,QAAnB;AAAA,MAA6BC,IAA7B,GAAsCvD,KAAtC,CAA6BuD,IAA7B;AACA,MAAQ5B,IAAR,GAA0B0B,SAA1B,CAAQ1B,IAAR;AAAA,MAAc6B,OAAd,GAA0BH,SAA1B,CAAcG,OAAd;;AACA,iBAAoC7C,8CAAO,CACvC;AAAA,WAAM8C,qBAAqB,CAACF,IAAD,EAAOF,SAAP,CAA3B;AAAA,GADuC,EAEvC,CAACE,IAAD,EAAOF,SAAP,CAFuC,CAA3C;AAAA,MAAQK,SAAR,YAAQA,SAAR;AAAA,MAAmBC,YAAnB,YAAmBA,YAAnB;;AAIA,MAAMC,MAAM,GAAGnD,kEAAK,EAApB;;AACA,MAAMoD,yBAAyB,GAAG,SAA5BA,yBAA4B,CAACC,EAAD,EAAuC;AACrET,aAAS,CAAC1B,IAAV,GAAiBoC,oFAAU,CAACD,EAAE,CAACZ,MAAH,CAAUC,KAAX,CAA3B;AACAG,YAAQ;AACX,GAHD;;AAIA,MAAMU,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAC7B,YAAD,EAA0B;AAC/CkB,aAAS,CAACG,OAAV,GACIlC,2GAAuC,CAACa,YAAD,CAD3C;AAEAmB,YAAQ;AACX,GAJD;;AAKA,MAAMW,qBAAqB,GAAG,SAAxBA,qBAAwB,GAAM;AAChCV,QAAI,CAACW,UAAL,CAAgBC,MAAhB,CAAuBZ,IAAI,CAACW,UAAL,CAAgBE,OAAhB,CAAwBf,SAAxB,CAAvB,EAA2D,CAA3D;AACAC,YAAQ;AACX,GAHD;;AAIA,sBACI,iDAAC,gEAAD;AAAM,QAAI,MAAV;AAAW,MAAE,EAAE;AAAf,kBACI,iDAAC,gEAAD;AAAM,aAAS,MAAf;AAAgB,WAAO,EAAE;AAAzB,kBACI,iDAAC,gEAAD;AAAM,QAAI,MAAV;AAAW,MAAE,EAAE;AAAf,kBACI,iDAAC,gEAAD;AACI,MAAE,EAAEM,MADR;AAEI,aAAS,EAAE,IAFf;AAGI,SAAK,EAAE,CAAC,CAACF,SAHb;AAII,WAAO,EAAC,UAJZ;AAKI,SAAK,EAAC,MALV;AAMI,cAAU,EAAEA,SANhB;AAOI,SAAK,EAAE/B,IAPX;AAQI,YAAQ,EAAEkC;AARd,IADJ,CADJ,eAaI,iDAAC,gEAAD;AAAM,QAAI;AAAV,kBACI,iDAAC,oFAAD;AACI,WAAO,EAAC,UADZ;AAEI,SAAK,EAAC,SAFV;AAGI,gBAAY,EAAEL,OAAO,CAAC/B,eAH1B;AAII,mBAAe,EAAEuC,gBAJrB;AAKI,SAAK,EAAEL;AALX,IADJ,CAbJ,eAsBI,iDAAC,gEAAD;AAAM,QAAI;AAAV,kBACI,iDAAC,kFAAD;AACI,SAAK,EAAC,gBADV;AAEI,WAAO,EAAEM;AAFb,kBAII,iDAAC,wEAAD,OAJJ,CADJ,CAtBJ,CADJ,CADJ;AAmCH;;AAED,SAASR,qBAAT,CACIF,IADJ,EAEIF,SAFJ,EAGE;AACE,MAAIM,YAAoB,GAAGtC,SAA3B;AACA,MAAMqC,SAAiB,GAAGrC,SAA1B;AACA,MAAMgD,KAAK,GAAGd,IAAI,CAACW,UAAL,CAAgBrD,MAAhB,CACV,UAAAyD,CAAC;AAAA,WAAIA,CAAC,CAACd,OAAF,CAAU/B,eAAV,KAA8B4B,SAAS,CAACG,OAAV,CAAkB/B,eAApD;AAAA,GADS,EAEZ8C,MAFF;AAGA,MAAIF,KAAK,GAAG,CAAZ,EAAeV,YAAY,yCAAZ;AACf,SAAO;AAAEA,gBAAY,EAAZA,YAAF;AAAgBD,aAAS,EAATA;AAAhB,GAAP;AACH;;AAEc,SAASc,uBAAT,GAAmC;AAC9C,MAAMnC,OAAO,GAAG,UAAhB;;AACA,yBAAwBoC,6EAAe,CACnC,sBADmC,EAEnC;AACIC,eAAW,EAAE,YADjB;AAEIR,cAAU,EAAE;AAFhB,GAFmC,CAAvC;AAAA,MAAOX,IAAP;AAAA,MAAaoB,OAAb;;AAQA,MAAMC,IAAI,GAAG;AACT,aAAS,WADA;AAET,oCAA8Bb,oFAAU,CAACR,IAAI,CAACmB,WAAN,CAAxC,OAFS;AAGTA,eAAW,EAAEnB,IAAI,CAACmB,WAHT;AAITG,YAAQ,EAAEtB,IAAI,CAACW,UAAL,CAAgB1C,GAAhB,CAAoB,UAAA8C,CAAC;AAAA,aAC3BQ,6GAA+B,CAACR,CAAC,CAACd,OAAH,EAAYc,CAAC,CAAC3C,IAAd,CADJ;AAAA,KAArB,CAJD;AAOT,gBAAYoD,kFAAYA;AAPf,GAAb;AASA,MAAMC,UAAU,GAAGC,IAAI,CAACC,SAAL,CAAeN,IAAf,EAAqB,IAArB,EAA2B,CAA3B,CAAnB;;AAEA,MAAMO,MAAM,GAAG,SAATA,MAAS,GAAM;AACjBR,WAAO,CAACS,0EAAK,CAAC7B,IAAD,CAAN,CAAP;AACH,GAFD;;AAGA,MAAM8B,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACvB,EAAD,EAAuC;AACnEP,QAAI,CAACmB,WAAL,GAAmBZ,EAAE,CAACZ,MAAH,CAAUC,KAA7B;AACAgC,UAAM;AACT,GAHD;;AAIA,MAAMG,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAC9B,OAAD,EAAiC;AACtD,QAAM+B,KAAK,GAAGhC,IAAI,CAACW,UAAL,CAAgB1C,GAAhB,CAAoB,UAAA8C,CAAC;AAAA,aAAIA,CAAC,CAAC3C,IAAN;AAAA,KAArB,CAAd;AACA4B,QAAI,CAACW,UAAL,CAAgBsB,IAAhB,CAAqB;AACjB7D,UAAI,EAAE8D,+EAAU,CAACF,KAAD,EAAQ/B,OAAO,CAACT,OAAhB,CADC;AAEjBS,aAAO,EAAPA;AAFiB,KAArB;AAIA2B,UAAM;AACT,GAPD;;AASA,sBACI,iHACI,0FADJ,eAEI,kEACO,GADP,eAEI,iDAAC,2DAAD;AAAM,QAAI,EAAC;AAAX,mBAFJ,EAIY,GAJZ,4GAM+C,GAN/C,eAOI,iDAAC,2DAAD;AAAM,MAAE,EAAC;AAAT,sCAPJ,iDAFJ,eAaI,iDAAC,gEAAD;AAAM,aAAS,MAAf;AAAgB,aAAS,EAAC,KAA1B;AAAgC,WAAO,EAAE;AAAzC,kBACI,iDAAC,gEAAD;AAAM,QAAI,MAAV;AAAW,MAAE,EAAE;AAAf,kBACI,iDAAC,gEAAD;AACI,YAAQ,MADZ;AAEI,aAAS,EAAE,IAFf;AAGI,SAAK,EAAC,cAHV;AAII,eAAW,EAAC,WAJhB;AAKI,SAAK,EAAE5B,IAAI,CAACmB,WAAL,IAAoB,EAL/B;AAMI,YAAQ,EAAEW,uBANd;AAOI,WAAO,EAAEhD;AAPb,IADJ,CADJ,EAYKkB,IAAI,CAACW,UAAL,CAAgB1C,GAAhB,CAAoB,UAAC8C,CAAD,EAAIoB,CAAJ;AAAA,wBACjB,iDAAC,YAAD;AACI,SAAG,EAAEpB,CAAC,CAAC3C,IADX;AAEI,UAAI,EAAE4B,IAFV;AAGI,eAAS,EAAEe,CAHf;AAII,cAAQ,EAAEa;AAJd,MADiB;AAAA,GAApB,CAZL,eAoBI,iDAAC,gEAAD;AAAM,QAAI,MAAV;AAAW,MAAE,EAAE;AAAf,kBACI,iDAAC,8EAAD;AAAsB,SAAK,EAAEG;AAA7B,IADJ,CApBJ,eAuBI,iDAAC,gEAAD;AAAM,QAAI,MAAV;AAAW,MAAE,EAAE;AAAf,kBACI,iDAAC,qEAAD,qBACI,iDAAC,oEAAD;AACI,SAAK,EAAEN,UADX;AAEI,QAAI,EAAC,MAFT;AAGI,YAAQ,EAAC;AAHb,IADJ,CADJ,CAvBJ,CAbJ,CADJ;AAiDH,C","file":"component---src-pages-tools-azure-device-twin-designer-tsx-533fa2dbf78cbdf3facb.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\"\n}), 'Add');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z\"\n}), 'Delete');\n\nexports.default = _default;","import React, { useMemo } from 'react';\nimport { Menu, MenuItem, Typography } from '@material-ui/core';\nimport { isInfrastructure, serviceSpecificationFromClassIdentifier, serviceSpecifications } from '../../jacdac-ts/src/jdom/spec';\n// tslint:disable-next-line: match-default-export-name no-submodule-imports\nimport AddIcon from '@material-ui/icons/Add';\n// tslint:disable-next-line: match-default-export-name no-submodule-imports\nimport IconButtonWithTooltip from \"./ui/IconButtonWithTooltip\"\nimport { useId } from \"react-use-id-hook\"\n\nexport default function AddServiceIconButton(props: {\n    onAdd: (service: jdspec.ServiceSpec) => void,\n    serviceFilter?: (service: jdspec.ServiceSpec) => boolean,\n    error?: string,\n    children?: JSX.Element | JSX.Element[]\n}) {\n    const { error, onAdd, children, serviceFilter } = props;\n    const [servicesAnchorEl, setServicesAnchorEl] = React.useState<null | HTMLElement>(null);\n    const servicesMenuId = useId();\n    const services = useMemo(() => serviceSpecifications()\n        .filter(srv => !isInfrastructure(srv))\n        .filter(srv => !serviceFilter || serviceFilter(srv))\n        , [serviceFilter])\n\n    const handleServiceAddClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n        setServicesAnchorEl(event.currentTarget);\n    };\n    const handleServiceAddClose = (id: number) => () => {\n        setServicesAnchorEl(null);\n        if (id !== undefined) {\n            const srv = serviceSpecificationFromClassIdentifier(id);\n            onAdd(srv);\n        }\n    };\n\n    return <>\n        <IconButtonWithTooltip title=\"Add a service\" aria-controls={servicesMenuId} aria-haspopup=\"true\" onClick={handleServiceAddClick}>\n            {children || <AddIcon />}\n        </IconButtonWithTooltip>\n        <Menu\n            id={servicesMenuId}\n            anchorEl={servicesAnchorEl}\n            keepMounted\n            open={Boolean(servicesAnchorEl)}\n            onClose={handleServiceAddClose(undefined)}\n        >\n            {services.map(srv => <MenuItem key={srv.classIdentifier} value={srv.classIdentifier.toString(16)}\n                onClick={handleServiceAddClose(srv.classIdentifier)}>\n                {srv.name}\n            </MenuItem>)}\n        </Menu>\n        <Typography variant=\"caption\" color={error ? \"error\" : \"inherit\"} component=\"div\">\n            {error || \"Select one or more services.\"}\n        </Typography></>\n}","import { createStyles, makeStyles, MenuItem, TextField, Theme } from \"@material-ui/core\";\nimport React, { ChangeEvent, useState } from \"react\";\nimport { serviceSpecifications } from \"../../jacdac-ts/src/jdom/spec\"\n\nconst useStyles = makeStyles(() =>\n    createStyles({\n        root: {\n            minWidth: \"18rem\",\n        }\n    }),\n);\n\nexport default function ServiceSpecificationSelect(props: {\n    label: string,\n    serviceClass: number;\n    setServiceClass: (serviceClass: number) => void;\n    variant?: \"outlined\" | \"filled\" | \"standard\";\n    fullWidth?: boolean;\n    error?: string;\n}) {\n    const { label, serviceClass, setServiceClass, variant, fullWidth, error } = props;\n    const [labelId] = useState('select-' + Math.random());\n    const classes = useStyles();\n    const specs = serviceSpecifications().filter(spec => !/^_/.test(spec.shortId))\n\n    const handleChange = (event: ChangeEvent<HTMLInputElement>) =>\n        setServiceClass(parseInt(event.target.value));\n\n    return <TextField\n        id={labelId}\n        className={classes.root}\n        label={label}\n        error={!!error}\n        helperText={error}\n        value={serviceClass}\n        select\n        variant={variant}\n        fullWidth={fullWidth}\n        onChange={handleChange}>\n        <MenuItem key=\"none\" value=\"NaN\">No service selected</MenuItem>\n        {specs.map(spec => <MenuItem\n            key={spec.classIdentifier}\n            value={spec.classIdentifier}>{spec.name}</MenuItem>)}\n    </TextField>\n}","import { Grid, TextField } from \"@material-ui/core\"\nimport React, { ChangeEvent, useMemo } from \"react\"\nimport { clone, uniqueName } from \"../../../jacdac-ts/src/jdom/utils\"\nimport useLocalStorage from \"../../components/useLocalStorage\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport DeleteIcon from \"@material-ui/icons/Delete\"\nimport { serviceSpecificationFromClassIdentifier } from \"../../../jacdac-ts/src/jdom/spec\"\nimport AddServiceIconButton from \"../../components/AddServiceIconButton\"\nimport ServiceSpecificationSelect from \"../../components/ServiceSpecificationSelect\"\nimport { DTDL_CONTEXT, escapeName } from \"../../../jacdac-ts/src/azure-iot/dtdl\"\nimport IconButtonWithTooltip from \"../../components/ui/IconButtonWithTooltip\"\nimport Snippet from \"../../components/ui/Snippet\"\nimport PaperBox from \"../../components/ui/PaperBox\"\nimport { useId } from \"react-use-id-hook\"\nimport { Link } from \"gatsby-theme-material-ui\"\nimport { serviceSpecificationToComponent } from \"../../../jacdac-ts/src/azure-iot/dtdlspec\"\n\ninterface DigitalTwinComponent {\n    name: string\n    service: jdspec.ServiceSpec\n}\n\ninterface DigitalTwinSpec {\n    displayName: string\n    components: DigitalTwinComponent[]\n}\n\nfunction ComponentRow(props: {\n    twin: DigitalTwinSpec\n    component: DigitalTwinComponent\n    onUpdate: () => void\n}) {\n    const { component, onUpdate, twin } = props\n    const { name, service } = component\n    const { nameError, serviceError } = useMemo(\n        () => validateTwinComponent(twin, component),\n        [twin, component]\n    )\n    const nameId = useId()\n    const handleComponentNameChange = (ev: ChangeEvent<HTMLInputElement>) => {\n        component.name = escapeName(ev.target.value)\n        onUpdate()\n    }\n    const handleSetService = (serviceClass: number) => {\n        component.service =\n            serviceSpecificationFromClassIdentifier(serviceClass)\n        onUpdate()\n    }\n    const handleComponentDelete = () => {\n        twin.components.splice(twin.components.indexOf(component), 1)\n        onUpdate()\n    }\n    return (\n        <Grid item xs={12}>\n            <Grid container spacing={2}>\n                <Grid item xs={6}>\n                    <TextField\n                        id={nameId}\n                        fullWidth={true}\n                        error={!!nameError}\n                        variant=\"outlined\"\n                        label=\"name\"\n                        helperText={nameError}\n                        value={name}\n                        onChange={handleComponentNameChange}\n                    />\n                </Grid>\n                <Grid item>\n                    <ServiceSpecificationSelect\n                        variant=\"outlined\"\n                        label=\"service\"\n                        serviceClass={service.classIdentifier}\n                        setServiceClass={handleSetService}\n                        error={serviceError}\n                    />\n                </Grid>\n                <Grid item>\n                    <IconButtonWithTooltip\n                        title=\"Remove service\"\n                        onClick={handleComponentDelete}\n                    >\n                        <DeleteIcon />\n                    </IconButtonWithTooltip>\n                </Grid>\n            </Grid>\n        </Grid>\n    )\n}\n\nfunction validateTwinComponent(\n    twin: DigitalTwinSpec,\n    component: DigitalTwinComponent\n) {\n    let serviceError: string = undefined\n    const nameError: string = undefined\n    const count = twin.components.filter(\n        c => c.service.classIdentifier === component.service.classIdentifier\n    ).length\n    if (count > 1) serviceError = `Multiple same service not supported.`\n    return { serviceError, nameError }\n}\n\nexport default function AzureDeviceTwinDesigner() {\n    const variant = \"outlined\"\n    const [twin, setTwin] = useLocalStorage<DigitalTwinSpec>(\n        \"jacdac:digitaltwin;1\",\n        {\n            displayName: \"mydesigner\",\n            components: [],\n        } as DigitalTwinSpec\n    )\n\n    const dtdl = {\n        \"@type\": \"Interface\",\n        \"@id\": `dtmi:jacdac:devices:${escapeName(twin.displayName)},1`,\n        displayName: twin.displayName,\n        contents: twin.components.map(c =>\n            serviceSpecificationToComponent(c.service, c.name)\n        ),\n        \"@context\": DTDL_CONTEXT,\n    }\n    const dtdlSource = JSON.stringify(dtdl, null, 2)\n\n    const update = () => {\n        setTwin(clone(twin))\n    }\n    const handleDisplayNameChange = (ev: ChangeEvent<HTMLInputElement>) => {\n        twin.displayName = ev.target.value\n        update()\n    }\n    const handleAddService = (service: jdspec.ServiceSpec) => {\n        const names = twin.components.map(c => c.name)\n        twin.components.push({\n            name: uniqueName(names, service.shortId),\n            service,\n        })\n        update()\n    }\n\n    return (\n        <>\n            <h1>Azure Device Twin Designer</h1>\n            <p>\n                An{\" \"}\n                <Link href=\"https://github.com/Azure/opendigitaltwins-dtdl/\">\n                    device twin\n                </Link>{\" \"}\n                is to be used in IoT solutions such as with Azure IoT Hubs,\n                Azure IoT Plug And Play. The repository of{\" \"}\n                <Link to=\"/dtmi/\">Azure IoT Plug And Play models</Link> for\n                services can be used to resolve models.\n            </p>\n\n            <Grid container direction=\"row\" spacing={2}>\n                <Grid item xs={12}>\n                    <TextField\n                        required\n                        fullWidth={true}\n                        label=\"Display name\"\n                        placeholder=\"My device\"\n                        value={twin.displayName || \"\"}\n                        onChange={handleDisplayNameChange}\n                        variant={variant}\n                    />\n                </Grid>\n                {twin.components.map((c, i) => (\n                    <ComponentRow\n                        key={c.name}\n                        twin={twin}\n                        component={c}\n                        onUpdate={update}\n                    />\n                ))}\n                <Grid item xs={12}>\n                    <AddServiceIconButton onAdd={handleAddService} />\n                </Grid>\n                <Grid item xs={12}>\n                    <PaperBox>\n                        <Snippet\n                            value={dtdlSource}\n                            mode=\"json\"\n                            download=\"model\"\n                        />\n                    </PaperBox>\n                </Grid>\n            </Grid>\n        </>\n    )\n}\n"],"sourceRoot":""}