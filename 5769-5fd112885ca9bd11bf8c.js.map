{"version":3,"sources":["webpack://jacdac-docs/./src/components/hooks/usePlayTone.ts","webpack://jacdac-docs/./src/components/dashboard/DashboardBuzzer.tsx","webpack://jacdac-docs/./src/components/hooks/useArrowKeys.ts","webpack://jacdac-docs/./src/components/hooks/useKeyboardNavigation.ts","webpack://jacdac-docs/./src/components/hooks/useKeyboardNavigationProps.ts"],"names":["VOLUME_GAIN","usePlayTone","defaultVolume","contextRef","useRef","volumeRef","useEffect","current","close","setVolume","v","isNaN","gain","value","playTone","frequency","duration","tone","createOscillator","type","connect","start","stop","currentTime","e","console","log","onClickActivateAudioContext","ctx","window","AudioContext","webkitAudioContext","buffer","createBuffer","source","createBufferSource","destination","volumeNode","createGain","undefined","error","useStyles","makeStyles","createStyles","btn","minWidth","padding","DashboardBuzzer","props","service","classes","gridRef","server","useServiceServer","color","volumeRegister","register","BuzzerReg","useRegisterUnpackedValue","volume","keyboardProps","useKeyboardNavigationProps","subscribe","BuzzerServer","args","notes","name","sendPlayTone","f","vol","period","duty","data","jdpack","sendCmdAsync","BuzzerCmd","handlePointerEnter","ev","buttons","handlePlayTone","handleChange","newValue","sendSetPackedAsync","map","note","LEFT_KEY","UP_KEY","RIGHT_KEY","DOWN_KEY","useArrowKeys","options","onLeft","onUp","onRight","onDown","symmetric","handlers","charCode","keyCodeFromEvent","handler","preventDefault","useKeyboardNavigation","parentRef","query","onMove","offset","focusable","Array","from","querySelectorAll","length","me","findIndex","document","activeElement","next","focus","vertical","onKeyDown"],"mappings":"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","file":"5769-5fd112885ca9bd11bf8c.js","sourcesContent":["import { useEffect, useRef, useState } from \"react\";\n\nconst VOLUME_GAIN = 0.5;\n\nexport default function usePlayTone(defaultVolume?: number) {\n    const contextRef = useRef<AudioContext>();\n    const volumeRef = useRef<GainNode>();\n\n    // final cleanup\n    useEffect(() => () => contextRef.current?.close(), [])\n\n    const setVolume = (v: number) => {\n        if (volumeRef.current && !isNaN(v)) {\n            volumeRef.current.gain.value = v * VOLUME_GAIN;\n        }\n    }\n\n    const playTone = (frequency: number, duration: number) => {\n        if (!contextRef.current) return;\n        try {\n            const tone = contextRef.current.createOscillator();\n            tone.type = \"sawtooth\";\n            tone.connect(volumeRef.current);\n            tone.frequency.value = frequency; // update frequency\n            tone.start(); // start and stop\n            tone.stop(contextRef.current.currentTime + duration / 1000);\n        }\n        catch (e) {\n            console.log(e)\n        }\n    }\n\n    // needs to be initiated in onClick on safari mobile\n    const onClickActivateAudioContext = () => {\n        if (contextRef.current) return;\n\n        try {\n            const ctx = contextRef.current = new (window.AudioContext || (window as any).webkitAudioContext)();\n\n            // play silence sound within onlick to unlock it\n            const buffer = ctx.createBuffer(1, 1, 22050);\n            const source = ctx.createBufferSource();\n            source.buffer = buffer;\n            source.connect(ctx.destination);\n            source.start();\n\n            // output node with volume\n            const volumeNode = volumeRef.current = ctx.createGain();\n            volumeNode.connect(ctx.destination);\n            volumeNode.gain.value = (defaultVolume !== undefined ? defaultVolume : 0.2) * VOLUME_GAIN;\n        }\n        catch (e) {\n            contextRef.current = undefined;\n            volumeRef.current = undefined;\n            console.error(e);\n        }\n    }\n\n    return {\n        onClickActivateAudioContext,\n        setVolume,\n        playTone\n    }\n}\n","\nimport { Button, createStyles, Grid, makeStyles, Slider } from \"@material-ui/core\";\nimport React, { useEffect, useRef } from \"react\";\nimport { BuzzerCmd, BuzzerReg } from \"../../../jacdac-ts/src/jdom/constants\";\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\";\nimport { jdpack } from \"../../../jacdac-ts/src/jdom/pack\";\nimport useKeyboardNavigationProps from \"../hooks/useKeyboardNavigationProps\";\nimport { useRegisterUnpackedValue } from \"../../jacdac/useRegisterValue\";\nimport useServiceServer from \"../hooks/useServiceServer\";\nimport usePlayTone from \"../hooks/usePlayTone\";\nimport BuzzerServer from \"../../../jacdac-ts/src/servers/buzzerserver\";\n\nconst useStyles = makeStyles(() => createStyles({\n    btn: {\n        minWidth: \"1em\",\n        padding: \"1em 0.75em 1em 0.75em\"\n    }\n}));\n\nexport default function DashboardBuzzer(props: DashboardServiceProps) {\n    const { service } = props;\n    const classes = useStyles();\n    const gridRef = useRef<HTMLDivElement>();\n    const server = useServiceServer<BuzzerServer>(service);\n    const color = server ? \"secondary\" : \"primary\";\n    const volumeRegister = service.register(BuzzerReg.Volume);\n    const [volume] = useRegisterUnpackedValue<[number]>(volumeRegister, props)\n    const keyboardProps = useKeyboardNavigationProps(gridRef.current)\n    const { playTone, setVolume, onClickActivateAudioContext } = usePlayTone(volume);\n\n    // listen for playTone commands from the buzzer\n    useEffect(() => server?.subscribe<[number, number]>(BuzzerServer.PLAY_TONE, args => {\n        playTone?.(args[0], args[1])\n    }), [server]);\n\n    const notes = [\n        { name: \"C\", frequency: 261.64 },\n        { name: \"D\", frequency: 293.68 },\n        { name: \"E\", frequency: 329.64 },\n        { name: \"F\", frequency: 349.24 },\n        { name: \"G\", frequency: 392.00 },\n        { name: \"A\", frequency: 440 },\n        { name: \"B\", frequency: 493.92 },\n    ];\n    const sendPlayTone = async (f: number) => {\n        if (server)\n            onClickActivateAudioContext(); // enable audio context within click handler\n        const vol = 1;\n        const period = 1000000 / f;\n        const duty = period * vol / 2;\n        const duration = 400;\n        const data = jdpack<[number, number, number]>(\"u16 u16 u16\", [period, duty, duration])\n        await service.sendCmdAsync(BuzzerCmd.PlayTone, data)\n    }\n    const handlePointerEnter = (f: number) => (ev: any) => {\n        if (ev.buttons)\n            sendPlayTone(f)\n    }\n    const handlePlayTone = (f: number) => () => sendPlayTone(f)\n    const handleChange = async (ev: unknown, newValue: number | number[]) => {\n        volumeRegister.sendSetPackedAsync(\"u0.8\", [newValue], true);\n    }\n    useEffect(() => setVolume(volume), [volume]);\n\n    return <Grid ref={gridRef} container alignItems=\"center\" alignContent=\"space-between\">\n        {notes.map(note => <Grid key={note.frequency} item xs><Button\n            className={classes.btn}\n            size=\"small\"\n            variant=\"outlined\"\n            onPointerEnter={handlePointerEnter(note.frequency)}\n            onPointerDown={handlePlayTone(note.frequency)}\n            {...keyboardProps}\n        >{note.name}</Button>\n        </Grid>)}\n        {volume !== undefined && <Grid item xs={12}>\n            <Slider\n                valueLabelDisplay=\"off\"\n                min={0} max={1} step={0.05}\n                aria-label=\"volume\"\n                value={volume}\n                color={color}\n                onChange={handleChange}\n            />\n        </Grid>}\n    </Grid>\n}\n","import React, { KeyboardEvent } from \"react\"\nimport { keyCodeFromEvent } from \"./useFireKey\";\n\nconst LEFT_KEY = 37;\nconst UP_KEY = 38;\nconst RIGHT_KEY = 39;\nconst DOWN_KEY = 40;\n\nexport default function useArrowKeys(options: {\n    onLeft?: () => void,\n    onRight?: () => void,\n    onUp?: () => void,\n    onDown?: () => void,\n    symmetric?: boolean;\n}) {\n    const { onLeft, onUp, onRight, onDown, symmetric } = options;\n\n    if (!onLeft && !onUp && !onRight && !onDown)\n        return undefined;\n\n    const handlers = {\n        [LEFT_KEY]: onLeft,\n        [RIGHT_KEY]: onRight,\n        [UP_KEY]: onUp || (symmetric && onRight),\n        [DOWN_KEY]: onDown || (symmetric && onLeft)\n    }\n\n    return (e: KeyboardEvent<Element>) => {\n        const charCode = keyCodeFromEvent(e);\n        const handler = handlers[charCode];\n        if (handler) {\n            e.preventDefault();\n            handler();\n        }\n    }\n}\n","import React from \"react\"\n\nexport default function useKeyboardNavigation(parentRef: Element) {\n    const query = '[tabindex=\"0\"]';\n    const onMove = (offset: number) => () => {\n        console.log('keyboard move', { offset })\n        const focusable = Array.from<SVGElement>(parentRef?.querySelectorAll(query) || []);\n        if (focusable.length) {\n            const me = focusable.findIndex(f => f === document.activeElement);\n            const next = ((me + offset) + focusable.length) % focusable.length;\n            focusable[next].focus();\n        }\n    }\n    return onMove;\n}","import useArrowKeys from \"./useArrowKeys\";\nimport useKeyboardNavigation from \"./useKeyboardNavigation\";\n\nexport default function useKeyboardNavigationProps(parentRef: Element, vertical?: boolean) {\n    const onMove = useKeyboardNavigation(parentRef);\n\n    const onKeyDown = useArrowKeys({\n        onLeft: !vertical && onMove(-1),\n        onRight: !vertical && onMove(1),\n        onDown: vertical && onMove(1),\n        onUp: vertical && onMove(-1),\n    });\n\n    return {\n        onKeyDown: parentRef && onKeyDown\n    }\n}"],"sourceRoot":""}