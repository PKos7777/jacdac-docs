{"version":3,"sources":["webpack:///./src/components/dashboard/DashboardGyroscope.tsx"],"names":["Sliders","props","host","register","visible","rates","useRegisterUnpackedValue","handleChangeX","event","newValue","reading","values","y","z","n","setValues","sendGetAsync","handleChangeY","x","handleChangeZ","valueDisplay","v","roundWithPrecision","length","step","marks","value","DashboardGyroscope","service","GyroscopeReg","RotationRates","useServiceHost","color","useWidgetTheme","active","rotator","useCallback","delta","rotation","unpackedValue","degreesToRadians","Math","PI","f"],"mappings":"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","file":"108-02fdcfcaeefaf8aba9cb.js","sourcesContent":["import React, { useCallback } from \"react\"\nimport { GyroscopeReg } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\"\nimport { useRegisterUnpackedValue } from \"../../jacdac/useRegisterValue\"\nimport useWidgetTheme from \"../widgets/useWidgetTheme\"\nimport useServiceHost from \"../hooks/useServiceHost\"\nimport SensorServiceHost from \"../../../jacdac-ts/src/hosts/sensorservicehost\"\nimport { JDRegister } from \"../../../jacdac-ts/src/jdom/register\"\nimport { Grid, Mark, NoSsr } from \"@material-ui/core\"\nimport { roundWithPrecision } from \"../../../jacdac-ts/src/jdom/utils\"\nimport CanvasWidget from \"../widgets/CanvasWidget\"\nimport { Vector } from \"../widgets/threeutils\"\nimport LoadingProgress from \"../ui/LoadingProgress\"\nimport Suspense from \"../ui/Suspense\"\nimport SliderWithLabel from \"../ui/SliderWithLabel\"\n\nfunction Sliders(props: {\n    host: SensorServiceHost<[number, number, number]>\n    register: JDRegister\n    visible: boolean\n}) {\n    const { host, register, visible } = props\n    const rates = useRegisterUnpackedValue<[number, number, number]>(register, {\n        visible,\n    })\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const handleChangeX: any = (\n        event: unknown,\n        newValue: number | number[]\n    ) => {\n        const [, y, z] = host.reading.values()\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const n = (newValue as any) as number\n        host.reading.setValues([n, y, z])\n        register.sendGetAsync()\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const handleChangeY: any = (\n        event: unknown,\n        newValue: number | number[]\n    ) => {\n        const [x, , z] = host.reading.values()\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const n = (newValue as any) as number\n        host.reading.setValues([x, n, z])\n        register.sendGetAsync()\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const handleChangeZ: any = (\n        event: unknown,\n        newValue: number | number[]\n    ) => {\n        const [x, y] = host.reading.values()\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const n = (newValue as any) as number\n        host.reading.setValues([x, y, n])\n        register.sendGetAsync()\n    }\n    const valueDisplay = (v: number) => `${roundWithPrecision(v, 1)}Â°/s`\n\n    if (!rates?.length) return <LoadingProgress />\n    const [x, y, z] = rates\n    const step = 1\n    const marks: Mark[] = [\n        {\n            value: 0,\n        },\n    ]\n    return (\n        <>\n            <Grid item xs={12}>\n                <SliderWithLabel\n                    label=\"X\"\n                    valueLabelDisplay=\"auto\"\n                    valueLabelFormat={valueDisplay}\n                    aria-label=\"x rotation rate slider\"\n                    min={-180}\n                    max={180}\n                    step={step}\n                    value={x}\n                    marks={marks}\n                    onChange={handleChangeX}\n                />\n            </Grid>\n            <Grid item xs={12}>\n                <SliderWithLabel\n                    label={\"Y\"}\n                    valueLabelDisplay=\"auto\"\n                    valueLabelFormat={valueDisplay}\n                    aria-label=\"y rotation rate slider\"\n                    min={-180}\n                    max={180}\n                    step={step}\n                    value={y}\n                    marks={marks}\n                    onChange={handleChangeY}\n                />\n            </Grid>\n            <Grid item xs={12}>\n                <SliderWithLabel\n                    label=\"Z\"\n                    valueLabelDisplay=\"auto\"\n                    valueLabelFormat={valueDisplay}\n                    aria-label=\"z rotation rate slider\"\n                    min={-180}\n                    max={180}\n                    step={step}\n                    value={z}\n                    marks={marks}\n                    onChange={handleChangeZ}\n                />\n            </Grid>\n        </>\n    )\n}\n\nexport default function DashboardGyroscope(props: DashboardServiceProps) {\n    const { service, visible } = props\n    const register = service.register(GyroscopeReg.RotationRates)\n    const host = useServiceHost<SensorServiceHost<[number, number, number]>>(\n        service\n    )\n    const color = host ? \"secondary\" : \"primary\"\n    const { active } = useWidgetTheme(color)\n    const rotator = useCallback(\n        (delta, rotation: Vector) => {\n            const rates = register.unpackedValue\n            if (!rates) return\n\n            const [x, y, z] = rates // degrees\n            const degreesToRadians = Math.PI / 180\n            const f = delta * degreesToRadians\n            return {\n                x: rotation.x + x * f,\n                y: rotation.y - z * f,\n                z: rotation.z - y * f,\n            }\n        },\n        [register]\n    )\n\n    return (\n        <Grid container direction=\"row\">\n            <Grid item>\n                <NoSsr>\n                    <Suspense>\n                        <CanvasWidget color={active} rotator={rotator} />\n                    </Suspense>\n                </NoSsr>\n            </Grid>\n            {host && (\n                <Sliders host={host} register={register} visible={visible} />\n            )}\n        </Grid>\n    )\n}\n"],"sourceRoot":""}