{"version":3,"sources":["webpack:///./src/components/makecode/MakeCodeSim.tsx","webpack:///./src/pages/tools/makecode-sim.tsx","webpack:///./src/jacdac/useDeviceSpecification.ts","webpack:///./src/components/dashboard/DashboardDeviceItem.tsx","webpack:///./node_modules/@material-ui/core/esm/internal/svg-icons/Person.js","webpack:///./node_modules/@material-ui/core/esm/Avatar/Avatar.js","webpack:///./src/components/devices/DeviceAvatar.tsx"],"names":["deviceSort","l","r","srvScore","srv","packets","reduce","prev","pkt","isReading","isValueOrIntensity","score","srvs","ls","services","slice","map","specification","filter","spec","rs","strcmp","deviceId","ignoredServices","SRV_CONTROL","SRV_LOGGER","SRV_SETTINGS","SRV_ROLE_MANAGER","SRV_POWER","Carousel","useContext","AppContext","toggleShowDeviceHostsDialog","devices","useDevices","announced","ignoreSelf","device","serviceClasses","sc","indexOf","length","sort","handleAdd","extensions","unique","arrayConcatMany","resolveMakecodeServiceFromClassIdentifier","serviceClass","info","client","repo","q","window","parent","postMessage","type","broadcast","id","VIRTUAL_DEVICE_NODE_NAME","Page","DarkModeContext","toggleDarkMode","rawTheme","createMuiTheme","palette","primary","main","secondary","contrastThreshold","theme","responsiveFontSizes","useEffect","useDeviceSpecification","firmwareIdentifierRegister","service","register","ControlReg","FirmwareIdentifier","firmwareIdentifier","useRegisterIntValue","deviceSpecificationFromFirmwareIdentifier","DashboardDeviceItem","props","expanded","toggleExpanded","variant","other","breakpoints","useChange","breakpointWeight","dashboardServiceWeight","readingRegister","valueRegister","intensityRegister","c","v","xs","sm","md","lg","xl","useStyles","makeStyles","createStyles","img","marginTop","small","width","spacing","height","large","DeviceAvatar","showMissing","size","imageUrl","useDeviceImage","name","useDeviceName","classes","sizeClassName","undefined","host","useDeviceHost","useDeviceStatusLightStyle","statusLEDClassName","className","statusLEDHelmetStyle","helmetStyle","handleIdentify","identify"],"mappings":"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","file":"component---src-pages-tools-makecode-sim-tsx-5ef321773270de71aa32.js","sourcesContent":["import React, { useContext, useEffect } from \"react\"\nimport { Button, createMuiTheme, responsiveFontSizes } from \"@material-ui/core\";\nimport ThemedLayout from \"../../components/ui/ThemedLayout\";\nimport { Grid } from \"@material-ui/core\";\nimport { JDDevice } from \"../../../jacdac-ts/src/jdom/device\";\nimport { isReading, isValueOrIntensity, resolveMakecodeServiceFromClassIdentifier } from \"../../../jacdac-ts/src/jdom/spec\";\nimport { arrayConcatMany, strcmp, unique } from \"../../../jacdac-ts/src/jdom/utils\";\nimport useDevices from \"../hooks/useDevices\";\nimport { SRV_CONTROL, SRV_LOGGER, SRV_POWER, SRV_ROLE_MANAGER, SRV_SETTINGS } from \"../../../jacdac-ts/src/jdom/constants\";\nimport MakeCodeIcon from \"../icons/MakeCodeIcon\"\nimport DashboardDeviceItem from \"../dashboard/DashboardDeviceItem\";\nimport Helmet from \"react-helmet\"\nimport DarkModeContext from \"../ui/DarkModeContext\";\nimport KindIcon from \"../KindIcon\";\nimport AppContext from \"../AppContext\";\nimport { VIRTUAL_DEVICE_NODE_NAME } from \"../../../jacdac-ts/src/jdom/constants\";\n\nfunction deviceSort(l: JDDevice, r: JDDevice): number {\n    const srvScore = (srv: jdspec.ServiceSpec) => srv.packets\n        .reduce((prev, pkt) => prev + (isReading(pkt) ? 10 : isValueOrIntensity(pkt) ? 1 : 0), 0) || 0;\n    const score = (srvs: jdspec.ServiceSpec[]) => srvs.reduce((prev, srv) => srvScore(srv), 0)\n\n    const ls = score(l.services().slice(1).map(srv => srv.specification).filter(spec => !!spec))\n    const rs = score(r.services().slice(1).map(srv => srv.specification).filter(spec => !!spec))\n    if (ls !== rs)\n        return -ls + rs;\n    return strcmp(l.deviceId, r.deviceId);\n}\n\n// hide the makecode device itself and power devices\nconst ignoredServices = [\n    SRV_CONTROL,\n    SRV_LOGGER,\n    SRV_SETTINGS,\n    SRV_ROLE_MANAGER,\n    SRV_POWER\n]\n\nfunction Carousel() {\n    const { toggleShowDeviceHostsDialog } = useContext(AppContext)\n    const devices = useDevices({ announced: true, ignoreSelf: true })\n        // ignore MakeCode device (role manager) and power devices\n        .filter(device => device.serviceClasses.filter(sc => ignoredServices.indexOf(sc) < 0).length)\n        // show best in front\n        .sort(deviceSort);\n    const handleAdd = () => {\n        // list all devices connected to the bus\n        // and query for them, let makecode show the missing ones\n        const extensions = unique(\n            arrayConcatMany(\n                devices.map(device => device.services()\n                    .map(srv => resolveMakecodeServiceFromClassIdentifier(srv.serviceClass))\n                    .map(info => info?.client.repo)\n                    .filter(q => !!q)\n                )\n            )\n        );\n        if (extensions?.length) {\n            // send message to makecode\n            window.parent.postMessage({\n                type: \"addextensions\",\n                extensions,\n                broadcast: true\n            }, \"*\")\n        }\n    }\n\n    return <Grid container alignItems=\"flex-start\" spacing={1}>\n        {devices.map(device => <DashboardDeviceItem key={device.id}\n            device={device} showAvatar={true} showHeader={true} />)}\n        <Grid item>\n            <Grid container spacing={1} direction=\"row\">\n                <Grid item>\n                    <Button size=\"medium\" variant=\"contained\" startIcon={<KindIcon kind={VIRTUAL_DEVICE_NODE_NAME} />}\n                        onClick={toggleShowDeviceHostsDialog} aria-label={\"Start Simulator\"}>Start simulator</Button>\n                </Grid>\n                {!!devices?.length && <Grid item>\n                    <Button size=\"medium\" color=\"primary\" variant=\"contained\" startIcon={<MakeCodeIcon />}\n                        onClick={handleAdd} aria-label={\"Add blocks\"}>Add blocks</Button>\n                </Grid>}\n            </Grid>\n        </Grid>\n    </Grid>\n}\n\nexport default function Page() {\n    const { toggleDarkMode } = useContext(DarkModeContext);\n    const rawTheme = createMuiTheme({\n        palette: {\n            primary: {\n                main: '#63c',\n            },\n            secondary: {\n                main: '#ffc400',\n            },\n            contrastThreshold: 5.1,\n            type: \"dark\"\n        },\n    })\n    const theme = responsiveFontSizes(rawTheme);\n\n    useEffect(() => toggleDarkMode('dark'), []); // always dark mode\n\n    return <ThemedLayout theme={theme}>\n        <Helmet>\n            <style>\n                {`\nhtml {\n    margin-right: 4px;\n    overflow-y: auto !important;\n}\nhtml, body {\n    background: transparent !important;\n}\n`}\n            </style>\n        </Helmet>\n        <Carousel />\n    </ThemedLayout>\n}\n","import React from \"react\"\nimport MakeCodeSim from \"../../components/makecode/MakeCodeSim\"\n\nexport default function Page() {\n    return <MakeCodeSim />\n}","import { ControlReg } from \"../../jacdac-ts/src/jdom/constants\";\nimport { JDDevice } from \"../../jacdac-ts/src/jdom/device\";\nimport { deviceSpecificationFromFirmwareIdentifier } from \"../../jacdac-ts/src/jdom/spec\";\nimport { useRegisterIntValue } from \"./useRegisterValue\";\n\nexport default function useDeviceSpecification(device: JDDevice) {\n    const firmwareIdentifierRegister = device?.service(0)?.register(ControlReg.FirmwareIdentifier);\n    const firmwareIdentifier = useRegisterIntValue(firmwareIdentifierRegister);\n    const specification = deviceSpecificationFromFirmwareIdentifier(firmwareIdentifier);\n    return specification;\n}\n","import { Grid } from \"@material-ui/core\";\nimport React, { useMemo } from \"react\";\nimport { JDDevice } from \"../../../jacdac-ts/src/jdom/device\";\nimport DashboardDevice from \"./DashboardDevice\";\nimport { GridBreakpoints } from \"../useGridBreakpoints\";\nimport { DashboardDeviceProps } from \"./Dashboard\";\nimport useChange from \"../../jacdac/useChange\";\nimport { dashboardServiceWeight } from \"./DashboardServiceWidget\";\n\nexport default function DashboardDeviceItem(props: {\n    device: JDDevice,\n    expanded?: boolean,\n    toggleExpanded?: () => void,\n    variant?: \"icon\" | \"\"\n} & DashboardDeviceProps) {\n    const { device, expanded, toggleExpanded, variant, ...other } = props;\n    const breakpoints: GridBreakpoints = useChange(device, () => {\n        const breakpointWeight = device.services()\n            .map(srv => {\n                return dashboardServiceWeight(srv)\n                    || (srv.readingRegister || srv.valueRegister || srv.intensityRegister ? 1 : 0)\n            })\n            .reduce((c: number, v) => c + v, 0);\n\n        if (breakpointWeight > 3)\n            return { xs: 12, sm: 12, md: 12, lg: 6, xl: 6 };\n        else if (breakpointWeight == 3)\n            return { xs: 12, sm: 12, md: 4, lg: 4, xl: 4 };\n        else if (breakpointWeight == 2)\n            return { xs: 12, sm: 6, md: 4, lg: 3, xl: 4 };\n        else\n            return { xs: expanded ? 12 : 6, sm: 4, md: 3, lg: 2, xl: \"auto\" };\n    }, [expanded]);\n\n    // based on size, expanded or reduce widget size\n    return <Grid item {...breakpoints}>\n        <DashboardDevice\n            device={device}\n            expanded={expanded}\n            toggleExpanded={toggleExpanded}\n            variant={variant}\n            {...other}\n        />\n    </Grid>\n}","import * as React from 'react';\nimport createSvgIcon from '../../utils/createSvgIcon';\n/**\n * @ignore - internal component.\n */\n\nexport default createSvgIcon( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\"\n}), 'Person');","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport { chainPropTypes } from '@material-ui/utils';\nimport withStyles from '../styles/withStyles';\nimport Person from '../internal/svg-icons/Person';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      position: 'relative',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      flexShrink: 0,\n      width: 40,\n      height: 40,\n      fontFamily: theme.typography.fontFamily,\n      fontSize: theme.typography.pxToRem(20),\n      lineHeight: 1,\n      borderRadius: '50%',\n      overflow: 'hidden',\n      userSelect: 'none'\n    },\n\n    /* Styles applied to the root element if not `src` or `srcSet`. */\n    colorDefault: {\n      color: theme.palette.background.default,\n      backgroundColor: theme.palette.type === 'light' ? theme.palette.grey[400] : theme.palette.grey[600]\n    },\n\n    /* Styles applied to the root element if `variant=\"circle\"`. */\n    circle: {},\n\n    /* Styles applied to the root element if `variant=\"circular\"`. */\n    circular: {},\n\n    /* Styles applied to the root element if `variant=\"rounded\"`. */\n    rounded: {\n      borderRadius: theme.shape.borderRadius\n    },\n\n    /* Styles applied to the root element if `variant=\"square\"`. */\n    square: {\n      borderRadius: 0\n    },\n\n    /* Styles applied to the img element if either `src` or `srcSet` is defined. */\n    img: {\n      width: '100%',\n      height: '100%',\n      textAlign: 'center',\n      // Handle non-square image. The property isn't supported by IE 11.\n      objectFit: 'cover',\n      // Hide alt text.\n      color: 'transparent',\n      // Hide the image broken icon, only works on Chrome.\n      textIndent: 10000\n    },\n\n    /* Styles applied to the fallback icon */\n    fallback: {\n      width: '75%',\n      height: '75%'\n    }\n  };\n};\n\nfunction useLoaded(_ref) {\n  var src = _ref.src,\n      srcSet = _ref.srcSet;\n\n  var _React$useState = React.useState(false),\n      loaded = _React$useState[0],\n      setLoaded = _React$useState[1];\n\n  React.useEffect(function () {\n    if (!src && !srcSet) {\n      return undefined;\n    }\n\n    setLoaded(false);\n    var active = true;\n    var image = new Image();\n    image.src = src;\n    image.srcSet = srcSet;\n\n    image.onload = function () {\n      if (!active) {\n        return;\n      }\n\n      setLoaded('loaded');\n    };\n\n    image.onerror = function () {\n      if (!active) {\n        return;\n      }\n\n      setLoaded('error');\n    };\n\n    return function () {\n      active = false;\n    };\n  }, [src, srcSet]);\n  return loaded;\n}\n\nvar Avatar = /*#__PURE__*/React.forwardRef(function Avatar(props, ref) {\n  var alt = props.alt,\n      childrenProp = props.children,\n      classes = props.classes,\n      className = props.className,\n      _props$component = props.component,\n      Component = _props$component === void 0 ? 'div' : _props$component,\n      imgProps = props.imgProps,\n      sizes = props.sizes,\n      src = props.src,\n      srcSet = props.srcSet,\n      _props$variant = props.variant,\n      variant = _props$variant === void 0 ? 'circle' : _props$variant,\n      other = _objectWithoutProperties(props, [\"alt\", \"children\", \"classes\", \"className\", \"component\", \"imgProps\", \"sizes\", \"src\", \"srcSet\", \"variant\"]);\n\n  var children = null; // Use a hook instead of onError on the img element to support server-side rendering.\n\n  var loaded = useLoaded({\n    src: src,\n    srcSet: srcSet\n  });\n  var hasImg = src || srcSet;\n  var hasImgNotFailing = hasImg && loaded !== 'error';\n\n  if (hasImgNotFailing) {\n    children = /*#__PURE__*/React.createElement(\"img\", _extends({\n      alt: alt,\n      src: src,\n      srcSet: srcSet,\n      sizes: sizes,\n      className: classes.img\n    }, imgProps));\n  } else if (childrenProp != null) {\n    children = childrenProp;\n  } else if (hasImg && alt) {\n    children = alt[0];\n  } else {\n    children = /*#__PURE__*/React.createElement(Person, {\n      className: classes.fallback\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    className: clsx(classes.root, classes.system, classes[variant], className, !hasImgNotFailing && classes.colorDefault),\n    ref: ref\n  }, other), children);\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiAvatar'\n})(Avatar);","import { Avatar, createStyles, makeStyles, Theme } from \"@material-ui/core\";\nimport React from \"react\";\nimport { VIRTUAL_DEVICE_NODE_NAME } from \"../../../jacdac-ts/src/jdom/constants\";\nimport { JDDevice } from \"../../../jacdac-ts/src/jdom/device\";\nimport useDeviceSpecification from \"../../jacdac/useDeviceSpecification\";\nimport CmdButton from \"../CmdButton\";\nimport useDeviceHost from \"../hooks/useDeviceHost\";\nimport KindIcon from \"../KindIcon\"\nimport useDeviceStatusLightStyle from \"./useDeviceStatusLightStyle\";\nimport Helmet from \"react-helmet\"\nimport useDeviceName from \"../useDeviceName\";\nimport useDeviceImage from \"./useDeviceImage\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    img: {\n      marginTop: \"58%\",\n    },\n    small: {\n      width: theme.spacing(3),\n      height: theme.spacing(3),\n    },\n    large: {\n      width: theme.spacing(7),\n      height: theme.spacing(7),\n    },\n  }),\n);\n\nexport default function DeviceAvatar(props: { device: JDDevice, showMissing?: boolean, size?: \"small\" | \"large\" }) {\n  const { device, showMissing, size } = props;\n  const specification = useDeviceSpecification(device);\n  const imageUrl = useDeviceImage(specification, \"avatar\")\n  const name = useDeviceName(device);\n  const classes = useStyles();\n  const sizeClassName = size === \"small\" ? classes.small : size === \"large\" ? classes.large : undefined;\n  const host = useDeviceHost(device);\n  const {\n    className: statusLEDClassName,\n    helmetStyle: statusLEDHelmetStyle } = useDeviceStatusLightStyle(device)\n\n  if (!showMissing && (!host && !imageUrl))\n    return null;\n  const handleIdentify = async () => await device.identify();\n  return <>\n    {statusLEDHelmetStyle && <Helmet><style>{statusLEDHelmetStyle}</style></Helmet>}\n    <CmdButton\n      trackName=\"device.identify\"\n      size=\"small\"\n      title={`identify ${host ? \"simulator\" : \"device\"} ${name}`}\n      onClick={handleIdentify}\n      className={statusLEDClassName}\n      icon={host ? <KindIcon kind={VIRTUAL_DEVICE_NODE_NAME} /> : <Avatar\n        className={sizeClassName}\n        alt={specification?.name || \"Image of the device\"}\n        src={imageUrl}\n        classes={{\n          img: classes.img\n        }}\n      />}\n    />\n  </>\n}"],"sourceRoot":""}