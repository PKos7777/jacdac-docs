{"version":3,"sources":["webpack://jacdac-docs/./node_modules/@material-ui/core/esm/CardActions/CardActions.js","webpack://jacdac-docs/./node_modules/@material-ui/core/esm/CardMedia/CardMedia.js","webpack://jacdac-docs/./node_modules/@material-ui/core/esm/ListItemIcon/ListItemIcon.js","webpack://jacdac-docs/./node_modules/@material-ui/core/esm/ListItemText/ListItemText.js","webpack://jacdac-docs/./node_modules/@material-ui/core/esm/ListSubheader/ListSubheader.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/HourglassEmpty.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/PlayCircleFilled.js","webpack://jacdac-docs/./jacdac-ts/jacdac-spec/spectool/jdtestfuns.ts","webpack://jacdac-docs/./src/components/ui/CardMediaWithSkeleton.tsx","webpack://jacdac-docs/./src/components/DeviceCardMedia.tsx","webpack://jacdac-docs/./src/components/DeviceCardHeader.tsx","webpack://jacdac-docs/./src/components/services/useServiceRole.ts","webpack://jacdac-docs/./src/components/services/ServiceRole.tsx","webpack://jacdac-docs/./src/components/dashboard/DashboardServiceWidgetItem.tsx","webpack://jacdac-docs/./src/components/dashboard/DashboardServiceDetails.tsx","webpack://jacdac-docs/./src/components/hooks/useIntersectionObserver.ts","webpack://jacdac-docs/./src/components/dashboard/DashboardDevice.tsx","webpack://jacdac-docs/./src/components/services/useRoleManager.ts","webpack://jacdac-docs/./node_modules/@material-ui/core/esm/ListItemSecondaryAction/ListItemSecondaryAction.js","webpack://jacdac-docs/./jacdac-ts/src/test/testrunner.ts","webpack://jacdac-docs/./src/components/test/ServiceTestRunner.tsx","webpack://jacdac-docs/./src/components/useGridBreakpoints.ts","webpack://jacdac-docs/./src/components/useServiceClient.ts"],"names":["getTestCommandFunctions","testFunctions","filter","f","context","getTestExpressionFunctions","id","args","prompt","undefined","useStyles","makeStyles","theme","createStyles","media","height","paddingTop","CardMediaWithSkeleton","props","image","src","className","others","classes","hasImage","DeviceCardMedia","device","specification","useDeviceSpecification","imageUrl","useDeviceImage","name","DeviceFirmwareVersionChip","firmwareVersionRegister","service","register","ControlReg","useRegisterUnpackedValue","firmwareVersion","DeviceTemperatureChip","tempRegister","temperature","DeviceCardHeader","showFirmware","showTemperature","showMedia","showDeviceId","showAvatar","identifierToUrlPath","deviceId","s","join","useServiceRole","useState","role","setRole","useEffect","subscribe","ROLE_CHANGE","console","log","ServiceRole","useContext","AppContext","showSelectRoleDialog","roleManager","useRoleManager","handleClick","hasRoleForService","useChange","_","DashboardServiceWidgetItem","expanded","isMixin","SystemReg","instanceName","server","useServiceServer","handleRemove","removeService","float","ignoreRegisters","collapsedRegisters","DashboardServiceDetails","visible","spec","registers","useMemo","packets","ids","pkt","isRegister","map","identifier","indexOf","slice","reg","length","useIntersectionObserver","elementRef","options","entry","setEntry","threshold","root","rootMargin","freezeOnceVisible","frozen","isIntersecting","updateEntry","node","current","hasIOSupport","window","IntersectionObserver","observerParams","observer","observe","disconnect","ignoredServices","SRV_CTRL","SRV_LOGGER","DashboardDevice","toggleExpanded","variant","showHeader","useDeviceName","services","serviceClass","useTheme","mobile","useMediaQuery","breakpoints","down","MOBILE_BREAKPOINT","serviceGridRef","useRef","intersection","ServiceWidgets","useCallback","srv","dependencyId","padding","paddingBottom","serviceIndex","JacdacContext","bus","mgr","setMgr","ROLE_MANAGER_CHANGE","JDTestCommandStatus","JDTestStatus","commandStatusToTestStatus","status","Active","Passed","Failed","NotReady","RequiresUserInput","cmdToTestFunction","cmd","call","callee","find","t","unparse","e","type","ae","elements","caller","arguments","computed","object","property","be","left","operator","right","ue","argument","raw","JDExprEvaluator","env","start","exprStack","tos","eval","visitExpression","pop","getStartVal","r","v","push","goal","error","ev","top","le","lhs","rhs","val","lit","value","JDCommandEvaluator","testRunner","command","_prompt","_progress","_status","_startExpressions","_rangeComplete","_eventsComplete","testFun","startExprs","exprVisitor","p","ce","eventList","forEach","child","findIndex","exprEval","createPrompt","replaceId","a","i","replaceVal","aStart","roundWithPrecision","toString","replace","setEvent","checkExpression","expr","getStart","evaluate","Math","abs","pretify","regSaved","regValue","amtSaved","beginSaved","endSaved","hasEvent","consumeEvent","shift","event","jdreg","serviceTestRunner","fmt","packFormat","sendSetPackedAsync","fld","lookup","JDTestCommandRunner","_output","message","progress","_commmandEvaluator","reset","output","envChange","isActive","newOutput","finish","cancel","finishCommand","emit","CHANGE","JDEventSource","JDTestRunner","testSpec","commands","testCommands","c","_commandIndex","_currentEvent","commandIndex","refreshEnvironment","next","newStatus","currentCommand","eventChange","ret","description","index","refresh_env","k","retry","refresh","unpackedValue","JDServiceTestRunner","_testIndex","_registers","_events","tests","serviceSpec","serviceSpecificationFromClassIdentifier","events","eventName","isEvent","mount","EVENT","currentTest","regName","field","fields","stats","total","success","failed","indeterminate","test","testIndex","ct","JDServiceClient","TestStatusIcon","TestListItem","onSelectTest","selected","handleSelectTest","TestList","CommandStatusIcon","CommandListItem","handleAnswer","ActiveTest","handleRestart","handleNext","ServiceTestRunner","serviceTest","serviceTestFromServiceClass","factory","useServiceClient","useGridBreakpoints","itemCount","drawerType","xs","sm","md","lg","xl","DrawerType","deps","client","setClient","unmount"],"mappings":"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","file":"859a83de993caea7524bf57c2975f3be6812c8c3-fac13ff398ae6294d9b8.js","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nexport var styles = {\n  /* Styles applied to the root element. */\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    padding: 8\n  },\n\n  /* Styles applied to the root element if `disableSpacing={false}`. */\n  spacing: {\n    '& > :not(:first-child)': {\n      marginLeft: 8\n    }\n  }\n};\nvar CardActions = /*#__PURE__*/React.forwardRef(function CardActions(props, ref) {\n  var _props$disableSpacing = props.disableSpacing,\n      disableSpacing = _props$disableSpacing === void 0 ? false : _props$disableSpacing,\n      classes = props.classes,\n      className = props.className,\n      other = _objectWithoutProperties(props, [\"disableSpacing\", \"classes\", \"className\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, className, !disableSpacing && classes.spacing),\n    ref: ref\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiCardActions'\n})(CardActions);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nimport { chainPropTypes } from '@material-ui/utils';\nexport var styles = {\n  /* Styles applied to the root element. */\n  root: {\n    display: 'block',\n    backgroundSize: 'cover',\n    backgroundRepeat: 'no-repeat',\n    backgroundPosition: 'center'\n  },\n\n  /* Styles applied to the root element if `component=\"video, audio, picture, iframe, or img\"`. */\n  media: {\n    width: '100%'\n  },\n\n  /* Styles applied to the root element if `component=\"picture or img\"`. */\n  img: {\n    // ⚠️ object-fit is not supported by IE 11.\n    objectFit: 'cover'\n  }\n};\nvar MEDIA_COMPONENTS = ['video', 'audio', 'picture', 'iframe', 'img'];\nvar CardMedia = /*#__PURE__*/React.forwardRef(function CardMedia(props, ref) {\n  var children = props.children,\n      classes = props.classes,\n      className = props.className,\n      _props$component = props.component,\n      Component = _props$component === void 0 ? 'div' : _props$component,\n      image = props.image,\n      src = props.src,\n      style = props.style,\n      other = _objectWithoutProperties(props, [\"children\", \"classes\", \"className\", \"component\", \"image\", \"src\", \"style\"]);\n\n  var isMediaComponent = MEDIA_COMPONENTS.indexOf(Component) !== -1;\n  var composedStyle = !isMediaComponent && image ? _extends({\n    backgroundImage: \"url(\\\"\".concat(image, \"\\\")\")\n  }, style) : style;\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    className: clsx(classes.root, className, isMediaComponent && classes.media, \"picture img\".indexOf(Component) !== -1 && classes.img),\n    ref: ref,\n    style: composedStyle,\n    src: isMediaComponent ? image || src : undefined\n  }, other), children);\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiCardMedia'\n})(CardMedia);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nimport ListContext from '../List/ListContext';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      minWidth: 56,\n      color: theme.palette.action.active,\n      flexShrink: 0,\n      display: 'inline-flex'\n    },\n\n    /* Styles applied to the root element when the parent `ListItem` uses `alignItems=\"flex-start\"`. */\n    alignItemsFlexStart: {\n      marginTop: 8\n    }\n  };\n};\n/**\n * A simple wrapper to apply `List` styles to an `Icon` or `SvgIcon`.\n */\n\nvar ListItemIcon = /*#__PURE__*/React.forwardRef(function ListItemIcon(props, ref) {\n  var classes = props.classes,\n      className = props.className,\n      other = _objectWithoutProperties(props, [\"classes\", \"className\"]);\n\n  var context = React.useContext(ListContext);\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, className, context.alignItems === 'flex-start' && classes.alignItemsFlexStart),\n    ref: ref\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiListItemIcon'\n})(ListItemIcon);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nimport Typography from '../Typography';\nimport ListContext from '../List/ListContext';\nexport var styles = {\n  /* Styles applied to the root element. */\n  root: {\n    flex: '1 1 auto',\n    minWidth: 0,\n    marginTop: 4,\n    marginBottom: 4\n  },\n\n  /* Styles applied to the `Typography` components if primary and secondary are set. */\n  multiline: {\n    marginTop: 6,\n    marginBottom: 6\n  },\n\n  /* Styles applied to the `Typography` components if dense. */\n  dense: {},\n\n  /* Styles applied to the root element if `inset={true}`. */\n  inset: {\n    paddingLeft: 56\n  },\n\n  /* Styles applied to the primary `Typography` component. */\n  primary: {},\n\n  /* Styles applied to the secondary `Typography` component. */\n  secondary: {}\n};\nvar ListItemText = /*#__PURE__*/React.forwardRef(function ListItemText(props, ref) {\n  var children = props.children,\n      classes = props.classes,\n      className = props.className,\n      _props$disableTypogra = props.disableTypography,\n      disableTypography = _props$disableTypogra === void 0 ? false : _props$disableTypogra,\n      _props$inset = props.inset,\n      inset = _props$inset === void 0 ? false : _props$inset,\n      primaryProp = props.primary,\n      primaryTypographyProps = props.primaryTypographyProps,\n      secondaryProp = props.secondary,\n      secondaryTypographyProps = props.secondaryTypographyProps,\n      other = _objectWithoutProperties(props, [\"children\", \"classes\", \"className\", \"disableTypography\", \"inset\", \"primary\", \"primaryTypographyProps\", \"secondary\", \"secondaryTypographyProps\"]);\n\n  var _React$useContext = React.useContext(ListContext),\n      dense = _React$useContext.dense;\n\n  var primary = primaryProp != null ? primaryProp : children;\n\n  if (primary != null && primary.type !== Typography && !disableTypography) {\n    primary = /*#__PURE__*/React.createElement(Typography, _extends({\n      variant: dense ? 'body2' : 'body1',\n      className: classes.primary,\n      component: \"span\",\n      display: \"block\"\n    }, primaryTypographyProps), primary);\n  }\n\n  var secondary = secondaryProp;\n\n  if (secondary != null && secondary.type !== Typography && !disableTypography) {\n    secondary = /*#__PURE__*/React.createElement(Typography, _extends({\n      variant: \"body2\",\n      className: classes.secondary,\n      color: \"textSecondary\",\n      display: \"block\"\n    }, secondaryTypographyProps), secondary);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, className, dense && classes.dense, inset && classes.inset, primary && secondary && classes.multiline),\n    ref: ref\n  }, other), primary, secondary);\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiListItemText'\n})(ListItemText);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nimport capitalize from '../utils/capitalize';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      boxSizing: 'border-box',\n      lineHeight: '48px',\n      listStyle: 'none',\n      color: theme.palette.text.secondary,\n      fontFamily: theme.typography.fontFamily,\n      fontWeight: theme.typography.fontWeightMedium,\n      fontSize: theme.typography.pxToRem(14)\n    },\n\n    /* Styles applied to the root element if `color=\"primary\"`. */\n    colorPrimary: {\n      color: theme.palette.primary.main\n    },\n\n    /* Styles applied to the root element if `color=\"inherit\"`. */\n    colorInherit: {\n      color: 'inherit'\n    },\n\n    /* Styles applied to the inner `component` element if `disableGutters={false}`. */\n    gutters: {\n      paddingLeft: 16,\n      paddingRight: 16\n    },\n\n    /* Styles applied to the root element if `inset={true}`. */\n    inset: {\n      paddingLeft: 72\n    },\n\n    /* Styles applied to the root element if `disableSticky={false}`. */\n    sticky: {\n      position: 'sticky',\n      top: 0,\n      zIndex: 1,\n      backgroundColor: 'inherit'\n    }\n  };\n};\nvar ListSubheader = /*#__PURE__*/React.forwardRef(function ListSubheader(props, ref) {\n  var classes = props.classes,\n      className = props.className,\n      _props$color = props.color,\n      color = _props$color === void 0 ? 'default' : _props$color,\n      _props$component = props.component,\n      Component = _props$component === void 0 ? 'li' : _props$component,\n      _props$disableGutters = props.disableGutters,\n      disableGutters = _props$disableGutters === void 0 ? false : _props$disableGutters,\n      _props$disableSticky = props.disableSticky,\n      disableSticky = _props$disableSticky === void 0 ? false : _props$disableSticky,\n      _props$inset = props.inset,\n      inset = _props$inset === void 0 ? false : _props$inset,\n      other = _objectWithoutProperties(props, [\"classes\", \"className\", \"color\", \"component\", \"disableGutters\", \"disableSticky\", \"inset\"]);\n\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    className: clsx(classes.root, className, color !== 'default' && classes[\"color\".concat(capitalize(color))], inset && classes.inset, !disableSticky && classes.sticky, !disableGutters && classes.gutters),\n    ref: ref\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiListSubheader'\n})(ListSubheader);","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm-4-5l-4-4V4h8v3.5l-4 4z\"\n}), 'HourglassEmpty');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 14.5v-9l6 4.5-6 4.5z\"\n}), 'PlayCircleFilled');\n\nexports.default = _default;","/* eslint-disable @typescript-eslint/triple-slash-reference */\n/// <reference path=\"jdtest.d.ts\" />\n\nexport type JDTestFunctions =\n    | \"changes\"\n    | \"ask\"\n    | \"check\"\n    | \"increases\"\n    | \"decreases\"\n    | \"increasesBy\"\n    | \"decreasesBy\"\n    | \"stepsUpTo\"\n    | \"stepsDownTo\"\n    | \"events\"\n    | \"awaitEvent\"\n    | \"nextEvent\"\n    | \"assign\"\n    | \"closeTo\"\n\nexport function getTestCommandFunctions() {\n    return testFunctions.filter(f => f.context === \"command\" || f.context === \"either\")\n}\n\nexport function getTestExpressionFunctions() {\n    return testFunctions.filter(f => f.context === \"expression\" || f.context === \"either\")\n}\n\nconst testFunctions: jdtest.TestFunctionDescription[] = [\n    {\n        id: \"changes\",\n        args: [\"register\"],\n        prompt: `check that {1} changes`,\n        context: \"command\",\n    },\n    {\n        id: \"ask\",\n        args: [],\n        prompt: undefined,\n        context: \"command\",\n    },\n    {\n        id: \"events\",\n        args: [\"events\"],\n        prompt: `check that events {1} are observed`,\n        context: \"command\",\n    },\n    {\n        id: \"awaitEvent\",\n        args: [\"event\", [\"boolean\", true] ],\n        prompt: `wait for event {1} and then check {2} (other events ignored)`,\n        context: \"command\",\n    },\n    {\n        id: \"nextEvent\",\n        args: [\"event\", [\"boolean\", true]],\n        prompt: `next event must be {1}, then check {2}`,\n        context: \"command\",\n    },\n    {\n        id: \"assign\",\n        args: [\"register\", \"number\"],\n        prompt: `write value {2:val} to {1}`,\n        context: \"command\",\n    },\n    {\n        id: \"check\",\n        args: [\"boolean\"],\n        prompt: `check that {1}`,\n        context: \"command\",\n    },\n    {\n        id: \"increases\",\n        args: [\"register\"],\n        prompt: `check that {1} increases`,\n        context: \"command\",\n    },\n    {\n        id: \"decreases\",\n        args: [\"register\"],\n        prompt: `check that {1} decreases`,\n        context: \"command\",\n    },\n    {\n        id: \"increasesBy\",\n        args: [\"register\", \"number\"],\n        prompt: `check that  {1} (initially {1:val}) increases by {2:val}`,\n        context: \"command\",\n    },\n    {\n        id: \"decreasesBy\",\n        args: [\"register\", \"number\"],\n        prompt: `check that {1} (initially {1:val}) decreases by {2:val}`,\n        context: \"command\",\n    },\n    {\n        id: \"stepsUpTo\",\n        args: [\"register\", \"number\"],\n        prompt: `{1} should step up (by ones) from {1:val} to {2:val}`,\n        context: \"command\",\n    },\n    {\n        id: \"stepsDownTo\",\n        args: [\"register\", \"number\"],\n        prompt: `{1} should step down (by ones) from {1:val} to {2:val}`,\n        context: \"command\",\n    },\n    {\n        id: \"start\",\n        args: [\"any\"],\n        prompt: undefined,\n        context: \"expression\",\n    },\n    {\n        id: \"closeTo\",\n        args: [\"number\", \"number\", \"number\"],\n        prompt: `evaluate {1} until it is close to {2:val}, as given by error {3:val}`,\n        context: \"either\",\n    },\n]\n","import { CardMedia, CardMediaProps, createStyles, makeStyles, Theme } from \"@material-ui/core\";\nimport React from \"react\";\n\nconst useStyles = makeStyles((theme: Theme) => createStyles({\n    media: {\n        height: 0,\n        paddingTop: '75%', // 4:3\n    }\n}));\n\n/*\n        [theme.breakpoints.down('lg')]: {\n            paddingTop: '56.72%', // 16:9\n        },\n        [theme.breakpoints.down('xs')]: {\n            paddingTop: '18%',\n        },\n        [theme.breakpoints.down('md')]: { // 6:3\n            paddingTop: '50%',\n        }\n*/\n\nexport default function CardMediaWithSkeleton(props: CardMediaProps) {\n    const { image, src, className, ...others } = props;\n    const classes = useStyles();\n    const hasImage = !!image || !!src;\n    return hasImage ?\n        <CardMedia className={className || classes.media} {...others} image={image} src={src} />\n        : <></>;\n}","import React from \"react\";\nimport { JDDevice } from \"../../jacdac-ts/src/jdom/device\";\nimport useDeviceSpecification from \"../jacdac/useDeviceSpecification\";\nimport useDeviceImage from \"./devices/useDeviceImage\";\nimport CardMediaWithSkeleton from \"./ui/CardMediaWithSkeleton\";\n\nexport default function DeviceCardMedia(props: { device: JDDevice }) {\n    const { device } = props;\n    const specification = useDeviceSpecification(device)\n    const imageUrl = useDeviceImage(specification)\n\n    return <CardMediaWithSkeleton\n        image={imageUrl}\n        title={specification?.name}\n    />\n}","import { ControlReg } from \"../../jacdac-ts/src/jdom/constants\"\nimport { CardHeader, Chip, Typography } from \"@material-ui/core\"\n// tslint:disable-next-line: no-submodule-imports\nimport { Link } from \"gatsby-theme-material-ui\"\nimport { JDDevice } from \"../../jacdac-ts/src/jdom/device\"\nimport React from \"react\"\nimport {\n    useRegisterUnpackedValue,\n} from \"../jacdac/useRegisterValue\"\nimport DeviceActions from \"./DeviceActions\"\nimport DeviceName from \"./devices/DeviceName\"\nimport DeviceCardMedia from \"./DeviceCardMedia\"\nimport useDeviceSpecification from \"../jacdac/useDeviceSpecification\"\nimport { identifierToUrlPath } from \"../../jacdac-ts/src/jdom/spec\"\nimport DeviceAvatar from \"./devices/DeviceAvatar\"\n\nfunction DeviceFirmwareVersionChip(props: { device: JDDevice }) {\n    const { device } = props\n    const firmwareVersionRegister = device\n        ?.service(0)\n        ?.register(ControlReg.FirmwareVersion)\n    const [firmwareVersion] = useRegisterUnpackedValue<[string]>(firmwareVersionRegister)\n\n    return (\n        (firmwareVersion && <Chip size=\"small\" label={firmwareVersion} />) || (\n            <></>\n        )\n    )\n}\n\nfunction DeviceTemperatureChip(props: { device: JDDevice }) {\n    const { device } = props\n    const tempRegister = device?.service(0)?.register(ControlReg.McuTemperature)\n    const [temperature] = useRegisterUnpackedValue<[number]>(tempRegister)\n    return (\n        (temperature !== undefined && (\n            <Chip size=\"small\" label={`${temperature}°`} />\n        )) || <></>\n    )\n}\n\nexport default function DeviceCardHeader(props: {\n    device: JDDevice\n    showAvatar?: boolean\n    showDeviceId?: boolean\n    showFirmware?: boolean\n    showTemperature?: boolean\n    showMedia?: boolean\n}) {\n    const {\n        device,\n        showFirmware,\n        showTemperature,\n        showMedia,\n        showDeviceId,\n        showAvatar,\n    } = props\n    const specification = useDeviceSpecification(device)\n\n    return (\n        <>\n            {showMedia && <DeviceCardMedia device={device} />}\n            <CardHeader\n                avatar={showAvatar && <DeviceAvatar device={device} />}\n                action={<DeviceActions device={device} showReset={true} />}\n                title={\n                    <Link\n                        color=\"textPrimary\"\n                        to={`/devices/${\n                            identifierToUrlPath(specification?.id) || \"\"\n                        }`}\n                    >\n                        <DeviceName device={device} />\n                    </Link>\n                }\n                subheader={\n                    <>\n                        <Typography variant=\"caption\" gutterBottom>\n                            {[\n                                specification?.name,\n                                showDeviceId && device.deviceId,\n                            ]\n                                .filter(s => !!s)\n                                .join(\", \")}\n                        </Typography>\n                        {showFirmware && (\n                            <DeviceFirmwareVersionChip device={device} />\n                        )}\n                        {showTemperature && (\n                            <DeviceTemperatureChip device={device} />\n                        )}\n                    </>\n                }\n            />\n        </>\n    )\n}\n","import { useEffect, useState } from \"react\"\nimport { ROLE_CHANGE } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { JDService } from \"../../../jacdac-ts/src/jdom/service\"\n\nexport default function useServiceRole(service: JDService) {\n    const [role, setRole] = useState<string>(service?.role);\n    useEffect(() => service?.subscribe(ROLE_CHANGE, () => {\n        console.log(\"role change\", { service })\n        setRole(service.role)\n    }), [service])\n    return role;\n}","import { Button } from \"@material-ui/core\"\nimport React, { useContext } from \"react\"\nimport { JDService } from \"../../../jacdac-ts/src/jdom/service\"\nimport useChange from \"../../jacdac/useChange\"\nimport AppContext from \"../AppContext\"\nimport useRoleManager from \"./useRoleManager\"\nimport useServiceRole from \"./useServiceRole\"\n\nexport default function ServiceRole(props: { service: JDService }) {\n    const { service } = props\n    const { showSelectRoleDialog } = useContext(AppContext)\n    const roleManager = useRoleManager()\n    const role = useServiceRole(service)\n    const handleClick = () => showSelectRoleDialog(service)\n\n    const hasRoleForService = useChange(roleManager, _ => _?.hasRoleForService(service))\n    // hide if no role manager or role not compatible with required roles\n    if (!hasRoleForService)\n        return null;\n\n    return <Button size=\"small\" onClick={handleClick}>{role || \"...\"}</Button>\n}\n","import { Grid, Typography } from \"@material-ui/core\"\nimport React from \"react\"\nimport DashboardServiceWidget, {\n    DashboardServiceProps,\n} from \"./DashboardServiceWidget\"\nimport ServiceRole from \"../services/ServiceRole\"\nimport { useRegisterUnpackedValue } from \"../../jacdac/useRegisterValue\"\nimport { SystemReg } from \"../../../jacdac-ts/src/jdom/constants\"\nimport useServiceServer from \"../hooks/useServiceServer\"\nimport IconButtonWithTooltip from \"../ui/IconButtonWithTooltip\"\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport CloseIcon from \"@material-ui/icons/Close\"\n\nexport default function DashboardServiceWidgetItem(\n    props: React.Attributes & DashboardServiceProps\n): JSX.Element {\n    const { service, expanded } = props\n    const { isMixin } = service\n    const [instanceName] = useRegisterUnpackedValue<[number]>(\n        service.register(SystemReg.InstanceName),\n        props\n    )\n    const server = useServiceServer(service)\n\n    const handleRemove = () => server?.device.removeService(server)\n\n    return (\n        <Grid item>\n            <Grid container spacing={1} alignItems=\"center\">\n                <Grid item xs>\n                    <ServiceRole service={service} />\n                </Grid>\n                {instanceName && (\n                    <Grid item>\n                        <Typography\n                            className=\"no-pointer-events\"\n                            variant=\"caption\"\n                            component=\"span\"\n                            style={{ float: \"right\" }}\n                        >\n                            {instanceName}\n                        </Typography>\n                    </Grid>\n                )}\n                {expanded && !isMixin && server && (\n                    <Grid item xs>\n                        <IconButtonWithTooltip\n                            title=\"Remove service\"\n                            onClick={handleRemove}\n                        >\n                            <CloseIcon />\n                        </IconButtonWithTooltip>\n                    </Grid>\n                )}\n            </Grid>\n            <DashboardServiceWidget {...props} />\n        </Grid>\n    )\n}\n","import React, { useMemo } from \"react\"\nimport { BaseReg, SystemReg } from \"../../../jacdac-ts/src/jdom/constants\"\nimport useChange from \"../../jacdac/useChange\"\nimport RegisterInput from \"../RegisterInput\"\nimport { isIntegerType, isRegister } from \"../../../jacdac-ts/src/jdom/spec\"\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\"\nimport { Grid } from \"@material-ui/core\"\nimport { JDRegister } from \"../../../jacdac-ts/src/jdom/register\"\n\n// filter out common registers\nconst ignoreRegisters = [\n    SystemReg.StatusCode,\n    SystemReg.StreamingPreferredInterval,\n    SystemReg.StreamingSamples,\n    SystemReg.StreamingInterval,\n]\nconst collapsedRegisters = [\n    SystemReg.Reading,\n    SystemReg.Value,\n    SystemReg.Intensity,\n]\n\nexport default function DashboardServiceDetails(props: DashboardServiceProps) {\n    const { service, expanded, visible } = props\n    const specification = useChange(service, spec => spec.specification)\n    const registers: JDRegister[] = useMemo(() => {\n        const packets = specification?.packets\n        let ids =\n            packets\n                ?.filter(pkt => isRegister(pkt))\n                ?.map(pkt => pkt.identifier) || []\n        ids = ids.filter(id => ignoreRegisters.indexOf(id) < 0)\n        if (!expanded)\n            // grab the first interresting register\n            ids = ids\n                .filter(id => collapsedRegisters.indexOf(id) > -1)\n                .slice(0, 1)\n        return ids.map(id => service.register(id)).filter(reg => !!reg)\n    }, [specification, expanded])\n\n    if (!registers?.length)\n        // nothing to see here\n        return null\n\n    return (\n        <>\n            {registers.map(register => {\n                return (\n                    <Grid key={register.id} item xs={true}>\n                        <RegisterInput\n                            register={register}\n                            showServiceName={true}\n                            showRegisterName={true}\n                            hideMissingValues={false}\n                            showTrend={false}\n                            visible={visible}\n                        />\n                    </Grid>\n                )\n            })}\n        </>\n    )\n}\n","import { useEffect, useState, RefObject } from 'react'\n\nexport interface Args extends IntersectionObserverInit {\n  freezeOnceVisible?: boolean\n}\n\nexport default function useIntersectionObserver(\n  elementRef: RefObject<Element>,\n  options?: { freezeOnceVisible?: boolean } & IntersectionObserverInit\n): IntersectionObserverEntry | undefined {\n  const [entry, setEntry] = useState<IntersectionObserverEntry>()\n  const { threshold = 0, root = null, rootMargin = '0%', freezeOnceVisible } = options || {};\n\n  const frozen = entry?.isIntersecting && freezeOnceVisible\n\n  const updateEntry = ([entry]: IntersectionObserverEntry[]): void => {\n    setEntry(entry)\n  }\n\n  useEffect(() => {\n    const node = elementRef?.current // DOM Ref\n    const hasIOSupport = !!window.IntersectionObserver\n\n    if (!hasIOSupport || frozen || !node) return\n\n    const observerParams = { threshold, root, rootMargin }\n    const observer = new IntersectionObserver(updateEntry, observerParams)\n\n    //console.log(`observe`, { node })\n    observer.observe(node)\n\n    return () => observer.disconnect()\n\n  }, [elementRef, threshold, root, rootMargin, frozen])\n\n  return entry\n}\n","import {\n    Card,\n    CardContent,\n    CardHeader,\n    Grid,\n    Paper,\n    Typography,\n    useMediaQuery,\n    useTheme,\n} from \"@material-ui/core\"\nimport React, { useCallback, useRef } from \"react\"\nimport { SRV_CTRL, SRV_LOGGER } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { JDDevice } from \"../../../jacdac-ts/src/jdom/device\"\nimport useChange from \"../../jacdac/useChange\"\nimport DeviceName from \"../devices/DeviceName\"\nimport IconButtonWithTooltip from \"../ui/IconButtonWithTooltip\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport ExpandLessIcon from \"@material-ui/icons/ExpandLess\"\nimport useDeviceSpecification from \"../../jacdac/useDeviceSpecification\"\nimport DeviceAvatar from \"../devices/DeviceAvatar\"\nimport DashboardServiceWidgetItem from \"./DashboardServiceWidgetItem\"\nimport DeviceActions from \"../DeviceActions\"\nimport DashboardServiceDetails from \"./DashboardServiceDetails\"\nimport { MOBILE_BREAKPOINT } from \"../layout\"\nimport useDeviceName from \"../devices/useDeviceName\"\nimport { DashboardDeviceProps } from \"./Dashboard\"\nimport useIntersectionObserver from \"../hooks/useIntersectionObserver\"\nimport { dependencyId } from \"../../../jacdac-ts/src/jdom/node\"\n\nconst ignoredServices = [SRV_CTRL, SRV_LOGGER]\n\nexport default function DashboardDevice(\n    props: {\n        device: JDDevice\n        expanded?: boolean\n        toggleExpanded?: () => void\n        variant?: \"icon\" | \"\"\n    } & DashboardDeviceProps\n) {\n    const {\n        device,\n        expanded,\n        toggleExpanded,\n        variant,\n        showAvatar,\n        showHeader,\n    } = props\n    const name = useDeviceName(device)\n    const services = useChange(device, () =>\n        device\n            .services({ specification: true })\n            .filter(\n                service => ignoredServices.indexOf(service.serviceClass) < 0\n            )\n    )\n    const specification = useDeviceSpecification(device)\n    const theme = useTheme()\n    const mobile = useMediaQuery(theme.breakpoints.down(MOBILE_BREAKPOINT))\n    const serviceGridRef = useRef<HTMLDivElement>()\n    const intersection = useIntersectionObserver(serviceGridRef)\n    const visible = !!intersection?.isIntersecting\n\n    const ServiceWidgets = useCallback(\n        () => (\n            <Grid\n                ref={serviceGridRef}\n                component=\"div\"\n                container\n                spacing={2}\n                justify=\"center\"\n                alignItems=\"flex-end\"\n                alignContent=\"space-between\"\n            >\n                {services\n                    ?.filter(srv => expanded || !srv.isMixin)\n                    ?.map(service => (\n                        <DashboardServiceWidgetItem\n                            key={service.id}\n                            service={service}\n                            expanded={expanded}\n                            services={services}\n                            variant={variant}\n                            visible={visible}\n                        />\n                    ))}\n            </Grid>\n        ),\n        [dependencyId(services), expanded, variant, visible]\n    )\n\n    if (!showHeader)\n        return (\n            <Paper style={{ padding: \"0.25em\" }} variant=\"outlined\">\n                <ServiceWidgets />\n            </Paper>\n        )\n\n    return (\n        <Card aria-live=\"polite\" aria-label={`device ${name} started`}>\n            <CardHeader\n                style={{ paddingBottom: 0 }}\n                avatar={showAvatar && <DeviceAvatar device={device} />}\n                action={\n                    <DeviceActions\n                        device={device}\n                        showStop={expanded}\n                        hideIdentity={!expanded}\n                        showReset={expanded && !mobile}\n                    >\n                        {toggleExpanded && (\n                            <IconButtonWithTooltip\n                                onClick={toggleExpanded}\n                                title={expanded ? \"Collapse\" : \"Expand\"}\n                            >\n                                {expanded ? (\n                                    <ExpandLessIcon />\n                                ) : (\n                                    <ExpandMoreIcon />\n                                )}\n                            </IconButtonWithTooltip>\n                        )}\n                    </DeviceActions>\n                }\n                title={<DeviceName showShortId={false} device={device} />}\n                subheader={\n                    <>\n                        {!mobile && specification && (\n                            <Typography variant=\"caption\" gutterBottom>\n                                {specification.name}\n                            </Typography>\n                        )}\n                    </>\n                }\n            />\n            <CardContent style={{ paddingTop: 0 }}>\n                <ServiceWidgets />\n                {expanded && (\n                    <Grid\n                        container\n                        direction=\"column\"\n                        spacing={1}\n                        alignContent=\"stretch\"\n                    >\n                        {services?.map(service => (\n                            <DashboardServiceDetails\n                                key={\"details\" + service.serviceIndex}\n                                service={service}\n                                services={services}\n                                expanded={expanded}\n                                variant={variant}\n                                visible={visible}\n                            />\n                        ))}\n                    </Grid>\n                )}\n            </CardContent>\n        </Card>\n    )\n}\n","import { useContext, useEffect, useState } from \"react\"\nimport { ROLE_MANAGER_CHANGE } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { RoleManagerClient } from \"../../../jacdac-ts/src/jdom/rolemanagerclient\"\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\"\n\nexport default function useRoleManager(): RoleManagerClient {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const [mgr, setMgr] = useState<RoleManagerClient>(bus.roleManager)\n    useEffect(() =>\n        bus.subscribe(ROLE_MANAGER_CHANGE, () => setMgr(bus.roleManager))\n    )\n    return mgr\n}\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nexport var styles = {\n  /* Styles applied to the root element. */\n  root: {\n    position: 'absolute',\n    right: 16,\n    top: '50%',\n    transform: 'translateY(-50%)'\n  }\n};\n/**\n * Must be used as the last child of ListItem to function properly.\n */\n\nvar ListItemSecondaryAction = /*#__PURE__*/React.forwardRef(function ListItemSecondaryAction(props, ref) {\n  var classes = props.classes,\n      className = props.className,\n      other = _objectWithoutProperties(props, [\"classes\", \"className\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, className),\n    ref: ref\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nListItemSecondaryAction.muiName = 'ListItemSecondaryAction';\nexport default withStyles(styles, {\n  name: 'MuiListItemSecondaryAction'\n})(ListItemSecondaryAction);","import {\n    getTestCommandFunctions,\n    JDTestFunctions,\n} from \"../../jacdac-spec/spectool/jdtestfuns\"\nimport { exprVisitor } from \"../../jacdac-spec/spectool/jdutils\"\n\nimport { CHANGE, EVENT } from \"../jdom/constants\"\nimport { JDEventSource } from \"../jdom/eventsource\"\nimport { JDService } from \"../jdom/service\"\nimport { JDRegister } from \"../jdom/register\"\nimport { JDEvent } from \"../jdom/event\"\nimport { JDServiceClient } from \"../jdom/serviceclient\"\nimport {\n    isEvent,\n    isRegister,\n    serviceSpecificationFromClassIdentifier,\n} from \"../jdom/spec\"\nimport { roundWithPrecision } from \"../jdom/utils\"\n\nexport enum JDTestCommandStatus {\n    NotReady,\n    Active,\n    RequiresUserInput,\n    Passed,\n    Failed,\n}\n\nexport enum JDTestStatus {\n    NotReady,\n    Active,\n    Passed,\n    Failed,\n}\n\nfunction commandStatusToTestStatus(status: JDTestCommandStatus) {\n    switch (status) {\n        case JDTestCommandStatus.Active:\n            return JDTestStatus.Active\n        case JDTestCommandStatus.Passed:\n            return JDTestStatus.Passed\n        case JDTestCommandStatus.Failed:\n            return JDTestStatus.Failed\n        case JDTestCommandStatus.NotReady:\n            return JDTestStatus.NotReady\n        case JDTestCommandStatus.RequiresUserInput:\n            return JDTestStatus.Active\n    }\n}\n\nfunction cmdToTestFunction(cmd: jdtest.TestCommandSpec) {\n    const id = (<jsep.Identifier>cmd.call.callee).name\n    return getTestCommandFunctions().find(t => t.id == id)\n}\n\nfunction unparse(e: jsep.Expression): string {\n    switch (e.type) {\n        case \"ArrayExpression\": {\n            const ae = e as jsep.ArrayExpression\n            return `[${ae.elements.map(unparse).join(\", \")}]`\n        }\n        case \"CallExpression\": {\n            const caller = e as jsep.CallExpression\n            return `${unparse(caller.callee)}(${caller.arguments\n                .map(unparse)\n                .join(\", \")})`\n        }\n        case \"MemberExpression\": {\n            const root = e as jsep.MemberExpression\n            return root.computed\n                ? `${unparse(root.object)}[${unparse(root.property)}]`\n                : `${unparse(root.object)}.${unparse(root.property)}`\n        }\n        case \"BinaryExpression\":\n        case \"LogicalExpression\": {\n            const be = e as any\n            return `(${unparse(be.left)} ${be.operator} ${unparse(be.right)})`\n        }\n        case \"UnaryExpression\": {\n            const ue = e as jsep.UnaryExpression\n            return `${ue.operator}${unparse(ue.argument)}`\n        }\n        case \"Identifier\": {\n            return (e as jsep.Identifier).name\n        }\n        case \"Literal\": {\n            return (e as jsep.Literal).raw\n        }\n        default:\n            return \"TODO\"\n    }\n}\n\ntype SMap<T> = { [v: string]: T }\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype StartMap = { e: jsep.Expression; v: any }[]\n\ntype GetValue = (root: string, fld: string) => any\n\nclass JDExprEvaluator {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    private exprStack: any[] = []\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(private env: GetValue, private start: StartMap) {}\n\n    private tos() {\n        return this.exprStack[this.exprStack.length - 1]\n    }\n\n    public eval(e: jsep.Expression) {\n        this.exprStack = []\n        this.visitExpression(e)\n        return this.exprStack.pop()\n    }\n\n    private getStartVal(e: jsep.Expression) {\n        return this.start.find(r => r.e === e).v\n    }\n\n    private visitExpression(e: jsep.Expression) {\n        switch (e.type) {\n            case \"ArrayExpression\": {\n                // nothing to do here yet (only used for event function)\n                break\n            }\n\n            case \"CallExpression\": {\n                const caller = <jsep.CallExpression>e\n                const callee = <jsep.Identifier>caller.callee\n                switch (callee.name) {\n                    case \"start\": {\n                        this.exprStack.push(\n                            this.getStartVal(caller.arguments[0])\n                        )\n                        return\n                    }\n                    case \"closeTo\": {\n                        const args = caller.arguments\n                        const goal = this.getStartVal(args[1])\n                        const error = this.getStartVal(args[2])\n                        this.visitExpression(args[0])\n                        const ev = this.exprStack.pop()\n                        this.exprStack.push(\n                            ev >= goal - error && ev <= goal + error\n                        )\n                        break\n                    }\n                    default: // ERROR\n                }\n                break\n            }\n\n            case \"BinaryExpression\": {\n                const be = <jsep.BinaryExpression>e\n                this.visitExpression(be.left)\n                this.visitExpression(be.right)\n                const right = this.exprStack.pop()\n                const left = this.exprStack.pop()\n                switch (be.operator) {\n                    case \"+\":\n                        this.exprStack.push(left + right)\n                        return\n                    case \"-\":\n                        this.exprStack.push(left - right)\n                        return\n                    case \"/\":\n                        this.exprStack.push(left / right)\n                        return\n                    case \"*\":\n                        this.exprStack.push(left * right)\n                        return\n                    case \"%\":\n                        this.exprStack.push(left % right)\n                        return\n                    case \">>\":\n                        this.exprStack.push(left >> right)\n                        return\n                    case \">>>\":\n                        this.exprStack.push(left >>> right)\n                        return\n                    case \"<<\":\n                        this.exprStack.push(left << right)\n                        return\n                    case \"|\":\n                        this.exprStack.push(left | right)\n                        return\n                    case \"&\":\n                        this.exprStack.push(left & right)\n                        return\n                    case \"^\":\n                        this.exprStack.push(left ^ right)\n                        return\n                    case \"==\":\n                        this.exprStack.push(left == right)\n                        return\n                    case \"!=\":\n                        this.exprStack.push(left != right)\n                        return\n                    case \"===\":\n                        this.exprStack.push(left === right)\n                        return\n                    case \"!==\":\n                        this.exprStack.push(left !== right)\n                        return\n\n                    case \"<\":\n                        this.exprStack.push(left < right)\n                        return\n                    case \">\":\n                        this.exprStack.push(left > right)\n                        return\n                    case \"<=\":\n                        this.exprStack.push(left <= right)\n                        return\n                    case \">=\":\n                        this.exprStack.push(left >= right)\n                        return\n                }\n                break\n            }\n\n            case \"UnaryExpression\": {\n                const ue = <jsep.UnaryExpression>e\n                this.visitExpression(ue.argument)\n                const top = this.exprStack.pop()\n                switch (ue.operator) {\n                    case \"!\":\n                        this.exprStack.push(!top)\n                        return\n                    case \"~\":\n                        this.exprStack.push(~top)\n                        return\n                    case \"-\":\n                        this.exprStack.push(-top)\n                        return\n                    case \"+\":\n                        this.exprStack.push(+top)\n                        return\n                }\n                break\n            }\n\n            case \"LogicalExpression\": {\n                const le = <jsep.LogicalExpression>e\n                this.visitExpression(le.left)\n                switch (le.operator) {\n                    case \"||\":\n                        if (this.tos()) return\n                        else this.visitExpression(le.right)\n                        return\n                    case \"&&\":\n                        if (!this.tos()) return\n                        else this.visitExpression(le.right)\n                        return\n                    default:\n                }\n                break\n            }\n            case \"MemberExpression\": {\n                // member expressions are of form [register|event].field\n                const root = e as jsep.MemberExpression\n                const lhs = root.object as jsep.Identifier\n                const rhs = root.property as jsep.Identifier\n                const val = this.env(lhs.name, rhs.name)\n                // console.log(`${lhs.name}.${rhs.name} = ${val}`)\n                this.exprStack.push(val)\n                return\n            }\n            case \"Identifier\": {\n                const id = <jsep.Identifier>e\n                this.exprStack.push(this.env(id.name, \"\"))\n                return\n            }\n            case \"Literal\": {\n                const lit = <jsep.Literal>e\n                this.exprStack.push(lit.value)\n                return\n            }\n            default:\n        }\n    }\n}\n\nclass JDCommandEvaluator {\n    private _prompt = \"\"\n    private _progress = \"\"\n    private _status = JDTestCommandStatus.Active\n    private _startExpressions: StartMap = []\n    private _rangeComplete: number = undefined\n    private _eventsComplete: string[] = undefined\n\n    constructor(\n        private readonly testRunner: JDTestRunner,\n        private readonly command: jdtest.TestCommandSpec\n    ) {}\n\n    public get prompt() {\n        return this._prompt\n    }\n    public get status() {\n        return this._status\n    }\n    public get progress() {\n        return this._progress\n    }\n\n    private get env() {\n        return (root: string, fld = \"\") => {\n            return this.testRunner.serviceTestRunner.lookup(root, fld)\n        }\n    }\n\n    // TODO: define an interface between test runner and command evaluator\n    // TODO: so this all can be done modularly\n    public start() {\n        this._startExpressions = []\n        const testFun = cmdToTestFunction(this.command)\n        const args = this.command.call.arguments\n        const startExprs: jsep.Expression[] = []\n        switch (testFun.id as JDTestFunctions) {\n            case \"check\":\n            case \"awaitEvent\":\n            case \"nextEvent\": {\n                exprVisitor(null, args, (p, ce: jsep.CallExpression) => {\n                    if (ce.type !== \"CallExpression\") return\n                    if ((<jsep.Identifier>ce.callee).name === \"start\")\n                        startExprs.push(ce.arguments[0])\n                    else if ((<jsep.Identifier>ce.callee).name === \"closeTo\") {\n                        startExprs.push(ce.arguments[1])\n                        startExprs.push(ce.arguments[2])\n                    }\n                })\n                break\n            }\n            case \"changes\":\n            case \"increases\":\n            case \"decreases\": {\n                startExprs.push(args[0])\n                break\n            }\n            case \"increasesBy\":\n            case \"decreasesBy\":\n            case \"stepsUpTo\":\n            case \"stepsDownTo\": {\n                startExprs.push(args[0])\n                startExprs.push(args[1])\n                break\n            }\n            case \"closeTo\": {\n                startExprs.push(args[1])\n                startExprs.push(args[2])\n                break\n            }\n            case \"assign\": {\n                startExprs.push(args[1])\n                break\n            }\n            case \"events\": {\n                const eventList = this.command.call\n                    .arguments[0] as jsep.ArrayExpression\n                this._eventsComplete = (eventList.elements as jsep.Identifier[]).map(\n                    id => id.name\n                )\n                break\n            }\n        }\n        // evaluate the start expressions and store the results\n        startExprs.forEach(child => {\n            if (this._startExpressions.findIndex(r => r.e === child) < 0) {\n                const exprEval = new JDExprEvaluator(this.env, [])\n                this._startExpressions.push({\n                    e: child,\n                    v: exprEval.eval(child),\n                })\n            }\n        })\n        this.createPrompt()\n    }\n\n    private createPrompt() {\n        const testFun = cmdToTestFunction(this.command)\n        const replaceId = this.command.call.arguments.map((a, i) => {\n            return [`{${i + 1}}`, unparse(a)]\n        })\n        const replaceVal = this.command.call.arguments.map((a, i) => {\n            const aStart = this._startExpressions.find(r => r.e === a)\n            return [\n                `{${i + 1}:val}`,\n                aStart && aStart.v\n                    ? roundWithPrecision(aStart.v, 3).toString()\n                    : unparse(a),\n            ]\n        })\n        this._prompt =\n            testFun.id === \"ask\" || testFun.id === \"say\"\n                ? this.command.prompt.slice(0)\n                : testFun.prompt.slice(0)\n        replaceId.forEach(\n            p => (this._prompt = this._prompt.replace(p[0], p[1]))\n        )\n        replaceVal.forEach(\n            p => (this._prompt = this._prompt.replace(p[0], p[1]))\n        )\n    }\n\n    public setEvent(ev: string) {}\n\n    private checkExpression(e: jsep.Expression) {\n        const expr = new JDExprEvaluator(this.env, this._startExpressions)\n        return expr.eval(e)\n            ? JDTestCommandStatus.Passed\n            : JDTestCommandStatus.Active\n    }\n\n    private getStart(e: jsep.Expression) {\n        return this._startExpressions.find(r => r.e === e)\n    }\n\n    public evaluate() {\n        const testFun = cmdToTestFunction(this.command)\n        const args = this.command.call.arguments\n        this._status = JDTestCommandStatus.Active\n        this._progress = \"\"\n        switch (testFun.id as JDTestFunctions) {\n            case \"ask\": {\n                this._status = JDTestCommandStatus.RequiresUserInput\n                break\n            }\n            case \"check\": {\n                this._status = this.checkExpression(args[0])\n                break\n            }\n            case \"closeTo\": {\n                const goal = this.getStart(args[1])\n                const error = this.getStart(args[2])\n                const expr = new JDExprEvaluator(\n                    this.env,\n                    this._startExpressions\n                )\n                const ev = expr.eval(args[0]) as number\n                if (Math.abs(ev - goal.v) <= error.v)\n                    this._status = JDTestCommandStatus.Passed\n                this._progress = `current: ${pretify(ev)}; goal: ${pretify(\n                    goal.v\n                )}; error: ${pretify(error.v)}`\n                break\n            }\n            case \"changes\":\n            case \"increases\":\n            case \"decreases\": {\n                const regSaved = this._startExpressions.find(\n                    r => r.e === args[0]\n                )\n                const regValue = this.env(unparse(args[0]))\n                const status =\n                    regValue &&\n                    regSaved.v &&\n                    ((testFun.id === \"changes\" && regValue !== regSaved.v) ||\n                        (testFun.id === \"increases\" && regValue > regSaved.v) ||\n                        (testFun.id === \"decreases\" && regValue < regSaved.v))\n                        ? JDTestCommandStatus.Passed\n                        : JDTestCommandStatus.Active\n                this._status = status\n                regSaved.v = regValue\n                break\n            }\n            case \"increasesBy\":\n            case \"decreasesBy\": {\n                const regSaved = this.getStart(args[0])\n                const amtSaved = this.getStart(args[1])\n                const regValue = this.env(unparse(args[0]))\n                if (testFun.id === \"increasesBy\") {\n                    if (regValue >= regSaved.v + amtSaved.v) {\n                        this._status = JDTestCommandStatus.Passed\n                    } else if (\n                        regValue >= regSaved.v &&\n                        regValue < regSaved.v + amtSaved.v\n                    ) {\n                        this._status = JDTestCommandStatus.Active\n                        this._progress = `current: ${pretify(\n                            regValue\n                        )}, goal: ${pretify(regSaved.v + amtSaved.v)}`\n                    } else {\n                        this._status = JDTestCommandStatus.Active\n                    }\n                } else {\n                    if (regValue <= regSaved.v - amtSaved.v) {\n                        this._status = JDTestCommandStatus.Passed\n                        this._progress = \"completed\"\n                    } else if (\n                        regValue <= regSaved.v &&\n                        regValue > regSaved.v - amtSaved.v\n                    ) {\n                        this._status = JDTestCommandStatus.Active\n                        this._progress = `current: ${pretify(\n                            regValue\n                        )} goal: ${pretify(regSaved.v - amtSaved.v)}`\n                    } else {\n                        this._status = JDTestCommandStatus.Active\n                    }\n                }\n                break\n            }\n            case \"stepsUpTo\":\n            case \"stepsDownTo\": {\n                this._status = JDTestCommandStatus.Active\n                const regValue = this.env(unparse(args[0]))\n                const beginSaved = this.getStart(args[0])\n                const endSaved = this.getStart(args[1])\n                if (this._rangeComplete === undefined) {\n                    this._rangeComplete = regValue\n                } else {\n                    if (\n                        regValue ===\n                        this._rangeComplete +\n                            (testFun.id == \"stepsUpTo\" ? 1 : -1)\n                    )\n                        this._rangeComplete = regValue\n                    if (this._rangeComplete === endSaved.v) {\n                        this._status = JDTestCommandStatus.Passed\n                    }\n                }\n                if (this._rangeComplete != undefined) {\n                    this._progress =\n                        testFun.id == \"stepsUpTo\"\n                            ? `from ${pretify(beginSaved.v)} up to ${pretify(\n                                  this._rangeComplete\n                              )}`\n                            : `from ${pretify(beginSaved.v)} down to ${pretify(\n                                  this._rangeComplete\n                              )}`\n                }\n                break\n            }\n            case \"events\": {\n                if (this.testRunner.hasEvent) {\n                    const ev = this.testRunner.consumeEvent()\n                    if (ev === this._eventsComplete[0]) {\n                        this._eventsComplete.shift()\n                        if (this._eventsComplete.length === 0)\n                            this._status = JDTestCommandStatus.Passed\n                    } else {\n                        this._status = JDTestCommandStatus.Failed\n                    }\n                    this._progress = `got event ${ev}; remaining = [${this._eventsComplete}]`\n                } else {\n                    this._progress = `no events received; remaining = [${this._eventsComplete}]`\n                }\n                break\n            }\n            case \"awaitEvent\":\n            case \"nextEvent\": {\n                const event = args[0] as jsep.Identifier\n                this._progress = `waiting for event ${event.name}`\n                if (this.testRunner.hasEvent) {\n                    const ev = this.testRunner.consumeEvent()\n                    if (ev !== event.name) {\n                        if (testFun.id === \"nextEvent\")\n                            this._status = JDTestCommandStatus.Failed\n                    } else {\n                        // this._status = JDTestCommandStatus.Passed\n                        this._status = this.checkExpression(\n                            this.command.call.arguments[1]\n                        )\n                    }\n                } else {\n                    this._progress = `no events received; ${this._progress}`\n                }\n                break\n            }\n            case \"assign\": {\n                const reg = args[0] as jsep.Identifier\n                const jdreg = this.testRunner.serviceTestRunner.registers[\n                    reg.name\n                ]\n                const expr = new JDExprEvaluator(\n                    this.env,\n                    this._startExpressions\n                )\n                const ev = expr.eval(args[1])\n                if (jdreg) {\n                    const fmt = jdreg.specification?.packFormat\n                    jdreg.sendSetPackedAsync(fmt, [ev])\n                    this._status = JDTestCommandStatus.Passed\n                    this._progress = `wrote ${ev} to register ${reg.name}`\n                }\n            }\n        }\n\n        function pretify(v: number) {\n            return roundWithPrecision(v, 3)\n        }\n    }\n}\n\nexport interface JDCommandOutput {\n    message: string\n    progress: string\n}\n\nexport class JDTestCommandRunner extends JDEventSource {\n    private _status = JDTestCommandStatus.NotReady\n    private _output: JDCommandOutput = { message: \"\", progress: \"\" }\n    private _commmandEvaluator: JDCommandEvaluator = null\n\n    constructor(\n        private readonly testRunner: JDTestRunner,\n        private readonly command: jdtest.TestCommandSpec\n    ) {\n        super()\n    }\n\n    get status() {\n        return this._status\n    }\n\n    set status(s: JDTestCommandStatus) {\n        if (s != this._status) {\n            this._status = s\n            this.emit(CHANGE)\n        }\n    }\n\n    get indeterminate(): boolean {\n        return (\n            this.status !== JDTestCommandStatus.Failed &&\n            this.status !== JDTestCommandStatus.Passed\n        )\n    }\n\n    get isActive(): boolean {\n        return (\n            this.status === JDTestCommandStatus.Active ||\n            this.status === JDTestCommandStatus.RequiresUserInput\n        )\n    }\n\n    get output() {\n        return this._output\n    }\n\n    set output(value: JDCommandOutput) {\n        if (\n            !this._output ||\n            this._output.message !== value.message ||\n            this._output.progress !== value.progress\n        ) {\n            this._output = value\n            this.emit(CHANGE)\n        }\n    }\n\n    reset() {\n        this.status = JDTestCommandStatus.NotReady\n        this.output = { message: \"\", progress: \"\" }\n        this._commmandEvaluator = null\n    }\n\n    start() {\n        this.status = JDTestCommandStatus.Active\n        this._commmandEvaluator = new JDCommandEvaluator(\n            this.testRunner,\n            this.command\n        )\n        this._commmandEvaluator.start()\n        this.envChange()\n    }\n\n    envChange() {\n        if (this.isActive) {\n            this._commmandEvaluator.evaluate()\n            const newOutput: JDCommandOutput = {\n                message: this._commmandEvaluator.prompt,\n                progress: this._commmandEvaluator.progress,\n            }\n            this.output = newOutput\n            if (\n                this._commmandEvaluator.status ===\n                JDTestCommandStatus.RequiresUserInput\n            )\n                this.status = JDTestCommandStatus.RequiresUserInput\n            else this.finish(this._commmandEvaluator.status)\n        }\n    }\n\n    cancel() {\n        this.finish(JDTestCommandStatus.Failed)\n    }\n\n    finish(s: JDTestCommandStatus) {\n        if (\n            this.isActive &&\n            (s === JDTestCommandStatus.Failed ||\n                s === JDTestCommandStatus.Passed)\n        ) {\n            this.status = s\n            this.testRunner.finishCommand()\n        }\n    }\n}\n\nexport class JDTestRunner extends JDEventSource {\n    private _status = JDTestStatus.NotReady\n    private _commandIndex: number\n    private _currentEvent: string\n    public readonly commands: JDTestCommandRunner[]\n\n    constructor(\n        public readonly serviceTestRunner: JDServiceTestRunner,\n        private readonly testSpec: jdtest.TestSpec\n    ) {\n        super()\n        this.commands = testSpec.testCommands.map(\n            c => new JDTestCommandRunner(this, c)\n        )\n    }\n\n    public reset() {\n        if (this.status !== JDTestStatus.NotReady) {\n            this._status = JDTestStatus.NotReady\n            this._commandIndex = undefined\n            this._currentEvent = undefined\n            this.commands.forEach(t => t.reset())\n            this.emit(CHANGE)\n        }\n    }\n\n    start() {\n        this.reset()\n        this.status = JDTestStatus.Active\n        this.commandIndex = 0\n        this.serviceTestRunner.refreshEnvironment()\n    }\n\n    next() {\n        this.serviceTestRunner.next()\n    }\n\n    cancel() {\n        this.finish(JDTestStatus.Failed)\n    }\n\n    get status() {\n        return this._status\n    }\n\n    set status(s: JDTestStatus) {\n        if (s != this._status) {\n            this._status = s\n            this.emit(CHANGE)\n        }\n    }\n\n    get indeterminate(): boolean {\n        return (\n            this.status !== JDTestStatus.Failed &&\n            this.status !== JDTestStatus.Passed\n        )\n    }\n\n    get description() {\n        return this.testSpec.description\n    }\n\n    get prompt() {\n        return this.testSpec.prompt\n    }\n\n    finish(newStatus: JDTestStatus) {\n        if (this.status === JDTestStatus.Active) {\n            this.status = newStatus\n        }\n    }\n\n    private get commandIndex() {\n        return this._commandIndex\n    }\n\n    private set commandIndex(index: number) {\n        if (this._commandIndex !== index) {\n            this._commandIndex = index\n            this.currentCommand?.start()\n            this.emit(CHANGE)\n        }\n    }\n\n    public envChange() {\n        if (this.status === JDTestStatus.Active) {\n            this.currentCommand?.envChange()\n        }\n    }\n\n    public eventChange(event: string) {\n        if (this.status === JDTestStatus.Active) {\n            this._currentEvent = event\n            this.envChange()\n        }\n    }\n\n    public get hasEvent() {\n        return this._currentEvent != undefined\n    }\n\n    public consumeEvent() {\n        const ret = this._currentEvent\n        this._currentEvent = undefined\n        return ret\n    }\n\n    public finishCommand() {\n        if (this.commandIndex === this.commands.length - 1)\n            this.finish(commandStatusToTestStatus(this.currentCommand.status))\n        else this.commandIndex++\n    }\n\n    get currentCommand() {\n        return this.commands[this._commandIndex]\n    }\n}\n\nasync function refresh_env(registers: SMap<JDRegister>) {\n    for (const k in registers) {\n        const register = registers[k]\n        let retry = 0\n        let val: any = undefined\n        do {\n            await register.refresh()\n            val = register.unpackedValue?.[0]\n        } while (val === undefined && retry++ < 2)\n    }\n}\n\nexport class JDServiceTestRunner extends JDServiceClient {\n    private _testIndex = -1\n    private _registers: SMap<JDRegister> = {}\n    private _events: SMap<JDEvent> = {}\n    public readonly tests: JDTestRunner[]\n\n    constructor(\n        public readonly testSpec: jdtest.ServiceTestSpec,\n        service: JDService\n    ) {\n        super(service)\n        this.tests = this.testSpec.tests.map(t => new JDTestRunner(this, t))\n        const serviceSpec = serviceSpecificationFromClassIdentifier(\n            service.serviceClass\n        )\n        this.testSpec.tests.forEach(t => {\n            t.events.forEach(eventName => {\n                if (!this.events[eventName]) {\n                    const pkt = serviceSpec.packets.find(\n                        pkt => isEvent(pkt) && pkt.name === eventName\n                    )\n                    const event = service.event(pkt.identifier)\n                    this.events[eventName] = event\n                    this.mount(\n                        event.subscribe(EVENT, () => {\n                            this.currentTest?.eventChange(eventName)\n                        })\n                    )\n                }\n            })\n            t.registers.forEach(regName => {\n                if (!this._registers[regName]) {\n                    const pkt = serviceSpec.packets.find(\n                        pkt => isRegister(pkt) && pkt.name === regName\n                    )\n                    const register = service.register(pkt.identifier)\n                    this._registers[regName] = register\n                    this.mount(\n                        register.subscribe(CHANGE, () => {\n                            this.currentTest?.envChange()\n                        })\n                    )\n                }\n            })\n        })\n        this.start()\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    public lookup(root: string, fld = \"\"): any {\n        if (root in this.registers) {\n            if (!fld) return this.registers[root].unpackedValue?.[0]\n            else {\n                const field = this.registers[root].fields.find(\n                    f => f.name === fld\n                )\n                return field?.value\n            }\n        } else if (root in this.events) {\n            const field = this.events[root].fields?.find(f => f.name === fld)\n            return field?.value\n        }\n        return undefined\n    }\n\n    public refreshEnvironment() {\n        refresh_env(this.registers)\n    }\n\n    public get registers() {\n        return this._registers\n    }\n\n    public get events() {\n        return this._events\n    }\n\n    private get testIndex() {\n        return this._testIndex\n    }\n\n    private set testIndex(index: number) {\n        if (this._testIndex !== index) {\n            // stop previous test if needed\n            const ct = this.currentTest\n            if (ct) {\n                if (ct.status === JDTestStatus.Active) {\n                    ct.cancel()\n                }\n            }\n\n            // update test\n            this._testIndex = index\n            this.emit(CHANGE)\n        }\n    }\n\n    public stats() {\n        const r = {\n            total: this.tests.length,\n            success: 0,\n            failed: 0,\n            indeterminate: 0,\n        }\n        for (const test of this.tests) {\n            switch (test.status) {\n                case JDTestStatus.Failed:\n                    r.failed++\n                    break\n                case JDTestStatus.Passed:\n                    r.success++\n                    break\n                default:\n                    r.indeterminate++\n            }\n        }\n        return r\n    }\n\n    public start() {\n        this.tests.forEach(t => t.reset())\n        this.testIndex = 0\n    }\n\n    public next() {\n        this.testIndex++\n    }\n\n    get currentTest() {\n        return this.tests[this._testIndex]\n    }\n\n    set currentTest(test: JDTestRunner) {\n        const index = this.tests.indexOf(test)\n        if (index > -1) this.testIndex = index\n    }\n}\n","import React, { useCallback, useEffect } from \"react\"\nimport useServiceClient from \"../useServiceClient\"\nimport {\n    Grid,\n    Button,\n    List,\n    ListItemText,\n    ListItem,\n    ListItemIcon,\n    ListItemSecondaryAction,\n    Typography,\n    Card,\n    CardContent,\n    CardActions,\n    Box,\n    ListSubheader,\n} from \"@material-ui/core\"\n// tslint:disable-next-line: match-default-export-name no-submodule-imports\nimport Alert from \"../ui/Alert\"\nimport { JDService } from \"../../../jacdac-ts/src/jdom/service\"\nimport {\n    JDServiceTestRunner,\n    JDTestRunner,\n    JDTestStatus,\n    JDTestCommandRunner,\n    JDTestCommandStatus,\n} from \"../../../jacdac-ts/src/test/testrunner\"\nimport ErrorIcon from \"@material-ui/icons/Error\"\nimport CheckCircleIcon from \"@material-ui/icons/CheckCircle\"\nimport HourglassEmptyIcon from \"@material-ui/icons/HourglassEmpty\"\nimport PlayCircleFilledIcon from \"@material-ui/icons/PlayCircleFilled\"\nimport useChange from \"../../jacdac/useChange\"\nimport DashboardDevice from \"../dashboard/DashboardDevice\"\nimport LoadingProgress from \"../ui/LoadingProgress\"\nimport { serviceTestFromServiceClass } from \"../../../jacdac-ts/src/test/testspec\"\n\nfunction TestStatusIcon(props: { test: JDTestRunner }) {\n    const { test } = props\n    const status = useChange(test, t => t.status)\n\n    switch (status) {\n        case JDTestStatus.Active:\n            return <PlayCircleFilledIcon color=\"action\" />\n        case JDTestStatus.Failed:\n            return <ErrorIcon color=\"error\" />\n        case JDTestStatus.Passed:\n            return <CheckCircleIcon color=\"primary\" />\n        default:\n            return <HourglassEmptyIcon color=\"disabled\" />\n    }\n}\n\nfunction TestListItem(props: {\n    test: JDTestRunner\n    currentTest: JDTestRunner\n    onSelectTest: (test: JDTestRunner) => void\n}) {\n    const { test, currentTest, onSelectTest } = props\n    const description = useChange(test, t => t.description)\n    const selected = test === currentTest\n    const handleSelectTest = () => onSelectTest(test)\n\n    return (\n        <ListItem selected={selected} button onClick={handleSelectTest}>\n            <ListItemIcon>\n                <TestStatusIcon test={test} />\n            </ListItemIcon>\n            <ListItemText primary={description} />\n        </ListItem>\n    )\n}\n\nfunction TestList(props: {\n    testRunner: JDServiceTestRunner\n    currentTest: JDTestRunner\n    onSelectTest: (test: JDTestRunner) => void\n}) {\n    const { testRunner, currentTest, onSelectTest } = props\n    const { tests } = testRunner\n    const stats = useChange(testRunner, r => r.stats())\n\n    return (\n        <Card>\n            <CardContent>\n                <List\n                    dense={true}\n                    subheader={\n                        <ListSubheader>\n                            {`${stats.total} tests, ${stats.success} success, ${stats.failed} failed`}\n                        </ListSubheader>\n                    }\n                >\n                    {tests?.map((test, i) => (\n                        <TestListItem\n                            key={i}\n                            test={test}\n                            currentTest={currentTest}\n                            onSelectTest={onSelectTest}\n                        />\n                    ))}\n                </List>\n            </CardContent>\n        </Card>\n    )\n}\n\nfunction CommandStatusIcon(props: { command: JDTestCommandRunner }) {\n    const { command } = props\n    const status = useChange(command, c => c.status)\n\n    switch (status) {\n        case JDTestCommandStatus.Active:\n        case JDTestCommandStatus.RequiresUserInput:\n            return <PlayCircleFilledIcon color=\"action\" />\n        case JDTestCommandStatus.Failed:\n            return <ErrorIcon color=\"error\" />\n        case JDTestCommandStatus.Passed:\n            return <CheckCircleIcon color=\"primary\" />\n        default:\n            return <HourglassEmptyIcon color=\"disabled\" />\n    }\n}\n\nfunction CommandListItem(props: { command: JDTestCommandRunner }) {\n    const { command } = props\n    const { message, progress } = useChange(command, c => c.output)\n    const status = useChange(command, c => c.status)\n    const handleAnswer = (status: JDTestCommandStatus) => () =>\n        command.finish(status)\n    return (\n        <>\n            <ListItem selected={status === JDTestCommandStatus.Active}>\n                <ListItemIcon>\n                    <CommandStatusIcon command={command} />\n                </ListItemIcon>\n                <ListItemText\n                    primary={message}\n                    secondary={progress}\n                />\n            </ListItem>\n            {status === JDTestCommandStatus.RequiresUserInput && (\n                <ListItem>\n\n                    <ListItemSecondaryAction>\n                        <Grid container spacing={1}>\n                            <Grid item><Button\n                                variant=\"outlined\"\n                                onClick={handleAnswer(JDTestCommandStatus.Passed)}\n                            >\n                                Yes\n                    </Button>\n                            </Grid>\n                            <Grid item>\n                                <Button\n                                    variant=\"outlined\"\n                                    onClick={handleAnswer(JDTestCommandStatus.Failed)}\n                                >\n                                    No\n                    </Button>\n                            </Grid>\n                        </Grid>\n                    </ListItemSecondaryAction>\n                </ListItem>\n            )}\n\n        </>\n    )\n}\n\nfunction ActiveTest(props: { test: JDTestRunner }) {\n    const { test } = props\n    const { commands } = test\n    const status = useChange(test, t => t.status)\n    const handleRestart = () => test.start()\n    const handleNext = () => test.next()\n    // auto start\n    useEffect(() => test.start(), [test])\n\n    return (\n        <Card>\n            <CardContent>\n                <Typography variant=\"h5\">DO</Typography>\n                <Box m={2}>\n                    <Typography variant=\"body1\">{test.prompt}</Typography>\n                </Box>\n                <Typography variant=\"h5\">TEST</Typography>\n                <List dense={false}>\n                    {commands.map((cmd, i) => (\n                        <CommandListItem key={i} command={cmd} />\n                    ))}\n                </List>\n                {status === JDTestStatus.Passed && (\n                    <Alert severity=\"success\">Test passed</Alert>\n                )}\n                {status === JDTestStatus.Failed && (\n                    <Alert severity=\"error\">Test failed</Alert>\n                )}\n            </CardContent>\n            <CardActions>\n                <Button\n                    variant={\n                        status === JDTestStatus.Active\n                            ? \"outlined\"\n                            : \"contained\"\n                    }\n                    color={\n                        status === JDTestStatus.Passed ? \"primary\" : undefined\n                    }\n                    onClick={handleNext}\n                >\n                    Next\n                </Button>\n                <Button variant=\"outlined\" onClick={handleRestart}>\n                    Restart\n                </Button>\n            </CardActions>\n        </Card>\n    )\n}\n\nexport default function ServiceTestRunner(props: {\n    service: JDService\n    serviceTest?: jdtest.ServiceTestSpec\n}) {\n    const {\n        service,\n        serviceTest = serviceTestFromServiceClass(service.serviceClass),\n    } = props\n    const factory = useCallback(\n        service => serviceTest && new JDServiceTestRunner(serviceTest, service),\n        [service, serviceTest]\n    )\n    const testRunner = useServiceClient(service, factory)\n    const currentTest = useChange(testRunner, t => t?.currentTest)\n    const handleSelectTest = (test: JDTestRunner) => {\n        testRunner.currentTest = test\n    }\n\n    if (!serviceTest)\n        return (\n            <Alert severity=\"warning\">\n                Sorry, there are no tests available for service{\" \"}\n                {service.specification.name}.\n            </Alert>\n        )\n\n    if (!testRunner) return <LoadingProgress />\n\n    return (\n        <Grid container spacing={2}>\n            <Grid item xs={3}>\n                <TestList\n                    testRunner={testRunner}\n                    currentTest={currentTest}\n                    onSelectTest={handleSelectTest}\n                />\n            </Grid>\n            <Grid item xs={6}>\n                {currentTest ? <ActiveTest test={currentTest} /> : <Alert severity={\"info\"}>\n                    Select a test to get started.\n                </Alert>}\n            </Grid>\n            {service && (\n                <Grid item xs={3}>\n                    <DashboardDevice\n                        showAvatar={true}\n                        showHeader={true}\n                        device={service.device}\n                    />\n                </Grid>\n            )}\n        </Grid>\n    )\n}\n","import { GridSize } from \"@material-ui/core\"\nimport React, { useContext } from \"react\"\nimport AppContext, { DrawerType } from \"./AppContext\"\n\nexport interface GridBreakpoints {\n    xs?: GridSize,\n    md?: GridSize,\n    sm?: GridSize,\n    lg?: GridSize,\n    xl?: GridSize\n}\n\nexport default function useGridBreakpoints(itemCount?: number): GridBreakpoints {\n    const { drawerType } = useContext(AppContext)\n\n    if (itemCount !== undefined) {\n        switch (itemCount) {\n            case 1:\n            case 2: return { xs: 12, sm: 6, md: 6, lg: 6, xl: 6 }\n            case 3: return { xs: 12, sm: 6, md: 6, lg: 4, xl: 4 }\n        }\n    }\n\n    if (drawerType != DrawerType.None)\n        return { xs: 12, md: 6, sm: 6, lg: 6, xl: 4 }\n    else return {\n        xs: 12,\n        sm: 6,\n        md: 4,\n        lg: 4,\n        xl: 3\n    }\n}","import { useEffect, useState } from \"react\"\nimport { JDService } from \"../../jacdac-ts/src/jdom/service\"\nimport { JDServiceClient } from \"../../jacdac-ts/src/jdom/serviceclient\"\n\nexport default function useServiceClient<T extends JDServiceClient>(service: JDService, factory: (service: JDService) => T, deps: React.DependencyList = []) {\n    const [client, setClient] = useState<T>(undefined)\n\n    useEffect(() => {\n        const c = service && factory(service)\n        setClient(c)\n        return () => c?.unmount()\n    }, [service, ...deps]) // don't use factory in cache!\n\n    return client;\n}"],"sourceRoot":""}