{"version":3,"sources":["webpack:///./src/components/dashboard/DashboardGyroscope.tsx"],"names":["Sliders","props","host","register","rates","useRegisterUnpackedValue","handleChangeX","event","newValue","reading","values","y","z","n","setValues","sendGetAsync","handleChangeY","x","handleChangeZ","valueDisplay","v","roundWithPrecision","length","step","marks","value","DashboardGyroscope","service","GyroscopeReg","RotationRates","useServiceHost","color","useWidgetTheme","active","rotator","useCallback","delta","rotation","unpackedValue","degreesToRadians","Math","PI","f","height","width"],"mappings":"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","file":"74-0a7a025d39f4b033812c.js","sourcesContent":["import React, { Suspense, useCallback } from \"react\";\nimport { GyroscopeReg } from \"../../../jacdac-ts/src/jdom/constants\";\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\";\nimport { useRegisterUnpackedValue } from \"../../jacdac/useRegisterValue\";\nimport useWidgetTheme from \"../widgets/useWidgetTheme\";\nimport useServiceHost from \"../hooks/useServiceHost\";\nimport SensorServiceHost from \"../../../jacdac-ts/src/hosts/sensorservicehost\";\nimport { JDRegister } from \"../../../jacdac-ts/src/jdom/register\";\nimport { Grid, Mark, NoSsr, Slider } from \"@material-ui/core\";\nimport { roundWithPrecision } from \"../../../jacdac-ts/src/jdom/utils\";\nimport CanvasWidget from \"../widgets/CanvasWidget\";\nimport { Vector } from \"../widgets/threeutils\";\nimport LoadingProgress from \"../ui/LoadingProgress\";\n\nfunction Sliders(props: { host: SensorServiceHost<[number, number, number]>, register: JDRegister }) {\n    const { host, register } = props;\n    const rates = useRegisterUnpackedValue<[number, number, number]>(register);\n    const handleChangeX = (event: unknown, newValue: number | number[]) => {\n        const [, y, z] = host.reading.values();\n        const n = newValue as any as number;\n        host.reading.setValues([n, y, z]);\n        register.sendGetAsync()\n    }\n    const handleChangeY = (event: unknown, newValue: number | number[]) => {\n        const [x, , z] = host.reading.values();\n        const n = newValue as any as number;\n        host.reading.setValues([x, n, z]);\n        register.sendGetAsync()\n    }\n    const handleChangeZ = (event: unknown, newValue: number | number[]) => {\n        const [x, y] = host.reading.values();\n        const n = newValue as any as number;\n        host.reading.setValues([x, y, n]);\n        register.sendGetAsync()\n    }\n    const valueDisplay = (v: number) => `${roundWithPrecision(v, 1)}Â°/s`\n\n    if (!rates?.length)\n        return <LoadingProgress />;\n    const [x, y, z] = rates;\n    const step = 1\n    const marks: Mark[] = [\n        {\n            value: 0,\n        },\n    ]\n    return <>\n        <Grid item>\n            <Slider\n                valueLabelDisplay=\"auto\"\n                valueLabelFormat={valueDisplay}\n                aria-label=\"x rotation rate slider\" orientation=\"vertical\" min={-180} max={180} step={step}\n                value={x}\n                marks={marks}\n                onChange={handleChangeX} />\n        </Grid>\n        <Grid item>\n            <Slider\n                valueLabelDisplay=\"auto\"\n                valueLabelFormat={valueDisplay}\n                aria-label=\"y rotation rate slider\" orientation=\"vertical\" min={-180} max={180} step={step}\n                value={y}\n                marks={marks}\n                onChange={handleChangeY} />\n        </Grid>\n        <Grid item>\n            <Slider\n                valueLabelDisplay=\"auto\"\n                valueLabelFormat={valueDisplay}\n                aria-label=\"z rotation rate slider\" orientation=\"vertical\" min={-180} max={180} step={step}\n                value={z}\n                marks={marks}\n                onChange={handleChangeZ} />\n        </Grid>\n    </>\n}\n\nexport default function DashboardGyroscope(props: DashboardServiceProps) {\n    const { service } = props;\n    const register = service.register(GyroscopeReg.RotationRates);\n    const host = useServiceHost<SensorServiceHost<[number, number, number]>>(service);\n    const color = host ? \"secondary\" : \"primary\"\n    const { active } = useWidgetTheme(color)\n    const rotator = useCallback((delta, rotation: Vector) => {\n        const rates = register.unpackedValue;\n        if (!rates) return;\n\n        const [x, y, z] = rates; // degrees\n        const degreesToRadians = Math.PI / 180;\n        const f = delta * degreesToRadians;\n        return {\n            x: rotation.x + x * f,\n            y: rotation.y - z * f,\n            z: rotation.z - y * f\n        }\n    }, [register])\n\n    return <Grid container direction=\"row\">\n        <Grid item style={({ height: \"20vh\", width: \"20vh\" })}>\n            <NoSsr><Suspense fallback={<LoadingProgress />}>\n                <CanvasWidget color={active} rotator={rotator} />\n            </Suspense></NoSsr>\n        </Grid>\n        {host && <Sliders host={host} register={register} />}\n    </Grid>\n}"],"sourceRoot":""}