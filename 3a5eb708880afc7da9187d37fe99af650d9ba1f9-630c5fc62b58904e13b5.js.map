{"version":3,"sources":["webpack:///./node_modules/@material-ui/core/esm/ListItemIcon/ListItemIcon.js","webpack:///./src/components/ui/CardMediaWithSkeleton.tsx","webpack:///./src/components/DeviceCardMedia.tsx","webpack:///./src/components/DeviceCardHeader.tsx","webpack:///./node_modules/@material-ui/icons/PauseCircleOutline.js","webpack:///./node_modules/@material-ui/lab/esm/AlertTitle/AlertTitle.js","webpack:///./node_modules/@material-ui/icons/Info.js","webpack:///./node_modules/@material-ui/core/esm/CardMedia/CardMedia.js","webpack:///./node_modules/@material-ui/core/esm/ListItemText/ListItemText.js","webpack:///./src/components/useGridBreakpoints.ts","webpack:///./node_modules/@material-ui/icons/PlayCircleFilled.js","webpack:///./jacdac-ts/src/jdom/serviceclient.ts","webpack:///./jacdac-ts/jacdac-spec/spectool/jdtestfuns.ts","webpack:///./jacdac-ts/node_modules/jsonpath-plus/dist/index-browser-esm.js","webpack:///./node_modules/@material-ui/core/esm/ListItemSecondaryAction/ListItemSecondaryAction.js","webpack:///./node_modules/@material-ui/core/esm/LinearProgress/LinearProgress.js","webpack:///./jacdac-ts/src/jdom/test.ts","webpack:///./jacdac-ts/src/test/testrunner.ts","webpack:///./src/components/SelectService.tsx","webpack:///./src/components/ServiceTest.tsx","webpack:///./node_modules/@material-ui/core/esm/CardActions/CardActions.js","webpack:///./node_modules/@material-ui/icons/CheckCircle.js","webpack:///./node_modules/@material-ui/icons/HourglassEmpty.js","webpack:///./src/components/useServiceClient.ts"],"names":["useStyles","makeStyles","theme","createStyles","media","height","paddingTop","CardMediaWithSkeleton","props","image","src","className","others","classes","hasImage","DeviceCardMedia","device","specification","useDeviceSpecification","imageUrl","useDeviceImage","name","DeviceFirmwareVersionChip","firmwareVersionRegister","service","register","ControlReg","FirmwareVersion","firmwareVersion","useRegisterStringValue","DeviceTemperatureChip","tempRegister","McuTemperature","temperature","useRegisterIntValue","undefined","DeviceCardHeader","showFirmware","showTemperature","showMedia","showDeviceId","showAvatar","identifierToUrlPath","id","deviceId","filter","s","join","useGridBreakpoints","itemCount","useContext","AppContext","drawerType","xs","sm","md","lg","xl","DrawerType","None","JDServiceClient","toString","bus","JDClient","testCommandFunctions","args","prompt","testExpressionFunctions","_serviceTests","serviceTestData","serviceTestFromServiceSpec","spec","find","test","serviceClassIdentifier","classIdentifier","JDCommandStatus","JDTestStatus","commandStatusToTestStatus","status","Active","Passed","Failed","NotReady","RequiresUserInput","cmdToTestFunction","cmd","call","callee","t","unparse","e","type","caller","arguments","map","be","left","operator","right","ue","argument","raw","JDExprEvaluator","env","start","exprStack","tos","length","eval","visitExpression","pop","push","r","v","le","lit","value","JDCommandEvaluator","command","_prompt","_progress","_status","_startExpressions","testFun","startExprs","JSONPath","path","json","ce","forEach","child","findIndex","exprEval","createPrompt","replace","a","i","slice","p","evaluate","expr","ev","reg","regSaved","regValue","progress","amt","amtSaved","JDCommandRunner","testRunner","_output","message","_timeOut","_timeLeft","_commmandEvaluator","reset","output","envChange","finish","newOutput","cancel","finishCommand","emit","CHANGE","JDEventSource","JDTestRunner","serviceTestRunner","testSpec","commands","c","_description","description","ready","ReadyToRun","commandIndex","finishTest","currentCommand","_commandIndex","index","JDServiceTestRunner","_testIndex","registers","environment","tests","serviceSpec","serviceSpecificationFromClassIdentifier","serviceClass","regName","pkt","packets","identifier","mount","subscribe","intValue","currentTest","testIndex","SelectService","JacdacContext","onSelect","services","useChange","n","gridBreakpoints","handleSelect","Diagnostics","hostDefinition","hostDefinitionFromServiceClass","handleStartSimulator","addHost","TestStatusIcon","TestListItem","TestList","CommandStatusIcon","CommandListItem","handleAnswer","ActiveTest","handleRun","handleReset","handleCancel","showCommands","indexOf","ServiceTestRunnerSelect","LinearProgressWithLabel","total","TestProgress","executed","reduce","indeterminate","ServiceTest","showStartSimulator","serviceTest","useState","selectedService","setSelectedService","factory","useCallback","useServiceClient","shortId","Flags","diagnostics","deps","client","setClient","useEffect","unmount"],"mappings":"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AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,wCAAwC,SAAS;AACjD;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,YAAY,oDAAoD;AAChE;;AAEA;AACA;AACA,WAAW,aAAa;AACxB,WAAW,IAAI;AACf,aAAa,aAAa;AAC1B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf,WAAW,aAAa;AACxB,aAAa,aAAa;AAC1B;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA,aAAa,IAAI;AACjB;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,CAAC;AACD;AACA,YAAY,YAAY;AACxB,aAAa,OAAO;AACpB,aAAa,WAAW;AACxB,aAAa,yBAAyB;AACtC,aAAa,OAAO;AACpB;;AAEA;AACA;AACA,UAAU,mBAAmB;AAC7B,UAAU,mBAAmB;AAC7B,UAAU,aAAa;AACvB,YAAY;AACZ;;AAEA;AACA;AACA,UAAU,WAAW;AACrB,UAAU,OAAO;AACjB,UAAU,yBAAyB;AACnC,UAAU,OAAO;AACjB,YAAY;AACZ;;AAEA;;AAEA;AACA,aAAa,YAAY;AACzB,cAAc,KAAK;AACnB,cAAc,gBAAgB;AAC9B,cAAc,yDAAyD;AACvE,cAAc,QAAQ;AACtB,cAAc,QAAQ;AACtB,cAAc,YAAY,YAAY;AACtC,cAAc,QAAQ;AACtB,cAAc,8BAA8B;AAC5C,cAAc,YAAY;AAC1B,cAAc,iBAAiB;AAC/B,cAAc,kBAAkB;AAChC;AACA,cAAc,QAAQ;AACtB;;AAEA;;AAEA;AACA,WAAW,uBAAuB;AAClC,WAAW,OAAO;AAClB,WAAW,KAAK;AAChB,WAAW,iBAAiB;AAC5B;AACA;AACA,WAAW,kBAAkB;AAC7B;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;;AAGD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA,GAAG;AACH,EAAE;;;AAGF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qHAAqH;;AAErH;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,WAAW,yBAAyB;AACpC,WAAW,OAAO;AAClB,WAAW,iBAAiB;AAC5B,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,aAAa;AACb;;;AAGA;AACA,oBAAoB;AACpB;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA,wBAAwB;AACxB;;AAEA;AACA;AACA;AACA,aAAa,4BAA4B;AACzC,eAAe;AACf;;AAEA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,EAAE;AACP;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA;;;AAGA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,KAAK;;AAEL,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA,yBAAyB,+BAA+B;AACxD;AACA;AACA,OAAO;;AAEP,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;;AAGA;AACA,mBAAmB,gBAAgB;AACnC;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,0BAA0B,SAAS;AACnC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,mBAAmB,OAAO;AAC1B;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qBAAqB,SAAS;AAC9B,+FAA+F;AAC/F;AACA;AACA;AACA,uEAAuE;;;AAGvE;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE;AACF;;;AAGA;AACA;AACA,WAAW,SAAS;AACpB,aAAa,OAAO;AACpB;;AAEA;AACA;AACA;AACA;;AAEA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,OAAO;AACpB;;;AAGA;AACA;AACA;AACA;;AAEA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa;AACb;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,oHAAoH,GAAG;AACvH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH,mBAAmB,EAAE;AACrB,oDAAoD;AACpD;AACA;AACA,gBAAgB,WAAW;AAC3B,aAAa,yBAAyB,OAAO;AAC7C,GAAG;AACH,eAAe,GAAG,MAAM,GAAG;AAC3B,aAAa;AACb,oCAAoC;AACpC;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,UAAU,IAAI;AACd,YAAY;AACZ;;AAEA;AACA;AACA,WAAW,aAAa;AACxB,WAAW,aAAa;AACxB,WAAW,kBAAkB;AAC7B;AACA,aAAa;AACb;;;AAGA;AACA;;AAEA,iBAAiB,QAAQ;AACzB;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,YAAY;AACzB;AACA,eAAe,IAAI;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA,+CAA+C;AAC/C,KAAK;AACL,6BAA6B;;AAE7B;AACA,wCAAwC;AACxC,KAAK;AACL;AACA;;;AAGA,0BAA0B,4EAA4E;;AAEtG,8CAA8C;AAC9C,+IAA+I;;AAE/I;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACniC0D;AACgC;AAC3D;AACP;AACsB;AACvC,IAAI,8BAAM;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAI,+CAAuB,gBAAgB,mBAAgB;AAC3D;AACA;AACA,cAAc,kDAAwB;;AAEtC,sBAAsB,sBAAmB,QAAQ,sCAAQ;AACzD,eAAe,iCAAI;AACnB;AACA,GAAG;AACH,CAAC;AACD,MAAqC,GAAG,SAAM;AAC9C,+CAAuB;AACR,6HAAU,CAAC,8BAAM;AAChC;AACA,CAAC,EAAE,+CAAuB,CAAC,E;;;;;;;;;;;;;;;;;;;;;;;;;;AChC+B;AACgC;AAC3D;AACP;AACqB;AACC;AACe;AACnB;AAC1C,4BAA4B;;AAErB,IAAI,qBAAM;AACjB;AACA,4CAA4C,2CAAO,gBAAgB,0CAAM;AACzE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,wEAAwE;AACxE;AACA;AACA,KAAK;;AAEL,2EAA2E;AAC3E;AACA;AACA,KAAK;;AAEL;AACA,mBAAmB;;AAEnB;AACA,qBAAqB;;AAErB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,+DAA+D;AAC/D;AACA;AACA,KAAK;;AAEL,iEAAiE;AACjE;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAI,6BAAc,gBAAgB,mBAAgB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,kDAAwB;;AAEtC,cAAc,mCAAQ;AACtB;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK,UAAU,KAAqC,EAAE,EAEjD;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK,UAAU,KAAqC,EAAE,EAEjD;AACL;;AAEA,sBAAsB,sBAAmB,QAAQ,sCAAQ;AACzD,eAAe,iCAAI,sCAAsC,qCAAU;AACnE;AACA;AACA;AACA;AACA,KAAK;AACL;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","file":"3a5eb708880afc7da9187d37fe99af650d9ba1f9-630c5fc62b58904e13b5.js","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nimport ListContext from '../List/ListContext';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      minWidth: 56,\n      color: theme.palette.action.active,\n      flexShrink: 0,\n      display: 'inline-flex'\n    },\n\n    /* Styles applied to the root element when the parent `ListItem` uses `alignItems=\"flex-start\"`. */\n    alignItemsFlexStart: {\n      marginTop: 8\n    }\n  };\n};\n/**\n * A simple wrapper to apply `List` styles to an `Icon` or `SvgIcon`.\n */\n\nvar ListItemIcon = /*#__PURE__*/React.forwardRef(function ListItemIcon(props, ref) {\n  var classes = props.classes,\n      className = props.className,\n      other = _objectWithoutProperties(props, [\"classes\", \"className\"]);\n\n  var context = React.useContext(ListContext);\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, className, context.alignItems === 'flex-start' && classes.alignItemsFlexStart),\n    ref: ref\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiListItemIcon'\n})(ListItemIcon);","import { CardMedia, CardMediaProps, createStyles, makeStyles, Theme } from \"@material-ui/core\";\nimport React from \"react\";\n\nconst useStyles = makeStyles((theme: Theme) => createStyles({\n    media: {\n        height: 0,\n        paddingTop: '75%', // 4:3\n    }\n}));\n\n/*\n        [theme.breakpoints.down('lg')]: {\n            paddingTop: '56.72%', // 16:9\n        },\n        [theme.breakpoints.down('xs')]: {\n            paddingTop: '18%',\n        },\n        [theme.breakpoints.down('md')]: { // 6:3\n            paddingTop: '50%',\n        }\n*/\n\nexport default function CardMediaWithSkeleton(props: CardMediaProps) {\n    const { image, src, className, ...others } = props;\n    const classes = useStyles();\n    const hasImage = !!image || !!src;\n    return hasImage ?\n        <CardMedia className={className || classes.media} {...others} image={image} src={src} />\n        : <></>;\n}","import React from \"react\";\nimport { JDDevice } from \"../../jacdac-ts/src/jdom/device\";\nimport useDeviceSpecification from \"../jacdac/useDeviceSpecification\";\nimport useDeviceImage from \"./devices/useDeviceImage\";\nimport CardMediaWithSkeleton from \"./ui/CardMediaWithSkeleton\";\n\nexport default function DeviceCardMedia(props: { device: JDDevice }) {\n    const { device } = props;\n    const specification = useDeviceSpecification(device)\n    const imageUrl = useDeviceImage(specification)\n\n    return <CardMediaWithSkeleton\n        image={imageUrl}\n        title={specification?.name}\n    />\n}","import { ControlReg, SRV_CTRL } from \"../../jacdac-ts/src/jdom/constants\";\nimport { CardHeader, Chip, Typography } from \"@material-ui/core\";\n// tslint:disable-next-line: no-submodule-imports\nimport { Link } from 'gatsby-theme-material-ui';\nimport { JDDevice } from \"../../jacdac-ts/src/jdom/device\";\nimport React from \"react\";\nimport { useRegisterIntValue, useRegisterStringValue } from \"../jacdac/useRegisterValue\";\nimport DeviceActions from \"./DeviceActions\";\nimport DeviceName from \"./DeviceName\";\nimport DeviceCardMedia from \"./DeviceCardMedia\"\nimport useDeviceSpecification from \"../jacdac/useDeviceSpecification\";\nimport { identifierToUrlPath } from \"../../jacdac-ts/src/jdom/spec\";\nimport DeviceAvatar from \"./devices/DeviceAvatar\";\n\nfunction DeviceFirmwareVersionChip(props: { device: JDDevice }) {\n    const { device } = props;\n    const firmwareVersionRegister = device?.service(0)?.register(ControlReg.FirmwareVersion)\n    const firmwareVersion = useRegisterStringValue(firmwareVersionRegister);\n\n    return (firmwareVersion && <Chip size=\"small\" label={firmwareVersion} />) || <></>\n}\n\nfunction DeviceTemperatureChip(props: { device: JDDevice }) {\n    const { device } = props;\n    const tempRegister = device?.service(0)?.register(ControlReg.McuTemperature)\n    const temperature = useRegisterIntValue(tempRegister);\n    return (temperature !== undefined && <Chip size=\"small\" label={`${temperature}°`} />) || <></>\n}\n\nexport default function DeviceCardHeader(props: {\n    device: JDDevice,\n    showAvatar?: boolean,\n    showDeviceId?: boolean,\n    showFirmware?: boolean,\n    showTemperature?: boolean,\n    showMedia?: boolean\n}) {\n    const { device, showFirmware, showTemperature, showMedia, showDeviceId, showAvatar } = props;\n    const specification = useDeviceSpecification(device);\n\n    return <>\n        {showMedia && <DeviceCardMedia device={device} />}\n        <CardHeader\n            avatar={showAvatar && <DeviceAvatar device={device} />}\n            action={<DeviceActions device={device} showReset={true} />}\n            title={<Link color=\"textPrimary\" to={`/devices/${identifierToUrlPath(specification?.id) || \"\"}`}>\n                <DeviceName device={device} />\n            </Link>}\n            subheader={<>\n                <Typography variant=\"caption\" gutterBottom>\n                    {[specification?.name, showDeviceId && device.deviceId].filter(s => !!s).join(', ')}\n                </Typography>\n                {showFirmware && <DeviceFirmwareVersionChip device={device} />}\n                {showTemperature && <DeviceTemperatureChip device={device} />}\n            </>}\n        />\n    </>\n}","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M9 16h2V8H9v8zm3-14C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm1-4h2V8h-2v8z\"\n}), 'PauseCircleOutline');\n\nexports.default = _default;","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport { withStyles } from '@material-ui/core/styles';\nimport { Typography } from '@material-ui/core';\nimport clsx from 'clsx';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      fontWeight: theme.typography.fontWeightMedium,\n      marginTop: -2\n    }\n  };\n};\nvar AlertTitle = /*#__PURE__*/React.forwardRef(function AlertTitle(props, ref) {\n  var classes = props.classes,\n      className = props.className,\n      other = _objectWithoutProperties(props, [\"classes\", \"className\"]);\n\n  return /*#__PURE__*/React.createElement(Typography, _extends({\n    gutterBottom: true,\n    component: \"div\",\n    ref: ref,\n    className: clsx(classes.root, className)\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiAlertTitle'\n})(AlertTitle);","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z\"\n}), 'Info');\n\nexports.default = _default;","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nimport { chainPropTypes } from '@material-ui/utils';\nexport var styles = {\n  /* Styles applied to the root element. */\n  root: {\n    display: 'block',\n    backgroundSize: 'cover',\n    backgroundRepeat: 'no-repeat',\n    backgroundPosition: 'center'\n  },\n\n  /* Styles applied to the root element if `component=\"video, audio, picture, iframe, or img\"`. */\n  media: {\n    width: '100%'\n  },\n\n  /* Styles applied to the root element if `component=\"picture or img\"`. */\n  img: {\n    // ⚠️ object-fit is not supported by IE 11.\n    objectFit: 'cover'\n  }\n};\nvar MEDIA_COMPONENTS = ['video', 'audio', 'picture', 'iframe', 'img'];\nvar CardMedia = /*#__PURE__*/React.forwardRef(function CardMedia(props, ref) {\n  var children = props.children,\n      classes = props.classes,\n      className = props.className,\n      _props$component = props.component,\n      Component = _props$component === void 0 ? 'div' : _props$component,\n      image = props.image,\n      src = props.src,\n      style = props.style,\n      other = _objectWithoutProperties(props, [\"children\", \"classes\", \"className\", \"component\", \"image\", \"src\", \"style\"]);\n\n  var isMediaComponent = MEDIA_COMPONENTS.indexOf(Component) !== -1;\n  var composedStyle = !isMediaComponent && image ? _extends({\n    backgroundImage: \"url(\\\"\".concat(image, \"\\\")\")\n  }, style) : style;\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    className: clsx(classes.root, className, isMediaComponent && classes.media, \"picture img\".indexOf(Component) !== -1 && classes.img),\n    ref: ref,\n    style: composedStyle,\n    src: isMediaComponent ? image || src : undefined\n  }, other), children);\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiCardMedia'\n})(CardMedia);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nimport Typography from '../Typography';\nimport ListContext from '../List/ListContext';\nexport var styles = {\n  /* Styles applied to the root element. */\n  root: {\n    flex: '1 1 auto',\n    minWidth: 0,\n    marginTop: 4,\n    marginBottom: 4\n  },\n\n  /* Styles applied to the `Typography` components if primary and secondary are set. */\n  multiline: {\n    marginTop: 6,\n    marginBottom: 6\n  },\n\n  /* Styles applied to the `Typography` components if dense. */\n  dense: {},\n\n  /* Styles applied to the root element if `inset={true}`. */\n  inset: {\n    paddingLeft: 56\n  },\n\n  /* Styles applied to the primary `Typography` component. */\n  primary: {},\n\n  /* Styles applied to the secondary `Typography` component. */\n  secondary: {}\n};\nvar ListItemText = /*#__PURE__*/React.forwardRef(function ListItemText(props, ref) {\n  var children = props.children,\n      classes = props.classes,\n      className = props.className,\n      _props$disableTypogra = props.disableTypography,\n      disableTypography = _props$disableTypogra === void 0 ? false : _props$disableTypogra,\n      _props$inset = props.inset,\n      inset = _props$inset === void 0 ? false : _props$inset,\n      primaryProp = props.primary,\n      primaryTypographyProps = props.primaryTypographyProps,\n      secondaryProp = props.secondary,\n      secondaryTypographyProps = props.secondaryTypographyProps,\n      other = _objectWithoutProperties(props, [\"children\", \"classes\", \"className\", \"disableTypography\", \"inset\", \"primary\", \"primaryTypographyProps\", \"secondary\", \"secondaryTypographyProps\"]);\n\n  var _React$useContext = React.useContext(ListContext),\n      dense = _React$useContext.dense;\n\n  var primary = primaryProp != null ? primaryProp : children;\n\n  if (primary != null && primary.type !== Typography && !disableTypography) {\n    primary = /*#__PURE__*/React.createElement(Typography, _extends({\n      variant: dense ? 'body2' : 'body1',\n      className: classes.primary,\n      component: \"span\",\n      display: \"block\"\n    }, primaryTypographyProps), primary);\n  }\n\n  var secondary = secondaryProp;\n\n  if (secondary != null && secondary.type !== Typography && !disableTypography) {\n    secondary = /*#__PURE__*/React.createElement(Typography, _extends({\n      variant: \"body2\",\n      className: classes.secondary,\n      color: \"textSecondary\",\n      display: \"block\"\n    }, secondaryTypographyProps), secondary);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, className, dense && classes.dense, inset && classes.inset, primary && secondary && classes.multiline),\n    ref: ref\n  }, other), primary, secondary);\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiListItemText'\n})(ListItemText);","import { GridSize } from \"@material-ui/core\"\nimport React, { useContext } from \"react\"\nimport AppContext, { DrawerType } from \"./AppContext\"\n\nexport interface GridBreakpoints {\n    xs?: GridSize,\n    md?: GridSize,\n    sm?: GridSize,\n    lg?: GridSize,\n    xl?: GridSize\n}\n\nexport default function useGridBreakpoints(itemCount?: number): GridBreakpoints {\n    const { drawerType } = useContext(AppContext)\n\n    if (itemCount !== undefined) {\n        switch (itemCount) {\n            case 1:\n            case 2: return { xs: 12, sm: 6, md: 6, lg: 6, xl: 6 }\n            case 3: return { xs: 12, sm: 6, md: 6, lg: 4, xl: 4 }\n        }\n    }\n\n    if (drawerType != DrawerType.None)\n        return { xs: 12, md: 6, sm: 6, lg: 6, xl: 4 }\n    else return {\n        xs: 12,\n        sm: 6,\n        md: 4,\n        lg: 4,\n        xl: 3\n    }\n}","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 14.5v-9l6 4.5-6 4.5z\"\n}), 'PlayCircleFilled');\n\nexports.default = _default;","import { JDService } from \"./service\";\nimport { JDDevice } from \"./device\";\nimport { JDBus } from \"./bus\";\nimport { JDClient } from \"./client\";\n\nexport class JDServiceClient extends JDClient {\n\n    constructor(public readonly service: JDService) {\n        super()\n    }\n\n    protected get device(): JDDevice {\n        return this.service.device\n    }\n\n    protected get bus(): JDBus {\n        return this.device.bus\n    }\n\n    toString(): string {\n        return `client of ${this.service}`\n    }\n}\n","/* eslint-disable @typescript-eslint/triple-slash-reference */\n/// <reference path=\"jdtest.d.ts\" />\n\nexport type Commands =\n    | \"reset\"\n    | \"changes\"\n    | \"ask\"\n    | \"say\"\n    | \"check\"\n    | \"increases\"\n    | \"decreases\"\n    | \"increasesBy\"\n    | \"decreasesBy\"\n    | \"rangesFromUpTo\"\n    | \"rangesFromDownTo\"\n\nexport const testCommandFunctions: jdtest.TestFunctionDescription[] = [\n    { id: \"reset\", args: [], prompt: \"sends a reset command to the module\" },\n    { id: \"changes\", args: [\"register\"], prompt: `did the value of {1} change?` },\n    { id: \"say\", args: [], prompt: undefined },\n    { id: \"ask\", args: [], prompt: undefined },\n    { id: \"check\", args: [\"boolean\"], prompt: `does the condition {1} hold?` },\n    {\n        id: \"increases\",\n        args: [\"register\"],\n        prompt: `did the value of register {1} increase?`,\n    },\n    {\n        id: \"decreases\",\n        args: [\"register\"],\n        prompt: `did the value of register {1} decrease?`,\n    },\n    {\n        id: \"increasesBy\",\n        args: [\"register\", \"number\"],\n        prompt: `did the value of register {1} increase by {2}?`,\n    },\n    {\n        id: \"decreasesBy\",\n        args: [\"register\", \"number\"],\n        prompt: `did the value of register {1} decrease by {2}?`,\n    },\n    {\n        id: \"rangesFromUpTo\",\n        args: [\"register\", \"number\", \"number\"],\n        prompt: `register {1} should range in value from {2} up to {3}`,\n    },\n    {\n        id: \"rangesFromDownTo\",\n        args: [\"register\", \"number\", \"number\"],\n        prompt: `register {1} should range in value from {2} down to {3}`,\n    },\n]\n\nexport const testExpressionFunctions: jdtest.TestFunctionDescription[] = [\n    { id: \"start\", args: [\"any\"], prompt: undefined },\n]\n","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _construct(Parent, args, Class) {\n  if (_isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) _setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nfunction _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}\n\nfunction _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !_isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return _setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = o[Symbol.iterator]();\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n/* eslint-disable unicorn/prefer-spread -- IIRC, Babel's performance\n  with this not good */\n\n\nvar hasOwnProp = Object.prototype.hasOwnProperty;\n/**\n* @typedef {null|boolean|number|string|PlainObject|GenericArray} JSONObject\n*/\n\n/**\n * Copies array and then pushes item into it.\n * @param {GenericArray} arr Array to copy and into which to push\n * @param {any} item Array item to add (to end)\n * @returns {GenericArray} Copy of the original array\n */\n\nfunction push(arr, item) {\n  arr = arr.slice();\n  arr.push(item);\n  return arr;\n}\n/**\n * Copies array and then unshifts item into it.\n * @param {any} item Array item to add (to beginning)\n * @param {GenericArray} arr Array to copy and into which to unshift\n * @returns {GenericArray} Copy of the original array\n */\n\n\nfunction unshift(item, arr) {\n  arr = arr.slice();\n  arr.unshift(item);\n  return arr;\n}\n/**\n * Caught when JSONPath is used without `new` but rethrown if with `new`\n * @extends Error\n */\n\n\nvar NewError = /*#__PURE__*/function (_Error) {\n  _inherits(NewError, _Error);\n\n  var _super = _createSuper(NewError);\n  /**\n   * @param {any} value The evaluated scalar value\n   */\n\n\n  function NewError(value) {\n    var _this;\n\n    _classCallCheck(this, NewError);\n\n    _this = _super.call(this, 'JSONPath should not be called with \"new\" (it prevents return ' + 'of (unwrapped) scalar values)');\n    _this.avoidNew = true;\n    _this.value = value;\n    _this.name = 'NewError';\n    return _this;\n  }\n\n  return NewError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n/**\n* @typedef {PlainObject} ReturnObject\n* @property {string} path\n* @property {JSONObject} value\n* @property {PlainObject|GenericArray} parent\n* @property {string} parentProperty\n*/\n\n/**\n* @callback JSONPathCallback\n* @param {string|PlainObject} preferredOutput\n* @param {\"value\"|\"property\"} type\n* @param {ReturnObject} fullRetObj\n* @returns {void}\n*/\n\n/**\n* @callback OtherTypeCallback\n* @param {JSONObject} val\n* @param {string} path\n* @param {PlainObject|GenericArray} parent\n* @param {string} parentPropName\n* @returns {boolean}\n*/\n\n/* eslint-disable max-len -- Can make multiline type after https://github.com/syavorsky/comment-parser/issues/109 */\n\n/**\n * @typedef {PlainObject} JSONPathOptions\n * @property {JSON} json\n * @property {string|string[]} path\n * @property {\"value\"|\"path\"|\"pointer\"|\"parent\"|\"parentProperty\"|\"all\"} [resultType=\"value\"]\n * @property {boolean} [flatten=false]\n * @property {boolean} [wrap=true]\n * @property {PlainObject} [sandbox={}]\n * @property {boolean} [preventEval=false]\n * @property {PlainObject|GenericArray|null} [parent=null]\n * @property {string|null} [parentProperty=null]\n * @property {JSONPathCallback} [callback]\n * @property {OtherTypeCallback} [otherTypeCallback] Defaults to\n *   function which throws on encountering `@other`\n * @property {boolean} [autostart=true]\n */\n\n/* eslint-enable max-len -- Can make multiline type after https://github.com/syavorsky/comment-parser/issues/109 */\n\n/**\n * @param {string|JSONPathOptions} opts If a string, will be treated as `expr`\n * @param {string} [expr] JSON path to evaluate\n * @param {JSON} [obj] JSON object to evaluate against\n * @param {JSONPathCallback} [callback] Passed 3 arguments: 1) desired payload\n *     per `resultType`, 2) `\"value\"|\"property\"`, 3) Full returned object with\n *     all payloads\n * @param {OtherTypeCallback} [otherTypeCallback] If `@other()` is at the end\n *   of one's query, this will be invoked with the value of the item, its\n *   path, its parent, and its parent's property name, and it should return\n *   a boolean indicating whether the supplied value belongs to the \"other\"\n *   type or not (or it may handle transformations and return `false`).\n * @returns {JSONPath}\n * @class\n */\n\n\nfunction JSONPath(opts, expr, obj, callback, otherTypeCallback) {\n  // eslint-disable-next-line no-restricted-syntax\n  if (!(this instanceof JSONPath)) {\n    try {\n      return new JSONPath(opts, expr, obj, callback, otherTypeCallback);\n    } catch (e) {\n      if (!e.avoidNew) {\n        throw e;\n      }\n\n      return e.value;\n    }\n  }\n\n  if (typeof opts === 'string') {\n    otherTypeCallback = callback;\n    callback = obj;\n    obj = expr;\n    expr = opts;\n    opts = null;\n  }\n\n  var optObj = opts && _typeof(opts) === 'object';\n  opts = opts || {};\n  this.json = opts.json || obj;\n  this.path = opts.path || expr;\n  this.resultType = opts.resultType || 'value';\n  this.flatten = opts.flatten || false;\n  this.wrap = hasOwnProp.call(opts, 'wrap') ? opts.wrap : true;\n  this.sandbox = opts.sandbox || {};\n  this.preventEval = opts.preventEval || false;\n  this.parent = opts.parent || null;\n  this.parentProperty = opts.parentProperty || null;\n  this.callback = opts.callback || callback || null;\n\n  this.otherTypeCallback = opts.otherTypeCallback || otherTypeCallback || function () {\n    throw new TypeError('You must supply an otherTypeCallback callback option ' + 'with the @other() operator.');\n  };\n\n  if (opts.autostart !== false) {\n    var args = {\n      path: optObj ? opts.path : expr\n    };\n\n    if (!optObj) {\n      args.json = obj;\n    } else if ('json' in opts) {\n      args.json = opts.json;\n    }\n\n    var ret = this.evaluate(args);\n\n    if (!ret || _typeof(ret) !== 'object') {\n      throw new NewError(ret);\n    }\n\n    return ret;\n  }\n} // PUBLIC METHODS\n\n\nJSONPath.prototype.evaluate = function (expr, json, callback, otherTypeCallback) {\n  var _this2 = this;\n\n  var currParent = this.parent,\n      currParentProperty = this.parentProperty;\n  var flatten = this.flatten,\n      wrap = this.wrap;\n  this.currResultType = this.resultType;\n  this.currPreventEval = this.preventEval;\n  this.currSandbox = this.sandbox;\n  callback = callback || this.callback;\n  this.currOtherTypeCallback = otherTypeCallback || this.otherTypeCallback;\n  json = json || this.json;\n  expr = expr || this.path;\n\n  if (expr && _typeof(expr) === 'object' && !Array.isArray(expr)) {\n    if (!expr.path && expr.path !== '') {\n      throw new TypeError('You must supply a \"path\" property when providing an object ' + 'argument to JSONPath.evaluate().');\n    }\n\n    if (!hasOwnProp.call(expr, 'json')) {\n      throw new TypeError('You must supply a \"json\" property when providing an object ' + 'argument to JSONPath.evaluate().');\n    }\n\n    var _expr = expr;\n    json = _expr.json;\n    flatten = hasOwnProp.call(expr, 'flatten') ? expr.flatten : flatten;\n    this.currResultType = hasOwnProp.call(expr, 'resultType') ? expr.resultType : this.currResultType;\n    this.currSandbox = hasOwnProp.call(expr, 'sandbox') ? expr.sandbox : this.currSandbox;\n    wrap = hasOwnProp.call(expr, 'wrap') ? expr.wrap : wrap;\n    this.currPreventEval = hasOwnProp.call(expr, 'preventEval') ? expr.preventEval : this.currPreventEval;\n    callback = hasOwnProp.call(expr, 'callback') ? expr.callback : callback;\n    this.currOtherTypeCallback = hasOwnProp.call(expr, 'otherTypeCallback') ? expr.otherTypeCallback : this.currOtherTypeCallback;\n    currParent = hasOwnProp.call(expr, 'parent') ? expr.parent : currParent;\n    currParentProperty = hasOwnProp.call(expr, 'parentProperty') ? expr.parentProperty : currParentProperty;\n    expr = expr.path;\n  }\n\n  currParent = currParent || null;\n  currParentProperty = currParentProperty || null;\n\n  if (Array.isArray(expr)) {\n    expr = JSONPath.toPathString(expr);\n  }\n\n  if (!expr && expr !== '' || !json) {\n    return undefined;\n  }\n\n  var exprList = JSONPath.toPathArray(expr);\n\n  if (exprList[0] === '$' && exprList.length > 1) {\n    exprList.shift();\n  }\n\n  this._hasParentSelector = null;\n\n  var result = this._trace(exprList, json, ['$'], currParent, currParentProperty, callback).filter(function (ea) {\n    return ea && !ea.isParentSelector;\n  });\n\n  if (!result.length) {\n    return wrap ? [] : undefined;\n  }\n\n  if (!wrap && result.length === 1 && !result[0].hasArrExpr) {\n    return this._getPreferredOutput(result[0]);\n  }\n\n  return result.reduce(function (rslt, ea) {\n    var valOrPath = _this2._getPreferredOutput(ea);\n\n    if (flatten && Array.isArray(valOrPath)) {\n      rslt = rslt.concat(valOrPath);\n    } else {\n      rslt.push(valOrPath);\n    }\n\n    return rslt;\n  }, []);\n}; // PRIVATE METHODS\n\n\nJSONPath.prototype._getPreferredOutput = function (ea) {\n  var resultType = this.currResultType;\n\n  switch (resultType) {\n    case 'all':\n      {\n        var path = Array.isArray(ea.path) ? ea.path : JSONPath.toPathArray(ea.path);\n        ea.pointer = JSONPath.toPointer(path);\n        ea.path = typeof ea.path === 'string' ? ea.path : JSONPath.toPathString(ea.path);\n        return ea;\n      }\n\n    case 'value':\n    case 'parent':\n    case 'parentProperty':\n      return ea[resultType];\n\n    case 'path':\n      return JSONPath.toPathString(ea[resultType]);\n\n    case 'pointer':\n      return JSONPath.toPointer(ea.path);\n\n    default:\n      throw new TypeError('Unknown result type');\n  }\n};\n\nJSONPath.prototype._handleCallback = function (fullRetObj, callback, type) {\n  if (callback) {\n    var preferredOutput = this._getPreferredOutput(fullRetObj);\n\n    fullRetObj.path = typeof fullRetObj.path === 'string' ? fullRetObj.path : JSONPath.toPathString(fullRetObj.path); // eslint-disable-next-line node/callback-return\n\n    callback(preferredOutput, type, fullRetObj);\n  }\n};\n/**\n *\n * @param {string} expr\n * @param {JSONObject} val\n * @param {string} path\n * @param {PlainObject|GenericArray} parent\n * @param {string} parentPropName\n * @param {JSONPathCallback} callback\n * @param {boolean} hasArrExpr\n * @param {boolean} literalPriority\n * @returns {ReturnObject|ReturnObject[]}\n */\n\n\nJSONPath.prototype._trace = function (expr, val, path, parent, parentPropName, callback, hasArrExpr, literalPriority) {\n  var _this3 = this; // No expr to follow? return path and value as the result of\n  //  this trace branch\n\n\n  var retObj;\n\n  if (!expr.length) {\n    retObj = {\n      path: path,\n      value: val,\n      parent: parent,\n      parentProperty: parentPropName,\n      hasArrExpr: hasArrExpr\n    };\n\n    this._handleCallback(retObj, callback, 'value');\n\n    return retObj;\n  }\n\n  var loc = expr[0],\n      x = expr.slice(1); // We need to gather the return value of recursive trace calls in order to\n  // do the parent sel computation.\n\n  var ret = [];\n  /**\n   *\n   * @param {ReturnObject|ReturnObject[]} elems\n   * @returns {void}\n   */\n\n  function addRet(elems) {\n    if (Array.isArray(elems)) {\n      // This was causing excessive stack size in Node (with or\n      //  without Babel) against our performance test:\n      //  `ret.push(...elems);`\n      elems.forEach(function (t) {\n        ret.push(t);\n      });\n    } else {\n      ret.push(elems);\n    }\n  }\n\n  if ((typeof loc !== 'string' || literalPriority) && val && hasOwnProp.call(val, loc)) {\n    // simple case--directly follow property\n    addRet(this._trace(x, val[loc], push(path, loc), val, loc, callback, hasArrExpr));\n  } else if (loc === '*') {\n    // all child properties\n    this._walk(loc, x, val, path, parent, parentPropName, callback, function (m, l, _x, v, p, par, pr, cb) {\n      addRet(_this3._trace(unshift(m, _x), v, p, par, pr, cb, true, true));\n    });\n  } else if (loc === '..') {\n    // all descendent parent properties\n    // Check remaining expression with val's immediate children\n    addRet(this._trace(x, val, path, parent, parentPropName, callback, hasArrExpr));\n\n    this._walk(loc, x, val, path, parent, parentPropName, callback, function (m, l, _x, v, p, par, pr, cb) {\n      // We don't join m and x here because we only want parents,\n      //   not scalar values\n      if (_typeof(v[m]) === 'object') {\n        // Keep going with recursive descent on val's\n        //   object children\n        addRet(_this3._trace(unshift(l, _x), v[m], push(p, m), v, m, cb, true));\n      }\n    }); // The parent sel computation is handled in the frame above using the\n    // ancestor object of val\n\n  } else if (loc === '^') {\n    // This is not a final endpoint, so we do not invoke the callback here\n    this._hasParentSelector = true;\n    return {\n      path: path.slice(0, -1),\n      expr: x,\n      isParentSelector: true\n    };\n  } else if (loc === '~') {\n    // property name\n    retObj = {\n      path: push(path, loc),\n      value: parentPropName,\n      parent: parent,\n      parentProperty: null\n    };\n\n    this._handleCallback(retObj, callback, 'property');\n\n    return retObj;\n  } else if (loc === '$') {\n    // root only\n    addRet(this._trace(x, val, path, null, null, callback, hasArrExpr));\n  } else if (/^(\\x2D?[0-9]*):(\\x2D?[0-9]*):?([0-9]*)$/.test(loc)) {\n    // [start:end:step]  Python slice syntax\n    addRet(this._slice(loc, x, val, path, parent, parentPropName, callback));\n  } else if (loc.indexOf('?(') === 0) {\n    // [?(expr)] (filtering)\n    if (this.currPreventEval) {\n      throw new Error('Eval [?(expr)] prevented in JSONPath expression.');\n    }\n\n    this._walk(loc, x, val, path, parent, parentPropName, callback, function (m, l, _x, v, p, par, pr, cb) {\n      if (_this3._eval(l.replace(/^\\?\\(((?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?)\\)$/, '$1'), v[m], m, p, par, pr)) {\n        addRet(_this3._trace(unshift(m, _x), v, p, par, pr, cb, true));\n      }\n    });\n  } else if (loc[0] === '(') {\n    // [(expr)] (dynamic property/index)\n    if (this.currPreventEval) {\n      throw new Error('Eval [(expr)] prevented in JSONPath expression.');\n    } // As this will resolve to a property name (but we don't know it\n    //  yet), property and parent information is relative to the\n    //  parent of the property to which this expression will resolve\n\n\n    addRet(this._trace(unshift(this._eval(loc, val, path[path.length - 1], path.slice(0, -1), parent, parentPropName), x), val, path, parent, parentPropName, callback, hasArrExpr));\n  } else if (loc[0] === '@') {\n    // value type: @boolean(), etc.\n    var addType = false;\n    var valueType = loc.slice(1, -2);\n\n    switch (valueType) {\n      case 'scalar':\n        if (!val || !['object', 'function'].includes(_typeof(val))) {\n          addType = true;\n        }\n\n        break;\n\n      case 'boolean':\n      case 'string':\n      case 'undefined':\n      case 'function':\n        // eslint-disable-next-line valid-typeof\n        if (_typeof(val) === valueType) {\n          addType = true;\n        }\n\n        break;\n\n      case 'integer':\n        if (Number.isFinite(val) && !(val % 1)) {\n          addType = true;\n        }\n\n        break;\n\n      case 'number':\n        if (Number.isFinite(val)) {\n          addType = true;\n        }\n\n        break;\n\n      case 'nonFinite':\n        if (typeof val === 'number' && !Number.isFinite(val)) {\n          addType = true;\n        }\n\n        break;\n\n      case 'object':\n        // eslint-disable-next-line valid-typeof\n        if (val && _typeof(val) === valueType) {\n          addType = true;\n        }\n\n        break;\n\n      case 'array':\n        if (Array.isArray(val)) {\n          addType = true;\n        }\n\n        break;\n\n      case 'other':\n        addType = this.currOtherTypeCallback(val, path, parent, parentPropName);\n        break;\n\n      case 'null':\n        if (val === null) {\n          addType = true;\n        }\n\n        break;\n\n      /* istanbul ignore next */\n\n      default:\n        throw new TypeError('Unknown value type ' + valueType);\n    }\n\n    if (addType) {\n      retObj = {\n        path: path,\n        value: val,\n        parent: parent,\n        parentProperty: parentPropName\n      };\n\n      this._handleCallback(retObj, callback, 'value');\n\n      return retObj;\n    } // `-escaped property\n\n  } else if (loc[0] === '`' && val && hasOwnProp.call(val, loc.slice(1))) {\n    var locProp = loc.slice(1);\n    addRet(this._trace(x, val[locProp], push(path, locProp), val, locProp, callback, hasArrExpr, true));\n  } else if (loc.includes(',')) {\n    // [name1,name2,...]\n    var parts = loc.split(',');\n\n    var _iterator = _createForOfIteratorHelper(parts),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var part = _step.value;\n        addRet(this._trace(unshift(part, x), val, path, parent, parentPropName, callback, true));\n      } // simple case--directly follow property\n\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n  } else if (!literalPriority && val && hasOwnProp.call(val, loc)) {\n    addRet(this._trace(x, val[loc], push(path, loc), val, loc, callback, hasArrExpr, true));\n  } // We check the resulting values for parent selections. For parent\n  // selections we discard the value object and continue the trace with the\n  // current val object\n\n\n  if (this._hasParentSelector) {\n    for (var t = 0; t < ret.length; t++) {\n      var rett = ret[t];\n\n      if (rett && rett.isParentSelector) {\n        var tmp = this._trace(rett.expr, val, rett.path, parent, parentPropName, callback, hasArrExpr);\n\n        if (Array.isArray(tmp)) {\n          ret[t] = tmp[0];\n          var tl = tmp.length;\n\n          for (var tt = 1; tt < tl; tt++) {\n            t++;\n            ret.splice(t, 0, tmp[tt]);\n          }\n        } else {\n          ret[t] = tmp;\n        }\n      }\n    }\n  }\n\n  return ret;\n};\n\nJSONPath.prototype._walk = function (loc, expr, val, path, parent, parentPropName, callback, f) {\n  if (Array.isArray(val)) {\n    var n = val.length;\n\n    for (var i = 0; i < n; i++) {\n      f(i, loc, expr, val, path, parent, parentPropName, callback);\n    }\n  } else if (val && _typeof(val) === 'object') {\n    Object.keys(val).forEach(function (m) {\n      f(m, loc, expr, val, path, parent, parentPropName, callback);\n    });\n  }\n};\n\nJSONPath.prototype._slice = function (loc, expr, val, path, parent, parentPropName, callback) {\n  if (!Array.isArray(val)) {\n    return undefined;\n  }\n\n  var len = val.length,\n      parts = loc.split(':'),\n      step = parts[2] && Number.parseInt(parts[2]) || 1;\n  var start = parts[0] && Number.parseInt(parts[0]) || 0,\n      end = parts[1] && Number.parseInt(parts[1]) || len;\n  start = start < 0 ? Math.max(0, start + len) : Math.min(len, start);\n  end = end < 0 ? Math.max(0, end + len) : Math.min(len, end);\n  var ret = [];\n\n  for (var i = start; i < end; i += step) {\n    var tmp = this._trace(unshift(i, expr), val, path, parent, parentPropName, callback, true); // Should only be possible to be an array here since first part of\n    //   ``unshift(i, expr)` passed in above would not be empty, nor `~`,\n    //     nor begin with `@` (as could return objects)\n    // This was causing excessive stack size in Node (with or\n    //  without Babel) against our performance test: `ret.push(...tmp);`\n\n\n    tmp.forEach(function (t) {\n      ret.push(t);\n    });\n  }\n\n  return ret;\n};\n\nJSONPath.prototype._eval = function (code, _v, _vname, path, parent, parentPropName) {\n  if (code.includes('@parentProperty')) {\n    this.currSandbox._$_parentProperty = parentPropName;\n    code = code.replace(/@parentProperty/g, '_$_parentProperty');\n  }\n\n  if (code.includes('@parent')) {\n    this.currSandbox._$_parent = parent;\n    code = code.replace(/@parent/g, '_$_parent');\n  }\n\n  if (code.includes('@property')) {\n    this.currSandbox._$_property = _vname;\n    code = code.replace(/@property/g, '_$_property');\n  }\n\n  if (code.includes('@path')) {\n    this.currSandbox._$_path = JSONPath.toPathString(path.concat([_vname]));\n    code = code.replace(/@path/g, '_$_path');\n  }\n\n  if (code.includes('@root')) {\n    this.currSandbox._$_root = this.json;\n    code = code.replace(/@root/g, '_$_root');\n  }\n\n  if (/@([\\t-\\r \\)\\.\\[\\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF])/.test(code)) {\n    this.currSandbox._$_v = _v;\n    code = code.replace(/@([\\t-\\r \\)\\.\\[\\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF])/g, '_$_v$1');\n  }\n\n  try {\n    return this.vm.runInNewContext(code, this.currSandbox);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n    throw new Error('jsonPath: ' + e.message + ': ' + code);\n  }\n}; // PUBLIC CLASS PROPERTIES AND METHODS\n// Could store the cache object itself\n\n\nJSONPath.cache = {};\n/**\n * @param {string[]} pathArr Array to convert\n * @returns {string} The path string\n */\n\nJSONPath.toPathString = function (pathArr) {\n  var x = pathArr,\n      n = x.length;\n  var p = '$';\n\n  for (var i = 1; i < n; i++) {\n    if (!/^(~|\\^|@(?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?\\(\\))$/.test(x[i])) {\n      p += /^[\\*0-9]+$/.test(x[i]) ? '[' + x[i] + ']' : \"['\" + x[i] + \"']\";\n    }\n  }\n\n  return p;\n};\n/**\n * @param {string} pointer JSON Path\n * @returns {string} JSON Pointer\n */\n\n\nJSONPath.toPointer = function (pointer) {\n  var x = pointer,\n      n = x.length;\n  var p = '';\n\n  for (var i = 1; i < n; i++) {\n    if (!/^(~|\\^|@(?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?\\(\\))$/.test(x[i])) {\n      p += '/' + x[i].toString().replace(/~/g, '~0').replace(/\\//g, '~1');\n    }\n  }\n\n  return p;\n};\n/**\n * @param {string} expr Expression to convert\n * @returns {string[]}\n */\n\n\nJSONPath.toPathArray = function (expr) {\n  var cache = JSONPath.cache;\n\n  if (cache[expr]) {\n    return cache[expr].concat();\n  }\n\n  var subx = [];\n  var normalized = expr // Properties\n  .replace(/@(?:null|boolean|number|string|integer|undefined|nonFinite|scalar|array|object|function|other)\\(\\)/g, ';$&;') // Parenthetical evaluations (filtering and otherwise), directly\n  //   within brackets or single quotes\n  .replace(/['\\[](\\??\\((?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?\\))['\\]]/g, function ($0, $1) {\n    return '[#' + (subx.push($1) - 1) + ']';\n  }) // Escape periods and tildes within properties\n  .replace(/\\['((?:(?!['\\]])[\\s\\S])*)'\\]/g, function ($0, prop) {\n    return \"['\" + prop.replace(/\\./g, '%@%').replace(/~/g, '%%@@%%') + \"']\";\n  }) // Properties operator\n  .replace(/~/g, ';~;') // Split by property boundaries\n  .replace(/'?\\.'?(?!(?:(?!\\[)[\\s\\S])*\\])|\\['?/g, ';') // Reinsert periods within properties\n  .replace(/%@%/g, '.') // Reinsert tildes within properties\n  .replace(/%%@@%%/g, '~') // Parent\n  .replace(/(?:;)?(\\^+)(?:;)?/g, function ($0, ups) {\n    return ';' + ups.split('').join(';') + ';';\n  }) // Descendents\n  .replace(/;;;|;;/g, ';..;') // Remove trailing\n  .replace(/;$|'?\\]|'$/g, '');\n  var exprList = normalized.split(';').map(function (exp) {\n    var match = exp.match(/#([0-9]+)/);\n    return !match || !match[1] ? exp : subx[match[1]];\n  });\n  cache[expr] = exprList;\n  return cache[expr];\n};\n/**\n* @callback ConditionCallback\n* @param {any} item\n* @returns {boolean}\n*/\n\n/**\n * Copy items out of one array into another.\n * @param {GenericArray} source Array with items to copy\n * @param {GenericArray} target Array to which to copy\n * @param {ConditionCallback} conditionCb Callback passed the current item;\n *     will move item if evaluates to `true`\n * @returns {void}\n */\n\n\nvar moveToAnotherArray = function moveToAnotherArray(source, target, conditionCb) {\n  var il = source.length;\n\n  for (var i = 0; i < il; i++) {\n    var item = source[i];\n\n    if (conditionCb(item)) {\n      target.push(source.splice(i--, 1)[0]);\n    }\n  }\n};\n\nJSONPath.prototype.vm = {\n  /**\n   * @param {string} expr Expression to evaluate\n   * @param {PlainObject} context Object whose items will be added\n   *   to evaluation\n   * @returns {any} Result of evaluated code\n   */\n  runInNewContext: function runInNewContext(expr, context) {\n    var keys = Object.keys(context);\n    var funcs = [];\n    moveToAnotherArray(keys, funcs, function (key) {\n      return typeof context[key] === 'function';\n    });\n    var values = keys.map(function (vr, i) {\n      return context[vr];\n    });\n    var funcString = funcs.reduce(function (s, func) {\n      var fString = context[func].toString();\n\n      if (!/function/.test(fString)) {\n        fString = 'function ' + fString;\n      }\n\n      return 'var ' + func + '=' + fString + ';' + s;\n    }, '');\n    expr = funcString + expr; // Mitigate http://perfectionkills.com/global-eval-what-are-the-options/#new_function\n\n    if (!/([\"'])use strict\\1/.test(expr) && !keys.includes('arguments')) {\n      expr = 'var arguments = undefined;' + expr;\n    } // Remove last semi so `return` will be inserted before\n    //  the previous one instead, allowing for the return\n    //  of a bare ending expression\n\n\n    expr = expr.replace(/;[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]*$/, ''); // Insert `return`\n\n    var lastStatementEnd = expr.lastIndexOf(';');\n    var code = lastStatementEnd > -1 ? expr.slice(0, lastStatementEnd + 1) + ' return ' + expr.slice(lastStatementEnd + 1) : ' return ' + expr; // eslint-disable-next-line no-new-func\n\n    return _construct(Function, _toConsumableArray(keys).concat([code])).apply(void 0, _toConsumableArray(values));\n  }\n};\nexport { JSONPath };","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nexport var styles = {\n  /* Styles applied to the root element. */\n  root: {\n    position: 'absolute',\n    right: 16,\n    top: '50%',\n    transform: 'translateY(-50%)'\n  }\n};\n/**\n * Must be used as the last child of ListItem to function properly.\n */\n\nvar ListItemSecondaryAction = /*#__PURE__*/React.forwardRef(function ListItemSecondaryAction(props, ref) {\n  var classes = props.classes,\n      className = props.className,\n      other = _objectWithoutProperties(props, [\"classes\", \"className\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, className),\n    ref: ref\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nListItemSecondaryAction.muiName = 'ListItemSecondaryAction';\nexport default withStyles(styles, {\n  name: 'MuiListItemSecondaryAction'\n})(ListItemSecondaryAction);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport capitalize from '../utils/capitalize';\nimport withStyles from '../styles/withStyles';\nimport { darken, lighten } from '../styles/colorManipulator';\nimport useTheme from '../styles/useTheme';\nvar TRANSITION_DURATION = 4; // seconds\n\nexport var styles = function styles(theme) {\n  var getColor = function getColor(color) {\n    return theme.palette.type === 'light' ? lighten(color, 0.62) : darken(color, 0.5);\n  };\n\n  var backgroundPrimary = getColor(theme.palette.primary.main);\n  var backgroundSecondary = getColor(theme.palette.secondary.main);\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      position: 'relative',\n      overflow: 'hidden',\n      height: 4,\n      '@media print': {\n        colorAdjust: 'exact'\n      }\n    },\n\n    /* Styles applied to the root and bar2 element if `color=\"primary\"`; bar2 if `variant=\"buffer\"`. */\n    colorPrimary: {\n      backgroundColor: backgroundPrimary\n    },\n\n    /* Styles applied to the root and bar2 elements if `color=\"secondary\"`; bar2 if `variant=\"buffer\"`. */\n    colorSecondary: {\n      backgroundColor: backgroundSecondary\n    },\n\n    /* Styles applied to the root element if `variant=\"determinate\"`. */\n    determinate: {},\n\n    /* Styles applied to the root element if `variant=\"indeterminate\"`. */\n    indeterminate: {},\n\n    /* Styles applied to the root element if `variant=\"buffer\"`. */\n    buffer: {\n      backgroundColor: 'transparent'\n    },\n\n    /* Styles applied to the root element if `variant=\"query\"`. */\n    query: {\n      transform: 'rotate(180deg)'\n    },\n\n    /* Styles applied to the additional bar element if `variant=\"buffer\"`. */\n    dashed: {\n      position: 'absolute',\n      marginTop: 0,\n      height: '100%',\n      width: '100%',\n      animation: '$buffer 3s infinite linear'\n    },\n\n    /* Styles applied to the additional bar element if `variant=\"buffer\"` and `color=\"primary\"`. */\n    dashedColorPrimary: {\n      backgroundImage: \"radial-gradient(\".concat(backgroundPrimary, \" 0%, \").concat(backgroundPrimary, \" 16%, transparent 42%)\"),\n      backgroundSize: '10px 10px',\n      backgroundPosition: '0 -23px'\n    },\n\n    /* Styles applied to the additional bar element if `variant=\"buffer\"` and `color=\"secondary\"`. */\n    dashedColorSecondary: {\n      backgroundImage: \"radial-gradient(\".concat(backgroundSecondary, \" 0%, \").concat(backgroundSecondary, \" 16%, transparent 42%)\"),\n      backgroundSize: '10px 10px',\n      backgroundPosition: '0 -23px'\n    },\n\n    /* Styles applied to the layered bar1 and bar2 elements. */\n    bar: {\n      width: '100%',\n      position: 'absolute',\n      left: 0,\n      bottom: 0,\n      top: 0,\n      transition: 'transform 0.2s linear',\n      transformOrigin: 'left'\n    },\n\n    /* Styles applied to the bar elements if `color=\"primary\"`; bar2 if `variant` not \"buffer\". */\n    barColorPrimary: {\n      backgroundColor: theme.palette.primary.main\n    },\n\n    /* Styles applied to the bar elements if `color=\"secondary\"`; bar2 if `variant` not \"buffer\". */\n    barColorSecondary: {\n      backgroundColor: theme.palette.secondary.main\n    },\n\n    /* Styles applied to the bar1 element if `variant=\"indeterminate or query\"`. */\n    bar1Indeterminate: {\n      width: 'auto',\n      animation: '$indeterminate1 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite'\n    },\n\n    /* Styles applied to the bar1 element if `variant=\"determinate\"`. */\n    bar1Determinate: {\n      transition: \"transform .\".concat(TRANSITION_DURATION, \"s linear\")\n    },\n\n    /* Styles applied to the bar1 element if `variant=\"buffer\"`. */\n    bar1Buffer: {\n      zIndex: 1,\n      transition: \"transform .\".concat(TRANSITION_DURATION, \"s linear\")\n    },\n\n    /* Styles applied to the bar2 element if `variant=\"indeterminate or query\"`. */\n    bar2Indeterminate: {\n      width: 'auto',\n      animation: '$indeterminate2 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite'\n    },\n\n    /* Styles applied to the bar2 element if `variant=\"buffer\"`. */\n    bar2Buffer: {\n      transition: \"transform .\".concat(TRANSITION_DURATION, \"s linear\")\n    },\n    // Legends:\n    // || represents the viewport\n    // -  represents a light background\n    // x  represents a dark background\n    '@keyframes indeterminate1': {\n      //  |-----|---x-||-----||-----|\n      '0%': {\n        left: '-35%',\n        right: '100%'\n      },\n      //  |-----|-----||-----||xxxx-|\n      '60%': {\n        left: '100%',\n        right: '-90%'\n      },\n      '100%': {\n        left: '100%',\n        right: '-90%'\n      }\n    },\n    '@keyframes indeterminate2': {\n      //  |xxxxx|xxxxx||-----||-----|\n      '0%': {\n        left: '-200%',\n        right: '100%'\n      },\n      //  |-----|-----||-----||-x----|\n      '60%': {\n        left: '107%',\n        right: '-8%'\n      },\n      '100%': {\n        left: '107%',\n        right: '-8%'\n      }\n    },\n    '@keyframes buffer': {\n      '0%': {\n        opacity: 1,\n        backgroundPosition: '0 -23px'\n      },\n      '50%': {\n        opacity: 0,\n        backgroundPosition: '0 -23px'\n      },\n      '100%': {\n        opacity: 1,\n        backgroundPosition: '-200px -23px'\n      }\n    }\n  };\n};\n/**\n * ## ARIA\n *\n * If the progress bar is describing the loading progress of a particular region of a page,\n * you should use `aria-describedby` to point to the progress bar, and set the `aria-busy`\n * attribute to `true` on that region until it has finished loading.\n */\n\nvar LinearProgress = /*#__PURE__*/React.forwardRef(function LinearProgress(props, ref) {\n  var classes = props.classes,\n      className = props.className,\n      _props$color = props.color,\n      color = _props$color === void 0 ? 'primary' : _props$color,\n      value = props.value,\n      valueBuffer = props.valueBuffer,\n      _props$variant = props.variant,\n      variant = _props$variant === void 0 ? 'indeterminate' : _props$variant,\n      other = _objectWithoutProperties(props, [\"classes\", \"className\", \"color\", \"value\", \"valueBuffer\", \"variant\"]);\n\n  var theme = useTheme();\n  var rootProps = {};\n  var inlineStyles = {\n    bar1: {},\n    bar2: {}\n  };\n\n  if (variant === 'determinate' || variant === 'buffer') {\n    if (value !== undefined) {\n      rootProps['aria-valuenow'] = Math.round(value);\n      rootProps['aria-valuemin'] = 0;\n      rootProps['aria-valuemax'] = 100;\n      var transform = value - 100;\n\n      if (theme.direction === 'rtl') {\n        transform = -transform;\n      }\n\n      inlineStyles.bar1.transform = \"translateX(\".concat(transform, \"%)\");\n    } else if (process.env.NODE_ENV !== 'production') {\n      console.error('Material-UI: You need to provide a value prop ' + 'when using the determinate or buffer variant of LinearProgress .');\n    }\n  }\n\n  if (variant === 'buffer') {\n    if (valueBuffer !== undefined) {\n      var _transform = (valueBuffer || 0) - 100;\n\n      if (theme.direction === 'rtl') {\n        _transform = -_transform;\n      }\n\n      inlineStyles.bar2.transform = \"translateX(\".concat(_transform, \"%)\");\n    } else if (process.env.NODE_ENV !== 'production') {\n      console.error('Material-UI: You need to provide a valueBuffer prop ' + 'when using the buffer variant of LinearProgress.');\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, classes[\"color\".concat(capitalize(color))], className, {\n      'determinate': classes.determinate,\n      'indeterminate': classes.indeterminate,\n      'buffer': classes.buffer,\n      'query': classes.query\n    }[variant]),\n    role: \"progressbar\"\n  }, rootProps, {\n    ref: ref\n  }, other), variant === 'buffer' ? /*#__PURE__*/React.createElement(\"div\", {\n    className: clsx(classes.dashed, classes[\"dashedColor\".concat(capitalize(color))])\n  }) : null, /*#__PURE__*/React.createElement(\"div\", {\n    className: clsx(classes.bar, classes[\"barColor\".concat(capitalize(color))], (variant === 'indeterminate' || variant === 'query') && classes.bar1Indeterminate, {\n      'determinate': classes.bar1Determinate,\n      'buffer': classes.bar1Buffer\n    }[variant]),\n    style: inlineStyles.bar1\n  }), variant === 'determinate' ? null : /*#__PURE__*/React.createElement(\"div\", {\n    className: clsx(classes.bar, (variant === 'indeterminate' || variant === 'query') && classes.bar2Indeterminate, variant === 'buffer' ? [classes[\"color\".concat(capitalize(color))], classes.bar2Buffer] : classes[\"barColor\".concat(capitalize(color))]),\n    style: inlineStyles.bar2\n  }));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiLinearProgress'\n})(LinearProgress);","// eslint-disable-next-line @typescript-eslint/triple-slash-reference\n/// <reference path=\"../../jacdac-spec/spectool/jdspec.d.ts\" />\n// eslint-disable-next-line @typescript-eslint/triple-slash-reference\n/// <reference path=\"../../jacdac-spec/spectool/jdtest.d.ts\" />\n\nimport serviceTestData from \"../../jacdac-spec/dist/services-tests.json\"\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst _serviceTests: jdtest.ServiceTestSpec[] = serviceTestData as any\n\n/**\n * Given a service specification, see if it has a test\n * @param spec\n */\n export function serviceTestFromServiceSpec(\n    spec: jdspec.ServiceSpec\n): jdtest.ServiceTestSpec {\n    return (\n        !!spec &&\n        _serviceTests.find(\n            test => test.serviceClassIdentifier === spec.classIdentifier\n        )\n    )\n}\n","import {\n    Commands,\n    testCommandFunctions,\n} from \"../../jacdac-spec/spectool/jdtestfuns\"\nimport { CHANGE } from \"../jdom/constants\"\nimport { JDEventSource } from \"../jdom/eventsource\"\nimport { JDService } from \"../jdom/service\"\nimport { JDRegister } from \"../jdom/register\"\nimport { JDServiceClient } from \"../jdom/serviceclient\"\nimport { JSONPath } from \"jsonpath-plus\"\nimport { serviceSpecificationFromClassIdentifier } from \"../jdom/spec\"\n\nexport enum JDCommandStatus {\n    NotReady,\n    Active,\n    RequiresUserInput,\n    Passed,\n    Failed,\n}\n\nexport enum JDTestStatus {\n    NotReady,\n    ReadyToRun,\n    Active,\n    Passed,\n    Failed,\n}\n\nfunction commandStatusToTestStatus(status: JDCommandStatus) {\n    switch (status) {\n        case JDCommandStatus.Active:\n            return JDTestStatus.Active\n        case JDCommandStatus.Passed:\n            return JDTestStatus.Passed\n        case JDCommandStatus.Failed:\n            return JDTestStatus.Failed\n        case JDCommandStatus.NotReady:\n            return JDTestStatus.NotReady\n        case JDCommandStatus.RequiresUserInput:\n            return JDTestStatus.Active\n    }\n}\n\nfunction cmdToTestFunction(cmd: jdtest.CommandSpec) {\n    const id = (<jsep.Identifier>cmd.call.callee).name\n    return testCommandFunctions.find(t => t.id == id)\n}\n\nfunction unparse(e: jsep.Expression): string {\n    switch (e.type) {\n        case \"CallExpression\": {\n            const caller = e as jsep.CallExpression\n            return `${unparse(caller.callee)}(${caller.arguments\n                .map(unparse)\n                .join(\", \")})`\n        }\n        case \"BinaryExpression\":\n        case \"LogicalExpression\": {\n            const be = e as any\n            return `(${unparse(be.left)} ${be.operator} ${unparse(be.right)})`\n        }\n        case \"UnaryExpression\": {\n            const ue = e as jsep.UnaryExpression\n            return `${ue.operator}${unparse(ue.argument)}`\n        }\n        case \"Identifier\": {\n            return (e as jsep.Identifier).name\n        }\n        case \"Literal\": {\n            return (e as jsep.Literal).raw\n        }\n        default:\n            return \"TODO\"\n    }\n}\n\ntype SMap<T> = { [v: string]: T }\ntype StartMap = { e: jsep.Expression; v: any }[]\n\nclass JDExprEvaluator {\n    private exprStack: any[] = []\n\n    constructor(private env: SMap<any>, private start: StartMap) {}\n\n    private tos() {\n        return this.exprStack[this.exprStack.length - 1]\n    }\n\n    public eval(e: jsep.Expression) {\n        this.exprStack = []\n        this.visitExpression(e)\n        return this.exprStack.pop()\n    }\n\n    private visitExpression(e: jsep.Expression) {\n        switch (e.type) {\n            case \"CallExpression\": {\n                const caller = <jsep.CallExpression>e\n                const callee = <jsep.Identifier>caller.callee\n                switch (callee.name) {\n                    case \"start\":\n                        this.exprStack.push(\n                            this.start.find(r => r.e === caller).v\n                        )\n                        return\n                    default: // ERROR\n                }\n                break\n            }\n\n            case \"BinaryExpression\": {\n                const be = <jsep.BinaryExpression>e\n                this.visitExpression(be.left)\n                this.visitExpression(be.right)\n                const right = this.exprStack.pop()\n                const left = this.exprStack.pop()\n                switch (be.operator) {\n                    case \"+\":\n                        this.exprStack.push(left + right)\n                        return\n                    case \"-\":\n                        this.exprStack.push(left - right)\n                        return\n                    case \"/\":\n                        this.exprStack.push(left / right)\n                        return\n                    case \"*\":\n                        this.exprStack.push(left * right)\n                        return\n                    case \"%\":\n                        this.exprStack.push(left % right)\n                        return\n                    case \">>\":\n                        this.exprStack.push(left >> right)\n                        return\n                    case \">>>\":\n                        this.exprStack.push(left >>> right)\n                        return\n                    case \"<<\":\n                        this.exprStack.push(left << right)\n                        return\n                    case \"|\":\n                        this.exprStack.push(left | right)\n                        return\n                    case \"&\":\n                        this.exprStack.push(left & right)\n                        return\n                    case \"^\":\n                        this.exprStack.push(left ^ right)\n                        return\n                    case \"==\":\n                        this.exprStack.push(left == right)\n                        return\n                    case \"!=\":\n                        this.exprStack.push(left != right)\n                        return\n                    case \"===\":\n                        this.exprStack.push(left === right)\n                        return\n                    case \"!==\":\n                        this.exprStack.push(left !== right)\n                        return\n\n                    case \"<\":\n                        this.exprStack.push(left < right)\n                        return\n                    case \">\":\n                        this.exprStack.push(left > right)\n                        return\n                    case \"<=\":\n                        this.exprStack.push(left <= right)\n                        return\n                    case \">=\":\n                        this.exprStack.push(left >= right)\n                        return\n                }\n                break\n            }\n\n            case \"UnaryExpression\":\n            case \"LogicalExpression\": {\n                const le = <jsep.LogicalExpression>e\n                this.visitExpression(le.left)\n                switch (le.operator) {\n                    case \"||\":\n                        if (this.tos()) return\n                        else this.visitExpression(le.right)\n                        break\n                    case \"&&\":\n                        if (!this.tos()) return\n                        else this.visitExpression(le.right)\n                        break\n                    default:\n                }\n                break\n            }\n\n            case \"Identifier\": {\n                const id = <jsep.Identifier>e\n                this.exprStack.push(this.env[id.name])\n                break\n            }\n            case \"Literal\": {\n                const lit = <jsep.Literal>e\n                this.exprStack.push(lit.value)\n                break\n            }\n            default:\n        }\n    }\n}\n\nclass JDCommandEvaluator {\n    private _prompt = \"\"\n    private _progress = 0.0\n    private _status = JDCommandStatus.Active\n    private _startExpressions: StartMap = []\n\n    constructor(\n        private readonly env: SMap<any>,\n        private readonly command: jdtest.CommandSpec\n    ) {}\n\n    public get prompt() {\n        return this._prompt\n    }\n    public get status() {\n        return this._status\n    }\n    public get progress() {\n        return this._progress\n    }\n\n    public start() {\n        this._startExpressions = []\n        const testFun = cmdToTestFunction(this.command)\n        const args = this.command.call.arguments\n        let startExprs: jsep.Expression[] = []\n        switch (testFun.id as Commands) {\n            case \"check\": {\n                startExprs = (<jsep.CallExpression[]>JSONPath({\n                    path: \"$..*[?(@.type=='CallExpression')]\",\n                    json: args,\n                }))\n                    .filter(ce => (<jsep.Identifier>ce.callee).name === \"start\")\n                    .map(ce => ce.arguments[0])\n                break\n            }\n            case \"changes\":\n            case \"increases\":\n            case \"decreases\": {\n                startExprs.push(args[0])\n                break\n            }\n            case \"increasesBy\":\n            case \"decreasesBy\": {\n                startExprs.push(args[0])\n                startExprs.push(args[1])\n                break\n            }\n            case \"rangesFromUpTo\":\n            case \"rangesFromDownTo\": {\n                startExprs.push(args[1])\n                startExprs.push(args[2])\n                break\n            }\n        }\n        // evaluate the start expressions and store the results\n        startExprs.forEach(child => {\n            if (this._startExpressions.findIndex(r => r.e === child) < 0) {\n                const exprEval = new JDExprEvaluator(this.env, [])\n                this._startExpressions.push({\n                    e: child,\n                    v: exprEval.eval(child),\n                })\n            }\n        })\n        this.createPrompt()\n    }\n\n    private createPrompt() {\n        const testFun = cmdToTestFunction(this.command)\n        const replace = this.command.call.arguments.map((a, i) => [\n            `{${i + 1}}`,\n            unparse(a),\n        ])\n        this._prompt =\n            testFun.id === \"ask\" || testFun.id === \"say\"\n                ? this.command.prompt.slice(0)\n                : testFun.prompt.slice(0)\n        replace.forEach(p => (this._prompt = this._prompt.replace(p[0], p[1])))\n    }\n\n    public evaluate() {\n        const testFun = cmdToTestFunction(this.command)\n        this._status = JDCommandStatus.Active\n        this._progress = undefined\n        switch (testFun.id as Commands) {\n            case \"say\":\n            case \"ask\": {\n                this._status =\n                    testFun.id === \"say\"\n                        ? JDCommandStatus.Passed\n                        : JDCommandStatus.RequiresUserInput\n                break\n            }\n            case \"check\": {\n                const expr = new JDExprEvaluator(\n                    this.env,\n                    this._startExpressions\n                )\n                const ev = expr.eval(this.command.call.arguments[0])\n                this._status = ev\n                    ? JDCommandStatus.Passed\n                    : JDCommandStatus.Active\n                break\n            }\n            case \"changes\":\n            case \"increases\":\n            case \"decreases\": {\n                const reg = this.command.call.arguments[0]\n                const regSaved = this._startExpressions.find(r => r.e === reg)\n                const regValue = this.env[unparse(reg)]\n                const [status, progress] =\n                    (testFun.id === \"changes\" && regValue !== regSaved.v) ||\n                    (testFun.id === \"increases\" && regValue > regSaved.v) ||\n                    (testFun.id === \"decreases\" && regValue < regSaved.v)\n                        ? [JDCommandStatus.Passed, 1.0]\n                        : [JDCommandStatus.Active, 0.0]\n                this._status = status\n                this._progress = progress\n                regSaved.v = regValue\n                break\n            }\n            case \"increasesBy\":\n            case \"decreasesBy\": {\n                const reg = this.command.call.arguments[0]\n                const regSaved = this._startExpressions.find(r => r.e === reg)\n                const amt = this.command.call.arguments[1]\n                const amtSaved = this._startExpressions.find(r => r.e === amt)\n                const regValue = this.env[unparse(reg)]\n                if (testFun.id === \"increasesBy\") {\n                    if (regValue === regSaved.v + amtSaved.v) {\n                        this._status = JDCommandStatus.Passed\n                        this._progress = 1.0\n                    } else if (\n                        regValue >= regSaved.v &&\n                        regValue < regSaved.v.v + amtSaved.v\n                    ) {\n                        this._status = JDCommandStatus.Active\n                        this._progress = (regValue - regSaved.v) / amtSaved.v\n                    } else {\n                        this._status = JDCommandStatus.Active\n                    }\n                } else {\n                    if (regValue === regSaved.v - amtSaved.v) {\n                        this._status = JDCommandStatus.Passed\n                        this._progress = 1.0\n                    } else if (\n                        regValue <= regSaved.v &&\n                        regValue > regSaved.v.v - amtSaved.v\n                    ) {\n                        this._status = JDCommandStatus.Active\n                        this._progress = (regSaved.v - regValue) / amtSaved.v\n                    } else {\n                        this._status = JDCommandStatus.Active\n                    }\n                }\n                break\n            }\n            case \"rangesFromUpTo\":\n            case \"rangesFromDownTo\": {\n                break\n            }\n        }\n    }\n}\n\nexport interface JDCommandOutput {\n    message: string\n    progress: number\n}\n\nexport class JDCommandRunner extends JDEventSource {\n    private _status = JDCommandStatus.NotReady\n    private _output: JDCommandOutput = { message: \"\", progress: 0.0 }\n    private readonly _timeOut = 5000 // timeout\n    private _timeLeft = 5000\n    private _commmandEvaluator: JDCommandEvaluator = null\n\n    constructor(\n        private readonly testRunner: JDTestRunner,\n        private readonly env: SMap<any>,\n        private readonly command: jdtest.CommandSpec\n    ) {\n        super()\n    }\n\n    get status() {\n        return this._status\n    }\n\n    set status(s: JDCommandStatus) {\n        if (s != this._status) {\n            this._status = s\n            this.emit(CHANGE)\n        }\n    }\n\n    get indeterminate(): boolean {\n        return (\n            this.status !== JDCommandStatus.Failed &&\n            this.status !== JDCommandStatus.Passed\n        )\n    }\n\n\n    get output() {\n        return this._output\n    }\n\n    set output(value: JDCommandOutput) {\n        if (\n            !this._output ||\n            this._output.message !== value.message ||\n            this._output.progress !== value.progress\n        ) {\n            this._output = value\n            this.emit(CHANGE)\n        }\n    }\n\n    reset() {\n        this.output = { message: \"\", progress: 0.0 }\n        this.status = JDCommandStatus.NotReady\n        this._commmandEvaluator = null\n    }\n\n    start() {\n        this.status = JDCommandStatus.Active\n        this._commmandEvaluator = new JDCommandEvaluator(this.env, this.command)\n        this._commmandEvaluator.start()\n        this.envChange(false)\n        this.envChange(true)\n    }\n\n    envChange(finish = true) {\n        if (this._commmandEvaluator) {\n            this._commmandEvaluator.evaluate()\n            const newOutput: JDCommandOutput = {\n                message: this._commmandEvaluator.prompt,\n                progress: this._commmandEvaluator.progress,\n            }\n            this.output = newOutput\n            if (finish) this.finish(this._commmandEvaluator.status)\n        }\n    }\n\n    cancel() {\n        this.finish(JDCommandStatus.Failed)\n    }\n\n    finish(s: JDCommandStatus) {\n        if (\n            (s === JDCommandStatus.Failed || s === JDCommandStatus.Passed) &&\n            (this.status === JDCommandStatus.Active ||\n                this.status === JDCommandStatus.RequiresUserInput)\n        ) {\n            this.status = s\n            this.testRunner.finishCommand()\n        }\n    }\n}\n\nexport class JDTestRunner extends JDEventSource {\n    private _status = JDTestStatus.NotReady\n    private _description: string\n    private _commandIndex: number\n    public readonly commands: JDCommandRunner[]\n\n    constructor(\n        private readonly serviceTestRunner: JDServiceTestRunner,\n        private readonly env: SMap<any>,\n        private readonly testSpec: jdtest.TestSpec\n    ) {\n        super()\n        this.commands = testSpec.commands.map(\n            c => new JDCommandRunner(this, this.env, c)\n        )\n        this._description = testSpec.description\n    }\n\n    reset() {\n        this.status = JDTestStatus.NotReady\n        this.commands.forEach(t => t.reset())\n    }\n\n    ready() {\n        if (this.status === JDTestStatus.NotReady)\n           this.status = JDTestStatus.ReadyToRun\n    }\n\n    public start() {\n        if (this.status === JDTestStatus.ReadyToRun) {\n            this.status = JDTestStatus.Active\n            this.commandIndex = 0\n        }\n    }\n\n    cancel() {\n        this.finish(JDTestStatus.Failed)\n    }\n\n    get status() {\n        return this._status\n    }\n\n    set status(s: JDTestStatus) {\n        if (s != this._status) {\n            this._status = s\n            this.emit(CHANGE)\n        }\n    }\n\n    get indeterminate(): boolean {\n        return (\n            this.status !== JDTestStatus.Failed &&\n            this.status !== JDTestStatus.Passed\n        )\n    }\n\n    get description() {\n        return this._description\n    }\n\n    finish(s: JDTestStatus) {\n        if (this.status === JDTestStatus.Active) {\n            this.status = s\n            this.serviceTestRunner.finishTest()\n        }\n    }\n\n    private get commandIndex() {\n        return this._commandIndex\n    }\n\n    private set commandIndex(index: number) {\n        if (this._commandIndex !== index) {\n            this._commandIndex = index\n            this.currentCommand?.start()\n            this.emit(CHANGE)\n        }\n    }\n\n    public envChange() {\n        this.currentCommand?.envChange()\n    }\n\n    public finishCommand() {\n        if (this.commandIndex === this.commands.length - 1)\n            this.finish(commandStatusToTestStatus(this.currentCommand.status))\n        // (this.commandIndex < this.commands.length)\n        else this.commandIndex++\n    }\n\n    get currentCommand() {\n        return this.commands[this._commandIndex]\n    }\n}\n\nexport class JDServiceTestRunner extends JDServiceClient {\n    private _testIndex = -1\n    private registers: SMap<JDRegister> = {}\n    private environment: SMap<number> = {}\n    public readonly tests: JDTestRunner[]\n\n    constructor(\n        public readonly testSpec: jdtest.ServiceTestSpec,\n        service: JDService\n    ) {\n        super(service)\n        this.tests = this.testSpec.tests.map(\n            t => new JDTestRunner(this, this.environment, t)\n        )\n        const serviceSpec = serviceSpecificationFromClassIdentifier(\n            service.serviceClass\n        )\n        this.testSpec.tests.forEach(t => {\n            t.registers.forEach(regName => {\n                if (!this.registers[regName]) {\n                    const pkt = serviceSpec.packets.find(\n                        pkt => pkt.name === regName\n                    )\n                    const register = service.register(pkt.identifier)\n                    this.registers[regName] = register\n                    this.environment[regName] = 0\n                    this.mount(register.subscribe(CHANGE, () => {\n                        this.environment[regName] = register.intValue\n                        this.currentTest?.envChange()\n                    }))\n                }\n            })\n        })\n        this.start()\n    }\n\n    private get testIndex() {\n        return this._testIndex\n    }\n\n    private set testIndex(index: number) {\n        if (this._testIndex !== index) {\n            this._testIndex = index\n            this.emit(CHANGE)\n\n            this.currentTest?.ready()\n        }\n    }\n\n    public start() {\n        this.tests.forEach(t => t.reset())\n        this.testIndex = 0\n    }\n\n    public finishTest() {\n        if (this.testIndex < this.tests.length) {\n            this.testIndex++\n        }\n    }\n\n    get currentTest() {\n        return this.tests[this._testIndex]\n    }\n}\n","import React, { useContext } from \"react\"\nimport useGridBreakpoints from \"./useGridBreakpoints\"\nimport JacdacContext, { JacdacContextProps } from \"../jacdac/Context\"\nimport useChange from \"../jacdac/useChange\"\nimport {\n    Grid,\n    Card,\n    CardActions,\n    Button\n} from \"@material-ui/core\"\nimport DeviceCardHeader from \"./DeviceCardHeader\"\nimport Alert from \"./ui/Alert\"\nimport { JDService } from \"../../jacdac-ts/src/jdom/service\"\n\nexport default function SelectService(props: {\n    serviceClass: number\n    onSelect: (service: JDService) => void\n}) {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const { serviceClass, onSelect } = props\n    const services = useChange(bus, n => n.services({ serviceClass }), [])\n    const gridBreakpoints = useGridBreakpoints()\n\n    const handleSelect = (service: JDService) => () => onSelect(service)\n\n    return (\n        <>\n            {!!services.length && (\n                <Grid container spacing={2}>\n                    {services.map(service => (\n                        <Grid key={service.id} item {...gridBreakpoints}>\n                            <Card>\n                                <DeviceCardHeader device={service.device} />\n                                <CardActions>\n                                    <Button\n                                        variant=\"contained\"\n                                        color=\"primary\"\n                                        onClick={handleSelect(service)}\n                                    >\n                                        Select\n                                    </Button>\n                                </CardActions>\n                            </Card>\n                        </Grid>\n                    ))}\n                </Grid>\n            )}\n            {!services?.length && (\n                <Alert severity=\"info\">\n                    Not seeing your device? Try some of the following.\n                    <ul>\n                        <li>Check that your device is connected</li>\n                        <li>\n                            Use the <strong>packet console</strong> to monitor\n                            packets on the bus\n                        </li>\n                        <li>\n                            Check the class identifier in your annoucement\n                            packets\n                        </li>\n                    </ul>\n                </Alert>\n            )}\n        </>\n    )\n}","import React, { useContext, useState, useCallback } from \"react\"\nimport useServiceClient from \"./useServiceClient\"\nimport JacdacContext, { JacdacContextProps } from \"../jacdac/Context\"\nimport {\n    Grid,\n    Button,\n    List,\n    ListItemText,\n    ListItem,\n    ListItemIcon,\n    ListItemSecondaryAction,\n    Typography,\n    Card,\n    CardContent,\n    LinearProgressProps,\n    Box,\n    LinearProgress,\n    CardActions,\n    CardHeader,\n} from \"@material-ui/core\"\n// tslint:disable-next-line: no-submodule-imports\nimport { AlertTitle } from \"@material-ui/lab\"\n// tslint:disable-next-line: match-default-export-name no-submodule-imports\nimport InfoIcon from \"@material-ui/icons/Info\"\nimport Alert from \"./ui/Alert\"\nimport IconButtonWithTooltip from \"./ui/IconButtonWithTooltip\"\nimport PauseCircleOutlineIcon from '@material-ui/icons/PauseCircleOutline';\nimport {\n    addHost,\n    hostDefinitionFromServiceClass,\n} from \"../../jacdac-ts/src/hosts/hosts\"\nimport Flags from \"../../jacdac-ts/src/jdom/flags\"\nimport { JDService } from \"../../jacdac-ts/src/jdom/service\"\nimport { serviceTestFromServiceSpec } from \"../../jacdac-ts/src/jdom/test\"\nimport {\n    JDServiceTestRunner,\n    JDTestRunner,\n    JDTestStatus,\n    JDCommandRunner,\n    JDCommandStatus,\n} from \"../../jacdac-ts/src/test/testrunner\"\nimport SelectService from \"./SelectService\"\nimport ErrorIcon from '@material-ui/icons/Error';\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\nimport HourglassEmptyIcon from '@material-ui/icons/HourglassEmpty';\nimport PlayCircleFilledIcon from '@material-ui/icons/PlayCircleFilled';\nimport useChange from \"../jacdac/useChange\"\nimport DashboardDevice from \"./dashboard/DashboardDevice\"\n\nfunction Diagnostics(props: { serviceClass: number }) {\n    const { serviceClass } = props\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n\n    const hostDefinition = hostDefinitionFromServiceClass(serviceClass)\n    const handleStartSimulator = () => addHost(bus, hostDefinition.services())\n\n    if (!hostDefinition)\n        return null;\n\n    return (\n        <Alert severity=\"info\">\n            <AlertTitle>Developer zone</AlertTitle>\n            <Button variant=\"outlined\" onClick={handleStartSimulator}>\n                start simulator\n            </Button>\n        </Alert>\n    )\n}\n\nfunction TestStatusIcon(props: { test: JDTestRunner }) {\n    const { test } = props;\n    const status = useChange(test, t => t.status);\n\n    switch (status) {\n        case JDTestStatus.ReadyToRun: return <PauseCircleOutlineIcon color=\"action\" />\n        case JDTestStatus.Active: return <PlayCircleFilledIcon color=\"action\" />\n        case JDTestStatus.Failed: return <ErrorIcon color=\"error\" />\n        case JDTestStatus.Passed: return <CheckCircleIcon color=\"primary\" />\n        default: return <HourglassEmptyIcon color=\"disabled\" />\n    }\n}\n\nfunction TestListItem(props: { test: JDTestRunner }) {\n    const { test } = props;\n    const description = useChange(test, t => t.description);\n\n    return <ListItem>\n        <ListItemIcon>\n            <TestStatusIcon test={test} />\n        </ListItemIcon>\n        <ListItemText primary={description} />\n    </ListItem>\n}\n\nfunction TestList(props: { testRunner: JDServiceTestRunner }) {\n    const { testRunner } = props;\n    const { tests } = testRunner;\n\n    return <Card>\n        <CardContent>\n            <List dense={true}>\n                {tests.map((test, i) => <TestListItem key={i} test={test} />)}\n            </List>\n        </CardContent>\n    </Card>\n}\n\nfunction CommandStatusIcon(props: { command: JDCommandRunner }) {\n    const { command } = props;\n    const status = useChange(command, c => c.status);\n\n    switch (status) {\n        case JDCommandStatus.Active:\n        case JDCommandStatus.RequiresUserInput:\n            return <PlayCircleFilledIcon color=\"action\" />\n        case JDCommandStatus.Failed: return <ErrorIcon color=\"error\" />\n        case JDCommandStatus.Passed: return <CheckCircleIcon color=\"primary\" />\n        default: return <HourglassEmptyIcon color=\"disabled\" />\n    }\n}\n\nfunction CommandListItem(props: { command: JDCommandRunner }) {\n    const { command } = props;\n    const { message, progress } = useChange(command, c => c.output);\n    const status = useChange(command, c => c.status);\n    const handleAnswer = (status: JDCommandStatus) => () => command.finish(status)\n    return <ListItem>\n        <ListItemIcon>\n            <CommandStatusIcon command={command} />\n        </ListItemIcon>\n        <ListItemText primary={message} secondary={!progress ? \"\" : progress.toString()} />\n        {status === JDCommandStatus.RequiresUserInput &&\n            <ListItemSecondaryAction>\n                <Button variant=\"outlined\" onClick={handleAnswer(JDCommandStatus.Passed)}>Yes</Button>\n                <Button variant=\"outlined\" onClick={handleAnswer(JDCommandStatus.Failed)}>No</Button>\n            </ListItemSecondaryAction>\n        }\n    </ListItem>\n}\n\nfunction ActiveTest(props: { test: JDTestRunner }) {\n    const { test } = props;\n    const description = useChange(test, t => t.description);\n    const { commands } = test;\n    const status = useChange(test, t => t.status);\n    const handleRun = () => test.start();\n    const handleReset = () => { test.reset(); test.ready(); }\n    const handleCancel = () => { test.cancel() }\n    const showCommands = [JDTestStatus.Active, JDTestStatus.Failed, JDTestStatus.Passed].indexOf(status) > -1;\n\n    return <Card>\n        <CardHeader title={<Typography variant=\"h5\">{description}</Typography>} avatar={<TestStatusIcon test={test} />} />\n        <CardContent>\n            {showCommands &&\n                <List dense={false}>\n                    {commands.map((cmd, i) => <CommandListItem key={i} command={cmd} />)}\n                </List>\n            }\n        </CardContent>\n        <CardActions>\n            <Grid container spacing={1}>\n                {status === JDTestStatus.ReadyToRun &&\n                    <Grid item><Button variant=\"outlined\" onClick={handleRun}>Run</Button></Grid>\n                }\n                {status === JDTestStatus.Active &&\n                    <Grid item><Button variant=\"outlined\" onClick={handleReset}>Restart</Button></Grid>\n                }\n                {status === JDTestStatus.Active &&\n                    <Grid item><Button variant=\"outlined\" onClick={handleCancel}>Cancel</Button></Grid>\n                }\n            </Grid>\n        </CardActions>\n    </Card>\n}\n\nfunction ServiceTestRunnerSelect(props: { serviceClass: number, onSelect: (service: JDService) => void }) {\n    const { serviceClass, onSelect } = props;\n    return <>\n        <h3>Select a device to test</h3>\n        <SelectService\n            serviceClass={serviceClass}\n            onSelect={onSelect}\n        />\n    </>\n}\n\nfunction LinearProgressWithLabel(props: LinearProgressProps & { value: number, total: number }) {\n    const { value, total, ...others } = props;\n    return (\n        <Box display=\"flex\" alignItems=\"center\">\n            <Box>\n                <Typography variant=\"h5\" color=\"primary\">{`test ${value} / ${total}`}</Typography>\n            </Box>\n            <Box width=\"100%\" mr={1}>\n                <LinearProgress variant=\"determinate\" value={value / total * 100} {...others} />\n            </Box>\n        </Box>\n    );\n}\n\nfunction TestProgress(props: { testRunner: JDServiceTestRunner }) {\n    const { testRunner } = props;\n    const { tests } = testRunner;\n    const total = tests.length;\n    const executed = useChange(testRunner, t => t.tests.reduce((v, t) => v + (t.indeterminate ? 1 : 0), 0))\n    return <Card>\n        <CardContent>\n            <LinearProgressWithLabel value={executed} total={total} />\n        </CardContent>\n    </Card>\n}\n\nexport default function ServiceTest(props: {\n    serviceSpec: jdspec.ServiceSpec,\n    serviceTest?: jdtest.ServiceTestSpec,\n    showStartSimulator?: boolean\n}) {\n    const { serviceSpec, showStartSimulator, serviceTest = serviceTestFromServiceSpec(serviceSpec) } = props\n    const { classIdentifier: serviceClass } = serviceSpec\n    const [selectedService, setSelectedService] = useState<JDService>(undefined)\n    const factory = useCallback(service => new JDServiceTestRunner(serviceTest, service), [serviceTest])\n    const testRunner = useServiceClient(selectedService, factory)\n    const currentTest = useChange(testRunner, t => t?.currentTest)\n    const handleSelect = (service: JDService) => setSelectedService(service)\n    return (\n        <>\n            <h1>\n                {`${serviceSpec.name} tests`}\n                <IconButtonWithTooltip title=\"go to specifiction\" to={`/services/${serviceSpec.shortId}/`}>\n                    <InfoIcon />\n                </IconButtonWithTooltip>\n            </h1>\n            {(Flags.diagnostics || showStartSimulator) && <Diagnostics serviceClass={serviceClass} />}\n            {!testRunner && <ServiceTestRunnerSelect serviceClass={serviceClass} onSelect={handleSelect} />}\n            {testRunner && <Grid container spacing={2}>\n                <Grid item xs={12}>\n                    <TestProgress testRunner={testRunner} />\n                </Grid>\n                <Grid item xs={12}>\n                    <Grid container spacing={2} direction=\"row\">\n                        <Grid item xs={12} sm={3}>\n                            <TestList testRunner={testRunner} />\n                        </Grid>\n                        {currentTest && <Grid item xs={12} sm={6}>\n                            <ActiveTest test={currentTest} />\n                        </Grid>}\n                        {selectedService && <Grid item xs={12} sm={3}>\n                            <DashboardDevice\n                                showAvatar={true}\n                                showHeader={true}\n                                device={selectedService.device} />\n                        </Grid>}\n                    </Grid>\n                </Grid>\n            </Grid>}\n        </>\n    )\n}\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nexport var styles = {\n  /* Styles applied to the root element. */\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    padding: 8\n  },\n\n  /* Styles applied to the root element if `disableSpacing={false}`. */\n  spacing: {\n    '& > :not(:first-child)': {\n      marginLeft: 8\n    }\n  }\n};\nvar CardActions = /*#__PURE__*/React.forwardRef(function CardActions(props, ref) {\n  var _props$disableSpacing = props.disableSpacing,\n      disableSpacing = _props$disableSpacing === void 0 ? false : _props$disableSpacing,\n      classes = props.classes,\n      className = props.className,\n      other = _objectWithoutProperties(props, [\"disableSpacing\", \"classes\", \"className\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, className, !disableSpacing && classes.spacing),\n    ref: ref\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiCardActions'\n})(CardActions);","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"\n}), 'CheckCircle');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M6 2v6h.01L6 8.01 10 12l-4 4 .01.01H6V22h12v-5.99h-.01L18 16l-4-4 4-3.99-.01-.01H18V2H6zm10 14.5V20H8v-3.5l4-4 4 4zm-4-5l-4-4V4h8v3.5l-4 4z\"\n}), 'HourglassEmpty');\n\nexports.default = _default;","import { useEffect, useState } from \"react\"\nimport { JDService } from \"../../jacdac-ts/src/jdom/service\"\nimport { JDServiceClient } from \"../../jacdac-ts/src/jdom/serviceclient\"\n\nexport default function useServiceClient<T extends JDServiceClient>(service: JDService, factory: (service: JDService) => T, deps: React.DependencyList = []) {\n    const [client, setClient] = useState<T>(undefined)\n\n    useEffect(() => {\n        const c = service && factory(service)\n        setClient(c)\n        return () => c?.unmount()\n    }, [service, ...deps]) // don't use factory in cache!\n\n    return client;\n}"],"sourceRoot":""}