{"version":3,"sources":["webpack://jacdac-docs/./node_modules/@material-ui/icons/VoiceChat.js","webpack://jacdac-docs/./src/components/hooks/useAnalytics.ts","webpack://jacdac-docs/./src/components/CmdButton.tsx","webpack://jacdac-docs/./src/components/dashboard/DashboardSpeechSynthesis.tsx","webpack://jacdac-docs/./src/components/hooks/useMounted.tsx"],"names":["useAnalytics","page","track","ACK_RESET_DELAY","ERROR_RESET_DELAY","useStyles","makeStyles","theme","getBackgroundColor","palette","type","lighten","darken","createStyles","ack","color","fontWeight","typography","fontWeightMedium","backgroundColor","success","main","error","CmdButton","props","onClick","className","style","children","icon","title","disabled","disableReset","autoRun","trackName","trackProperties","ackResetDelay","others","useContext","AppContext","setAppError","setError","classes","useState","working","setWorking","setAck","undefined","mounted","useMounted","_disabled","run","delay","handleClick","ev","stopPropagation","statusIcon","modeClassName","elClassName","clsx","useEffect","DashboardSpeechSynthesis","service","enabled","register","SpeechSynthesisReg","text","setText","textId","useId","handleChange","newValue","target","value","handleSpeak","console","log","boolValue","sendSetAsync","jdpack","sendCmdAsync","SpeechSynthesisCmd","useRef","current"],"mappings":"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","file":"3887-d22c544cfe4077fa191e.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12l-4-3.2V14H6V6h8v3.2L18 6v8z\"\n}), 'VoiceChat');\n\nexports.default = _default;","/*\nrequires \"@microsoft/applicationinsights-web-basic\": \"^2.6.1\",\nimport { ApplicationInsights } from \"@microsoft/applicationinsights-web-basic\"\n\n// YOUR_INSTRUMENTATION_KEY_GOES_HERE\nconst instrumentationKey: string = undefined\nconst appInsights =\n    instrumentationKey &&\n    new ApplicationInsights({\n        instrumentationKey,\n        isStorageUseDisabled: true,\n        isCookieUseDisabled: true,\n    })\nconst page =\n    typeof window !== \"undefined\"\n        ? () =>\n              appInsights?.track({\n                  name: window.location.href,\n                  time: new Date().toUTCString(),\n                  baseType: \"PageData\",\n              })\n        : () => {}\nconst track =\n    typeof window !== \"undefined\"\n        ? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          (name: string, properties?: { [key: string]: any }) =>\n              appInsights?.track({\n                  name,\n                  time: new Date().toUTCString(),\n                  data: properties,\n                  baseType: \"EventData\",\n              })\n        : // eslint-disable-next-line @typescript-eslint/no-unused-vars\n          (name, properties) => {}\nif (typeof window !== \"undefined\") {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    ;(window as any).analytics = {\n        page,\n        track,\n    }\n}\n*/\n\nexport default function useAnalytics(): {\n    page: () => void\n    track: (name: string, properties?: { [key: string]: string | number }) => void\n} {\n    const page = () => {}\n    const track = () => {}\n    return {\n        page,\n        track,\n    }\n}\n","import { createStyles, darken, lighten, makeStyles, Theme } from \"@material-ui/core\"\nimport { Button } from \"gatsby-theme-material-ui\"\nimport React, { CSSProperties, ReactNode, useContext, useEffect, useState } from \"react\"\nimport AppContext from \"./AppContext\"\n// tslint:disable-next-line: match-default-export-name no-submodule-imports\nimport ErrorIcon from '@material-ui/icons/Error';\nimport { delay } from \"../../jacdac-ts/src/jdom/utils\";\nimport IconButtonWithTooltip from \"./ui/IconButtonWithTooltip\";\nimport useAnalytics from \"./hooks/useAnalytics\";\nimport useMounted from \"./hooks/useMounted\";\nimport clsx from \"clsx\";\n\nconst ACK_RESET_DELAY = 500\nconst ERROR_RESET_DELAY = 2000\n\nconst useStyles = makeStyles((theme: Theme) => {\n    const getBackgroundColor = theme.palette.type === 'light' ? lighten : darken;\n    return createStyles({\n        ack: {\n            color: '#fff',\n            fontWeight: theme.typography.fontWeightMedium,\n            backgroundColor: theme.palette.success.main\n        },\n        error: {\n            color: '#fff',\n            backgroundColor: getBackgroundColor(theme.palette.error.main, 0.6),\n        },\n    })\n})\n\nexport default function CmdButton(props: {\n    onClick: () => Promise<void>,\n    className?: string,\n    style?: CSSProperties,\n    title?: string,\n    children?: ReactNode,\n    icon?: JSX.Element,\n    size?: \"small\" | undefined,\n    variant?: \"outlined\" | \"contained\" | undefined,\n    disabled?: boolean,\n    disableReset?: boolean,\n    autoRun?: boolean,\n    trackName?: string,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    trackProperties?: { [key: string]: any },\n    ackResetDelay?: number\n}) {\n    const { onClick, className, style, children, icon, title, disabled, disableReset, autoRun,\n        trackName, trackProperties, ackResetDelay, ...others } = props\n    const { setError: setAppError } = useContext(AppContext)\n    const classes = useStyles()\n    const [working, setWorking] = useState(false)\n    const [ack, setAck] = useState(false)\n    const [error, setError] = useState(undefined)\n    const { track } = useAnalytics()\n    const mounted = useMounted();\n\n    const _disabled = disabled || working;\n\n    const run = async () => {\n        if (working) return; // already working\n\n        if (trackName)\n            track('cmd.' + trackName, trackProperties)\n        try {\n            setError(undefined)\n            setAck(false)\n            setWorking(true)\n            await onClick()\n            if (!mounted())\n                return;\n            setAck(true)\n            if (!disableReset) {\n                await delay(ackResetDelay || ACK_RESET_DELAY)\n                if (!mounted) return;\n                setAck(false)\n            }\n        }\n        catch (e) {\n            if (!mounted())\n                return;\n            setAppError(e)\n            setError(e)\n            if (!disableReset) {\n                await delay(ERROR_RESET_DELAY)\n                if (!mounted())\n                    return;\n                setError(undefined)\n            }\n        }\n        finally {\n            if (mounted())\n                setWorking(false)\n        }\n    }\n\n    const handleClick = async (ev: React.MouseEvent<HTMLButtonElement>) => {\n        ev.stopPropagation()\n        run();\n    }\n\n    const statusIcon = error ? <ErrorIcon /> : undefined;\n    const modeClassName = error ? classes.error : ack ? classes.ack : undefined;\n    const elClassName = clsx(className, modeClassName)\n\n    // run once\n    useEffect(() => {\n        if (autoRun)\n            run()\n    }, [autoRun]);\n\n    if (!children && icon)\n        return <IconButtonWithTooltip\n            className={elClassName}\n            style={style}\n            onClick={handleClick}\n            aria-label={title}\n            title={title}\n            disabled={_disabled}\n            {...others}>{statusIcon || icon}</IconButtonWithTooltip>\n    else\n        return <Button\n            className={elClassName}\n            style={style}\n            startIcon={icon}\n            endIcon={statusIcon}\n            onClick={handleClick}\n            aria-label={title}\n            title={title}\n            disabled={_disabled}\n            {...others}>{children}</Button>\n}","import React, { useState } from \"react\"\nimport {\n    SpeechSynthesisCmd,\n    SpeechSynthesisReg,\n} from \"../../../jacdac-ts/src/jdom/constants\"\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\"\nimport { Grid, TextField } from \"@material-ui/core\"\nimport VoiceChatIcon from \"@material-ui/icons/VoiceChat\"\nimport CmdButton from \"../CmdButton\"\nimport { jdpack } from \"../../../jacdac-ts/src/jdom/pack\"\nimport { useId } from \"react-use-id-hook\"\n\nexport default function DashboardSpeechSynthesis(props: DashboardServiceProps) {\n    const { service } = props\n    const enabled = service.register(SpeechSynthesisReg.Enabled)\n    const [text, setText] = useState(\"jacdac\")\n    const textId = useId()\n\n    const handleChange = ev => {\n        const newValue = ev.target.value\n        setText(newValue)\n    }\n\n    const handleSpeak = async () => {\n        console.log(`speak ${text}`)\n        if (!enabled.boolValue)\n            await enabled.sendSetAsync(\n                jdpack<[boolean]>(\"u8\", [true]),\n                true\n            )\n        await service.sendCmdAsync(\n            SpeechSynthesisCmd.Speak,\n            jdpack<[string]>(\"s\", [text])\n        )\n    }\n\n    return (\n        <>\n            <Grid item xs={12}>\n                <TextField\n                    id={textId}\n                    spellCheck={false}\n                    value={text}\n                    label={\"speech synthesis\"}\n                    helperText={\"Enter text to speak out\"}\n                    onChange={handleChange}\n                    type={\"text\"}\n                />\n                <CmdButton\n                    disabled={!text}\n                    title=\"speak text\"\n                    onClick={handleSpeak}\n                    icon={<VoiceChatIcon />}\n                />\n            </Grid>\n        </>\n    )\n}\n","import { useEffect, useRef } from \"react\";\n\nexport default function useMounted(): () => boolean {\n    const mounted = useRef(false);\n    useEffect(() => {\n        mounted.current = true;\n        return () => { mounted.current = false; }\n    }, []);\n    return () => mounted.current;\n}"],"sourceRoot":""}