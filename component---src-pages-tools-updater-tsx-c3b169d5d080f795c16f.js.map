{"version":3,"sources":["webpack:///./src/components/ui/CircularProgressWithLabel.tsx","webpack:///./src/components/GithubRepositoryCardHeader.tsx","webpack:///./src/components/alert/ConnectAlert.tsx","webpack:///./src/components/alert/DeviceLostAlert.tsx","webpack:///./src/components/firmware/useFirmwareRepos.ts","webpack:///./src/components/firmware/LocalFileFirmwareCard.tsx","webpack:///./src/components/firmware/FirmwareCardGrid.tsx","webpack:///./src/components/UpdateDeviceList.tsx","webpack:///./src/components/firmware/SafeBootAlert.tsx","webpack:///./src/components/tools/Flash.tsx","webpack:///./src/pages/tools/updater.tsx","webpack:///./src/components/firmware/FirmwareCard.tsx","webpack:///./node_modules/@material-ui/icons/DeleteForever.js","webpack:///./src/components/ServiceButton.tsx","webpack:///./src/components/DeviceCard.tsx"],"names":["CircularProgressWithLabel","props","Math","round","value","GithubRepositoryCardHeader","slug","showRelease","useRepository","repo","response","repoLoading","loading","status","useLatestRelease","release","iframe","inIFrame","target","title","html_url","organization","login","name","useStyles","makeStyles","theme","createStyles","button","marginLeft","spacing","NoSsrConnectAlert","classes","useContext","JacdacContext","bus","connectionState","serviceClass","devices","useChange","b","spec","serviceSpecificationFromClassIdentifier","webusb","isWebUSBEnabled","isWebUSBSupported","length","BusState","Disconnected","ConnectAlert","DeviceLostAlert","device","lost","useEventRaised","LOST","FOUND","dev","useFirmwareRepos","showAllRepos","useState","repos","setRepos","DEVICE_CHANGE","filter","announced","bootloaders","hasService","SRV_BOOTLOADER","registers","map","service","register","ControlReg","FirmwareIdentifier","reg","useEffectAsync","mounted","deviceSpecifications","firmwares","refresh","firmwareIdentifier","intValue","undefined","indexOf","push","bootloader","boot","services","bl_announce","Packet","onlyHeader","BootloaderCmd","Info","sendCmdAwaitResponseAsync","resp","jdunpack","console","warn","fw","deviceSpecificationFromFirmwareIdentifier","unique","id","join","ImportButton","lazy","LOCAL_FILE_SLUG","LocalFileFirmwareCard","downloading","setDownloading","error","setError","useFirmwareBlob","setFirmwareFile","firmwareBlobs","disabled","version","handleFiles","files","file","handleClear","blob","toString","FirmwareCardGrid","gridBreakpoints","useGridBreakpoints","safeBoot","firmwareRepos","firmwareRepo","UpdateDeviceCard","AppContext","progress","setProgress","blobs","useFirmwareBlobs","firmwareInfo","d","find","update","updateApplicable","flashing","handleFlashing","updateCandidates","flashFirmwareBlob","prog","UpdateDeviceList","scanning","setScanning","useDevices","ignoreSelf","ignoreSimulators","isFlashing","some","useMounted","scan","Connected","log","scanFirmwares","useEffect","subscribe","FIRMWARE_BLOBS_CHANGE","SafeBootAlert","DbContext","db","useSnackbar","enqueueSnackbar","setSafeBoot","handleRecovery","v","clear","variant","Flash","tab","setTab","handleTabChange","event","newValue","a11yProps","Page","FirmwareCard","useLatestReleases","releases","setRelease","firmwaresExpanded","setFirmwaresExpanded","tag","tag_name","updateAvailable","slice","substr","downloadColor","downloadVariant","handleReleaseChange","ev","rel","r","handleGitHubReleaseDownload","fetchReleaseBinary","firmware","ServiceButton","onClick","others","root","bullet","display","margin","transform","fontSize","pos","marginBottom","navigateToService","specification","navigate","shortId","DeviceDescription","description","useRegisterStringValue","DeviceCard","children","action","content","showDeviceId","showDescription","showTemperature","showFirmware","showServices","SRV_CTRL","SRV_LOGGER"],"mappings":"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","file":"component---src-pages-tools-updater-tsx-c3b169d5d080f795c16f.js","sourcesContent":["import React from \"react\"\nimport { CircularProgressProps, Box, CircularProgress, Typography } from \"@material-ui/core\";\n\nexport default function CircularProgressWithLabel(props: CircularProgressProps & { value: number }) {\n    return (\n        <Box position=\"relative\" display=\"inline-flex\">\n            <CircularProgress variant=\"determinate\" {...props} />\n            <Box\n                top={0}\n                left={0}\n                bottom={0}\n                right={0}\n                position=\"absolute\"\n                display=\"flex\"\n                alignItems=\"center\"\n                justifyContent=\"center\"\n            >\n                <Typography variant=\"caption\" component=\"div\" color=\"textSecondary\">{`${Math.round(\n                    props.value,\n                )}%`}</Typography>\n            </Box>\n        </Box>\n    );\n}","import React, { } from 'react';\n// tslint:disable-next-line: no-submodule-imports\nimport { Box, CardHeader, CircularProgress, Typography } from '@material-ui/core';\nimport { useLatestRelease, useRepository } from './github';\nimport GitHubIcon from '@material-ui/icons/GitHub';\nimport { Link } from 'gatsby-theme-material-ui';\nimport { inIFrame } from '../../jacdac-ts/src/jdom/iframeclient';\nimport LoadingProgress from './ui/LoadingProgress';\n\nexport default function GithubRepositoryCardHeader(props: {\n    slug: string,\n    showRelease?: boolean\n}) {\n    const { slug, showRelease } = props;\n    const { response: repo, loading: repoLoading, status } = useRepository(slug);\n    const { response: release } = useLatestRelease(showRelease && slug);\n    const iframe = inIFrame();\n    const target = iframe ? \"_blank\" : \"\"\n\n    const title = repo\n        ? <>\n            <Link href={repo.html_url} target={target}>\n                <Typography component=\"span\" variant=\"h6\">{repo.organization.login}</Typography>\n            </Link>\n            <Box component=\"span\" ml={0.5} mr={0.5}>/</Box>\n            <Link href={repo.html_url} target={target}>\n                <Typography component=\"span\" variant=\"h5\">{repo.name}</Typography>\n            </Link>\n        </> : <><Link href={`https://github.com/${slug}`} target={target}>\n            <Typography component=\"span\" variant=\"h6\">{slug}</Typography>\n        </Link>\n            {repoLoading && <LoadingProgress /> }\n            {status !== 403 && !repoLoading && !repo && <Typography component=\"p\" variant=\"caption\">Unable to find repository.</Typography>}\n        </>;\n\n    return <CardHeader\n        title={title}\n        subheader={release\n            && <Link color=\"textSecondary\" target=\"_blank\" to={release.html_url}>{release.name}</Link>\n        }\n        avatar={<GitHubIcon />}\n    />\n}","// tslint:disable-next-line: no-submodule-imports\nimport { Box, createStyles, makeStyles } from \"@material-ui/core\";\n// tslint:disable-next-line: no-submodule-imports\nimport Alert from \"../ui/Alert\";\nimport React, { useContext } from \"react\";\nimport { BusState } from \"../../../jacdac-ts/src/jdom/bus\";\nimport { serviceSpecificationFromClassIdentifier } from \"../../../jacdac-ts/src/jdom/spec\";\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\";\nimport ConnectButton from \"../../jacdac/ConnectButton\";\nimport { isWebUSBEnabled, isWebUSBSupported } from \"../../../jacdac-ts/src/jdom/usb\"\nimport { NoSsr } from '@material-ui/core';\nimport useChange from \"../../jacdac/useChange\";\n\nconst useStyles = makeStyles((theme) => createStyles({\n    button: {\n        marginLeft: theme.spacing(2)\n    }\n}))\n\nfunction NoSsrConnectAlert(props: { serviceClass?: number }) {\n    const classes = useStyles()\n    const { bus, connectionState } = useContext<JacdacContextProps>(JacdacContext)\n    const { serviceClass } = props\n    const devices = useChange(bus, b => b.devices({ serviceClass }))\n    const spec = serviceSpecificationFromClassIdentifier(serviceClass)\n    const webusb = isWebUSBEnabled() && isWebUSBSupported()\n\n    if (!devices?.length &&\n        webusb &&\n        connectionState === BusState.Disconnected)\n        return <Box displayPrint=\"none\">\n            <Alert severity=\"info\" closeable={true}>\n                {!spec && <span>Did you connect your device?</span>}\n                {spec && <span>Did you connect a {spec.name} device?</span>}\n                <ConnectButton className={classes.button} full={true} transparent={true} />\n            </Alert>\n        </Box>\n    return null\n}\n\nexport default function ConnectAlert(props: { serviceClass?: number }) {\n    return <NoSsr>\n        <NoSsrConnectAlert {...props} />\n    </NoSsr>\n}","import React from \"react\";\nimport { LOST, FOUND } from \"../../../jacdac-ts/src/jdom/constants\";\nimport { JDDevice } from \"../../../jacdac-ts/src/jdom/device\";\nimport useEventRaised from \"../../jacdac/useEventRaised\";\nimport Alert from \"../ui/Alert\";\n\nexport function DeviceLostAlert(props: { device: JDDevice }) {\n    const { device } = props;\n    const lost = useEventRaised([LOST, FOUND], device, dev => !!dev?.lost)\n    return <>\n        {lost && <Alert severity=\"info\">Device lost...</Alert>}\n    </>\n}","import { useContext, useState } from \"react\";\nimport { deviceSpecificationFromFirmwareIdentifier, deviceSpecifications } from \"../../../jacdac-ts/src/jdom/spec\";\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\";\nimport useEffectAsync from \"../useEffectAsync\";\nimport { unique } from \"../../../jacdac-ts/src/jdom/utils\";\nimport { BootloaderCmd, ControlReg, DEVICE_CHANGE, SRV_BOOTLOADER } from \"../../../jacdac-ts/src/jdom/constants\";\nimport useEventRaised from \"../../jacdac/useEventRaised\";\nimport Packet from \"../../../jacdac-ts/src/jdom/packet\";\n\nexport default function useFirmwareRepos(showAllRepos?: boolean) {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const [repos, setRepos] = useState<string[]>([])\n\n    const devices = useEventRaised(DEVICE_CHANGE, bus, () => bus.devices().filter(dev => dev.announced))\n    const bootloaders = devices.filter(device => device?.hasService(SRV_BOOTLOADER));\n    const registers = devices\n        .filter(device => !device?.hasService(SRV_BOOTLOADER)) // not a bootloader\n        .map(device => device?.service(0)?.register(ControlReg.FirmwareIdentifier))\n        .filter(reg => !!reg);\n\n    useEffectAsync(async (mounted) => {\n        let repos: string[] = [];\n        if (showAllRepos)\n            repos = deviceSpecifications().map(spec => spec.repo);\n        else {\n            const firmwares: number[] = [];\n            // ask firmware registers\n            for (const register of registers) {\n                await register.refresh(true)\n                const firmwareIdentifier = register.intValue;\n                if (firmwareIdentifier !== undefined && firmwares.indexOf(firmwareIdentifier) < 0)\n                    firmwares.push(firmwareIdentifier);\n            }\n            // ask bootloaders\n            for (const bootloader of bootloaders) {\n                const boot = bootloader.services({ serviceClass: SRV_BOOTLOADER })[0];\n                const bl_announce = Packet.onlyHeader(BootloaderCmd.Info)\n                try {\n                    const resp = await boot.sendCmdAwaitResponseAsync(bl_announce);\n                    const [, , , firmwareIdentifier] = resp.jdunpack<[number, number, number, number]>(\"u32 u32 u32 u32\");\n                    if (firmwareIdentifier !== undefined && firmwares.indexOf(firmwareIdentifier) < 0)\n                        firmwares.push(firmwareIdentifier);\n                }\n                catch (e) {\n                    console.warn(`bootloader firmware identifier failed`, e)\n                }\n            }\n            repos = firmwares.map(fw => deviceSpecificationFromFirmwareIdentifier(fw)?.repo)\n                .filter(repo => !!repo);\n        }\n        if (mounted)\n            setRepos(unique(repos))\n    }, [devices.map(dev => dev.id).join(), registers.map(reg => reg.id).join(), showAllRepos])\n    return repos;\n}","import React, { lazy, useState } from \"react\"\nimport { Button, Card, CardHeader, CardActions, CardContent, ListItem, List, ListItemText, Typography } from \"@material-ui/core\";\nimport { useFirmwareBlob } from \"./useFirmwareBlobs\";\nimport Alert from \"../ui/Alert\";\nimport Suspense from \"../ui/Suspense\"\nconst ImportButton = lazy(() => import(\"../ImportButton\"))\n\nconst LOCAL_FILE_SLUG = \"local file\";\n\nexport default function LocalFileFirmwareCard() {\n    const slug = LOCAL_FILE_SLUG;\n    const [downloading, setDownloading] = useState(false)\n    const [error, setError] = useState(\"\")\n    const { setFirmwareFile, firmwareBlobs } = useFirmwareBlob(slug)\n    const disabled = downloading;\n    const version = firmwareBlobs?.[0].version\n\n    const handleFiles = async (files: File[]) => {\n        const file = files[0]\n        if (file) {\n            try {\n                setDownloading(true)\n                await setFirmwareFile(undefined, file)\n            } finally {\n                setDownloading(false)\n            }\n        }\n    }\n\n    const handleClear = async () => {\n        try {\n            setError(\"\")\n            setDownloading(true)\n            setFirmwareFile(undefined, undefined)\n        }\n        finally {\n            setDownloading(false)\n        }\n    }\n\n    return <Card>\n        <CardHeader\n            title={slug} />\n        <CardContent>\n            {error && <Alert severity=\"error\">{error}</Alert>}\n            {version && <Typography variant=\"body2\">version <code>{version}</code></Typography>}\n            {!!firmwareBlobs?.length && <List dense>\n                {firmwareBlobs.map(blob => <ListItem key={blob.firmwareIdentifier}>\n                    <ListItemText primary={blob.name} secondary={`0x${blob.firmwareIdentifier.toString(16)}`} />\n                </ListItem>)}\n            </List>}\n        </CardContent>\n        <CardActions>\n            {!downloading && <Suspense><ImportButton text={\"Import UF2 file\"} onFilesUploaded={handleFiles} /></Suspense>}\n            {!downloading && firmwareBlobs?.length && <Button disabled={disabled} variant=\"text\" arial-label={\"Clear\"} onClick={handleClear}>\n                Clear\n            </Button>}\n        </CardActions>\n    </Card>\n}","import { Grid, Switch } from \"@material-ui/core\";\nimport React, { useContext, useState } from \"react\";\nimport useGridBreakpoints from \"../useGridBreakpoints\";\nimport FirmwareCard from \"./FirmwareCard\";\n// tslint:disable-next-line: no-submodule-imports\nimport useFirmwareRepos from \"./useFirmwareRepos\";\nimport LocalFileFirmwareCard from \"./LocalFileFirmwareCard\";\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\";\nimport useChange from \"../../jacdac/useChange\";\n\nexport default function FirmwareCardGrid() {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const gridBreakpoints = useGridBreakpoints()\n    const safeBoot = useChange(bus, b => b.safeBoot);\n    const firmwareRepos = useFirmwareRepos(safeBoot)\n\n    return <Grid container spacing={2}>\n        <Grid {...gridBreakpoints} item key=\"localfile\">\n            <LocalFileFirmwareCard />\n        </Grid>\n        {firmwareRepos.map(firmwareRepo => <Grid {...gridBreakpoints} item key={`firmwarerepo${firmwareRepo}`}>\n            <FirmwareCard slug={firmwareRepo} />\n        </Grid>)}\n    </Grid>\n}\n","import { Button, Grid } from \"@material-ui/core\"\nimport { Alert } from \"@material-ui/lab\"\nimport React, { useContext, useEffect, useState } from \"react\"\nimport { DEVICE_CHANGE, FIRMWARE_BLOBS_CHANGE, SRV_BOOTLOADER } from \"../../jacdac-ts/src/jdom/constants\"\nimport { JDDevice } from \"../../jacdac-ts/src/jdom/device\"\nimport { scanFirmwares, flashFirmwareBlob, updateApplicable } from \"../../jacdac-ts/src/jdom/flashing\"\nimport JacdacContext, { JacdacContextProps } from \"../jacdac/Context\";\nimport CircularProgressWithLabel from \"./ui/CircularProgressWithLabel\"\nimport DeviceCard from \"./DeviceCard\"\nimport useGridBreakpoints from \"./useGridBreakpoints\"\nimport { BusState } from \"../../jacdac-ts/src/jdom/bus\"\nimport AppContext from \"./AppContext\"\nimport useChange from \"../jacdac/useChange\"\nimport useDevices from \"./hooks/useDevices\"\nimport useFirmwareBlobs from \"./firmware/useFirmwareBlobs\"\nimport ConnectAlert from \"./alert/ConnectAlert\"\nimport useMounted from \"./hooks/useMounted\"\n\nfunction UpdateDeviceCard(props: {\n    device: JDDevice\n}) {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const { device } = props\n    const { setError } = useContext(AppContext)\n    const [progress, setProgress] = useState(0)\n    const blobs = useFirmwareBlobs();\n    const firmwareInfo = useChange(device, d => d.firmwareInfo);\n    const blob = firmwareInfo && blobs?.find(b => firmwareInfo.firmwareIdentifier == b.firmwareIdentifier)\n    const update = blob && firmwareInfo && updateApplicable(firmwareInfo, blob);\n    const flashing = useChange(device, d => d.flashing);\n\n    const handleFlashing = async () => {\n        if (device.flashing) return;\n        try {\n            setProgress(0)\n            device.flashing = true; // don't refresh registers while flashing\n            const updateCandidates = [firmwareInfo]\n            await flashFirmwareBlob(bus, blob, updateCandidates, prog => setProgress(prog))\n            // trigger info\n            device.firmwareInfo = undefined;\n        } catch (e) {\n            setError(e);\n        } finally {\n            device.flashing = false;\n        }\n    }\n\n    return <DeviceCard device={device}\n        showFirmware={true}\n        content={update && <span>Update to {blob.version}</span>}\n        // tslint:disable-next-line: react-this-binding-issue\n        action={flashing ? <CircularProgressWithLabel value={progress} />\n            : update\n                ? <Button aria-label=\"deploy new firmware to device\" disabled={flashing} variant=\"contained\"\n                    color=\"primary\" onClick={handleFlashing}>Flash</Button>\n                : firmwareInfo ? <Alert severity=\"success\">Up to date!</Alert>\n                    : undefined} />\n}\n\nexport default function UpdateDeviceList() {\n    const { bus, connectionState } = useContext<JacdacContextProps>(JacdacContext)\n    const [scanning, setScanning] = useState(false)\n    const gridBreakpoints = useGridBreakpoints()\n    const safeBoot = useChange(bus, b => b.safeBoot);\n    const devices = useDevices({ announced: true, ignoreSelf: true, ignoreSimulators: true, firmwareIdentifier: true }, [safeBoot])\n        .filter(dev => safeBoot || !dev.hasService(SRV_BOOTLOADER));\n    const isFlashing = devices.some(dev => dev.flashing);\n    const blobs = useFirmwareBlobs();\n    const mounted = useMounted();\n    async function scan() {\n        if (!blobs?.length || isFlashing || scanning || connectionState != BusState.Connected)\n            return;\n        console.log(`start scanning bus`)\n        try {\n            setScanning(true)\n            await scanFirmwares(bus)\n        }\n        finally {\n            if(mounted())\n                setScanning(false)\n        }\n    }\n    // load indexed db file once\n    useEffect(() => { scan() }, [isFlashing, connectionState, blobs])\n    useEffect(() => bus.subscribe([DEVICE_CHANGE, FIRMWARE_BLOBS_CHANGE], () => scan()), [])\n\n    return <Grid container spacing={2}>\n        {devices.map(device => <Grid key={device.id} item {...gridBreakpoints}>\n            <UpdateDeviceCard device={device} />\n        </Grid>)}\n    </Grid>\n\n}","import { Box, Button, Switch, Typography } from \"@material-ui/core\";\nimport React, { useContext, useEffect, useState } from \"react\";\n// tslint:disable-next-line: no-submodule-imports\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\";\nimport Alert from \"../ui/Alert\";\nimport DbContext, { DbContextProps } from \"../DbContext\";\n// tslint:disable-next-line: match-default-export-name tslint:disable-next-line: no-submodule-imports\nimport DeleteForeverIcon from '@material-ui/icons/DeleteForever';\nimport { useSnackbar } from \"notistack\";\n\nexport default function SafeBootAlert() {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const { db } = useContext<DbContextProps>(DbContext)\n    const { enqueueSnackbar } = useSnackbar();\n    const [safeBoot, setSafeBoot] = useState(bus.safeBoot);\n    const firmwares = db?.firmwares;\n\n    const handleRecovery = async () => {\n        const v = !safeBoot;\n        setSafeBoot(v);\n    }\n    const handleClear = async () => {\n        await firmwares.clear();\n        enqueueSnackbar(\"firmwares cleared\", {\n            variant: \"info\"\n        })\n    }\n\n    // turn on and off safeboot mode\n    useEffect(() => {\n        bus.safeBoot = safeBoot;\n        return () => { bus.safeBoot = false }\n    }, [safeBoot]);\n\n    return (<>\n        <Alert severity=\"info\">\n            <Switch value={safeBoot} onChange={handleRecovery} />\n            <Typography component=\"span\" variant=\"body1\">\n                recovery mode\n                </Typography>\n            <Box mr={1}>\n                <Typography component=\"span\" variant=\"caption\">\n                    If your module is malfunctioning from the start, you can flash it in bootloader mode.\n                    Turn on recovery mode and unplug/replug any malfunctioning device to switch it to bootloader mode (glowing status LED).\n                    Once your module is flashed, turn off recovery mode and unplug/replug your module again.\n                    </Typography>\n            </Box>\n        </Alert>\n        {safeBoot && <Alert severity=\"warning\">\n            <Button size=\"small\" variant=\"outlined\" disabled={!firmwares} onClick={handleClear} startIcon={<DeleteForeverIcon />}>\n                clear cache\n            </Button>\n            <Box mr={1}>\n                <Typography component=\"span\" variant=\"caption\">\n                    Delete all firmware cached in the browser. The firmware will have to be deleted again from this interface.\n                    </Typography>\n            </Box>\n        </Alert>}\n    </>)\n}\n","import { Box, Tab, Tabs } from \"@material-ui/core\";\nimport React, { useState } from \"react\";\nimport TabPanel, { a11yProps } from '../ui/TabPanel';\nimport ConnectAlert from \"../alert/ConnectAlert\";\nimport FirmwareCardGrid from \"../firmware/FirmwareCardGrid\";\n// tslint:disable-next-line: no-submodule-imports\nimport UpdateDeviceList from \"../UpdateDeviceList\";\nimport SafeBootAlert from \"../firmware/SafeBootAlert\";\n\nexport default function Flash() {\n    const [tab, setTab] = useState(0);\n    const handleTabChange = (event: React.ChangeEvent<unknown>, newValue: number) => {\n        setTab(newValue);\n    }\n\n    return (\n        <Box mb={2}>\n            <ConnectAlert />\n            <Tabs value={tab} onChange={handleTabChange} aria-label=\"View specification formats\">\n                <Tab label={`Updates`} {...a11yProps(1)} />\n                <Tab label={`Firmwares`} {...a11yProps(0)} />\n            </Tabs>\n            <TabPanel value={tab} index={0}>\n                <UpdateDeviceList />\n            </TabPanel>\n            <TabPanel value={tab} index={1}>\n                <FirmwareCardGrid />\n            </TabPanel>\n            <SafeBootAlert />\n        </Box>\n    )\n}\n","import React from \"react\"\nimport Flash from \"../../components/tools/Flash\"\n\nexport default function Page() {\n    return <>\n        <h1>Firmware Updater</h1>\n        <p>\n        This page allows you to update your Jacdac module with new firmware. Find the latest UF2 firmware file from your manufacturer \nand import it with the button below.\n            \n        </p>\n        <Flash />\n    </>\n}","import React, { ChangeEvent, useEffect, useState } from \"react\"\nimport { Accordion, AccordionDetails, AccordionSummary, Box, Button, Card, CardActions, CardContent, CircularProgress, Collapse, List, ListItem, ListItemText, MenuItem, Select, Typography } from \"@material-ui/core\";\nimport { fetchReleaseBinary, useLatestReleases } from \"../github\";\nimport { useFirmwareBlob } from \"./useFirmwareBlobs\";\nimport GithubRepositoryCardHeader from \"../GithubRepositoryCardHeader\";\nimport Alert from \"../ui/Alert\";\nimport { Link } from \"gatsby-theme-material-ui\";\nimport SelectWithLabel from \"../ui/SelectWithLabel\";\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport LoadingProgress from \"../ui/LoadingProgress\";\n\nexport default function FirmwareCard(props: { slug: string }) {\n    const { slug } = props\n    const { response: releases } = useLatestReleases(slug);\n    const [downloading, setDownloading] = useState(false)\n    const [error, setError] = useState(\"\")\n    const [release, setRelease] = useState(undefined)\n    const [firmwaresExpanded, setFirmwaresExpanded] = useState(false)\n    const { setFirmwareFile, firmwareBlobs } = useFirmwareBlob(slug)\n    const tag = release?.tag_name || \"\";\n    const disabled = downloading;\n    const version = firmwareBlobs?.[0].version\n    const updateAvailable = !!tag && !!version && tag.slice(1) !== version.substr(0, tag.length - 1)\n    const downloadColor = updateAvailable ? \"primary\" : \"inherit\"\n    const downloadVariant = updateAvailable ? \"contained\" : \"text\"\n\n    // initialize with latest release\n    useEffect(() => {\n        if (releases?.length && !release)\n            setRelease(releases[0]);\n    }, [releases])\n\n    const handleReleaseChange = (ev: ChangeEvent<{ name?: string; value: unknown; }>) => {\n        const v = ev.target.value as string;\n        const rel = releases?.find(r => r.tag_name === v);\n        setRelease(rel);\n    }\n    const handleGitHubReleaseDownload = async () => {\n        try {\n            setError(\"\")\n            setDownloading(true)\n            const firmware = await fetchReleaseBinary(slug, tag);\n            if (firmware)\n                setFirmwareFile(tag, firmware)\n        }\n        finally {\n            setDownloading(false)\n        }\n    }\n    const handleClear = async () => {\n        try {\n            setError(\"\")\n            setDownloading(true)\n            setFirmwareFile(tag, undefined)\n        }\n        finally {\n            setDownloading(false)\n        }\n    }\n\n    return <Card>\n        <GithubRepositoryCardHeader slug={slug} />\n        <CardContent>\n            {error && <Alert severity=\"error\">{error}</Alert>}\n            {!!firmwareBlobs?.length && <Box mb={1}><Accordion expanded={firmwaresExpanded} onChange={() => setFirmwaresExpanded(!firmwaresExpanded)}>\n                <AccordionSummary expandIcon={<ExpandMoreIcon />}>\n                    <Typography variant=\"body2\">\n                        <code>v{version}</code>\n                        <span> ({firmwareBlobs.length} firmwares)</span>\n                    </Typography>\n                </AccordionSummary>\n                <AccordionDetails>\n                    <List dense>\n                        {firmwareBlobs.map(blob => <ListItem key={blob.firmwareIdentifier}>\n                            <ListItemText primary={blob.name}\n                                secondary={<Link to={`/firmwares/0x${blob.firmwareIdentifier.toString(16)}`}>\n                                    {`0x${blob.firmwareIdentifier.toString(16)}`}\n                                </Link>} />\n                        </ListItem>)}\n                    </List>\n                </AccordionDetails>\n            </Accordion></Box>}\n            {releases?.length === 0 && <Alert severity=\"warning\">No releases found.</Alert>}\n            {!!releases?.length && <SelectWithLabel fullWidth={true} helperText=\"choose a version\" value={tag} onChange={handleReleaseChange}>\n                {releases?.map(rel => <MenuItem key={rel.tag_name} value={rel.tag_name}>{rel.tag_name}</MenuItem>)}\n            </SelectWithLabel>}\n        </CardContent>\n        <CardActions>\n            {!downloading && release && <Button disabled={downloading} color={downloadColor} variant={downloadVariant} aria-label={`Download last release from ${slug}`} onClick={handleGitHubReleaseDownload}>\n                Download\n            </Button>}\n            {!downloading && firmwareBlobs?.length && <Button disabled={disabled} variant=\"text\" arial-label={\"Clear\"} onClick={handleClear}>\n                Clear\n            </Button>}\n            {downloading && <LoadingProgress />}\n        </CardActions>\n    </Card>\n}","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z\"\n}), 'DeleteForever');\n\nexports.default = _default;","import { ButtonProps } from \"@material-ui/core\";\nimport { Button } from \"gatsby-theme-material-ui\";\nimport React from 'react';\nimport { JDService } from \"../../jacdac-ts/src/jdom/service\";\n\nexport default function ServiceButton(props: { service: JDService, onClick?: () => void } & ButtonProps) {\n    const { service, onClick, ...others } = props;\n    return <Button\n        {...others}\n        variant=\"contained\"\n        color=\"primary\"\n        onClick={onClick}>\n        {service.name}\n    </Button>\n}\n","import React from 'react';\n// tslint:disable-next-line: no-submodule-imports\nimport { makeStyles } from '@material-ui/core/styles';\n// tslint:disable-next-line: no-submodule-imports\nimport Card from '@material-ui/core/Card';\n// tslint:disable-next-line: no-submodule-imports\nimport CardContent from '@material-ui/core/CardContent';\nimport { JDDevice } from '../../jacdac-ts/src/jdom/device';\nimport { SRV_CTRL, SRV_LOGGER, ControlReg } from '../../jacdac-ts/src/jdom/constants';\nimport ServiceButton from './ServiceButton';\nimport useChange from '../jacdac/useChange';\nimport { navigate } from \"gatsby\";\nimport { JDService } from '../../jacdac-ts/src/jdom/service';\nimport { CardActions, createStyles } from '@material-ui/core';\nimport DeviceCardHeader from './DeviceCardHeader';\nimport { useRegisterStringValue } from '../jacdac/useRegisterValue';\nimport { DeviceLostAlert } from './alert/DeviceLostAlert';\n\nconst useStyles = makeStyles(() => createStyles({\n    root: {\n    },\n    bullet: {\n        display: 'inline-block',\n        margin: '0 2px',\n        transform: 'scale(0.8)',\n    },\n    title: {\n        fontSize: 14,\n    },\n    pos: {\n        marginBottom: 12,\n    },\n}));\n\nfunction navigateToService(service: JDService) {\n    const spec = service.specification;\n    if (spec)\n        navigate(`/services/${spec.shortId}/`) // todo spec\n}\n\nfunction DeviceDescription(props: { device: JDDevice }) {\n    const { device } = props;\n    const register = device?.service(0)?.register(ControlReg.DeviceDescription)\n    const description = useRegisterStringValue(register)\n    return <span>{description || \"\"}</span>\n}\n\nexport default function DeviceCard(props: {\n    device: JDDevice,\n    children?: any,\n    action?: JSX.Element | JSX.Element[],\n    content?: JSX.Element | JSX.Element[],\n    showDeviceId?: boolean,\n    showServices?: boolean,\n    showTemperature?: boolean,\n    showFirmware?: boolean,\n    showDescription?: boolean\n}) {\n    const { device, children, action, content,\n        showDeviceId,\n        showDescription, showTemperature, showFirmware, showServices } = props;\n    const classes = useStyles();\n    const services = useChange(device, () => device.services()\n        .filter(service => service.serviceClass != SRV_CTRL && service.serviceClass != SRV_LOGGER));\n\n    return (\n        <Card className={classes.root}>\n            <DeviceCardHeader device={device}\n                showDeviceId={showDeviceId}\n                showTemperature={showTemperature}\n                showFirmware={showFirmware}\n                showMedia={true} />\n            {(showDescription || content) &&\n                <CardContent>\n                    {<DeviceLostAlert device={device} />}\n                    {showDescription && <DeviceDescription device={device} />}\n                    {content}\n                </CardContent>}\n            <CardActions>\n                {action}\n                {showServices && services?.map(service => <ServiceButton key={service.id} service={service} onClick={() => navigateToService(service)} />)}\n            </CardActions>\n            {children}\n        </Card>\n    );\n}\n"],"sourceRoot":""}