{"version":3,"sources":["webpack:///./src/components/alert/ConnectAlert.tsx","webpack:///./src/pages/tools/service-test.tsx"],"names":["useStyles","makeStyles","theme","createStyles","button","marginLeft","spacing","NoSsrConnectAlert","props","classes","serviceClass","useContext","JacdacContext","bus","transports","devices","useChange","b","ignoreSelf","spec","serviceSpecificationFromClassIdentifier","length","name","map","transport","type","ConnectAlert","DeviceItem","device","serviceUnderTest","onServiceUnderTestSelected","services","d","specification","gridBreakpoints","useGridBreakpoints","handleServiceSelected","service","id","undefined","Page","useDevices","announced","useState","setServiceUnderTest"],"mappings":"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","file":"component---src-pages-tools-service-test-tsx-5f4d9a79249ab4cd01c9.js","sourcesContent":["// tslint:disable-next-line: no-submodule-imports\nimport { Box, createStyles, makeStyles } from \"@material-ui/core\"\n// tslint:disable-next-line: no-submodule-imports\nimport Alert from \"../ui/Alert\"\nimport React, { useContext } from \"react\"\nimport { serviceSpecificationFromClassIdentifier } from \"../../../jacdac-ts/src/jdom/spec\"\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\"\nimport ConnectButton from \"../../jacdac/ConnectButton\"\nimport { NoSsr } from \"@material-ui/core\"\nimport useChange from \"../../jacdac/useChange\"\n\nconst useStyles = makeStyles(theme =>\n    createStyles({\n        button: {\n            marginLeft: theme.spacing(2),\n        },\n    })\n)\n\nfunction NoSsrConnectAlert(props: { serviceClass?: number }) {\n    const classes = useStyles()\n    const { serviceClass } = props\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const { transports } = bus\n    const devices = useChange(bus, b => b.devices({ serviceClass, ignoreSelf: true }))\n    const spec = serviceSpecificationFromClassIdentifier(serviceClass)\n\n    // don't show if no transport, some devices\n    if (!transports.length || devices?.length) return null\n\n    return (\n        <Box displayPrint=\"none\">\n            <Alert severity=\"info\" closeable={true}>\n                {!spec && <span>Did you connect your device?</span>}\n                {spec && <span>Did you connect a {spec.name} device?</span>}\n                {transports.map(transport => (\n                    <ConnectButton\n                        key={transport.type}\n                        transport={transport}\n                        className={classes.button}\n                        full={true}\n                        transparent={true}\n                    />\n                ))}\n            </Alert>\n        </Box>\n    )\n}\n\nexport default function ConnectAlert(props: { serviceClass?: number }) {\n    return (\n        <NoSsr>\n            <NoSsrConnectAlert {...props} />\n        </NoSsr>\n    )\n}\n","import React, { useState } from \"react\"\nimport {\n    Button,\n    Card,\n    CardActions,\n    CardContent,\n    Grid,\n    Typography,\n} from \"@material-ui/core\"\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport useGridBreakpoints from \"../../components/useGridBreakpoints\"\nimport useDevices from \"../../components/hooks/useDevices\"\nimport DeviceCardHeader from \"../../components/DeviceCardHeader\"\nimport { JDService } from \"../../../jacdac-ts/src/jdom/service\"\nimport { JDDevice } from \"../../../jacdac-ts/src/jdom/device\"\nimport useChange from \"../../jacdac/useChange\"\nimport ConnectAlert from \"../../components/alert/ConnectAlert\"\nimport ServiceTestRunner from \"../../components/test/ServiceTestRunner\"\n\nfunction DeviceItem(props: {\n    device: JDDevice\n    serviceUnderTest: JDService\n    onServiceUnderTestSelected: (service: JDService) => void\n}) {\n    const { device, serviceUnderTest, onServiceUnderTestSelected } = props\n    const services = useChange(device, d => d.services({ specification: true }))\n    const gridBreakpoints = useGridBreakpoints()\n    const handleServiceSelected = (service: JDService) => () =>\n        onServiceUnderTestSelected(service)\n    return (\n        <Grid item {...gridBreakpoints}>\n            <Card>\n                <DeviceCardHeader device={device} showAvatar={true} />\n                <CardContent>\n                    <Typography variant=\"caption\">\n                        Select a service to test.\n                    </Typography>\n                </CardContent>\n                <CardActions>\n                    <Grid container spacing={1}>\n                        {services?.map(service => (\n                            <Grid item key={service.id}>\n                                <Button\n                                    variant={\n                                        serviceUnderTest === service\n                                            ? \"contained\"\n                                            : \"outlined\"\n                                    }\n                                    color={\n                                        serviceUnderTest === service\n                                            ? \"primary\"\n                                            : undefined\n                                    }\n                                    onClick={handleServiceSelected(service)}\n                                >\n                                    {service.name}\n                                </Button>\n                            </Grid>\n                        ))}\n                    </Grid>\n                </CardActions>\n            </Card>\n        </Grid>\n    )\n}\n\nexport default function Page() {\n    const devices = useDevices({ announced: true })\n    const [serviceUnderTest, setServiceUnderTest] = useState<JDService>(\n        undefined\n    )\n    return (\n        <>\n            <h1>Service Tests</h1>\n            <p>Connect devices to test its services.</p>\n            <ConnectAlert />\n            <Grid container spacing={2}>\n                {devices?.map(device => (\n                    <DeviceItem\n                        key={device.id}\n                        device={device}\n                        serviceUnderTest={serviceUnderTest}\n                        onServiceUnderTestSelected={setServiceUnderTest}\n                    />\n                ))}\n            </Grid>\n            {serviceUnderTest && <Grid item xs={12}>\n                <ServiceTestRunner service={serviceUnderTest} />\n            </Grid>}\n        </>\n    )\n}\n"],"sourceRoot":""}