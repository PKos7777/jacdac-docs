{"version":3,"sources":["webpack://jacdac-docs/./node_modules/@material-ui/core/esm/TableCell/TableCell.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/Add.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/Delete.js","webpack://jacdac-docs/./jacdac-ts/src/jdom/settingsclient.ts","webpack://jacdac-docs/./src/components/hooks/useServices.ts","webpack://jacdac-docs/./src/components/select/SelectDevice.tsx","webpack://jacdac-docs/./src/components/select/SelectEvent.tsx","webpack://jacdac-docs/./src/components/ui/KeyboardKeyInput.tsx","webpack://jacdac-docs/./src/components/ui/SelectWithLabel.tsx","webpack://jacdac-docs/./src/components/useServiceClient.ts","webpack://jacdac-docs/./src/components/select/SelectService.tsx","webpack://jacdac-docs/./src/pages/tools/hid-events.tsx"],"names":["SettingsClient","service","registersUseAcks","clear","sendCmdAsync","SettingsCmd","listKeys","inp","InPipeReader","bus","sendPacketAsync","openCommand","readAll","output","keys","map","pkt","stringData","filter","k","list","jdunpack","key","value","kv","setValue","trim","undefined","deleteValue","Packet","jdpack","emit","CHANGE","setStringValue","stringToBuffer","getValue","sendCmdAwaitResponseAsync","resp","data","rkey","console","error","getStringValue","bufferToString","JDServiceClient","useServices","options","useContext","JacdacContext","services","useChange","b","JSON","stringify","SelectDevice","props","devices","deviceId","onChange","handleDeviceChange","ev","id","target","device","node","identify","length","dev","describe","SelectEvent","events","eventId","friendlyName","label","handleChange","name","selectors","a","c","d","e","f","g","h","i","j","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","$","enter","escape","backspace","tab","_","capslock","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","printscreen","scrolllock","pause","insert","home","pageup","delete","end","pagedown","arrowright","arrowleft","arrowdown","arrowup","numlock","numpaddivide","numpadmultiply","numpadsubstract","numpadadd","numpadenter","numpad1","numpad2","numpad3","numpad4","numpad5","numpad6","numpad7","numpad8","numpad9","numpad0","numpaddecimal","numpadequal","f13","f14","f15","f16","f17","f18","f19","f20","f21","f22","f23","f24","execute","help","contextmenu","select","stop","again","undo","cut","copy","paste","find","mute","volumeup","volumedown","numpadcomma","reverseSelectors","Object","reduce","modifierCodes","controlleft","HidKeyboardModifiers","altleft","shiftleft","metaleft","controlright","altright","shiftright","metaright","RightGUI","useStyles","makeStyles","theme","createStyles","capture","cursor","borderColor","palette","primary","main","action","active","buttonSelected","background","dark","color","renderKey","selector","modifiers","flags","values","forEach","flag","push","sel","join","KeyboardKeyInput","keyboardRef","useRef","classes","layout","default","display","handleKeyboardKeyPress","code","toLowerCase","replace","newSelector","newModifiers","msel","mcode","useEffect","current","addButtonTheme","removeButtonTheme","SelectWithLabel","fullWidth","required","disabled","placeholder","onClose","children","helperText","type","none","labelId","useId","descrId","hasDescr","useServiceClient","factory","deps","useState","client","setClient","unmount","SelectService","serviceId","srv","instanceName","PREFIX","FORMAT","HIDEventToBuffer","event","fromHex","serviceClass","serviceIndex","payload","bufferToHIDEvent","eventCode","deviceIds","toHex","SelectHIDEvent","onAdd","setDeviceId","setServiceId","setEventId","setSelector","setModifiers","excludedServices","SRV_CONTROL","SRV_PROTO_TEST","SRV_ROLE_MANAGER","SRV_SETTINGS","SRV_LOGGER","eventFilter","SystemEvent","useDevices","ignoreSelf","specification","indexOf","some","handleServiceChange","handleEventChange","handleKeyChange","handleAdd","HIDEvents","settingsService","setSettingsService","hidEvents","setHIDEvents","settings","hes","all","entry","startsWith","he","hidEvent","randomDeviceId","handleRemoveBinding","index","handleSelectHub","newServiceId"],"mappings":";;;;;;;;;;;;;;;;AAA0F;AAChC;AAC3B;AACP;AACsB;AACD;AACsB;AAClB;AACQ;AAClD;AACP;AACA;AACA,UAAU,oFAAQ,GAAG;AACrB;AACA;AACA;AACA;AACA,8EAA8E,2EAAO,CAAC,wEAAI,oCAAoC,0EAAM,CAAC,wEAAI;AACzI;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL,0EAA0E,KAAK;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,6BAA6B,6CAAgB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,oGAAwB;;AAEtC,cAAc,6CAAgB,CAAC,iEAAY;AAC3C,kBAAkB,6CAAgB,CAAC,qEAAgB;AACnD;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,sBAAsB,gDAAmB,YAAY,oFAAQ;AAC7D;AACA,eAAe,sDAAI,0FAA0F,mEAAU,6DAA6D,mEAAU,wDAAwD,mEAAU;AAChQ;AACA;AACA;AACA,GAAG;AACH,CAAC;AACD,MAAqC,GAAG,CAAM;AAC9C,yDAAe,oEAAU;AACzB;AACA,CAAC,YAAY,E;;;;;;;;;ACxKA;;AAEb,6BAA6B,mBAAO,CAAC,KAA8C;;AAEnF,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","file":"component---src-pages-tools-hid-events-tsx-db585711ef53806e0b5a.js","sourcesContent":["import _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nimport capitalize from '../utils/capitalize';\nimport { darken, fade, lighten } from '../styles/colorManipulator';\nimport TableContext from '../Table/TableContext';\nimport Tablelvl2Context from '../Table/Tablelvl2Context';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: _extends({}, theme.typography.body2, {\n      display: 'table-cell',\n      verticalAlign: 'inherit',\n      // Workaround for a rendering bug with spanned columns in Chrome 62.0.\n      // Removes the alpha (sets it to 1), and lightens or darkens the theme color.\n      borderBottom: \"1px solid\\n    \".concat(theme.palette.type === 'light' ? lighten(fade(theme.palette.divider, 1), 0.88) : darken(fade(theme.palette.divider, 1), 0.68)),\n      textAlign: 'left',\n      padding: 16\n    }),\n\n    /* Styles applied to the root element if `variant=\"head\"` or `context.table.head`. */\n    head: {\n      color: theme.palette.text.primary,\n      lineHeight: theme.typography.pxToRem(24),\n      fontWeight: theme.typography.fontWeightMedium\n    },\n\n    /* Styles applied to the root element if `variant=\"body\"` or `context.table.body`. */\n    body: {\n      color: theme.palette.text.primary\n    },\n\n    /* Styles applied to the root element if `variant=\"footer\"` or `context.table.footer`. */\n    footer: {\n      color: theme.palette.text.secondary,\n      lineHeight: theme.typography.pxToRem(21),\n      fontSize: theme.typography.pxToRem(12)\n    },\n\n    /* Styles applied to the root element if `size=\"small\"`. */\n    sizeSmall: {\n      padding: '6px 24px 6px 16px',\n      '&:last-child': {\n        paddingRight: 16\n      },\n      '&$paddingCheckbox': {\n        width: 24,\n        // prevent the checkbox column from growing\n        padding: '0 12px 0 16px',\n        '&:last-child': {\n          paddingLeft: 12,\n          paddingRight: 16\n        },\n        '& > *': {\n          padding: 0\n        }\n      }\n    },\n\n    /* Styles applied to the root element if `padding=\"checkbox\"`. */\n    paddingCheckbox: {\n      width: 48,\n      // prevent the checkbox column from growing\n      padding: '0 0 0 4px',\n      '&:last-child': {\n        paddingLeft: 0,\n        paddingRight: 4\n      }\n    },\n\n    /* Styles applied to the root element if `padding=\"none\"`. */\n    paddingNone: {\n      padding: 0,\n      '&:last-child': {\n        padding: 0\n      }\n    },\n\n    /* Styles applied to the root element if `align=\"left\"`. */\n    alignLeft: {\n      textAlign: 'left'\n    },\n\n    /* Styles applied to the root element if `align=\"center\"`. */\n    alignCenter: {\n      textAlign: 'center'\n    },\n\n    /* Styles applied to the root element if `align=\"right\"`. */\n    alignRight: {\n      textAlign: 'right',\n      flexDirection: 'row-reverse'\n    },\n\n    /* Styles applied to the root element if `align=\"justify\"`. */\n    alignJustify: {\n      textAlign: 'justify'\n    },\n\n    /* Styles applied to the root element if `context.table.stickyHeader={true}`. */\n    stickyHeader: {\n      position: 'sticky',\n      top: 0,\n      left: 0,\n      zIndex: 2,\n      backgroundColor: theme.palette.background.default\n    }\n  };\n};\n/**\n * The component renders a `<th>` element when the parent context is a header\n * or otherwise a `<td>` element.\n */\n\nvar TableCell = /*#__PURE__*/React.forwardRef(function TableCell(props, ref) {\n  var _props$align = props.align,\n      align = _props$align === void 0 ? 'inherit' : _props$align,\n      classes = props.classes,\n      className = props.className,\n      component = props.component,\n      paddingProp = props.padding,\n      scopeProp = props.scope,\n      sizeProp = props.size,\n      sortDirection = props.sortDirection,\n      variantProp = props.variant,\n      other = _objectWithoutProperties(props, [\"align\", \"classes\", \"className\", \"component\", \"padding\", \"scope\", \"size\", \"sortDirection\", \"variant\"]);\n\n  var table = React.useContext(TableContext);\n  var tablelvl2 = React.useContext(Tablelvl2Context);\n  var isHeadCell = tablelvl2 && tablelvl2.variant === 'head';\n  var role;\n  var Component;\n\n  if (component) {\n    Component = component;\n    role = isHeadCell ? 'columnheader' : 'cell';\n  } else {\n    Component = isHeadCell ? 'th' : 'td';\n  }\n\n  var scope = scopeProp;\n\n  if (!scope && isHeadCell) {\n    scope = 'col';\n  }\n\n  var padding = paddingProp || (table && table.padding ? table.padding : 'default');\n  var size = sizeProp || (table && table.size ? table.size : 'medium');\n  var variant = variantProp || tablelvl2 && tablelvl2.variant;\n  var ariaSort = null;\n\n  if (sortDirection) {\n    ariaSort = sortDirection === 'asc' ? 'ascending' : 'descending';\n  }\n\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    ref: ref,\n    className: clsx(classes.root, classes[variant], className, align !== 'inherit' && classes[\"align\".concat(capitalize(align))], padding !== 'default' && classes[\"padding\".concat(capitalize(padding))], size !== 'medium' && classes[\"size\".concat(capitalize(size))], variant === 'head' && table && table.stickyHeader && classes.stickyHeader),\n    \"aria-sort\": ariaSort,\n    role: role,\n    scope: scope\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiTableCell'\n})(TableCell);","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\"\n}), 'Add');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z\"\n}), 'Delete');\n\nexports.default = _default;","import { CHANGE, SettingsCmd } from \"./constants\"\nimport { jdpack, jdunpack } from \"./pack\"\nimport Packet from \"./packet\"\nimport { InPipeReader } from \"./pipes\"\nimport { JDService } from \"./service\"\nimport { JDServiceClient } from \"./serviceclient\"\nimport { bufferToString, stringToBuffer } from \"./utils\"\n\nexport default class SettingsClient extends JDServiceClient {\n    constructor(service: JDService) {\n        super(service)\n        service.registersUseAcks = true\n    }\n\n    async clear() {\n        await this.service.sendCmdAsync(SettingsCmd.Clear)\n    }\n\n    async listKeys(): Promise<string[]> {\n        const inp = new InPipeReader(this.bus)\n        await this.service.sendPacketAsync(\n            inp.openCommand(SettingsCmd.ListKeys),\n            true\n        )\n        const { output } = await inp.readAll()\n        const keys = output.map(pkt => pkt.stringData)\n        return keys.filter(k => !!k)\n    }\n\n    async list(): Promise<{ key: string; value?: Uint8Array }[]> {\n        const inp = new InPipeReader(this.bus)\n        await this.service.sendPacketAsync(\n            inp.openCommand(SettingsCmd.List),\n            true\n        )\n        const { output } = await inp.readAll()\n        return output\n            .map(pkt => {\n                const [key, value] = pkt.jdunpack<[string, Uint8Array]>(\"z b\")\n                return key && { key, value }\n            })\n            .filter(kv => !!kv)\n    }\n\n    async setValue(key: string, value: Uint8Array) {\n        key = key.trim()\n        if (value === undefined) {\n            await this.deleteValue(key)\n        } else {\n            const pkt = Packet.from(\n                SettingsCmd.Set,\n                jdpack(\"z b\", [key, value])\n            )\n            await this.service.sendPacketAsync(pkt)\n            this.emit(CHANGE)\n        }\n    }\n\n    async setStringValue(key: string, value: string) {\n        await this.setValue(key, value ? stringToBuffer(value) : undefined)\n    }\n\n    async getValue(key: string): Promise<Uint8Array> {\n        if (!key) return undefined\n\n        key = key.trim()\n        const pkt = Packet.from(SettingsCmd.Get, jdpack(\"s\", [key]))\n        const resp = await this.service.sendCmdAwaitResponseAsync(pkt)\n        const [rkey, value] = jdunpack<[string, Uint8Array]>(resp.data, \"z b\")\n        if (key !== rkey) {\n            console.error(\n                `device returned different key, got \"${rkey}\", expected \"${key}\"`\n            )\n            return undefined\n        }\n        return value\n    }\n\n    async getStringValue(key: string) {\n        const value = await this.getValue(key)\n        return value && bufferToString(value)\n    }\n\n    async deleteValue(key: string) {\n        if (!key) return\n        key = key.trim()\n        const pkt = Packet.from(SettingsCmd.Delete, jdpack(\"s\", [key]))\n        await this.service.sendPacketAsync(pkt)\n\n        this.emit(CHANGE)\n    }\n}\n","import { useContext } from \"react\";\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\";\nimport useChange from '../../jacdac/useChange';\n\nexport default function useServices(options?: {\n    serviceName?: string\n    serviceClass?: number\n    specification?: boolean\n}) {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const services = useChange(bus, b => b.services(options), [\n        JSON.stringify(options),\n    ])\n    return services\n}","import { MenuItem } from \"@material-ui/core\"\nimport React, { ChangeEvent, useContext } from \"react\"\nimport { JDDevice } from \"../../../jacdac-ts/src/jdom/device\"\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\"\nimport SelectWithLabel from \"../ui/SelectWithLabel\"\n\nexport default function SelectDevice(props: {\n    devices: JDDevice[]\n    deviceId: string\n    onChange: (newDeviceId: string) => void\n}) {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const { devices, deviceId, onChange } = props\n\n    const handleDeviceChange = async (\n        ev: ChangeEvent<{ name?: string; value: unknown }>\n    ) => {\n        const id = ev.target.value as string\n        onChange(id)\n        const device = bus.node(id) as JDDevice\n        await device?.identify()\n    }\n    return (\n        <SelectWithLabel\n            helperText=\"choose a device\"\n            value={deviceId}\n            onChange={handleDeviceChange}\n            disabled={!devices?.length}\n        >\n            {devices?.map(dev => (\n                <MenuItem key={dev.id} value={dev.id}>\n                    {dev.describe()}\n                </MenuItem>\n            ))}\n        </SelectWithLabel>\n    )\n}\n","import React from \"react\"\nimport MenuItem from \"@material-ui/core/MenuItem\"\nimport { JDEvent } from \"../../../jacdac-ts/src/jdom/event\"\nimport SelectWithLabel from \"../ui/SelectWithLabel\"\n\nexport default function SelectEvent(props: {\n    events: JDEvent[]\n    eventId: string\n    onChange: (eventId: string) => void\n    friendlyName?: boolean,\n    label?: string\n}) {\n    const { events, eventId, onChange, friendlyName, label } = props\n\n    const handleChange = (ev: React.ChangeEvent<{ value: unknown }>) => {\n        onChange(ev.target.value as string)\n    }\n\n    return (\n        <SelectWithLabel\n            helperText={label || \"choose an event\"}\n            value={eventId}\n            onChange={handleChange}\n            disabled={!events?.length}\n        >\n            {events?.map(ev => (\n                <MenuItem key={ev.id} value={ev.id}>\n                    {friendlyName ? ev.friendlyName : ev.name}\n                </MenuItem>\n            ))}\n        </SelectWithLabel>\n    )\n}\n","import React, { useEffect, useRef } from \"react\"\nimport { createStyles, makeStyles } from \"@material-ui/core\"\nimport { HidKeyboardModifiers } from \"../../../jacdac-ts/jacdac-spec/dist/specconstants\"\nimport Keyboard from \"react-simple-keyboard\"\nimport \"react-simple-keyboard/build/css/index.css\"\n\nconst selectors = {\n    a: 0x04,\n    b: 0x05,\n    c: 0x06,\n    d: 0x07,\n    e: 0x08,\n    f: 0x09,\n    g: 0x0a,\n    h: 0x0b,\n    i: 0x0c,\n    j: 0x0d,\n    k: 0x0e,\n    l: 0x0f,\n    m: 0x10,\n    n: 0x11,\n    o: 0x12,\n    p: 0x13,\n    q: 0x14,\n    r: 0x15,\n    s: 0x16,\n    t: 0x17,\n    u: 0x18,\n    v: 0x19,\n    w: 0x1a,\n    x: 0x1b,\n    y: 0x1c,\n    z: 0x1d,\n\n    \"1\": 0x1e,\n    \"2\": 0x1f,\n    \"3\": 0x20,\n    \"4\": 0x21,\n    \"5\": 0x22,\n    \"6\": 0x23,\n    \"7\": 0x24,\n    \"8\": 0x25,\n    \"9\": 0x26,\n    \"0\": 0x27,\n\n    \"!\": 0x1e,\n    \"@\": 0x1f,\n    \"#\": 0x20,\n    $: 0x21,\n    \"%\": 0x22,\n    \"^\": 0x23,\n    \"&\": 0x24,\n    \"*\": 0x25,\n    \"(\": 0x26,\n    \")\": 0x27,\n\n    enter: 0x28,\n    escape: 0x29,\n    backspace: 0x2a,\n    tab: 0x2b,\n    \" \": 0x2c,\n    \"-\": 0x2d,\n    _: 0x2d,\n    \"=\": 0x2e,\n    \"+\": 0x2e,\n    \"[\": 0x2f,\n    \"{\": 0x2f,\n    \"]\": 0x30,\n    \"}\": 0x30,\n    \"\\\\\": 0x31,\n    \"|\": 0x31,\n    // non-US #\n    \"~\": 0x32,\n    \";\": 0x33,\n    \":\": 0x33,\n    \"'\": 0x34,\n    '\"': 0x34,\n    // grave accent tilde\n    \",\": 0x36,\n    \"<\": 0x37,\n    \".\": 0x37,\n    \">\": 0x37,\n    \"/\": 0x38,\n    \"?\": 0x38,\n    capslock: 0x39,\n    f1: 0x3a,\n    f2: 0x3b,\n    f3: 0x3c,\n    f4: 0x3d,\n    f5: 0x3e,\n    f6: 0x3f,\n    f7: 0x40,\n    f8: 0x41,\n    f9: 0x42,\n    f10: 0x43,\n    f11: 0x44,\n    f12: 0x45,\n    printscreen: 0x46,\n    scrolllock: 0x47,\n    pause: 0x48,\n    insert: 0x49,\n    home: 0x4a,\n    pageup: 0x4b,\n    delete: 0x4c,\n    end: 0x4d,\n    pagedown: 0x4e,\n    arrowright: 0x4f,\n    arrowleft: 0x50,\n    arrowdown: 0x51,\n    arrowup: 0x52,\n    numlock: 0x53,\n    numpaddivide: 0x54,\n    numpadmultiply: 0x55,\n    numpadsubstract: 0x56,\n    numpadadd: 0x57,\n    numpadenter: 0x58,\n    numpad1: 0x59,\n    numpad2: 0x5a,\n    numpad3: 0x5b,\n    numpad4: 0x5c,\n    numpad5: 0x5d,\n    numpad6: 0x5e,\n    numpad7: 0x5f,\n    numpad8: 0x60,\n    numpad9: 0x61,\n    numpad0: 0x62,\n    numpaddecimal: 0x63,\n    numpadequal: 0x67,\n    f13: 0x68,\n    f14: 0x69,\n    f15: 0x6a,\n    f16: 0x6b,\n    f17: 0x6c,\n    f18: 0x6d,\n    f19: 0x6e,\n    f20: 0x6f,\n    f21: 0x70,\n    f22: 0x71,\n    f23: 0x72,\n    f24: 0x73,\n    execute: 0x74,\n    help: 0x75,\n    contextmenu: 0x76,\n    select: 0x77,\n    stop: 0x78,\n    again: 0x79,\n    undo: 0x7a,\n    cut: 0x7b,\n    copy: 0x7c,\n    paste: 0x7d,\n    find: 0x7e,\n    mute: 0x7f,\n    volumeup: 0x80,\n    volumedown: 0x81,\n\n    numpadcomma: 0x85,\n}\nconst reverseSelectors: { [index: number]: string } = Object.keys(\n    selectors\n).reduce((r, key) => {\n    if (!r[selectors[key]]) r[selectors[key]] = key\n    return r\n}, {})\nconst modifierCodes = {\n    controlleft: HidKeyboardModifiers.LeftControl,\n    altleft: HidKeyboardModifiers.LeftAlt,\n    shiftleft: HidKeyboardModifiers.LeftShift,\n    metaleft: HidKeyboardModifiers.LeftGUI,\n\n    controlright: HidKeyboardModifiers.RightControl,\n    altright: HidKeyboardModifiers.RightAlt,\n    shiftright: HidKeyboardModifiers.RightShift,\n    metaright: HidKeyboardModifiers.RightGUI,\n}\n\nconst useStyles = makeStyles(theme =>\n    createStyles({\n        capture: {\n            cursor: \"pointer\",\n            \"&:hover\": {\n                borderColor: theme.palette.primary.main,\n            },\n            \"&:focus\": {\n                borderColor: theme.palette.action.active,\n            },\n        },\n        buttonSelected: {\n            background: `${theme.palette.primary.dark} !important`,\n            color: \"white !important\",\n        },\n    })\n)\n\nexport function renderKey(selector: number, modifiers: HidKeyboardModifiers) {\n    const flags = [\n        \"controlleft\",\n        \"shiftleft\",\n        \"altleft\",\n        \"metaleft\",\n        \"controlright\",\n        \"shiftright\",\n        \"altright\",\n        \"metaright\",\n    ]\n    const values = []\n    flags.forEach((flag, i) => {\n        if (modifiers & (1 << i)) {\n            values.push(`{${flag}}`)\n        }\n    })\n    const sel = reverseSelectors[selector]\n    if (sel !== undefined) values.push(sel.length > 1 ? `{${sel}}` : sel)\n    const value = values.filter(v => !!v).join(\" \")\n    return value\n}\n\nexport default function KeyboardKeyInput(props: {\n    selector: number\n    modifiers: HidKeyboardModifiers\n    onChange: (newSelector: number, newModifiers: HidKeyboardModifiers) => void\n}) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const keyboardRef = useRef<any>()\n    const { selector, modifiers, onChange } = props\n    const classes = useStyles()\n\n    const layout = {\n        default: [\n            \"{escape} {f1} {f2} {f3} {f4} {f5} {f6} {f7} {f8} {f9} {f10} {f11} {f12}\",\n            \"` 1 2 3 4 5 6 7 8 9 0 - = {backspace}\",\n            \"{tab} q w e r t y u i o p [ ] \\\\\",\n            \"{capslock} a s d f g h j k l ; ' {enter}\",\n            \"{shiftleft} z x c v b n m , . / {shiftright}\",\n            \"{controlleft} {altleft} {metaleft} {space} {metaright} {altright}\",\n        ],\n    }\n    const display = {\n        \"{escape}\": \"esc ⎋\",\n        \"{tab}\": \"tab ⇥\",\n        \"{backspace}\": \"backspace ⌫\",\n        \"{enter}\": \"enter ↵\",\n        \"{capslock}\": \"caps lock ⇪\",\n        \"{shiftleft}\": \"shift ⇧\",\n        \"{shiftright}\": \"shift ⇧\",\n        \"{controlleft}\": \"ctrl ⌃\",\n        \"{controlright}\": \"ctrl ⌃\",\n        \"{altleft}\": \"alt ⌥\",\n        \"{altright}\": \"alt ⌥\",\n        \"{metaleft}\": \"cmd ⌘\",\n        \"{metaright}\": \"cmd ⌘\",\n    }\n    const handleKeyboardKeyPress = (code: string) => {\n        code = code.toLowerCase().replace(/[{}]/g, \"\")\n        let newSelector = selector\n        let newModifiers = modifiers\n        const msel = selectors[code]\n        const mcode = modifierCodes[code]\n        if (msel) {\n            if (msel === selector) newSelector = undefined\n            else newSelector = msel\n        } else {\n            if (mcode) {\n                if (newModifiers & mcode) newModifiers &= ~mcode\n                else newModifiers |= mcode\n            }\n        }\n        onChange(newSelector, newModifiers)\n    }\n\n    // todo: render value to simple-keyboard selectors\n    const value = renderKey(selector, modifiers)\n    useEffect(() => {\n        keyboardRef.current?.addButtonTheme(value, classes.buttonSelected)\n        return () =>\n            keyboardRef.current?.removeButtonTheme(\n                value,\n                classes.buttonSelected\n            )\n    }, [value])\n\n    return (\n        <Keyboard\n            keyboardRef={r => (keyboardRef.current = r)}\n            onKeyPress={handleKeyboardKeyPress}\n            layout={layout}\n            display={display}\n            mergeDisplay={true}\n        />\n    )\n}\n","import {\n    FormControl,\n    FormHelperText,\n    InputLabel,\n    MenuItem,\n    Select,\n} from \"@material-ui/core\"\nimport React, { ChangeEvent, ReactNode } from \"react\"\nimport { useId } from \"react-use-id-hook\"\n\nexport default function SelectWithLabel(props: {\n    required?: boolean\n    label?: string\n    disabled?: boolean\n    error?: string\n    value?: string\n    placeholder?: string\n    type?: string\n    fullWidth?: boolean\n    onChange?: (ev: ChangeEvent<{ name?: string; value: unknown }>) => void\n    onClose?: (ev: ChangeEvent<unknown>) => void\n    helperText?: string\n    children?: ReactNode\n    none?: ReactNode\n}) {\n    const {\n        label,\n        fullWidth,\n        required,\n        disabled,\n        value,\n        error,\n        placeholder,\n        onChange,\n        onClose,\n        children,\n        helperText,\n        type,\n        none,\n    } = props\n    const labelId = useId()\n    const descrId = useId()\n    const hasDescr = !!helperText || !!error\n\n    return (\n        <FormControl fullWidth={fullWidth} variant=\"outlined\">\n            <InputLabel id={labelId} key=\"label\">\n                {required ? `${label} *` : label}\n            </InputLabel>\n            <Select\n                disabled={disabled}\n                label={label}\n                value={value}\n                error={!!error}\n                fullWidth={true}\n                placeholder={placeholder}\n                type={type}\n                labelId={labelId}\n                aria-describedby={hasDescr ? descrId : undefined}\n                onChange={onChange}\n                onClose={onClose}\n            >\n                {none && (\n                    <MenuItem key={\"none\"} value={\"\"}>\n                        {none}\n                    </MenuItem>\n                )}\n                {children}\n            </Select>\n            {hasDescr && (\n                <FormHelperText id={descrId}>\n                    {error || helperText}\n                </FormHelperText>\n            )}\n        </FormControl>\n    )\n}\n","import { useEffect, useState } from \"react\"\nimport { JDService } from \"../../jacdac-ts/src/jdom/service\"\nimport { JDServiceClient } from \"../../jacdac-ts/src/jdom/serviceclient\"\n\nexport default function useServiceClient<T extends JDServiceClient>(service: JDService, factory: (service: JDService) => T, deps: React.DependencyList = []) {\n    const [client, setClient] = useState<T>(undefined)\n\n    useEffect(() => {\n        const c = service && factory(service)\n        setClient(c)\n        return () => c?.unmount()\n    }, [service, ...deps]) // don't use factory in cache!\n\n    return client;\n}","import { MenuItem } from \"@material-ui/core\"\nimport React, { ChangeEvent } from \"react\"\nimport { JDService } from \"../../../jacdac-ts/src/jdom/service\"\nimport SelectWithLabel from \"../ui/SelectWithLabel\"\n\nexport default function SelectService(props: {\n    services: JDService[]\n    serviceId: string\n    onChange: (newServiceId: string) => void\n    friendlyName?: boolean\n    helperText?: string\n}) {\n    const { services, serviceId, onChange, helperText, friendlyName } = props\n\n    const handleChange = async (\n        ev: ChangeEvent<{ name?: string; value: unknown }>\n    ) => {\n        const id = ev.target.value as string\n        onChange(id)\n    }\n    return (\n        <SelectWithLabel\n            helperText={helperText || \"choose a service\"}\n            value={serviceId}\n            onChange={handleChange}\n            disabled={!services?.length}\n        >\n            {services?.map(srv => (\n                <MenuItem key={srv.id} value={srv.id}>\n                    {friendlyName\n                        ? srv.friendlyName\n                        : srv.instanceName || srv.name}\n                </MenuItem>\n            ))}\n        </SelectWithLabel>\n    )\n}\n","import React, { useContext, useState } from \"react\"\nimport SelectEvent from \"../../components/select/SelectEvent\"\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\"\nimport useDevices from \"../../components/hooks/useDevices\"\nimport SelectDevice from \"../../components/select/SelectDevice\"\nimport {\n    Grid,\n    Table,\n    TableBody,\n    TableCell,\n    TableHead,\n    TableRow,\n} from \"@material-ui/core\"\nimport { JDDevice } from \"../../../jacdac-ts/src/jdom/device\"\nimport useChange from \"../../jacdac/useChange\"\nimport SelectService from \"../../components/select/SelectService\"\nimport { JDService } from \"../../../jacdac-ts/src/jdom/service\"\nimport {\n    HidKeyboardModifiers,\n    SRV_CONTROL,\n    SRV_LOGGER,\n    SRV_PROTO_TEST,\n    SRV_ROLE_MANAGER,\n    SRV_SETTINGS,\n    SystemEvent,\n} from \"../../../jacdac-ts/src/jdom/constants\"\nimport { JDEvent } from \"../../../jacdac-ts/src/jdom/event\"\nimport KeyboardKeyInput, {\n    renderKey,\n} from \"../../components/ui/KeyboardKeyInput\"\nimport IconButtonWithTooltip from \"../../components/ui/IconButtonWithTooltip\"\nimport AddIcon from \"@material-ui/icons/Add\"\nimport DeleteIcon from \"@material-ui/icons/Delete\"\nimport SettingsClient from \"../../../jacdac-ts/src/jdom/settingsclient\"\nimport useServiceClient from \"../../components/useServiceClient\"\nimport { fromHex, toHex } from \"../../../jacdac-ts/src/jdom/utils\"\nimport { jdpack, jdunpack } from \"../../../jacdac-ts/src/jdom/pack\"\nimport { randomDeviceId } from \"../../../jacdac-ts/src/jdom/random\"\nimport { JDBus } from \"../../../jacdac-ts/src/jdom/bus\"\nimport useServices from \"../../components/hooks/useServices\"\n\n// all settings keys are prefixed with this string\nconst PREFIX = \"@ke_\"\n// data layout format (18bytes)\nconst FORMAT = \"b[8] u32 u8 u8 u16 u16\"\n// data layout types\ntype FORMAT_TYPE = [Uint8Array, number, number, number, number, number]\n\ninterface HIDEvent {\n    key?: string\n    eventId: string\n    selector: number\n    modifiers: HidKeyboardModifiers\n}\n\nfunction HIDEventToBuffer(event: JDEvent, ev: HIDEvent) {\n    const deviceId = fromHex(event.service.device.deviceId)\n    const { service, code } = event\n    const { serviceClass, serviceIndex } = service\n    const { selector, modifiers } = ev\n    const payload = jdpack<FORMAT_TYPE>(FORMAT, [\n        deviceId,\n        serviceClass,\n        serviceIndex,\n        code,\n        selector,\n        modifiers,\n    ])\n    return payload\n}\n\nfunction bufferToHIDEvent(key: string, data: Uint8Array, bus: JDBus): HIDEvent {\n    if (data?.length !== 18) return undefined\n    const [\n        deviceId,\n        serviceClass,\n        serviceIndex,\n        eventCode,\n        selector,\n        modifiers,\n    ] = jdunpack<FORMAT_TYPE>(data, FORMAT)\n    const deviceIds = toHex(deviceId)\n    const device = bus.device(deviceIds, true)\n    const event = device?.service(serviceIndex)?.event(eventCode)\n\n    if (!event || event.service.serviceClass !== serviceClass) return undefined\n    return {\n        key,\n        eventId: event.id,\n        selector,\n        modifiers,\n    }\n}\n\nfunction SelectHIDEvent(props: { onAdd: (hidEvent: HIDEvent) => void }) {\n    const { onAdd } = props\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const [deviceId, setDeviceId] = useState(\"\")\n    const [serviceId, setServiceId] = useState(\"\")\n    const [eventId, setEventId] = useState(\"\")\n    const [selector, setSelector] = useState(0)\n    const [modifiers, setModifiers] = useState(HidKeyboardModifiers.None)\n\n    const excludedServices = [\n        SRV_CONTROL,\n        SRV_PROTO_TEST,\n        SRV_ROLE_MANAGER,\n        SRV_SETTINGS,\n        SRV_LOGGER,\n    ]\n    const eventFilter = (ev: JDEvent) =>\n        ev.code !== SystemEvent.StatusCodeChanged\n    const devices = useDevices({ ignoreSelf: true })\n    const device = bus.node(deviceId) as JDDevice\n    const services = useChange(device, _ =>\n        _?.services({ specification: true })\n            .filter(srv => excludedServices.indexOf(srv.serviceClass) < 0)\n            .filter(srv => srv.events.some(eventFilter))\n    )\n    const service = bus.node(serviceId) as JDService\n    const events = useChange(service, _ => _?.events.filter(eventFilter))\n\n    const handleDeviceChange = (deviceId: string) => {\n        setDeviceId(deviceId)\n        setServiceId(\"\")\n        setEventId(\"\")\n    }\n    const handleServiceChange = (serviceId: string) => {\n        setServiceId(serviceId)\n        setEventId(\"\")\n    }\n    const handleEventChange = (id: string) => setEventId(id)\n    const handleKeyChange = (\n        newSelector: number,\n        newModifiers: HidKeyboardModifiers\n    ) => {\n        setSelector(newSelector)\n        setModifiers(newModifiers)\n    }\n    const disabled = !eventId || !selector\n    const handleAdd = () => {\n        onAdd({ eventId, selector, modifiers })\n    }\n\n    return (\n        <Grid container spacing={1}>\n            <Grid item>\n                <SelectDevice\n                    devices={devices}\n                    deviceId={deviceId}\n                    onChange={handleDeviceChange}\n                />\n            </Grid>\n            <Grid item>\n                <SelectService\n                    services={services}\n                    serviceId={serviceId}\n                    onChange={handleServiceChange}\n                />\n            </Grid>\n            <Grid item>\n                <SelectEvent\n                    events={events}\n                    eventId={eventId}\n                    onChange={handleEventChange}\n                />\n            </Grid>\n            <Grid item xs>\n                <KeyboardKeyInput\n                    selector={selector}\n                    modifiers={modifiers}\n                    onChange={handleKeyChange}\n                />\n            </Grid>\n            <Grid item>\n                <IconButtonWithTooltip\n                    title={\"Add binding\"}\n                    disabled={disabled}\n                    onClick={handleAdd}\n                >\n                    <AddIcon />\n                </IconButtonWithTooltip>\n            </Grid>\n        </Grid>\n    )\n}\n\nexport default function HIDEvents() {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const services = useServices({ serviceClass: SRV_SETTINGS })\n    const [settingsService, setSettingsService] = useState<JDService>()\n    const [hidEvents, setHIDEvents] = useState<HIDEvent[]>([])\n\n    const settings = useServiceClient(\n        settingsService,\n        srv => new SettingsClient(srv)\n    )\n    useChange(settings, async () => {\n        const hes: HIDEvent[] = []\n        if (settings) {\n            const all = await settings.list()\n            for (const kv of all.filter(entry =>\n                entry.key?.startsWith(PREFIX)\n            )) {\n                const { key, value } = kv\n                const he = bufferToHIDEvent(key, value, bus)\n                if (he) hes.push(he)\n            }\n        }\n        if (JSON.stringify(hes) !== JSON.stringify(hidEvents)) setHIDEvents(hes)\n    })\n    const handleAdd = async (hidEvent: HIDEvent) => {\n        const event = bus.node(hidEvent.eventId) as JDEvent\n        if (!event) return\n\n        const payload = HIDEventToBuffer(event, hidEvent)\n        settings.setValue(PREFIX + randomDeviceId(), payload)\n    }\n    const handleRemoveBinding = (index: number) => () => {\n        const { key } = hidEvents[index]\n        if (key) settings.deleteValue(key)\n    }\n    const handleSelectHub = (newServiceId: string) =>\n        setSettingsService(bus.node(newServiceId) as JDService)\n    return (\n        <>\n            <h1>Map events to Keyboard combos</h1>\n            <Grid container spacing={1}>\n                <Grid item xs={12}>\n                    <SelectService\n                        helperText=\"choose a hub\"\n                        friendlyName={true}\n                        services={services}\n                        serviceId={settingsService?.id}\n                        onChange={handleSelectHub}\n                    />\n                </Grid>\n                {settings && (\n                    <Grid item xs={12}>\n                        <SelectHIDEvent onAdd={handleAdd} />\n                    </Grid>\n                )}\n\n                {settings && (\n                    <Grid item>\n                        <Table>\n                            <TableHead>\n                                <TableRow>\n                                    <TableCell>Device</TableCell>\n                                    <TableCell>Service</TableCell>\n                                    <TableCell>Event</TableCell>\n                                    <TableCell>Key</TableCell>\n                                    <TableCell />\n                                </TableRow>\n                            </TableHead>\n                            <TableBody>\n                                {hidEvents.map(\n                                    (\n                                        { eventId, selector, modifiers },\n                                        index\n                                    ) => {\n                                        const event = bus.node(\n                                            eventId\n                                        ) as JDEvent\n                                        return (\n                                            <TableRow key={index}>\n                                                <TableCell>\n                                                    {\n                                                        event.service.device\n                                                            .friendlyName\n                                                    }\n                                                </TableCell>\n                                                <TableCell>\n                                                    {event.service.name}\n                                                </TableCell>\n                                                <TableCell>\n                                                    {event.name}\n                                                </TableCell>\n                                                <TableCell>\n                                                    <code>\n                                                        {renderKey(\n                                                            selector,\n                                                            modifiers\n                                                        )}\n                                                    </code>\n                                                </TableCell>\n                                                <TableCell>\n                                                    <IconButtonWithTooltip\n                                                        title={\"Remove binding\"}\n                                                        onClick={handleRemoveBinding(\n                                                            index\n                                                        )}\n                                                    >\n                                                        <DeleteIcon />\n                                                    </IconButtonWithTooltip>\n                                                </TableCell>\n                                            </TableRow>\n                                        )\n                                    }\n                                )}\n                            </TableBody>\n                        </Table>\n                    </Grid>\n                )}\n            </Grid>\n        </>\n    )\n}\n"],"sourceRoot":""}