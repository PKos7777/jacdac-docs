{"version":3,"sources":["webpack://jacdac-docs/./node_modules/@material-ui/core/esm/internal/svg-icons/Cancel.js","webpack://jacdac-docs/./node_modules/@material-ui/core/esm/Chip/Chip.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/BugReport.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/Cancel.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/OpenInBrowser.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/Pause.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/PlayArrow.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/PlayForWork.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/Save.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/Stop.js","webpack://jacdac-docs/./node_modules/core-js/internals/add-to-unscopables.js","webpack://jacdac-docs/./node_modules/core-js/internals/array-species-create.js","webpack://jacdac-docs/./node_modules/core-js/internals/flatten-into-array.js","webpack://jacdac-docs/./node_modules/core-js/internals/function-bind-context.js","webpack://jacdac-docs/./node_modules/core-js/internals/html.js","webpack://jacdac-docs/./node_modules/core-js/internals/is-array.js","webpack://jacdac-docs/./node_modules/core-js/internals/object-create.js","webpack://jacdac-docs/./node_modules/core-js/internals/object-define-properties.js","webpack://jacdac-docs/./node_modules/core-js/internals/object-keys.js","webpack://jacdac-docs/./node_modules/core-js/internals/to-object.js","webpack://jacdac-docs/./node_modules/core-js/modules/es.array.flat-map.js","webpack://jacdac-docs/./node_modules/core-js/modules/es.array.unscopables.flat-map.js","webpack://jacdac-docs/./jacdac-ts/src/azure-iot/dtdl.ts","webpack://jacdac-docs/./src/components/ImportButton.tsx","webpack://jacdac-docs/./jacdac-ts/src/vm/ir.ts","webpack://jacdac-docs/./jacdac-ts/src/vm/compile.ts","webpack://jacdac-docs/./jacdac-ts/src/vm/runner.ts","webpack://jacdac-docs/./src/components/vm/useVMRunner.ts","webpack://jacdac-docs/./src/components/vm/VMDiagnostics.tsx","webpack://jacdac-docs/./src/components/blockly/BlockRoles.tsx","webpack://jacdac-docs/./src/components/vm/VMRunnerButtons.tsx","webpack://jacdac-docs/./src/components/vm/VMStartSimulatorButton.tsx","webpack://jacdac-docs/./src/components/blockly/BlockFileButtons.tsx","webpack://jacdac-docs/./src/components/vm/VMToolbar.tsx","webpack://jacdac-docs/./src/components/vm/VMgenerator.ts","webpack://jacdac-docs/./src/components/blockly/dsl/servicesdsl.ts","webpack://jacdac-docs/./src/components/blockly/dsl/azureiothubdsl.ts","webpack://jacdac-docs/./src/components/blockly/dsl/devicetwindsl.ts","webpack://jacdac-docs/./src/components/blockly/dsl/toolsdsl.ts","webpack://jacdac-docs/./src/components/blockly/dsl/loopsdsl.ts","webpack://jacdac-docs/./src/components/blockly/dsl/logicdsl.ts","webpack://jacdac-docs/./src/components/blockly/dsl/mathdsl.ts","webpack://jacdac-docs/./src/components/vm/VMEditor.tsx","webpack://jacdac-docs/./src/pages/tools/vm-editor.tsx"],"names":["DTDL_REFERENCE_URL","DTDL_NAME","DTDL_CONTEXT","objectSchema","schemas","fields","arraySchema","schema","elementSchema","escapeName","name","trim","replace","test","toLowerCase","slice","escapeDisplayName","DTDLUnits","sort","DropzoneDialog","lazy","ImportButton","props","text","onFilesUploaded","disabled","acceptedFiles","icon","filesLimit","className","useState","open","setOpen","handleOpen","handleSave","files","length","handleClose","VMFunctions","id","args","prompt","context","toIdentifier","type","toMemberExpression","root","field","object","property","computed","handlerVisitor","handler","visitITE","visitCommand","commands","forEach","visitBase","base","ite","else","then","compileProgram","prog","newProgram","roles","handlers","map","h","removeIfThenElse","errors","newSequence","labels","labelId","time","end","push","command","callee","arguments","expr","assert","pop","cmd","getServiceFromRole","info","role","shortId","find","pair","def","serviceSpecificationFromName","serviceShortId","service","checkProgram","allErrors","goodHandlers","errorFun","e","sourceId","undefined","message","symbolResolver","SpecSymbolResolver","checker","VMChecker","_","errorCount","c","checkCommand","registers","s","split","fld","register","events","event","VMInternalStatus","VM_WAKE_SLEEPER","VMJumpException","label","Error","VMTimerException","ms","VMCommandEvaluator","parent","env","gc","_regSaved","_changeSaved","_started","trace","msg","evalExpression","VMExprEvaluator","lookup","eval","checkExpression","start","inst","evaluate","neededStart","Running","values","a","sendCommandAsync","Completed","hasEvent","regValue","ev","unparse","reg","writeRegisterAsync","writeLocal","watch","Stopped","VMError","VMCode","VMCommandRunner","handlerId","_status","_eval","val","stepAsync","status","VMHandlerRunner","_commandIndex","_currentCommand","stopped","_labelToIndex","index","reset","gotoTop","Ready","commandIndex","cancel","unsubscribe","wake","next","runToCompletionAsync","singleStep","singleStepCheckBreakAsync","getCommand","sid","breakpointOnAsync","singleStepAsync","emit","VM_EVENT","vmt","Sleeping","sleepAsync","JDEventSource","isEveryHandler","VMStatus","VMProgramRunner","bus","roleManager","program","_handlerRunners","_roles","_waitQueue","_everyQueue","_runQueue","_sleepQueue","_watch","_breaks","_in_run","compiled","console","warn","_env","VMEnvironment","_waitRunMutex","Mutex","_breaksMutex","_sleepMutex","mount","subscribe","CHANGE","waitingToRunning","wakeSleeper","initializeRoleManagement","setStatus","TRACE","value","oldValue","lookupWatch","setBreakpointsAsync","breaks","acquire","b","clearBreakpointsAsync","ret","handlerRunner","setTimeout","findIndex","p","splice","runAsync","debug","startAsync","setRoles","resumeAsync","Paused","getCurrentRunner","runHandlerAsync","postProcessHandler","newHead","emitBreakpoint","oneStep","brkCommand","VMRoleNoServiceException","moveToWait","done","shift","refreshRegistersAsync","atTop","waitCopy","handlersStarted","newRunners","sleepingRunners","hs","indexOf","consumeEvent","addRoleService","getService","serviceChanged","r","rv","ROLE_BOUND","ROLE_UNBOUND","JDClient","useVMRunner","autoRun","useContext","JacdacContext","AppContext","setError","runner","setRunner","_autoStart","_setAutoStart","run","useEffect","newTestRunner","unmount","ERROR","handleTrace","Flags","VMDiagnostics","JSON","stringify","RoleChip","BlockContext","workspace","server","useServiceServer","handleRoleClick","specification","addServiceProvider","serviceProviderDefinitionFromServiceClass","classIdentifier","twinBlock","getTopBlocks","TWIN_BLOCK","inputList","fieldRow","f","getVariable","newBlock","variable","setValue","getId","m","getMetrics","moveBy","viewWidth","viewHeight","initSvg","render","centerOnBlock","handleDelete","removeServiceProvider","device","BlockRoles","useChange","useWorkspaceBreakpoints","breakpoints","useMemo","arrayConcatMany","filter","meta","setBreakpointHighlight","highlightBlock","VMRunnerButtons","t","indeterminate","setIndeterminate","breakpoint","setBreakpoint","pausing","paused","mounted","useMounted","handleRun","handleCancel","handleResume","handlePause","handleStep","code","VMStartSimulatorButton","toggleShowDeviceHostsDialog","LoadButton","handleFiles","file","jsfile","parse","xml","dom","Xml","clear","SaveButton","workspaceXml","json","url","encodeURIComponent","BlockFileButtons","VMToolbar","ops","AND","OR","EQ","NEQ","LT","GT","LTE","GTE","NEG","ADD","MULTIPLY","DIVIDE","MINUS","makeVMBase","block","processErrors","workspaceJSONToVMProgram","dsls","variables","v","BUILTIN_TYPES","EmptyExpression","blockToExpression","blockIn","blockToExpressionInner","inputs","log","raw","argument","child","op","operator","prefix","left","right","definition","resolveServiceBlockDefinition","d","Blockly","dslName","dsl","res","compileExpressionToVM","template","blockToCommand","thenHandler","elseHandler","addCommands","children","exprErrors","ifThenElse","concat","dslRes","compileCommandToVM","nop","blocks","top","topEvent","topErrors","topMeta","compileEventToVM","expression","isBooleanField","isStringField","toBlocklyType","isNumericType","enumInfo","srv","enums","ignoredServices","SRV_CONTROL","SRV_LOGGER","SRV_ROLE_MANAGER","SRV_PROTO_TEST","SRV_SETTINGS","SRV_BOOTLOADER","ignoredEvents","SystemEvent","includedRegisters","SystemReg","customMessages","SRV_JOYSTICK","JoystickReg","get","commandColor","ServicesBlockDomainSpecificLanguage","supportedServices","createServiceColor","theme","sensorColor","palette","success","main","otherColor","serviceColor","isSensor","createBlocks","options","customShadows","serviceClass","SRV_SERVO","kind","identifier","ServoReg","shadow","ServoAngleField","SRV_BUZZER","BuzzerCmd","NoteField","lookupCustomShadow","cs","serviceHelp","withPrefix","fieldsSupported","pkt","every","fieldName","fieldToShadow","unit","defaultValue","min","typicalMin","absoluteMin","max","typicalMax","absoluteMax","variableName","humanify","camelName","fieldVariable","variableTypes","defaultType","fieldsToFieldInputs","check","fieldsToValues","toMap","fieldsToMessage","i","join","isEnabledRegister","customMessage","allServices","serviceSpecifications","resolveService","cls","packets","isRegister","lowLevel","isEvent","kv","isCommand","customBlockDefinitions","SRV_HID_KEYBOARD","message0","args0","KeyboardKeyField","colour","inputsInline","previousStatement","CODE_STATEMENT_TYPE","nextStatement","tooltip","helpUrl","SRV_LED","color","LEDColorField","speed","SRV_SEVEN_SEGMENT_DISPLAY","digits","SRV_LED_MATRIX","LEDMatrixField","eventBlocks","registerChangeByEventBlocks","some","splitFilter","registerSimples","registerComposites","registerSimpleTypes","registerSimpleOthers","registerSimplesGetBlocks","output","description","registerSimpleEnumTypes","einfo","registerCompositeEnumTypes","registerEnumGetBlocks","Object","keys","members","member","registerNumericsGetBlocks","re","registerSetBlocks","commandBlocks","_serviceBlocks","_eventFieldBlocks","_runtimeBlocks","CONNECTION_BLOCK","CONNECTED_BLOCK","SET_STATUS_LIGHT_BLOCK","createCategory","source","liveServices","blockServices","usedEvents","Set","eventName","jdBlocks","services","uniqueMap","toolboxServices","srvid","l","localeCompare","servicesCategories","serviceBlocks","contents","has","button","callbackKey","cat","commonCategory","toString","eventInfo","serviceCommand","exprsErrors","flatMap","servicesDSL","AzureIoTHubBlockDomainSpecificLanguage","_blocks","PRIMITIVE_TYPES","azureIoTHubDSL","DEVICE_TWIN_SEND_TELEMETRY","DEVICE_TWIN_DEFINITION_BLOCK","DEVICE_TWIN_PROPERTY_BLOCK","DEVICE_TWIN_PROPERTY_TYPE","DEVICE_TWIN_VALUE_TYPE","deviceTwinContentType","deviceTwinCommonOptionType","deviceTwinPropertyOptionType","deviceTwinStatementType","deviceTwinCommonOptionStatementType","deviceTwinPropertyOptionStatementType","DeviceTwinBlockDomainSpecificLanguage","deviceTwinDSL","toolsDSL","TwinField","INSPECT_BLOCK","JDomTreeField","WATCH_BLOCK","WatchValueField","loopsDsl","WAIT_BLOCK","REPEAT_EVERY_BLOCK","order","interval","logicDsl","A","B","BOOL","mathDSL","style","extensions","NUM","VM_SOURCE_STORAGE_KEY","VMEditorWithContext","workspaceJSON","setProgram","autoStart","error","ws","jacdacServices","VMEditor","variablesDsl","shadowDsl","fieldsDsl","Page"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAA+B;AACuB;AACtD;AACA;AACA;;AAEA,2CAAe,gCAAa,eAAe,mBAAmB;AAC9D;AACA,CAAC,YAAY,E;;;;;;;;;;;;ACR6C;AACgC;AAC3D;AACP;AAC8B;AACR;AACe;AAChB;AACU;AACV;AACN;AAChC;AACP;AACA,wBAAwB,iCAAI;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL,8DAA8D,KAAK;AACnE,gBAAgB;;AAEhB,iFAAiF,KAAK;AACtF;AACA;AACA;AACA;AACA;AACA,yBAAyB,sCAAS;AAClC,OAAO;AACP;AACA;AACA;AACA,KAAK;;AAEL,uGAAuG,KAAK;AAC5G;AACA;AACA,yBAAyB,sCAAS;AAClC;AACA,KAAK;;AAEL,yGAAyG,KAAK;AAC9G;AACA;AACA,yBAAyB,sCAAS;AAClC;AACA,KAAK;;AAEL;AACA;AACA;AACA,yBAAyB,sCAAS;AAClC;AACA,KAAK;;AAEL;AACA;AACA;AACA,yBAAyB,sCAAS;AAClC;AACA,KAAK;;AAEL;AACA;AACA;AACA,yBAAyB,sCAAS;AAClC;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,yBAAyB,iCAAI;AAC7B,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,yBAAyB,iCAAI;AAC7B;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,yBAAyB,iCAAI;AAC7B;AACA,KAAK;AACL;;AAEA;AACA,cAAc;;AAEd;AACA,mBAAmB;;AAEnB;AACA,0BAA0B;;AAE1B;AACA,4BAA4B;;AAE5B;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,iCAAI;AACnB;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,aAAa,iCAAI;AACjB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,aAAa,iCAAI;AACjB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,aAAa,iCAAI;AACjB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,aAAa,iCAAI;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA,wBAAwB,gBAAgB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,0CAAwB;;AAEtC,gBAAgB,YAAY;AAC5B,kBAAkB,6BAAU;;AAE5B;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,gDAAgD,yBAAU;AAC1D,gCAAgC,yBAAU;AAC1C;AACA,GAAG;AACH;;AAEA;AACA,wBAAwB,yBAAI,kFAAkF,6BAAU,qDAAqD,6BAAU;AACvL,gDAAgD,oBAAoB,gCAAgC,kBAAkB;AACtH,iBAAiB,yBAAI;AACrB;AACA,KAAK,iBAAiB,mBAAmB,CAAC,MAAU;AACpD,iBAAiB,yBAAI;AACrB;AACA,KAAK;AACL;;AAEA;;AAEA,iCAAiC,oBAAoB;AACrD,0BAA0B,kBAAkB;AAC5C,iBAAiB,yBAAI,+HAA+H,6BAAU;AAC9J,KAAK;AACL;;AAEA;;AAEA,+BAA+B,oBAAoB;AACnD,wBAAwB,kBAAkB;AAC1C,iBAAiB,yBAAI,uHAAuH,6BAAU;AACtJ,KAAK;AACL;;AAEA,MAAM,KAAqC,EAAE,EAI1C;;AAEH,sBAAsB,mBAAmB,YAAY,8BAAQ;AAC7D;AACA,eAAe,yBAAI,yEAAyE,6BAAU,wDAAwD,6BAAU,uDAAuD,6BAAU;AACzO;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,kDAAkD,mBAAmB;AACxE,eAAe,yBAAI;AACnB,GAAG;AACH,CAAC;AACD,MAAqC,GAAG,CAAM;AAC9C,8CAAe,6BAAU;AACzB;AACA,CAAC,OAAO,E;;;;;;;;;ACpaK;;AAEb,6BAA6B,mBAAO,CAAC,IAA8C;;AAEnF,8BAA8B,mBAAO,CAAC,IAA+C;;AAErF,6BAA6C;AAC7C;AACA,CAAC,CAAC;AACF,SAAe;;AAEf,oCAAoC,mBAAO,CAAC,KAAO;;AAEnD,4CAA4C,mBAAO,CAAC,KAAuB;;AAE3E;AACA;AACA,CAAC;;AAED,SAAe,Y;;;;;;;;;ACnBF;;AAEb,6BAA6B,mBAAO,CAAC,IAA8C;;AAEnF,8BAA8B,mBAAO,CAAC,IAA+C;;AAErF,6BAA6C;AAC7C;AACA,CAAC,CAAC;AACF,SAAe;;AAEf,oCAAoC,mBAAO,CAAC,KAAO;;AAEnD,4CAA4C,mBAAO,CAAC,KAAuB;;AAE3E;AACA;AACA,CAAC;;AAED,SAAe,Y;;;;;;;;;ACnBF;;AAEb,6BAA6B,mBAAO,CAAC,IAA8C;;AAEnF,8BAA8B,mBAAO,CAAC,IAA+C;;AAErF,6BAA6C;AAC7C;AACA,CAAC,CAAC;AACF,SAAe;;AAEf,oCAAoC,mBAAO,CAAC,KAAO;;AAEnD,4CAA4C,mBAAO,CAAC,KAAuB;;AAE3E;AACA;AACA,CAAC;;AAED,SAAe,Y;;;;;;;;;ACnBF;;AAEb,6BAA6B,mBAAO,CAAC,IAA8C;;AAEnF,8BAA8B,mBAAO,CAAC,IAA+C;;AAErF,6BAA6C;AAC7C;AACA,CAAC,CAAC;AACF,SAAe;;AAEf,oCAAoC,mBAAO,CAAC,KAAO;;AAEnD,4CAA4C,mBAAO,CAAC,KAAuB;;AAE3E;AACA;AACA,CAAC;;AAED,SAAe,Y;;;;;;;;;ACnBF;;AAEb,6BAA6B,mBAAO,CAAC,IAA8C;;AAEnF,8BAA8B,mBAAO,CAAC,IAA+C;;AAErF,6BAA6C;AAC7C;AACA,CAAC,CAAC;AACF,SAAe;;AAEf,oCAAoC,mBAAO,CAAC,KAAO;;AAEnD,4CAA4C,mBAAO,CAAC,KAAuB;;AAE3E;AACA;AACA,CAAC;;AAED,SAAe,Y;;;;;;;;;ACnBF;;AAEb,6BAA6B,mBAAO,CAAC,IAA8C;;AAEnF,8BAA8B,mBAAO,CAAC,IAA+C;;AAErF,6BAA6C;AAC7C;AACA,CAAC,CAAC;AACF,SAAe;;AAEf,oCAAoC,mBAAO,CAAC,KAAO;;AAEnD,4CAA4C,mBAAO,CAAC,KAAuB;;AAE3E;AACA;AACA,CAAC;;AAED,SAAe,Y;;;;;;;;;ACnBF;;AAEb,6BAA6B,mBAAO,CAAC,IAA8C;;AAEnF,8BAA8B,mBAAO,CAAC,IAA+C;;AAErF,6BAA6C;AAC7C;AACA,CAAC,CAAC;AACF,SAAe;;AAEf,oCAAoC,mBAAO,CAAC,KAAO;;AAEnD,4CAA4C,mBAAO,CAAC,KAAuB;;AAE3E;AACA;AACA,CAAC;;AAED,SAAe,Y;;;;;;;;;ACnBF;;AAEb,6BAA6B,mBAAO,CAAC,IAA8C;;AAEnF,8BAA8B,mBAAO,CAAC,IAA+C;;AAErF,6BAA6C;AAC7C;AACA,CAAC,CAAC;AACF,SAAe;;AAEf,oCAAoC,mBAAO,CAAC,KAAO;;AAEnD,4CAA4C,mBAAO,CAAC,KAAuB;;AAE3E;AACA;AACA,CAAC;;AAED,SAAe,Y;;;;;;;ACnBf,sBAAsB,mBAAO,CAAC,IAAgC;AAC9D,aAAa,mBAAO,CAAC,KAA4B;AACjD,2BAA2B,mBAAO,CAAC,IAAqC;;AAExE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;;;;;;;ACnBA,eAAe,mBAAO,CAAC,KAAwB;AAC/C,cAAc,mBAAO,CAAC,KAAuB;AAC7C,sBAAsB,mBAAO,CAAC,IAAgC;;AAE9D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;ACnBa;AACb,cAAc,mBAAO,CAAC,KAAuB;AAC7C,eAAe,mBAAO,CAAC,KAAwB;AAC/C,WAAW,mBAAO,CAAC,KAAoC;;AAEvD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;AC/BA,gBAAgB,mBAAO,CAAC,KAAyB;;AAEjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACvBA,iBAAiB,mBAAO,CAAC,KAA2B;;AAEpD;;;;;;;;ACFA,cAAc,mBAAO,CAAC,KAA0B;;AAEhD;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACPA,eAAe,mBAAO,CAAC,KAAwB;AAC/C,uBAAuB,mBAAO,CAAC,KAAuC;AACtE,kBAAkB,mBAAO,CAAC,KAA4B;AACtD,iBAAiB,mBAAO,CAAC,IAA0B;AACnD,WAAW,mBAAO,CAAC,KAAmB;AACtC,4BAA4B,mBAAO,CAAC,KAAsC;AAC1E,gBAAgB,mBAAO,CAAC,IAAyB;;AAEjD;AACA;AACA;AACA;AACA;;AAEA,oCAAoC;;AAEpC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,gBAAgB;AACnB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;;;;;;AC7EA,kBAAkB,mBAAO,CAAC,KAA0B;AACpD,2BAA2B,mBAAO,CAAC,IAAqC;AACxE,eAAe,mBAAO,CAAC,KAAwB;AAC/C,iBAAiB,mBAAO,CAAC,KAA0B;;AAEnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AChBA,yBAAyB,mBAAO,CAAC,KAAmC;AACpE,kBAAkB,mBAAO,CAAC,KAA4B;;AAEtD;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACRA,6BAA6B,mBAAO,CAAC,KAAuC;;AAE5E;AACA;AACA;AACA;AACA;;;;;;;;;ACNa;AACb,QAAQ,mBAAO,CAAC,KAAqB;AACrC,uBAAuB,mBAAO,CAAC,IAAiC;AAChE,eAAe,mBAAO,CAAC,KAAwB;AAC/C,eAAe,mBAAO,CAAC,KAAwB;AAC/C,gBAAgB,mBAAO,CAAC,KAAyB;AACjD,yBAAyB,mBAAO,CAAC,KAAmC;;AAEpE;AACA;AACA,GAAG,+BAA+B;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;ACpBD;AACA;AACA,uBAAuB,mBAAO,CAAC,KAAiC;;AAEhE;AACA;;;;;;;;;;;;;;;ACLA;AACA;AACA;AACO,IAAMA,kBAAkB,GAC3B,8EADG;AAEA,IAAMC,SAAS,GAAG,mCAAlB;AACA,IAAMC,YAAY,GAAG,qBAArB,C,CAEP;;AACO,SAASC,YAAT,CAAsBC,OAAtB,EAAyD;AAC5D,SAAO;AACH,aAAS,QADN;AAEHC,UAAM,EAAED;AAFL,GAAP;AAIH,C,CAED;;AACO,SAASE,WAAT,CAAqBC,MAArB,EAA8D;AACjE,SAAO;AACH,aAAS,OADN;AAEHC,iBAAa,EAAED;AAFZ,GAAP;AAIH;AA+BM,SAASE,UAAT,CAAoBC,IAApB,EAAkC;AACrCA,MAAI,GAAGA,IAAI,CAACC,IAAL,GAAYC,OAAZ,CAAoB,gBAApB,EAAsC,GAAtC,CAAP;AACA,MAAI,CAAC,YAAYC,IAAZ,CAAiBH,IAAjB,CAAL,EAA6BA,IAAI,GAAG,MAAMA,IAAb;AAC7BA,MAAI,GAAGA,IAAI,CAAC,CAAD,CAAJ,CAAQI,WAAR,KAAwBJ,IAAI,CAACK,KAAL,CAAW,CAAX,CAA/B;AACA,SAAOL,IAAI,CAACK,KAAL,CAAW,CAAX,EAAc,EAAd,CAAP;AACH;AAEM,SAASC,iBAAT,CAA2BN,IAA3B,EAAyC;AAC5C,SAAOA,IAAI,CAACK,KAAL,CAAW,CAAX,EAAc,EAAd,CAAP;AACH;AAEM,SAASE,SAAT,GAAqB;AACxB,SAAO,CACH,uBADG,EAEH,4BAFG,EAGH,QAHG,EAIH,QAJG,EAKH,aALG,EAMH,aANG,EAOH,aAPG,EAQH,MARG,EASH,wBATG,EAUH,iBAVG,EAWH,iBAXG,EAYH,qBAZG,EAaH,qBAbG,EAcH,aAdG,EAeH,kBAfG,EAgBH,kBAhBG,EAiBH,iBAjBG,EAkBH,SAlBG,EAmBH,YAnBG,EAoBH,YApBG,EAqBH,MArBG,EAsBH,OAtBG,EAuBH,YAvBG,EAwBH,YAxBG,EAyBH,WAzBG,EA0BH,WA1BG,EA2BH,QA3BG,EA4BH,aA5BG,EA6BH,aA7BG,EA8BH,cA9BG,EA+BH,kBA/BG,EAgCH,kBAhCG,EAiCH,kBAjCG,EAkCH,kBAlCG,EAmCH,kBAnCG,EAoCH,kBApCG,EAqCH,kBArCG,EAsCH,eAtCG,EAuCH,mBAvCG,EAwCH,mBAxCG,EAyCH,mBAzCG,EA0CH,mBA1CG,EA2CH,mBA3CG,EA4CH,mBA5CG,EA6CH,mBA7CG,EA8CH,KA9CG,EA+CH,SA/CG,EAgDH,SAhDG,EAiDH,SAjDG,EAkDH,SAlDG,EAmDH,SAnDG,EAoDH,SApDG,EAqDH,SArDG,EAsDH,MAtDG,EAuDH,UAvDG,EAwDH,UAxDG,EAyDH,UAzDG,EA0DH,UA1DG,EA2DH,UA3DG,EA4DH,UA5DG,EA6DH,UA7DG,EA8DH,uBA9DG,EA+DH,mBA/DG,EAgEH,OAhEG,EAiEH,YAjEG,EAkEH,YAlEG,EAmEH,YAnEG,EAoEH,WApEG,EAqEH,WArEG,EAsEH,MAtEG,EAuEH,MAvEG,EAwEH,MAxEG,EAyEH,cAzEG,EA0EH,kBA1EG,EA2EH,SA3EG,EA4EH,OA5EG,EA6EH,WA7EG,EA8EH,WA9EG,EA+EH,WA/EG,EAgFH,cAhFG,EAiFH,kBAjFG,EAkFH,cAlFG,EAmFH,QAnFG,EAoFH,OApFG,EAqFH,OArFG,EAsFH,KAtFG,EAuFH,OAvFG,EAwFH,WAxFG,EAyFH,WAzFG,EA0FH,WA1FG,EA2FH,uBA3FG,EA4FH,mBA5FG,EA6FH,KA7FG,EA8FH,YA9FG,EA+FH,OA/FG,EAgGH,YAhGG,EAiGH,YAjGG,EAkGH,QAlGG,EAmGH,aAnGG,EAoGH,aApGG,EAqGH,aArGG,EAsGH,MAtGG,EAuGH,QAvGG,EAwGH,aAxGG,EAyGH,aAzGG,EA0GH,aA1GG,EA2GH,MA3GG,EA4GH,OA5GG,EA6GH,YA7GG,EA8GH,YA9GG,EA+GH,YA/GG,EAgHH,WAhHG,EAiHH,WAjHG,EAkHH,MAlHG,EAmHH,MAnHG,EAoHH,MApHG,EAqHH,cArHG,EAsHH,kBAtHG,EAuHH,uBAvHG,EAwHH,MAxHG,EAyHH,WAzHG,EA0HH,WA1HG,EA2HH,UA3HG,EA4HH,UA5HG,EA6HH,UA7HG,EA8HH,YA9HG,EA+HH,qBA/HG,EAgIH,OAhIG,EAiIH,SAjIG,EAkIH,OAlIG,EAmIH,SAnIG,EAoIH,OApIG,EAqIH,UArIG,EAsIH,MAtIG,EAuIH,WAvIG,EAwIH,WAxIG,EAyIH,OAzIG,EA0IH,MA1IG,EA2IH,eA3IG,EA4IH,mBA5IG,EA6IH,aA7IG,EA8IH,iBA9IG,EA+IH,MA/IG,EAgJH,WAhJG,EAiJH,WAjJG,EAkJH,UAlJG,EAmJH,UAnJG,EAoJH,UApJG,EAqJH,YArJG,EAsJH,qBAtJG,EAuJH,QAvJG,EAwJH,YAxJG,EAyJH,KAzJG,EA0JH,UA1JG,EA2JH,sBA3JG,EA4JH,oBA5JG,EA6JH,iBA7JG,EA8JH,eA9JG,EA+JH,eA/JG,EAgKH,KAhKG,EAiKH,UAjKG,EAkKH,SAlKG,EAmKH,SAnKG,EAoKH,SApKG,EAqKH,KArKG,EAsKH,QAtKG,EAuKH,eAvKG,EAwKH,kBAxKG,EAyKH,QAzKG,EA0KH,OA1KG,EA2KH,OA3KG,EA4KH,KA5KG,EA6KH,QA7KG,EA8KH,aA9KG,EA+KH,aA/KG,EAgLH,YAhLG,EAiLH,QAjLG,EAkLH,MAlLG,EAmLH,KAnLG,EAoLH,MApLG,EAqLH,aArLG,EAsLH,gBAtLG,EAuLH,qBAvLG,EAwLH,oBAxLG,EAyLH,cAzLG,EA0LH,kBA1LG,EA2LH,aA3LG,EA4LH,eA5LG,EA6LH,MA7LG,EA8LH,MA9LG,EA+LH,WA/LG,EAgMH,WAhMG,EAiMH,UAjMG,EAkMH,UAlMG,EAmMH,YAnMG,EAoMH,iBApMG,EAqMH,OArMG,EAsMH,YAtMG,EAuMH,WAvMG,EAwMH,WAxMG,EAyMH,YAzMG,EA0MH,QA1MG,EA2MH,gBA3MG,EA4MH,qBA5MG,EA6MH,cA7MG,EA8MH,mBA9MG,EA+MLC,IA/MK,EAAP;AAgNH,C;;;;;;;;;;;;;;;;;;ACjRD;CAEA;;AACA;AACA;AACA;AACA,IAAMC,cAAc,gBAAGC,2CAAI,CAAC;AAAA,SAAM,qGAAN;AAAA,CAAD,CAA3B;AAEe,SAASC,YAAT,CAAsBC,KAAtB,EAQZ;AACC,MACIC,IADJ,GAQID,KARJ,CACIC,IADJ;AAAA,MAEIC,eAFJ,GAQIF,KARJ,CAEIE,eAFJ;AAAA,MAGIC,QAHJ,GAQIH,KARJ,CAGIG,QAHJ;AAAA,MAIIC,aAJJ,GAQIJ,KARJ,CAIII,aAJJ;AAAA,MAKIC,IALJ,GAQIL,KARJ,CAKIK,IALJ;AAAA,MAMIC,UANJ,GAQIN,KARJ,CAMIM,UANJ;AAAA,MAOIC,SAPJ,GAQIP,KARJ,CAOIO,SAPJ;;AASA,kBAAwBC,+CAAQ,CAAC,KAAD,CAAhC;AAAA,MAAOC,IAAP;AAAA,MAAaC,OAAb;;AAEA,MAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;AACrBD,WAAO,CAAC,IAAD,CAAP;AACH,GAFD;;AAGA,MAAME,UAAU,GAAG,SAAbA,UAAa,CAACC,KAAD,EAAmB;AAClC,QAAIA,KAAJ,aAAIA,KAAJ,eAAIA,KAAK,CAAEC,MAAX,EAAmBZ,eAAe,CAACW,KAAD,CAAf;AACnBH,WAAO,CAAC,KAAD,CAAP;AACH,GAHD;;AAIA,MAAMK,WAAW,GAAG,SAAdA,WAAc;AAAA,WAAML,OAAO,CAAC,KAAD,CAAb;AAAA,GAApB;;AAEA,sBACI,iDAAC,+DAAD;AAAK,aAAS,EAAEH;AAAhB,KACKF,IAAI,iBACD,iDAAC,uEAAD;AAAuB,SAAK,EAAEJ,IAA9B;AAAoC,WAAO,EAAEU;AAA7C,kBACI,iDAAC,8EAAD,OADJ,CAFR,EAMK,CAACN,IAAD,iBACG,iDAAC,+DAAD;AACI,YAAQ,EAAEF,QADd;AAEI,WAAO,EAAC,UAFZ;AAGI,WAAO,EAAEQ,UAHb;AAII,aAAS,eAAE,iDAAC,8EAAD;AAJf,KAMKV,IANL,CAPR,EAgBKQ,IAAI,iBACD,iDAAC,0DAAD,qBACI,iDAAC,cAAD;AACI,QAAI,EAAEA,IADV;AAEI,UAAM,EAAEG,UAFZ;AAGI,eAAW,EAAE,OAHjB;AAII,WAAO,EAAEG,WAJb;AAKI,iBAAa,EAAEX,aALnB;AAMI,kBAAc,EAAE,IANpB;AAOI,cAAU,EAAEE,UAAU,IAAI,CAP9B;AAQI,oBAAgB,EAAE;AARtB,IADJ,CAjBR,CADJ;AAiCH,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACdM,IAAMU,WAA6C,GAAG,CACzD;AACIC,IAAE,EAAE,OADR;AAEIC,MAAI,EAAE,CAAC,YAAD,CAFV;AAGIC,QAAM,oBAHV;AAIIC,SAAO,EAAE;AAJb,CADyD,EAOzD;AACIH,IAAE,EAAE,MADR;AAEIC,MAAI,EAAE,CAAC,YAAD,CAFV;AAGIC,QAAM,qBAHV;AAIIC,SAAO,EAAE;AAJb,CAPyD,EAazD;AACIH,IAAE,EAAE,mBADR;AAEIC,MAAI,EAAE,CAAC,SAAD,EAAY,YAAZ,CAFV;AAGIC,QAAM,iCAHV;AAIIC,SAAO,EAAE;AAJb,CAbyD,EAmBzD;AACIH,IAAE,EAAE,eADR;AAEIC,MAAI,EAAE,CAAC,UAAD,CAFV;AAGIC,QAAM,wCAHV;AAIIC,SAAO,EAAE;AAJb,CAnByD,EAyBzD;AACIH,IAAE,EAAE,aADR;AAEIC,MAAI,EAAE,CAAC,UAAD,EAAa,QAAb,CAFV;AAGIC,QAAM,0CAHV;AAIIC,SAAO,EAAE;AAJb,CAzByD,EA+BzD;AACIH,IAAE,EAAE,MADR;AAEIC,MAAI,EAAE,CAAC,QAAD,CAFV;AAGIC,QAAM,6BAHV;AAIIC,SAAO,EAAE;AAJb,CA/ByD,EAqCzD;AACIH,IAAE,EAAE,OADR;AAEIC,MAAI,EAAE,CAAC,QAAD,CAFV;AAGIC,QAAM,wBAHV;AAIIC,SAAO,EAAE;AAJb,CArCyD,EA2CzD;AACIH,IAAE,EAAE,YADR;AAEIC,MAAI,EAAE,CAAC,OAAD,EAAU,CAAC,SAAD,EAAY,IAAZ,CAAV,CAFV;AAGIC,QAAM,gEAHV;AAIIC,SAAO,EAAE;AAJb,CA3CyD,EAiDzD;AACIH,IAAE,EAAE,gBADR;AAEIC,MAAI,EAAE,CAAC,SAAD,CAFV;AAGIC,QAAM,0BAHV;AAIIC,SAAO,EAAE;AAJb,CAjDyD,EAuDzD;AACIH,IAAE,EAAE,eADR;AAEIC,MAAI,EAAE,CAAC,UAAD,EAAa,QAAb,CAFV;AAGIC,QAAM,8BAHV;AAIIC,SAAO,EAAE;AAJb,CAvDyD,EA6DzD;AACIH,IAAE,EAAE,YADR;AAEIC,MAAI,EAAE,CAAC,UAAD,EAAa,QAAb,CAFV;AAGIC,QAAM,8BAHV;AAIIC,SAAO,EAAE;AAJb,CA7DyD,EAmEzD;AACIH,IAAE,EAAE,MADR;AAEIC,MAAI,EAAE,EAFV;AAGIC,QAAM,kCAHV;AAIIC,SAAO,EAAE;AAJb,CAnEyD,EAyEzD;AACIH,IAAE,EAAE,KADR;AAEIC,MAAI,EAAE,EAFV;AAGIC,QAAM,gBAHV;AAIIC,SAAO,EAAE;AAJb,CAzEyD,EA+EzD;AACIH,IAAE,EAAE,iBADR;AAEIC,MAAI,EAAE,CAAC,YAAD,CAFV;AAGIC,QAAM,kCAHV;AAIIC,SAAO,EAAE;AAJb,CA/EyD,EAqFzD;AACIH,IAAE,EAAE,oBADR;AAEIC,MAAI,EAAE,CAAC,YAAD,CAFV;AAGIC,QAAM,qCAHV;AAIIC,SAAO,EAAE;AAJb,CArFyD,CAAtD,C;;;;;;ACxDP;AACA;AASA;AAIA;AAEO,SAASC,YAAT,CAAsBJ,EAAtB,EAAkC;AACrC,SAAO;AACHK,QAAI,EAAE,YADH;AAEHlC,QAAI,EAAE6B;AAFH,GAAP;AAIH;AAEM,SAASM,kBAAT,CACHC,IADG,EAEHC,KAFG,EAGL;AACE,SAAO;AACHH,QAAI,EAAE,kBADH;AAEHI,UAAM,EAAEL,YAAY,CAACG,IAAD,CAFjB;AAGHG,YAAQ,EAAE,OAAOF,KAAP,KAAiB,QAAjB,GAA4BJ,YAAY,CAACI,KAAD,CAAxC,GAAkDA,KAHzD;AAIHG,YAAQ,EAAE;AAJP,GAAP;AAMH;;AAED,SAASC,cAAT,CACIC,OADJ,EAEIC,QAFJ,EAGIC,YAHJ,EAIE;AACEF,SAAO,CAACG,QAAR,CAAiBC,OAAjB,CAAyBC,SAAzB;;AAEA,WAASA,SAAT,CAAmBC,IAAnB,EAAiC;AAC7B,YAAQA,IAAI,CAACd,IAAb;AACI,WAAK,KAAL;AAAY;AACR,cAAIU,YAAJ,EAAkBA,YAAY,CAACI,IAAD,CAAZ;AAClB;AACH;;AACD,WAAK,KAAL;AAAY;AAAA;;AACR,cAAMC,IAAG,GAAGD,IAAZ;AACA,cAAIL,QAAJ,EAAcA,QAAQ,CAACM,IAAD,EAAM,CAAN,CAAR;AACdA,cAAG,SAAH,IAAAA,IAAG,WAAH,yBAAAA,IAAG,CAAEC,IAAL,wDAAWJ,OAAX,CAAmBC,SAAnB;AACA,cAAIJ,QAAJ,EAAcA,QAAQ,CAACM,IAAD,EAAM,CAAN,CAAR;AACdA,cAAG,SAAH,IAAAA,IAAG,WAAH,yBAAAA,IAAG,CAAEE,IAAL,wDAAWL,OAAX,CAAmBC,SAAnB;AACA,cAAIJ,QAAJ,EAAcA,QAAQ,CAACM,IAAD,EAAM,CAAN,CAAR;AACjB;AAZL;AAcH;AACJ;;AAEM,SAASG,cAAT,CAAwBC,IAAxB,EAAyC;AAC5C,MAAMC,UAAqB,GAAG;AAAEC,SAAK,EAAEF,IAAI,CAACE,KAAL,CAAWlD,KAAX,CAAiB,CAAjB,CAAT;AAA8BmD,YAAQ,EAAE;AAAxC,GAA9B;AACAF,YAAU,CAACE,QAAX,GAAsBH,IAAI,CAACG,QAAL,CAAcC,GAAd,CAAkB,UAAAC,CAAC,EAAI;AACzC,WAAO;AAAEb,cAAQ,EAAEc,gBAAgB,CAACD,CAAD,CAA5B;AAAiCE,YAAM,EAAEF,CAAF,aAAEA,CAAF,uBAAEA,CAAC,CAAEE;AAA5C,KAAP;AACH,GAFqB,CAAtB;AAGA,SAAON,UAAP;AACH;;AAED,SAASK,gBAAT,CAA0BjB,OAA1B,EAAwD;AACpD,MAAMmB,WAAwB,GAAG,EAAjC;AACA,MAAMC,MAAuC,GAAG,EAAhD;AACA,MAAIC,OAAO,GAAG,CAAd;AACAtB,gBAAc,CACVC,OADU,EAEV,UAACO,GAAD,EAAMe,IAAN,EAAe;AACX,YAAQA,IAAR;AACI,WAAK,CAAL;AAAQ;AACJ;AACA,cAAMb,IAAI,aAAWY,OAArB;AACA,cAAME,GAAG,YAAUF,OAAnB;AACAD,gBAAM,CAACI,IAAP,CAAY;AAAEf,gBAAI,EAAJA,IAAF;AAAQc,eAAG,EAAHA;AAAR,WAAZ;AACAF,iBAAO;AACPF,qBAAW,CAACK,IAAZ,CAAiB;AACbhC,gBAAI,EAAE,KADO;AAEbiC,mBAAO,EAAE;AACLjC,kBAAI,EAAE,gBADD;AAELkC,oBAAM,EAAEnC,YAAY,CAAC,mBAAD,CAFf;AAGLoC,uBAAS,EAAE,CAACpB,GAAG,CAACqB,IAAL,EAAWrC,YAAY,CAACkB,IAAD,CAAvB;AAHN;AAFI,WAAjB;AAQA;AACH;;AACD,WAAK,CAAL;AAAQ;AACJ;AACA,wBAAsBW,MAAM,CAACA,MAAM,CAACpC,MAAP,GAAgB,CAAjB,CAA5B;AAAA,cAAQyB,KAAR,WAAQA,IAAR;AAAA,cAAcc,IAAd,WAAcA,GAAd;AACAJ,qBAAW,CAACK,IAAZ,CAAiB;AACbhC,gBAAI,EAAE,KADO;AAEbiC,mBAAO,EAAE;AACLjC,kBAAI,EAAE,gBADD;AAELkC,oBAAM,EAAEnC,YAAY,CAAC,MAAD,CAFf;AAGLoC,uBAAS,EAAE,CAACpC,YAAY,CAACgC,IAAD,CAAb;AAHN;AAFI,WAAjB;AAQAJ,qBAAW,CAACK,IAAZ,CAAiB;AACbhC,gBAAI,EAAE,KADO;AAEbiC,mBAAO,EAAE;AACLjC,kBAAI,EAAE,gBADD;AAELkC,oBAAM,EAAEnC,YAAY,CAAC,OAAD,CAFf;AAGLoC,uBAAS,EAAE,CAACpC,YAAY,CAACkB,KAAD,CAAb;AAHN;AAFI,WAAjB;AAQA;AACH;;AACD,WAAK,CAAL;AAAQ;AACJoB,kCAAM,CAACT,MAAM,CAACpC,MAAP,GAAgB,CAAjB,CAAN;AACA,cAAQuC,KAAR,GAAgBH,MAAM,CAACA,MAAM,CAACpC,MAAP,GAAgB,CAAjB,CAAtB,CAAQuC,GAAR;AACAJ,qBAAW,CAACK,IAAZ,CAAiB;AACbhC,gBAAI,EAAE,KADO;AAEbiC,mBAAO,EAAE;AACLjC,kBAAI,EAAE,gBADD;AAELkC,oBAAM,EAAEnC,YAAY,CAAC,OAAD,CAFf;AAGLoC,uBAAS,EAAE,CAACpC,YAAY,CAACgC,KAAD,CAAb;AAHN;AAFI,WAAjB;AAQAH,gBAAM,CAACU,GAAP;AACH;AAlDL;AAoDH,GAvDS,EAwDV,UAAAC,GAAG,EAAI;AACHZ,eAAW,CAACK,IAAZ,CAAiBO,GAAjB;AACH,GA1DS,CAAd;AA4DA,SAAOZ,WAAP;AACH;;AAYM,IAAMa,kBAAkB,GAAG,SAArBA,kBAAqB,CAACC,IAAD;AAAA,SAAqB,UAACC,IAAD,EAAkB;AACrE;AACA,QAAMC,OAAO,GAAGF,IAAI,CAACpB,KAAL,CAAWuB,IAAX,CAAgB,UAAAC,IAAI;AAAA,aAAIA,IAAI,CAACH,IAAL,KAAcA,IAAlB;AAAA,KAApB,CAAhB;;AACA,QAAIC,OAAJ,EAAa;AACT;AACA,UAAMG,GAAG,GAAGC,6CAA4B,CAACJ,OAAO,CAACK,cAAT,CAAxC;AACAX,8BAAM,CAAC,CAAC,CAACS,GAAH,eAAmBH,OAAO,CAACK,cAA3B,mBAAN;AACA,aAAOF,GAAP;AACH,KALD,MAKO;AACH,UAAMG,OAAO,GAAGF,6CAA4B,CAACL,IAAD,CAA5C;AACA,aAAOO,OAAP;AACH;AACJ,GAZiC;AAAA,CAA3B;AAcA,SAASC,YAAT,CAAsB/B,IAAtB,EAIL;AACE,MAAMgC,SAAoB,GAAG,EAA7B;AACA,MAAMC,YAAyB,GAAG,EAAlC;;AACA,MAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACC,CAAD,EAAe;AAC5BH,aAAS,CAACnB,IAAV,CAAe;AAAEuB,cAAQ,EAAEC,SAAZ;AAAuBC,aAAO,EAAEH;AAAhC,KAAf;AACH,GAFD;;AAGA,MAAMI,cAAc,GAAG,IAAIC,kCAAJ,CACnBH,SADmB,EAEnBhB,kBAAkB,CAACrB,IAAD,CAFC,EAGnBkC,QAHmB,CAAvB;AAKA,MAAMO,OAAO,GAAG,IAAIC,yBAAJ,CAAcH,cAAd,EAA8B,UAAAI,CAAC;AAAA,WAAI,IAAJ;AAAA,GAA/B,EAAyCT,QAAzC,CAAhB;AACAlC,MAAI,CAACG,QAAL,CAAcV,OAAd,CAAsB,UAAAY,CAAC,EAAI;AACvB,QAAIA,CAAJ,aAAIA,CAAJ,eAAIA,CAAC,CAAEE,MAAH,CAAUlC,MAAd,EAAsB;AAClBgC,OAAC,SAAD,IAAAA,CAAC,WAAD,YAAAA,CAAC,CAAEE,MAAH,CAAUd,OAAV,CAAkB,UAAA0C,CAAC;AAAA,eAAIH,SAAS,CAACnB,IAAV,CAAesB,CAAf,CAAJ;AAAA,OAAnB;AACA;AACH;;AACD,QAAMS,UAAU,GAAGZ,SAAS,CAAC3D,MAA7B;AACAkE,kBAAc,CAACrC,KAAf,GAAuB,EAAvB;AACAd,kBAAc,CAACiB,CAAD,EAAIgC,SAAJ,EAAe,UAAAQ,CAAC;AAAA,aAC1BJ,OAAO,CAACK,YAAR,CAAqBD,CAAC,CAAC/B,OAAvB,EAAgCvC,WAAhC,CAD0B;AAAA,KAAhB,CAAd;;AAGA,QAAI,CAAA8B,CAAC,SAAD,IAAAA,CAAC,WAAD,YAAAA,CAAC,CAAEE,MAAH,CAAUlC,MAAV,MAAqB,CAArB,IAA0B2D,SAAS,CAAC3D,MAAV,KAAqBuE,UAAnD,EAA+D;AAC3DvC,OAAC,CAACH,KAAF,GAAUqC,cAAc,CAACrC,KAAzB;AACA+B,kBAAY,CAACpB,IAAb,CAAkBR,CAAlB;AACH,KAHD,MAGO;AACHA,OAAC,SAAD,IAAAA,CAAC,WAAD,YAAAA,CAAC,CAAEE,MAAH,CAAUd,OAAV,CAAkB,UAAA0C,CAAC;AAAA,eAAIH,SAAS,CAACnB,IAAV,CAAesB,CAAf,CAAJ;AAAA,OAAnB;AACH;AACJ,GAhBD;AAiBAnC,MAAI,CAACG,QAAL,GAAgB8B,YAAhB;AAEA,SAAO;AACHc,aAAS,EAAER,cAAc,CAACQ,SAAf,CAAyB3C,GAAzB,CAA6B,UAAA4C,CAAC,EAAI;AACzC,qBAAoBA,CAAC,CAACC,KAAF,CAAQ,GAAR,CAApB;AAAA,UAAOlE,IAAP;AAAA,UAAamE,GAAb;;AACA,aAAO;AAAE3B,YAAI,EAAExC,IAAR;AAAcoE,gBAAQ,EAAED;AAAxB,OAAP;AACH,KAHU,CADR;AAKHE,UAAM,EAAEb,cAAc,CAACa,MAAf,CAAsBhD,GAAtB,CAA0B,UAAA+B,CAAC,EAAI;AACnC,qBAAoBA,CAAC,CAACc,KAAF,CAAQ,GAAR,CAApB;AAAA,UAAOlE,IAAP;AAAA,UAAamE,GAAb;;AACA,aAAO;AAAE3B,YAAI,EAAExC,IAAR;AAAcsE,aAAK,EAAEH;AAArB,OAAP;AACH,KAHO,CALL;AASH3C,UAAM,EAAEyB;AATL,GAAP;AAWH,C;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3MD;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;CAGA;;IAGKsB,gB;;WAAAA,gB;AAAAA,kB;AAAAA,kB;AAAAA,kB;AAAAA,kB;AAAAA,kB;AAAAA,kB;GAAAA,gB,KAAAA,gB;;AASL,IAAMC,eAAe,GAAG,eAAxB;;IAkBMC,e;;;AACF,2BAAmBC,KAAnB,EAAkC;AAAA;;AAC9B;AAD8B,UAAfA,KAAe,GAAfA,KAAe;AAAA;AAEjC;;;mDAHyBC,K;;IAMxBC,gB;;;AACF,4BAAmBC,EAAnB,EAA+B;AAAA;;AAC3B;AAD2B,WAAZA,EAAY,GAAZA,EAAY;AAAA;AAE9B;;;mDAH0BF,K;;IAMzBG,kB;AAIF,8BACWC,MADX,EAEqBC,GAFrB,EAGqBC,EAHrB,EAIE;AAAA,SAPMC,SAON,GAP0B5B,SAO1B;AAAA,SANM6B,YAMN,GAN6B7B,SAM7B;AAAA,SALM8B,QAKN,GALiB,KAKjB;AAAA,SAHSL,MAGT,GAHSA,MAGT;AAAA,SAFmBC,GAEnB,GAFmBA,GAEnB;AAAA,SADmBC,EACnB,GADmBA,EACnB;AAAE;;;;SAEJI,K,GAAA,eAAMC,GAAN,EAAmB1F,OAAnB,EAAiD;AAAA,QAA9BA,OAA8B;AAA9BA,aAA8B,GAAJ,EAAI;AAAA;;AAC7C,SAAKmF,MAAL,CAAYM,KAAZ,CAAkBC,GAAlB;AAAyBvD,aAAO,EAAE,KAAKkD,EAAL,CAAQlD,OAAR,CAAgBjC;AAAlD,OAA2DF,OAA3D;AACH,G;;SAMO2F,c,GAAR,wBAAuBnC,CAAvB,EAA2C;AAAA;;AACvC,QAAMlB,IAAI,GAAG,IAAIsD,8BAAJ,CAAoB,UAAApC,CAAC;AAAA,aAAI,MAAI,CAAC4B,GAAL,CAASS,MAAT,CAAgBrC,CAAhB,CAAJ;AAAA,KAArB,EAA6CE,SAA7C,CAAb;AACA,WAAOpB,IAAI,CAACwD,IAAL,CAAUtC,CAAV,CAAP;AACH,G;;SAEOuC,e,GAAR,yBAAwBvC,CAAxB,EAA4C;AACxC,WAAO,KAAKmC,cAAL,CAAoBnC,CAApB,IAAyB,IAAzB,GAAgC,KAAvC;AACH,G;;SAEOwC,K,GAAR,iBAAgB;AACZ,QACI,KAAKX,EAAL,CAAQlD,OAAR,CAAgBC,MAAhB,CAAuBlC,IAAvB,KAAgC,kBAAhC,KACC,KAAK+F,IAAL,KAAc,eAAd,IAAiC,KAAKA,IAAL,KAAc,aADhD,CADJ,EAGE;AACE;AACA,UAAMnG,IAAI,GAAG,KAAKuF,EAAL,CAAQlD,OAAR,CAAgBE,SAA7B;AACA,WAAKiD,SAAL,GAAiB,KAAKK,cAAL,CAAoB7F,IAAI,CAAC,CAAD,CAAxB,CAAjB;AACA,UAAI,KAAKmG,IAAL,KAAc,aAAlB,EACI,KAAKV,YAAL,GAAoB,KAAKI,cAAL,CAAoB7F,IAAI,CAAC,CAAD,CAAxB,CAApB;AACJ,aAAO,IAAP;AACH;;AACD,WAAO,KAAP;AACH,G;;SAEYoG,Q;iGAAb;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,kBACS,KAAKV,QADd;AAAA;AAAA;AAAA;;AAEcW,yBAFd,GAE4B,KAAKH,KAAL,EAF5B;AAGQ,mBAAKR,QAAL,GAAgB,IAAhB;;AAHR,mBAIYW,WAJZ;AAAA;AAAA;AAAA;;AAAA,+CAIgCxB,gBAAgB,CAACyB,OAJjD;;AAAA;AAMUtG,kBANV,GAMiB,KAAKuF,EAAL,CAAQlD,OAAR,CAAgBE,SANjC;;AAAA,oBAOQ,KAAKgD,EAAL,CAAQlD,OAAR,CAAgBC,MAAhB,CAAuBlC,IAAvB,KAAgC,kBAPxC;AAAA;AAAA;AAAA;;AAQQ;AACMoC,kBATd,GASqB,IAAIsD,8BAAJ,CAAoB,UAAApC,CAAC;AAAA,uBAAI,MAAI,CAAC4B,GAAL,CAASS,MAAT,CAAgBrC,CAAhB,CAAJ;AAAA,eAArB,EAA6CE,SAA7C,CATrB;AAUc2C,qBAVd,GAUuB,KAAKhB,EAAL,CAAQlD,OAAR,CAAgBE,SAAhB,CAA0BZ,GAA1B,CAA8B,UAAA6E,CAAC;AAAA,uBAAIhE,IAAI,CAACwD,IAAL,CAAUQ,CAAV,CAAJ;AAAA,eAA/B,CAVvB;AAAA;AAAA,qBAWc,KAAKlB,GAAL,CAASmB,gBAAT,CACF,KAAKlB,EAAL,CAAQlD,OAAR,CAAgBC,MADd,EAEFiE,OAFE,CAXd;;AAAA;AAAA,+CAee1B,gBAAgB,CAAC6B,SAfhC;;AAAA;AAAA,4BAiBY,KAAKP,IAjBjB;AAAA,8CAkBa,mBAlBb,wBAyBa,MAzBb,wBA4Ba,OA5Bb,wBA+Ba,YA/Bb,wBAwCa,gBAxCb,wBA6Ca,aA7Cb,wBA8Ca,eA9Cb,wBAiEa,eAjEb,wBAkEa,YAlEb,wBAmFa,OAnFb,wBA4Fa,MA5Fb,wBA+Fa,KA/Fb,wBAkGa,MAlGb,wBA0Ga,iBA1Gb,wBA+Ga,mBA/Gb;AAAA;;AAAA;AAmBkB3D,mBAnBlB,GAmByB,KAAKyD,eAAL,CAAqBjG,IAAI,CAAC,CAAD,CAAzB,CAnBzB;;AAAA,mBAoBgBwC,KApBhB;AAAA;AAAA;AAAA;;AAAA,oBAqBsB,IAAIuC,eAAJ,CAAqB/E,IAAI,CAAC,CAAD,CAAL,CAA6B9B,IAAjD,CArBtB;;AAAA;AAAA,+CAuBmB2G,gBAAgB,CAAC6B,SAvBpC;;AAAA;AAAA,oBA0BkB,IAAI3B,eAAJ,CAAqB/E,IAAI,CAAC,CAAD,CAAL,CAA6B9B,IAAjD,CA1BlB;;AAAA;AAAA,+CA6BmB2G,gBAAgB,CAAC6B,SA7BpC;;AAAA;AAgCkB9B,mBAhClB,GAgC0B5E,IAAI,CAAC,CAAD,CAhC9B;;AAAA,mBAiCgB,KAAKsF,GAAL,CAASqB,QAAT,CAAkB/B,KAAlB,CAjChB;AAAA;AAAA;AAAA;;AAAA,+CAkCuB,KAAKqB,eAAL,CAAqBjG,IAAI,CAAC,CAAD,CAAzB,IACD6E,gBAAgB,CAAC6B,SADhB,GAED7B,gBAAgB,CAACyB,OApCvC;;AAAA;AAAA,+CAsCmBzB,gBAAgB,CAACyB,OAtCpC;;AAAA;AAAA,+CAyCmB,KAAKL,eAAL,CAAqBjG,IAAI,CAAC,CAAD,CAAzB,IACD6E,gBAAgB,CAAC6B,SADhB,GAED7B,gBAAgB,CAACyB,OA3CnC;;AAAA;AA+CkBM,sBA/ClB,GA+C6B,KAAKf,cAAL,CAAoB7F,IAAI,CAAC,CAAD,CAAxB,CA/C7B;;AAAA,oBAiDiB,KAAKmG,IAAL,KAAc,eAAd,IACGS,QAAQ,KAAK,KAAKpB,SADtB,IAEC,KAAKW,IAAL,KAAc,aAAd,KACK,KAAKV,YAAL,KAAsB,CAAtB,IACEmB,QAAQ,KAAK,KAAKpB,SADrB,IAEI,KAAKC,YAAL,GAAoB,CAApB,IACGmB,QAAQ,IACJ,KAAKpB,SAAL,GAAiB,KAAKC,YAJjC,IAKI,KAAKA,YAAL,GAAoB,CAApB,IACGmB,QAAQ,IACJ,KAAKpB,SAAL,GAAiB,KAAKC,YARrC,CAnDjB;AAAA;AAAA;AAAA;;AAAA,+CA6DuBZ,gBAAgB,CAAC6B,SA7DxC;;AAAA;AAAA,+CA+DmB7B,gBAAgB,CAACyB,OA/DpC;;AAAA;AAmEkB9D,oBAnElB,GAmEyB,IAAIsD,8BAAJ,CACT,UAAApC,CAAC;AAAA,uBAAI,MAAI,CAAC4B,GAAL,CAASS,MAAT,CAAgBrC,CAAhB,CAAJ;AAAA,eADQ,EAETE,SAFS,CAnEzB;AAuEkBiD,gBAvElB,GAuEuBrE,MAAI,CAACwD,IAAL,CAAUhG,IAAI,CAAC,CAAD,CAAd,CAvEvB;AAwEY,mBAAK2F,KAAL,CAAW,UAAX,EAAuB;AAAEnD,oBAAI,EAAEsE,0BAAO,CAAC9G,IAAI,CAAC,CAAD,CAAL;AAAf,eAAvB;AACM+G,iBAzElB,GAyEwB/G,IAAI,CAAC,CAAD,CAzE5B;;AAAA,oBA0EgB,KAAKmG,IAAL,KAAc,eA1E9B;AAAA;AAAA;AAAA;;AAAA;AAAA,qBA2EsB,KAAKb,GAAL,CAAS0B,kBAAT,CAA4BD,GAA5B,EAAiCF,EAAjC,CA3EtB;;AAAA;AA4EgB,mBAAKlB,KAAL,CAAW,kBAAX,EAA+B;AAC3BoB,mBAAG,EAAED,0BAAO,CAACC,GAAD,CADe;AAE3BvE,oBAAI,EAAEqE;AAFqB,eAA/B;AA5EhB;AAAA;;AAAA;AAgFmB,mBAAKvB,GAAL,CAAS2B,UAAT,CAAoBF,GAApB,EAAyBF,EAAzB;;AAhFnB;AAAA,+CAiFmBhC,gBAAgB,CAAC6B,SAjFpC;;AAAA;AAoFkBlE,oBApFlB,GAoFyB,IAAIsD,8BAAJ,CACT,UAAApC,CAAC;AAAA,uBAAI,MAAI,CAAC4B,GAAL,CAASS,MAAT,CAAgBrC,CAAhB,CAAJ;AAAA,eADQ,EAETE,SAFS,CApFzB;AAwFkBiD,iBAxFlB,GAwFuBrE,MAAI,CAACwD,IAAL,CAAUhG,IAAI,CAAC,CAAD,CAAd,CAxFvB;AAyFY,mBAAKqF,MAAL,CAAY6B,KAAZ,aAAkB,KAAK3B,EAAvB,6CAAkB,SAAS5B,QAA3B,EAAqCkD,GAArC;AAzFZ,+CA0FmBhC,gBAAgB,CAAC6B,SA1FpC;;AAAA;AAAA,+CA6FmB7B,gBAAgB,CAACsC,OA7FpC;;AAAA;AAAA,+CAgGmBtC,gBAAgB,CAAC6B,SAhGpC;;AAAA;AAmGkBlE,oBAnGlB,GAmGyB,IAAIsD,8BAAJ,CACT,UAAApC,CAAC;AAAA,uBAAI,MAAI,CAAC4B,GAAL,CAASS,MAAT,CAAgBrC,CAAhB,CAAJ;AAAA,eADQ,EAETE,SAFS,CAnGzB;AAuGkBiD,kBAvGlB,GAuGuBrE,MAAI,CAACwD,IAAL,CAAUhG,IAAI,CAAC,CAAD,CAAd,CAvGvB;AAAA,oBAwGkB,IAAIkF,gBAAJ,CAAqB2B,IAAE,GAAG,IAA1B,CAxGlB;;AAAA;AAAA,+CA6GmBhC,gBAAgB,CAAC6B,SA7GpC;;AAAA;AAAA,+CAkHmB7B,gBAAgB,CAAC6B,SAlHpC;;AAAA;AAAA,oBAqHkB,IAAIU,wBAAJ,CACFC,gDADE,2BAEqB,KAAKlB,IAF1B,CArHlB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;;;;;;;;;;SA5BA,eAAmB;AAAA;;AACf,sCAAQ,KAAKZ,EAAL,CAAQlD,OAAR,CAAgBC,MAAxB,0DAAO,sBAA6CpE,IAApD;AACH;;;;;;IAuJCoJ,e;AAGF,2BACoBjC,MADpB,EAEYkC,SAFZ,EAGIjC,GAHJ,EAIWC,EAJX,EAKE;AAAA,SANMiC,OAMN,GANkC3C,gBAAgB,CAACyB,OAMnD;AAAA,SAJkBjB,MAIlB,GAJkBA,MAIlB;AAAA,SAHUkC,SAGV,GAHUA,SAGV;AAAA,SADShC,EACT,GADSA,EACT;AACE,SAAKkC,KAAL,GAAa,IAAIrC,kBAAJ,CAAuB,IAAvB,EAA6BE,GAA7B,EAAkCC,EAAlC,CAAb;AACH;;;;UAEDI,K,GAAA,eAAMC,GAAN,EAAmB1F,OAAnB,EAAiD;AAAA,QAA9BA,OAA8B;AAA9BA,aAA8B,GAAJ,EAAI;AAAA;;AAC7C,SAAKmF,MAAL,CAAYM,KAAZ,CAAkBC,GAAlB;AAAyBhF,aAAO,EAAE,KAAK2G;AAAvC,OAAqDrH,OAArD;AACH,G;;UAEDgH,K,GAAA,eAAMnH,EAAN,EAAkB2H,GAAlB,EAA4B;AACxB,SAAKrC,MAAL,CAAY6B,KAAZ,CAAkBnH,EAAlB,EAAsB2H,GAAtB;AACH,G;;UAUKC,S;kGAAN;AAAA;AAAA;AAAA;AAAA;AAAA,oBACQ,KAAKC,MAAL,KAAgB/C,gBAAgB,CAACyB,OADzC;AAAA;AAAA;AAAA;;AAEQ,mBAAKX,KAAL,CAAWmB,0BAAO,CAAC,KAAKvB,EAAL,CAAQlD,OAAT,CAAlB;AAFR;AAAA,qBAG4B,KAAKoF,KAAL,CAAWrB,QAAX,EAH5B;;AAAA;AAGQ,mBAAKwB,MAHb;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;;;;;;;;;;SARA,eAAa;AACT,aAAO,KAAKJ,OAAZ;AACH,K;SAED,aAAWjD,CAAX,EAAgC;AAC5B,WAAKiD,OAAL,GAAejD,CAAf;AACH;;;;;;IAUCsD,e;;;AAMF,2BACoBxC,MADpB,EAEoBtF,EAFpB,EAGoBuF,GAHpB,EAIoB1E,OAJpB,EAKE;AAAA;;AACE,+CADF,CAEE;;AAFF,WAVMkH,aAUN,GAV8BlE,SAU9B;AAAA,WATMmE,eASN,GATyCnE,SASzC;AAAA,WARMoE,OAQN,GARgB,KAQhB;AAAA,WAPMC,aAON,GAPoC,EAOpC;AAAA,WAJkB5C,MAIlB,GAJkBA,MAIlB;AAAA,WAHkBtF,EAGlB,GAHkBA,EAGlB;AAAA,WAFkBuF,GAElB,GAFkBA,GAElB;AAAA,WADkB1E,OAClB,GADkBA,OAClB;;AAGE,WAAKA,OAAL,CAAaG,QAAb,CAAsBC,OAAtB,CAA8B,UAACoD,CAAD,EAAI8D,KAAJ,EAAc;AAAA;;AACxC,UAAMvF,GAAG,GAAGyB,CAAZ;AACA,UAAMrE,EAAE,mBAAG4C,GAAG,CAACN,OAAP,iDAAG,aAAaC,MAAxB;;AACA,UAAI,CAAAvC,EAAE,SAAF,IAAAA,EAAE,WAAF,YAAAA,EAAE,CAAE7B,IAAJ,MAAa,OAAjB,EAA0B;AACtB,YAAM8G,MAAK,GAAGrC,GAAG,CAACN,OAAJ,CAAYE,SAAZ,CAAsB,CAAtB,CAAd;AACA,eAAK0F,aAAL,CAAmBjD,MAAK,CAAC9G,IAAzB,IAAiCgK,KAAjC;AACH;AACJ,KAPD;;AAQA,WAAKC,KAAL;;AAXF;AAYD;;;;UAEDxC,K,GAAA,eAAMC,GAAN,EAAmB1F,OAAnB,EAAiD;AAAA,QAA9BA,OAA8B;AAA9BA,aAA8B,GAAJ,EAAI;AAAA;;AAC7C,SAAKmF,MAAL,CAAYM,KAAZ,CAAkBC,GAAlB;AAAyB7F,QAAE,EAAE,KAAKA;AAAlC,OAAyCG,OAAzC;AACH,G;;UAEDgH,K,GAAA,eAAMnH,EAAN,EAAkB2H,GAAlB,EAA4B;AACxB,SAAKrC,MAAL,CAAY6B,KAAZ,CAAkBnH,EAAlB,EAAsB2H,GAAtB;AACH,G;;UAoBDU,O,GAAA,mBAAU;AACN,QACI,KAAKR,MAAL,KAAgB/C,gBAAgB,CAACwD,KAAjC,IACA,KAAKzH,OAAL,CAAaG,QAAb,CAAsBnB,MAF1B,EAII,KAAK0I,YAAL,GAAoB,CAApB;AACP,G;;UAEDH,K,GAAA,iBAAQ;AACJ,SAAKG,YAAL,GAAoB1E,SAApB;AACA,SAAKoE,OAAL,GAAe,KAAf;AACH,G;;UAEDO,M,GAAA,kBAAS;AACL,SAAKP,OAAL,GAAe,IAAf;AACA,SAAK1C,GAAL,CAASkD,WAAT;AACH,G;;UAEDC,I,GAAA,gBAAO;AACH,QAAI,KAAKV,eAAT,EAA0B;AACtB,WAAKA,eAAL,CAAqBH,MAArB,GAA8B/C,gBAAgB,CAAC6B,SAA/C;AACA,WAAKgC,IAAL;AACH;AACJ,G,CAED;;;UACMC,oB;;;6GAAN,kBAA2BC,UAA3B;AAAA;AAAA;AAAA;AAAA;AAAA,kBAA2BA,UAA3B;AAA2BA,0BAA3B,GAAwC,KAAxC;AAAA;;AAAA,oBACQ,KAAKZ,OAAL,IAAgB,CAAC,KAAKpH,OAAL,CAAaG,QAAb,CAAsBnB,MAD/C;AAAA;AAAA;AAAA;;AAAA,gDAC8DgE,SAD9D;;AAAA;AAEI,kBAAI,KAAK0E,YAAL,KAAsB1E,SAA1B,EAAqC;AACjC,qBAAK0E,YAAL,GAAoB,CAApB;AACH;;AAJL;AAAA,qBAKe,KAAKO,yBAAL,CAA+BD,UAA/B,CALf;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA,6BAK8D,CAACA,UAL/D;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,gDAMe,KAAKb,eANpB;;AAAA;AAAA,mBAOW,KAAKW,IAAL,EAPX;AAAA;AAAA;AAAA;;AAAA,6BAQYE,UARZ;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAQiC,KAAKC,yBAAL,EARjC;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,gDASmB,KAAKd,eATxB;;AAAA;AAAA;AAAA;;AAAA;AAAA,gDAWWnE,SAXX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;;;;;;;;UAcQ8E,I,GAAR,gBAAe;AACX,QACI,KAAKX,eAAL,CAAqBH,MAArB,KAAgC/C,gBAAgB,CAAC6B,SAAjD,IACA,KAAK4B,YAAL,GAAoB,KAAK1H,OAAL,CAAaG,QAAb,CAAsBnB,MAAtB,GAA+B,CAFvD,EAGE;AACE,WAAK0I,YAAL;AACA,aAAO,IAAP;AACH;;AACD,WAAO,KAAP;AACH,G;;UAEOQ,U,GAAR,sBAAqB;AACjB,QAAMnG,GAAG,GAAG,KAAK/B,OAAL,CAAaG,QAAb,CAAsB,KAAK+G,aAA3B,CAAZ;;AACA,QAAInF,GAAG,CAACvC,IAAJ,KAAa,KAAjB,EAAwB;AACpB,YAAM,IAAIgH,wBAAJ,CAAYC,gDAAZ,EAAkC,uBAAlC,CAAN;AACH;;AACD,WAAO1E,GAAP;AACH,G;;UAEakG,yB;kHAAd,kBAAwCD,UAAxC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAwCA,UAAxC;AAAwCA,0BAAxC,GAAqD,KAArD;AAAA;;AACI,mBAAKjD,KAAL,CAAW,YAAX;AACMoD,iBAFV,4BAEgB,KAAKhB,eAAL,CAAqBxC,EAFrC,0DAEgB,sBAAyB5B,QAFzC;AAAA,6BAGQ,CAACiF,UAHT;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAG8B,KAAKvD,MAAL,CAAY2D,iBAAZ,CAA8BD,GAA9B,CAH9B;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,gDAIe,IAJf;;AAAA;AAAA;AAAA,qBAMU,KAAKE,eAAL,EANV;;AAAA;AAOI,mBAAKtD,KAAL,CAAW,UAAX;AAPJ,gDAQW,KARX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;;;;;;;;UAWcsD,e;wGAAd;AAAA;;AAAA;AAAA;AAAA;AAAA;AACUF,iBADV,GACgB,KAAKhB,eAAL,CAAqBxC,EAArB,CAAwB5B,QADxC;AAEI,mBAAK0B,MAAL,CAAY6D,IAAZ,CAAiBC,sBAAjB,EAA2B9B,kDAA3B,EAAkD0B,GAAlD;AAFJ;AAAA;AAAA,qBAIc,KAAKhB,eAAL,CAAqBJ,SAArB,EAJd;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA,oBAMY,wBAAa5C,eANzB;AAAA;AAAA;AAAA;;AAAA,mCAOoBC,OAPpB,QAOoBA,KAPpB;AAQkBkD,mBARlB,GAQ0B,KAAKD,aAAL,CAAmBjD,OAAnB,CAR1B;AASY,mBAAKsD,YAAL,GAAoBJ,KAApB;AACA,mBAAKH,eAAL,CAAqBH,MAArB,GAA8B/C,gBAAgB,CAAC6B,SAA/C;AAVZ;AAAA;;AAAA;AAAA,oBAWmB,wBAAaxB,gBAXhC;AAAA;AAAA;AAAA;;AAYkBkE,iBAZlB;AAaY,mBAAKrB,eAAL,CAAqBH,MAArB,GAA8B/C,gBAAgB,CAACwE,QAA/C;AAbZ;AAAA,qBAckB,KAAKhE,MAAL,CAAYiE,UAAZ,CAAuB,IAAvB,EAA6BF,GAAG,CAACjE,EAAjC,CAdlB;;AAAA;AAAA;AAAA;;AAAA;AAgBY,mBAAK+D,IAAL,CACIC,sBADJ,EAEI9B,gDAFJ,EAGI,KAAKU,eAAL,CAAqBxC,EAArB,CAAwB5B,QAH5B;AAhBZ;;AAAA;AAwBI,kBAAI,KAAKoE,eAAL,CAAqBH,MAArB,KAAgC/C,gBAAgB,CAAC6B,SAArD,EACI,KAAKrB,MAAL,CAAY6D,IAAZ,CACIC,sBADJ,EAEI9B,sDAFJ,EAGI,KAAKU,eAAL,CAAqBxC,EAArB,CAAwB5B,QAH5B;AAKJ,kBAAI,KAAKoE,eAAL,CAAqBH,MAArB,KAAgC/C,gBAAgB,CAACsC,OAArD,EACI,KAAKa,OAAL,GAAe,IAAf;;AA/BR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;;;;;;;;;;SAxFA,eAAa;AACT,aAAO,KAAKA,OAAL,GACDnD,gBAAgB,CAACsC,OADhB,GAED,KAAKW,aAAL,KAAuBlE,SAAvB,GACAiB,gBAAgB,CAACwD,KADjB,GAEA,KAAKN,eAAL,CAAqBH,MAJ3B;AAKH;;;SAED,eAAc;AACV,aAAO,KAAKG,eAAZ;AACH;;;SAED,eAAY;AACR,aACI,KAAKH,MAAL,KAAgB/C,gBAAgB,CAACyB,OAAjC,IAA4C,KAAKwB,aAAL,KAAuB,CADvE;AAGH;;;SAyHD,eAA2B;AACvB,aAAO,KAAKA,aAAZ;AACH,K;SAjBD,aAAyBI,KAAzB,EAAwC;AACpC,UAAIA,KAAK,KAAKtE,SAAd,EAAyB;AACrB,aAAKkE,aAAL,GAAqBlE,SAArB;AACA,aAAKmE,eAAL,GAAuBnE,SAAvB;AACH,OAHD,MAGO,IAAIsE,KAAK,KAAK,KAAKJ,aAAnB,EAAkC;AACrC,aAAKA,aAAL,GAAqBI,KAArB;AACA,aAAKH,eAAL,GAAuB,IAAIT,eAAJ,CACnB,IADmB,EAEnB,KAAKvH,EAFc,EAGnB,KAAKuF,GAHc,EAInB,KAAKwD,UAAL,EAJmB,CAAvB;AAMH;AACJ;;;;EAxKyBS,gC;;AAwL9B,SAASC,cAAT,CAAwB5H,CAAxB,EAAsC;AAClCa,0BAAM,CAAC,CAAC,CAACb,CAAH,CAAN;;AACA,MAAIA,CAAC,CAACb,QAAF,CAAWnB,MAAf,EAAuB;AACnB,QAAM+C,GAAG,GAAIf,CAAC,CAACb,QAAF,CAAW,CAAX,CAAD,CAA6BsB,OAA7B,CACPC,MADL;AAEA,WAAOK,GAAG,CAACzE,IAAJ,KAAa,MAApB;AACH;;AACD,SAAO,KAAP;AACH;;AAEM,IAAKuL,QAAZ;;WAAYA,Q;AAAAA,U;AAAAA,U;AAAAA,U;GAAAA,Q,KAAAA,Q;;AAML,IAAMC,eAAb;AAAA;;AACI;AAYA;AAKA,2BACaC,GADb,EAEaC,WAFb,EAGaC,OAHb,EAIE;AAAA;;AACE;AADF,WApBMC,eAoBN,GApB2C,EAoB3C;AAAA,WAlBMC,MAkBN,GAlByB,EAkBzB;AAAA,WAfMC,UAeN,GAfsC,EAetC;AAAA,WAdMC,WAcN,GAduC,EAcvC;AAAA,WAbMC,SAaN,GAbqC,EAarC;AAAA,WAXMC,WAWN,GAXuC,EAWvC;AAAA,WARMC,MAQN,GAR0B,EAQ1B;AAAA,WAPMC,OAON,GAP+B,EAO/B;AAAA,WAgSMC,OAhSN,GAgSgB,KAhShB;AAAA,WAHWX,GAGX,GAHWA,GAGX;AAAA,WAFWC,WAEX,GAFWA,WAEX;AAAA,WADWC,OACX,GADWA,OACX;AAEE,QAAMU,QAAQ,GAAGjJ,cAAc,CAACuI,OAAD,CAA/B;;AACA,wBAAsCvG,YAAY,CAACiH,QAAD,CAAlD;AAAA,QAAQjG,SAAR,iBAAQA,SAAR;AAAA,QAAmBK,MAAnB,iBAAmBA,MAAnB;AAAA,QAA2B7C,MAA3B,iBAA2BA,MAA3B;;AACA,WAAKiI,MAAL,GAAcQ,QAAQ,CAAC9I,KAAvB;;AACA,QAAIK,MAAM,CAAClC,MAAX,EAAmB;AACf4K,aAAO,CAACC,IAAR,CAAa,QAAb,EAAuB3I,MAAvB;AACH,KAPH,CAQE;;;AACA,WAAK0F,OAAL,GAAeiC,QAAQ,CAACtC,OAAxB;AACA,WAAKuD,IAAL,GAAY,IAAIC,iCAAJ,CAAkBrG,SAAlB,EAA6BK,MAA7B,CAAZ;AACA,WAAKmF,eAAL,GAAuBS,QAAQ,CAAC7I,QAAT,CAAkBC,GAAlB,CACnB,UAACC,CAAD,EAAIsG,KAAJ;AAAA,aAAc,IAAIL,eAAJ,mDAA0BK,KAA1B,EAAiC,OAAKwC,IAAtC,EAA4C9I,CAA5C,CAAd;AAAA,KADmB,CAAvB,CAXF,CAcE;;AACA;AACR;AACA;AACA;AACA;AACA;AACA;;AAEQ,WAAKgJ,aAAL,GAAqB,IAAIC,sBAAJ,EAArB;AACA,WAAKC,YAAL,GAAoB,IAAID,sBAAJ,EAApB;AACA,WAAKE,WAAL,GAAmB,IAAIF,sBAAJ,EAAnB,CAzBF,CA0BE;;AACA,WAAKG,KAAL,CACI,OAAKN,IAAL,CAAUO,SAAV,CAAoBC,yBAApB,EAA4B,YAAM;AAC9B,aAAKC,gBAAL;AACH,KAFD,CADJ;;AAKA,WAAKH,KAAL,CACI,OAAKC,SAAL,CACInG,eADJ;AAAA,+FAEI,kBAAOlD,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACU,OAAKwJ,WAAL,CAAiBxJ,CAAjB,CADV;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAFJ;;AAAA;AAAA;AAAA;AAAA,QADJ;;AAQA,WAAKyJ,wBAAL;;AAxCF;AAyCD,GA/DL,CAiEI;;;AAjEJ;;AAAA,UAsEYC,SAtEZ,GAsEI,mBAAkB/G,CAAlB,EAA+B;AAC3B,QAAIA,CAAC,KAAK,KAAKiD,OAAf,EAAwB;AACpB,WAAKA,OAAL,GAAejD,CAAf;AACA,WAAK2E,IAAL,CAAUgC,yBAAV;AACH;AACJ,GA3EL,CA6EI;AA7EJ;;AAAA,UA8EIvF,KA9EJ,GA8EI,eAAM9B,OAAN,EAAuB3D,OAAvB,EAAqD;AAAA,QAA9BA,OAA8B;AAA9BA,aAA8B,GAAJ,EAAI;AAAA;;AACjD,SAAKgJ,IAAL,CAAUqC,wBAAV,EAAiB;AAAE1H,aAAO,EAAPA,OAAF;AAAW3D,aAAO,EAAPA;AAAX,KAAjB;AACH,GAhFL,CAkFI;AAlFJ;;AAAA,UAmFIgH,KAnFJ,GAmFI,eAAMvD,QAAN,EAAwB6H,KAAxB,EAA+C;AAC3C,QAAMC,QAAQ,GAAG,KAAKrB,MAAL,CAAYzG,QAAZ,CAAjB;;AACA,QAAI8H,QAAQ,KAAKD,KAAjB,EAAwB;AACpB,WAAKpB,MAAL,CAAYzG,QAAZ,IAAwB6H,KAAxB;AACA,WAAKtC,IAAL,CAAUC,sBAAV,EAAoB9B,4CAApB,EAAwC1D,QAAxC;AACH;AACJ,GAzFL;;AAAA,UA2FI+H,WA3FJ,GA2FI,qBAAY/H,QAAZ,EAA8B;AAC1B,WAAO,KAAKyG,MAAL,CAAYzG,QAAZ,CAAP;AACH,GA7FL,CA+FI;AA/FJ;;AAAA,UAgGUgI,mBAhGV;AAAA;AAAA;AAAA,4GAgGI,kBAA0BC,MAA1B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACU,KAAKd,YAAL,CAAkBe,OAAlB,4FAA0B;AAAA;AAAA;AAAA;AAAA;AAC5B,8BAAI,CAACxB,OAAL,GAAe,EAAf;AACAuB,8BAAM,CAAC5K,OAAP,CAAe,UAAA8K,CAAC,EAAI;AAChB,gCAAI,CAACzB,OAAL,CAAayB,CAAb,IAAkB,IAAlB;AACH,yBAFD;;AAF4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAA1B,GADV;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAhGJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA,UAyGUC,qBAzGV;AAAA,8GAyGI;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACU,KAAKjB,YAAL,CAAkBe,OAAlB,4FAA0B;AAAA;AAAA;AAAA;AAAA;AAC5B,8BAAI,CAACxB,OAAL,GAAe,EAAf;;AAD4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAA1B,GADV;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAzGJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA,UA+GUrB,iBA/GV;AAAA,0GA+GI,mBAAwBjJ,EAAxB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AACQiM,iBADR,GACc,KADd;AAAA;AAAA,qBAEU,KAAKlB,YAAL,CAAkBe,OAAlB,4FAA0B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAC5BG,2BAAG,GAAG,CAAC,oBAAC,MAAI,CAAC3B,OAAN,2CAAC,eAAetK,EAAf,CAAD,CAAP;;AAD4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAA1B,GAFV;;AAAA;AAAA,iDAKWiM,GALX;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA/GJ;;AAAA;AAAA;AAAA;;AAAA;AAAA,MAuHI;AAvHJ;;AAAA,UAwHU1C,UAxHV;AAAA;AAAA;AAAA,mGAwHI,mBACI2C,aADJ,EAEI9G,EAFJ,EAGIvE,OAHJ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,kBAGIA,OAHJ;AAGIA,uBAHJ,GAGyBgD,SAHzB;AAAA;;AAAA;AAAA,qBAKU,KAAKmH,WAAL,CAAiBc,OAAjB,4FAAyB;AAAA;AAAA;AAAA;AAAA;AAAA;AACrB9L,0BADqB,GAChBmM,UAAU,CAAC,YAAM;AACxB,iCAAI,CAAChD,IAAL,CACIpE,eADJ,EAEImH,aAAa,GAAGA,aAAH,GAAmBrL,OAFpC;AAIH,yBALoB,EAKlBuE,EALkB,CADM;;AAO3B,+BAAI,CAACgF,WAAL,CAAiB/H,IAAjB,CAAsB;AAAE+C,4BAAE,EAAFA,EAAF;AAAM8G,uCAAa,EAAbA,aAAN;AAAqBlM,4BAAE,EAAFA,EAArB;AAAyBa,iCAAO,EAAPA;AAAzB,yBAAtB;;AAP2B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAzB,GALV;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAxHJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA,UAwIkBwK,WAxIlB;AAAA,oGAwII,mBAA0BxJ,CAA1B;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEQ;AACIqK,2BAHZ,GAG6CrI,SAH7C,EAIQ;;AAJR;AAAA,qBAKc,KAAKmH,WAAL,CAAiBc,OAAjB,4FAAyB;AAAA;AAAA;AAAA;AAAA;AAAA;AACrB3D,6BADqB,GACb,OAAI,CAACiC,WAAL,CAAiBgC,SAAjB,CACV,UAAAC,CAAC;AAAA,iCAAI,CAAAA,CAAC,SAAD,IAAAA,CAAC,WAAD,YAAAA,CAAC,CAAEH,aAAH,MAAqBrK,CAAzB;AAAA,yBADS,CACkB;AADlB,yBADa;AAI3Ba,gDAAM,CAACyF,KAAK,IAAE,CAAR,CAAN;;AACA,4BAAIA,KAAK,IAAI,CAAb,EAAgB;AACNkE,2BADM,GACF,OAAI,CAACjC,WAAL,CAAiBjC,KAAjB,CADE,EAEZ;;AAAA;AACA+D,uCAAa,GAAGG,CAAC,CAACH,aAAlB,CAHY,CAIZ;;AAAA;AACA,iCAAI,CAAC9B,WAAL,CAAiBkC,MAAjB,CAAwBnE,KAAxB,EAA+B,CAA/B,EALY,CAMZ;;AACH;;AAZ0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAzB,GALd;;AAAA;AAAA,oBAmBY,KAAKN,MAAL,KAAgB6B,QAAQ,CAACtC,OAnBrC;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA,qBAqBc,KAAKyD,aAAL,CAAmBiB,OAAnB,4FAA2B;AAAA;AAAA;AAAA;AAAA;AAC7B;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACgB,4BAAII,aAAJ,EAAmB;AACf;AACAA,uCAAa,CAACxD,IAAd;;AACA,iCAAI,CAACyB,SAAL,CAAe9H,IAAf,CAAoB6J,aAApB;AACH;;AAhB4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAA3B,GArBd;;AAAA;AAuCQ;AACZ;AACA;AACA;AACA;AACA;AACY,kBAAIA,aAAJ,EAAmB,KAAKK,QAAL;AA7C3B;AAAA;;AAAA;AAAA;AAAA;AA+CQ9B,qBAAO,CAAC+B,KAAR;AACA,mBAAKrD,IAAL,CAAUC,sBAAV,EAAoB9B,gDAApB;;AAhDR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAxIJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA,UA4LUmF,UA5LV;AAAA,mGA4LI;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,oBACQ,KAAK5E,MAAL,KAAgB6B,QAAQ,CAACtC,OADjC;AAAA;AAAA;AAAA;;AAAA;;AAAA;AACiD;AAC7C,mBAAKxB,KAAL,CAAW,OAAX;AAFJ;AAIQ,mBAAKiE,WAAL,CAAiB6C,QAAjB,CAA0B,KAAK1C,MAA/B;AAJR;AAAA,qBAKc,KAAKa,aAAL,CAAmBiB,OAAnB,4FAA2B;AAAA;AAAA;AAAA;AAAA;AAC7B,+BAAI,CAAC7B,UAAL,GAAkB,OAAI,CAACF,eAAL,CAAqBvL,KAArB,CAA2B,CAA3B,CAAlB;;AACA,+BAAI,CAACyL,UAAL,CAAgBhJ,OAAhB,CAAwB,UAAAY,CAAC;AAAA,iCAAIA,CAAC,CAACuG,KAAF,EAAJ;AAAA,yBAAzB;;AACA,+BAAI,CAAC+B,SAAL,GAAiB,EAAjB;AACA,+BAAI,CAACD,WAAL,GAAmB,EAAnB,CAJ6B,CAK7B;;AACA;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAlB6C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAA3B,GALd;;AAAA;AAyBQ,mBAAK8B,qBAAL;AACA,mBAAKT,SAAL,CAAe7B,QAAQ,CAACnD,OAAxB;AACA,mBAAK6E,gBAAL;AACA,mBAAKmB,QAAL;AA5BR;AAAA;;AAAA;AAAA;AAAA;AA8BQ9B,qBAAO,CAAC+B,KAAR;AACA,mBAAKrD,IAAL,CAAUC,sBAAV,EAAoB9B,gDAApB;;AA/BR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA5LJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA,UA+NIkB,MA/NJ,GA+NI,kBAAS;AACL,QAAI,KAAKX,MAAL,KAAgB6B,QAAQ,CAACtC,OAA7B,EAAsC,OADjC,CACwC;;AAC7C,SAAKmE,SAAL,CAAe7B,QAAQ,CAACtC,OAAxB;AACA,SAAKxB,KAAL,CAAW,WAAX;AACH,GAnOL;;AAAA,UAqOU+G,WArOV;AAAA,oGAqOI;AAAA;AAAA;AAAA;AAAA;AAAA,oBACQ,KAAK9E,MAAL,KAAgB6B,QAAQ,CAACkD,MADjC;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAEI,mBAAKhH,KAAL,CAAW,QAAX;AACA,mBAAK2F,SAAL,CAAe7B,QAAQ,CAACnD,OAAxB;AAHJ;AAAA,qBAIU,KAAKgG,QAAL,EAJV;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KArOJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA,UA4OU3E,SA5OV;AAAA,mGA4OI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACQ,KAAKC,MAAL,KAAgB6B,QAAQ,CAACkD,MADjC;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAEI,mBAAKhH,KAAL,CAAW,MAAX;AAFJ;AAAA,qBAGoB,KAAKiH,gBAAL,EAHpB;;AAAA;AAGUhL,eAHV;;AAAA,mBAIQA,CAJR;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAKc,KAAKiL,eAAL,CAAqBjL,CAArB,EAAwB,IAAxB,CALd;;AAAA;AAAA;AAAA,qBAMc,KAAKkL,kBAAL,CAAwBlL,CAAxB,CANd;;AAAA;AAAA;AAAA,qBAO8B,KAAKgL,gBAAL,EAP9B;;AAAA;AAOcG,qBAPd;;AAQQ,kBAAIA,OAAO,IAAIA,OAAO,KAAKnL,CAA3B,EAA8B;AAC1B,qBAAKoL,cAAL,CAAoBD,OAApB;AACH;;AAVT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA5OJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA,UA0PYC,cA1PZ,GA0PI,wBAAuBpL,CAAvB,EAA2C;AAAA;;AACvC,SAAKsH,IAAL,CACIC,sBADJ,EAEI9B,0CAFJ,EAGIzF,CAHJ,EAIIA,CAAC,CAACgG,MAAF,KAAa/C,gBAAgB,CAAC6B,SAA9B,GACM,EADN,oBAEM9E,CAAC,CAACS,OAAF,CAAUkD,EAFhB,kDAEM,cAAc5B,QANxB;AAQH,GAnQL;;AAAA,UAqQkBkJ,eArQlB;AAAA,wGAqQI,mBAA8BjL,CAA9B,EAAkDqL,OAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAkDA,OAAlD;AAAkDA,uBAAlD,GAA4D,KAA5D;AAAA;;AAAA;AAAA;AAAA,qBAEiCrL,CAAC,CAAC+G,oBAAF,CAAuBsE,OAAvB,CAFjC;;AAAA;AAEcC,wBAFd;;AAGQ,kBAAKA,UAAU,IAAI,CAACD,OAAhB,IAA4B,KAAKrF,MAAL,KAAgB6B,QAAQ,CAACkD,MAAzD,EAAiE;AAC7D,qBAAKrB,SAAL,CAAe7B,QAAQ,CAACkD,MAAxB;AACA,qBAAKK,cAAL,CAAoBpL,CAApB;AACH;;AACD,kBAAIA,CAAC,CAACgG,MAAF,KAAa/C,gBAAgB,CAAC6B,SAAlC,EAA6C;AACzC9E,iBAAC,CAACuG,KAAF;AACH;;AATT;AAAA;;AAAA;AAAA;AAAA;;AAWQ,kBAAI,yBAAagF,4CAAjB,EAA2C;AACvC,qBAAKjE,IAAL,CACIC,sBADJ,EAEI9B,4CAFJ,EAGI,cAAgCvE,IAHpC;AAKH,eAND,MAMO;AACH0H,uBAAO,CAAC+B,KAAR;AACA,qBAAKrD,IAAL,CAAUC,sBAAV,EAAoB9B,gDAApB;AACH,eApBT,CAqBQ;;;AACAzF,eAAC,CAACuG,KAAF;;AAtBR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KArQJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA,UA+RkB2E,kBA/RlB;AAAA,2GA+RI,mBAAiClL,CAAjC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAEQA,CAAC,CAACgG,MAAF,KAAa/C,gBAAgB,CAACwD,KAA9B,IACAzG,CAAC,CAACgG,MAAF,KAAa/C,gBAAgB,CAACwE,QAHtC;AAAA;AAAA;AAAA;;AAKc+D,wBALd,GAK2BxL,CAAC,CAACgG,MAAF,KAAa/C,gBAAgB,CAACwD,KALzD;AAMYgF,kBANZ,GAMoCzJ,SANpC;AAAA;AAAA,qBAOc,KAAKgH,aAAL,CAAmBiB,OAAnB,4FAA2B;AAAA;AAAA;AAAA;AAAA;AAC7B,4BAAI,OAAI,CAAC3B,SAAL,CAAetK,MAAnB,EAA2B;AACvB6C,kDAAM,CAACb,CAAC,KAAK,OAAI,CAACsI,SAAL,CAAe,CAAf,CAAP,CAAN;AACAmD,8BAAI,GAAG,OAAI,CAACnD,SAAL,CAAeoD,KAAf,EAAP;;AACA,8BAAIF,UAAU,IAAI,CAAC5D,cAAc,CAAC5H,CAAC,CAAChB,OAAH,CAAjC,EAA8C;AAC1C,mCAAI,CAACoJ,UAAL,CAAgB5H,IAAhB,CAAqBiL,IAArB;;AACAA,gCAAI,GAAGzJ,SAAP;AACH;AACJ;;AAR4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAA3B,GAPd;;AAAA;AAAA,oBAiBYyJ,IAAI,IAAIzL,CAAC,CAACgG,MAAF,KAAa/C,gBAAgB,CAACwD,KAAtC,IAA+CmB,cAAc,CAAC5H,CAAC,CAAChB,OAAH,CAjBzE;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAkBkB,KAAKiM,eAAL,CAAqBjL,CAArB,CAlBlB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA/RJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA,UAuTkB0K,QAvTlB;AAAA,iGAuTI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACQ,KAAK1E,MAAL,KAAgB6B,QAAQ,CAACtC,OADjC;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA,mBAEQ,KAAKmD,OAFb;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAGI,mBAAK3E,KAAL,CAAW,KAAX;AACA,mBAAK2E,OAAL,GAAe,IAAf;AAJJ;AAAA;AAAA,qBAMc,KAAKI,IAAL,CAAU6C,qBAAV,EANd;;AAAA;AAOY3L,eAPZ,GAOiCgC,SAPjC;;AAAA;AAAA,8BASY,KAAKgE,MAAL,KAAgB6B,QAAQ,CAACnD,OATrC;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAUuB,KAAKsG,gBAAL,EAVvB;;AAAA;AAAA,8BAUahL,CAVb;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAYYa,sCAAM,CAAC,CAACb,CAAC,CAAC4L,KAAJ,CAAN;AAZZ;AAAA,qBAakB,KAAKX,eAAL,CAAqBjL,CAArB,CAblB;;AAAA;AAAA;AAAA,qBAckB,KAAKkL,kBAAL,CAAwBlL,CAAxB,CAdlB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAiBQ4I,qBAAO,CAAC+B,KAAR;AACA,mBAAKrD,IAAL,CAAUC,sBAAV,EAAoB9B,gDAApB;;AAlBR;AAoBI,mBAAKiD,OAAL,GAAe,KAAf;AACA,mBAAK3E,KAAL,CAAW,SAAX;;AArBJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAvTJ;;AAAA;AAAA;AAAA;;AAAA;AAAA,MA+UI;AA/UJ;;AAAA,UAgVkBwF,gBAhVlB;AAAA;AAAA;AAAA,yGAgVI;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,oBACQ,KAAKvD,MAAL,KAAgB6B,QAAQ,CAACtC,OADjC;AAAA;AAAA;AAAA;;AAEYsG,sBAFZ,GAE0C7J,SAF1C;AAAA;AAAA,qBAGc,KAAKgH,aAAL,CAAmBiB,OAAnB,4FAA2B;AAAA;AAAA;AAAA;AAAA;AAAA,8BACzB,OAAI,CAACjE,MAAL,KAAgB6B,QAAQ,CAACkD,MAAzB,IAAmC,OAAI,CAACzC,SAAL,CAAetK,MADzB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAG7B6N,gCAAQ,GAAG,OAAI,CAACzD,UAAL,CAAgBzL,KAAhB,CAAsB,CAAtB,CAAX;;AAH6B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAA3B,GAHd;;AAAA;AAAA,kBAQakP,QARb;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAUcC,6BAVd,GAU6C,EAV7C;AAWcC,wBAXd,GAW8C,EAX9C;AAYcC,6BAZd,GAYmD,EAZnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAamBhM,yBAbnB;AAAA;AAAA,+BAckB,OAAI,CAACiL,eAAL,CAAqBjL,CAArB,EAAwB,IAAxB,CAdlB;;AAAA;AAeY,4BAAIA,CAAC,CAACgG,MAAF,KAAa/C,gBAAgB,CAACwE,QAAlC,EAA4C;AACxCuE,yCAAe,CAACxL,IAAhB,CAAqBR,CAArB;AACH,yBAFD,MAEO,IACH,CAACA,CAAC,CAAC4L,KAAH,IACAE,eAAe,CAACvB,SAAhB,CAA0B,UAAA0B,EAAE;AAAA,iCAAIA,EAAE,KAAKjM,CAAC,CAAChB,OAAb;AAAA,yBAA5B,MAAsD,CAAC,CAFpD,EAGL;AACE+M,oCAAU,CAACvL,IAAX,CAAgBR,CAAhB;AACA8L,yCAAe,CAACtL,IAAhB,CAAqBR,CAAC,CAAChB,OAAvB;AACH;;AAvBb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0DAawB6M,QAbxB;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,qBAyBc,KAAK7C,aAAL,CAAmBiB,OAAnB,4FAA2B;AAAA;AAAA;AAAA;AAAA;AAC7B8B,kCAAU,CAAC3M,OAAX,CAAmB,UAAAY,CAAC,EAAI;AACpB,iCAAI,CAACsI,SAAL,CAAe9H,IAAf,CAAoBR,CAApB;;AACA,8BAAMsG,KAAK,GAAG,OAAI,CAAC8B,UAAL,CAAgB8D,OAAhB,CAAwBlM,CAAxB,CAAd;;AACA,8BAAIsG,KAAK,IAAI,CAAb,EACI,OAAI,CAAC8B,UAAL,CAAgBqC,MAAhB,CAAuBnE,KAAvB,EAA8B,CAA9B;AACP,yBALD;AAMA0F,uCAAe,CAAC5M,OAAhB,CAAwB,UAAAY,CAAC,EAAI;AACzB,8BAAMsG,KAAK,GAAG,OAAI,CAAC8B,UAAL,CAAgB8D,OAAhB,CAAwBlM,CAAxB,CAAd;;AACA,8BAAIsG,KAAK,IAAI,CAAb,EACI,OAAI,CAAC8B,UAAL,CAAgBqC,MAAhB,CAAuBnE,KAAvB,EAA8B,CAA9B;AACP,yBAJD;;AAP6B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAA3B,GAzBd;;AAAA;AAsCQ,mBAAKwC,IAAL,CAAUqD,YAAV;;AACA,mBAAKzB,QAAL;;AAvCR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAhVJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA,UA2XkBM,gBA3XlB;AAAA,yGA2XI;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACiB,KAAKhC,aAAL,CAAmBiB,OAAnB,4FAA2B;AAAA;AAAA;AAAA;AAAA;AAAA,6BAChC,OAAI,CAAC3B,SAAL,CAAetK,MADiB;AAAA;AAAA;AAAA;;AAAA,2DACF,OAAI,CAACsK,SAAL,CAAe,CAAf,CADE;;AAAA;AAAA,2DAE7BtG,SAF6B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAA3B,GADjB;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA3XJ;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA,UAkYYyH,wBAlYZ,GAkYI,oCAAmC;AAAA;;AAC/B;AACA,QAAM2C,cAAc,GAAG,SAAjBA,cAAiB,CAAClL,IAAD,EAAkB;AACrC,UAAMO,OAAO,GAAG,OAAI,CAACuG,WAAL,CAAiBqE,UAAjB,CAA4BnL,IAA5B,CAAhB;;AACA,UAAIO,OAAJ,EAAa;AACT,eAAI,CAACqH,IAAL,CAAUwD,cAAV,CAAyBpL,IAAzB,EAA+BO,OAA/B;AACH;AACJ,KALD,CAF+B,CAQ/B;;;AACA,SAAKuG,WAAL,CAAiBnI,KAAjB,CAAuBT,OAAvB,CAA+B,UAAAmN,CAAC,EAAI;AAChC,UAAI,OAAI,CAACpE,MAAL,CAAY/G,IAAZ,CAAiB,UAAAoL,EAAE;AAAA,eAAIA,EAAE,CAACtL,IAAH,KAAYqL,CAAC,CAACrL,IAAlB;AAAA,OAAnB,CAAJ,EAAgD;AAC5CkL,sBAAc,CAACG,CAAC,CAACrL,IAAH,CAAd;AACH;AACJ,KAJD;AAKA,SAAKkI,KAAL,CACI,KAAKpB,WAAL,CAAiBqB,SAAjB,CAA2BoD,6BAA3B;AAAA,gGAAuC,mBAAOvL,IAAP;AAAA;AAAA;AAAA;AAAA;AACnCkL,8BAAc,CAAClL,IAAD,CAAd;;AADmC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAvC;;AAAA;AAAA;AAAA;AAAA,QADJ;AAKA,SAAKkI,KAAL,CACI,KAAKpB,WAAL,CAAiBqB,SAAjB,CAA2BqD,+BAA3B,EAAyC,UAACxL,IAAD,EAAkB;AACvD,aAAI,CAAC4H,IAAL,CAAUwD,cAAV,CAAyBpL,IAAzB,EAA+Bc,SAA/B;AACH,KAFD,CADJ;AAKH,GA1ZL;;AAAA;AAAA;AAAA,SAkEI,eAAa;AACT,aAAO,KAAK4D,OAAZ;AACH;AApEL;;AAAA;AAAA,EAAqC+G,sBAArC,E;;;;;;;;CCzcA;;AAEA;AAIA;AACA;AACA;AACA;AAGe,SAASC,WAAT,CACX5E,WADW,EAEXC,OAFW,EAGX4E,OAHW,EAIb;AACE,oBAAgBC,oBAAU,CAAqBC,sBAArB,CAA1B;AAAA,MAAQhF,GAAR,eAAQA,GAAR;;AACA,qBAAqB+E,oBAAU,CAACE,0BAAD,CAA/B;AAAA,MAAQC,QAAR,gBAAQA,QAAR;;AACA,kBAA4BvP,kBAAQ,EAApC;AAAA,MAAOwP,MAAP;AAAA,MAAeC,SAAf;;AACA,mBAAoCzP,kBAAQ,CAAU,CAAC,CAACmP,OAAZ,CAA5C;AAAA,MAAOO,UAAP;AAAA,MAAmBC,aAAnB;;AAEA,MAAMC,GAAG;AAAA,4FAAG;AAAA;AAAA;AAAA;AAAA;AACRD,2BAAa,CAAC,CAAC,CAACR,OAAH,CAAb;;AADQ;AAAA,qBAEFK,MAAM,CAACtC,UAAP,EAFE;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAH0C,GAAG;AAAA;AAAA;AAAA,KAAT;;AAIA,MAAM3G,MAAM;AAAA,6FAAG;AAAA;AAAA;AAAA;AAAA;AACX0G,2BAAa,CAAC,KAAD,CAAb;;AACAH,oBAAM,CAACvG,MAAP;;AAFW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAANA,MAAM;AAAA;AAAA;AAAA,KAAZ,CAVF,CAeE;;;AACA4G,qBAAS,CAAC,YAAM;AACZ,QAAIH,UAAU,IAAIF,MAAlB,EAA0BA,MAAM,CAACtC,UAAP;AAC1B,WAAO;AAAA,aAAMsC,MAAN,aAAMA,MAAN,uBAAMA,MAAM,CAAEvG,MAAR,EAAN;AAAA,KAAP;AACH,GAHQ,EAGN,CAACuG,MAAD,EAASE,UAAT,CAHM,CAAT,CAhBF,CAqBE;;AACAG,qBAAS,CAAC,YAAM;AACZ,QAAI;AACA,UAAMC,aAAa,GACfvF,OAAO,IAAI,IAAIH,eAAJ,CAAoBC,GAApB,EAAyBC,WAAzB,EAAsCC,OAAtC,CADf;AAEAkF,eAAS,CAACK,aAAD,CAAT;AAEA,aAAO;AAAA,eAAMA,aAAN,aAAMA,aAAN,uBAAMA,aAAa,CAAEC,OAAf,EAAN;AAAA,OAAP;AACH,KAND,CAME,OAAO3L,CAAP,EAAU;AACR8G,aAAO,CAAC+B,KAAR,CAAc7I,CAAd;AACAqL,eAAS,CAACnL,SAAD,CAAT;AACH;AACJ,GAXQ,EAWN,CAACgG,WAAD,EAAcC,OAAd,CAXM,CAAT,CAtBF,CAmCE;;AACAsF,qBAAS,CAAC;AAAA,WAAML,MAAN,aAAMA,MAAN,uBAAMA,MAAM,CAAE7D,SAAR,CAAkBqE,wBAAlB,EAAyB,UAAA5L,CAAC;AAAA,aAAImL,QAAQ,CAACnL,CAAD,CAAZ;AAAA,KAA1B,CAAN;AAAA,GAAD,EAAmD,CAACoL,MAAD,CAAnD,CAAT,CApCF,CAqCE;;AACA,MAAMS,WAAW,GAAG,SAAdA,WAAc,CAAC/D,KAAD,EAGd;AACF,QAAQ3H,OAAR,GAA6B2H,KAA7B,CAAQ3H,OAAR;AAAA,QAAiB3D,OAAjB,GAA6BsL,KAA7B,CAAiBtL,OAAjB;AACA,QAAIsP,4CAAJ,EAAuBhF,OAAO,CAAC+B,KAAR,UAAqB1I,OAArB,EAAgC3D,OAAhC;AAC1B,GAND;;AAOAiP,qBAAS,CACL;AAAA,WACIL,MADJ,aACIA,MADJ,uBACIA,MAAM,CAAE7D,SAAR,CACIM,wBADJ,EAEIgE,WAFJ,CADJ;AAAA,GADK,EAML,CAACT,MAAD,CANK,CAAT;AASA,SAAO;AAAEA,UAAM,EAANA,MAAF;AAAUI,OAAG,EAAHA,GAAV;AAAe3G,UAAM,EAANA;AAAf,GAAP;AACH,C;;;;;;ACxED;AACA;AAEA;AAEe,SAASkH,aAAT,CAAuB3Q,KAAvB,EAAsD;AACjE,MAAQ+K,OAAR,GAAoB/K,KAApB,CAAQ+K,OAAR;AACA,sBACI,oBAAC,mBAAD;AAAM,QAAI,MAAV;AAAW,MAAE,EAAE;AAAf,kBACI,oBAAC,yBAAD;AAAY,WAAO,EAAC;AAApB,UADJ,eAEI,oBAAC,iBAAD;AACI,aAAS,EAAC,MADd;AAEI,gBAAY,EAAE,cAFlB;AAGI,gBAAY,EAAE6F,IAAI,CAACC,SAAL,CAAe9F,OAAf,EAAwB,IAAxB,EAA8B,CAA9B;AAHlB,KAKK6F,IAAI,CAACC,SAAL,CAAe9F,OAAf,EAAwB,IAAxB,EAA8B,CAA9B,CALL,CAFJ,CADJ;AAYH,C;;;;;;;;;;;;;;;;;;;;ACnBD;CAEA;;AACA;AACA;AACA;AAEA;AAIA;AAEA;AACA;AACA;AACA;;AAEA,SAAS+F,QAAT,CAAkB9Q,KAAlB,EAKG;AACC,oBAAsB4P,oBAAU,CAACmB,2BAAD,CAAhC;AAAA,MAAQC,SAAR,eAAQA,SAAR;;AACA,MAAQhN,IAAR,GAA0ChE,KAA1C,CAAQgE,IAAR;AAAA,MAAcO,OAAd,GAA0CvE,KAA1C,CAAcuE,OAAd;AAAA,MAAuBD,cAAvB,GAA0CtE,KAA1C,CAAuBsE,cAAvB;;AACA,qBAAgBsL,oBAAU,CAAqBC,sBAArB,CAA1B;AAAA,MAAQhF,GAAR,gBAAQA,GAAR;;AACA,MAAMoG,MAAM,GAAGC,mCAAgB,CAAC3M,OAAD,CAA/B;;AACA,MAAM4M,eAAe,GAAG,SAAlBA,eAAkB,GAAM;AAC1B;AACA,QAAI,CAAC5M,OAAL,EAAc;AACV,UAAM6M,aAAa,GAAG/M,6CAA4B,CAACC,cAAD,CAAlD;AACA,UAAI8M,aAAJ,EACIC,sCAAkB,CACdxG,GADc,EAEdyG,6DAAyC,CACrCF,aAAa,CAACG,eADuB,CAF3B,CAAlB;AAMP,KAXyB,CAY1B;;;AACA,QAAIP,SAAJ,EAAe;AACX;AACA,UAAIQ,SAAS,GAAGR,SAAS,CACpBS,YADW,CACE,KADF,EAEXvN,IAFW,CAGR,UAAA8I,CAAC;AAAA;;AAAA,eACGA,CAAC,CAAC1L,IAAF,KAAWoQ,0BAAX,IACA,0BACI1E,CAAC,CAAC2E,SAAF,CAAY,CAAZ,EAAeC,QAAf,CAAwB1N,IAAxB,CACI,UAAA2N,CAAC;AAAA,iBAAIA,CAAC,CAACzS,IAAF,KAAW,MAAf;AAAA,SADL,CADJ,0GAIG0S,WAJH,oFAIkB1S,IAJlB,MAI2B4E,IAN9B;AAAA,OAHO,CAAhB;;AAWA,UAAI,CAACwN,SAAL,EAAgB;AACZA,iBAAS,GAAGR,SAAS,CAACe,QAAV,CAAmBL,0BAAnB,CAAZ;AACA,YAAMM,QAAQ,GAAGhB,SAAS,CAACc,WAAV,CAAsB9N,IAAtB,EAA4BM,cAA5B,CAAjB;AACA,YAAM7C,KAAK,GAAG+P,SAAS,CAACG,SAAV,CAAoB,CAApB,EAAuBC,QAAvB,CAAgC1N,IAAhC,CACV,UAAA2N,CAAC;AAAA,iBAAIA,CAAC,CAACzS,IAAF,KAAW,MAAf;AAAA,SADS,CAAd;AAGAqC,aAAK,CAACwQ,QAAN,CAAeD,QAAQ,CAACE,KAAT,EAAf;AACA,YAAMC,CAAC,GAAGnB,SAAS,CAACoB,UAAV,EAAV;AACAZ,iBAAS,CAACa,MAAV,CAAiBF,CAAC,CAACG,SAAF,GAAc,CAA/B,EAAkCH,CAAC,CAACI,UAAF,GAAe,CAAjD;AACAf,iBAAS,CAACgB,OAAV;AACAhB,iBAAS,CAACiB,MAAV,CAAiB,KAAjB;AACH;;AACDzB,eAAS,CAAC0B,aAAV,CAAwBlB,SAAS,CAACvQ,EAAlC;AACH;AACJ,GAxCD;;AA0CA,MAAM0R,YAAY,GAAG,SAAfA,YAAe;AAAA,WAAM9H,GAAG,CAAC+H,qBAAJ,CAA0B3B,MAAM,CAAC4B,MAAjC,CAAN;AAAA,GAArB;;AACA,sBACI,oBAAC,mBAAD;AACI,SAAK,EAAE7O,IADX;AAEI,WAAO,EAAEO,OAAO,GAAG,SAAH,GAAe,UAFnC;AAGI,UAAM,EAAEA,OAAO,iBAAI,oBAAC,2BAAD;AAAc,YAAM,EAAEA,OAAO,CAACsO;AAA9B,MAHvB;AAII,WAAO,EAAE1B,eAJb;AAKI,YAAQ,EAAEF,MAAM,GAAG0B,YAAH,GAAkB7N,SALtC;AAMI,cAAU,eACN,oBAAC,uBAAD;AAAS,WAAK,EAAC;AAAf,oBACI,oBAAC,qBAAD,OADJ;AAPR,IADJ;AAcH;;AAEc,SAASgO,UAAT,GAAsB;AACjC,qBAAwBlD,oBAAU,CAACmB,2BAAD,CAAlC;AAAA,MAAQjG,WAAR,gBAAQA,WAAR;;AACA,MAAMnI,KAAK,GAAGoQ,4BAAS,CAACjI,WAAD,EAAc,UAAA1F,CAAC;AAAA,WAAIA,CAAJ,aAAIA,CAAJ,uBAAIA,CAAC,CAAEzC,KAAP;AAAA,GAAf,CAAvB;AAEA,sBACI,0CACKA,KADL,aACKA,KADL,uBACKA,KAAK,CAAEE,GAAP,CAAW;AAAA,QAAGmB,IAAH,QAAGA,IAAH;AAAA,QAASO,OAAT,QAASA,OAAT;AAAA,QAAkBD,cAAlB,QAAkBA,cAAlB;AAAA,wBACR,oBAAC,mBAAD;AAAM,UAAI,MAAV;AAAW,SAAG,EAAEN;AAAhB,oBACI,oBAAC,QAAD;AACI,UAAI,EAAEA,IADV;AAEI,aAAO,EAAEO,OAFb;AAGI,oBAAc,EAAED;AAHpB,MADJ,CADQ;AAAA,GAAX,CADL,CADJ;AAaH,C;;;;;;;;;;;;;;;;;;;;ACxGD;CAEA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;AAEA,SAAS0O,uBAAT,CAAiCjI,OAAjC,EAAqD;AACjD,oBAAsB6E,oBAAU,CAACmB,2BAAD,CAAhC;AAAA,MAAQC,SAAR,eAAQA,SAAR;;AACA,MAAMiC,WAAW,GAAGC,iBAAO,CACvB;AAAA;;AAAA,WACI,qBAAAC,iCAAe,CACXpI,OADW,aACXA,OADW,4CACXA,OAAO,CAAEnI,QADE,sDACX,kBACMwQ,MADN,CACa,UAAAtQ,CAAC;AAAA,aAAI,CAACA,CAAC,CAACuQ,IAAP;AAAA,KADd,EAC2B;AAD3B,MAC2B;AACtBxQ,OAFL,CAES,UAAAC,CAAC;AAAA,aAAIA,CAAC,CAACb,QAAF,CAAWY,GAAX,CAAe,UAAAgB,GAAG;AAAA,eAAIA,GAAG,CAACgB,QAAR;AAAA,OAAlB,CAAJ;AAAA,KAFV,CADW,CAAf,sEAIGuO,MAJH,CAIU,UAAAnS,EAAE;AAAA,aAAI,CAAC,CAACA,EAAN;AAAA,KAJZ,MAIyB,EAL7B;AAAA,GADuB,EAOvB,CAAC8J,OAAD,CAPuB,CAA3B;;AASA,MAAMuI,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACzO,QAAD,EAAsB;AACjDmM,aAAS,SAAT,IAAAA,SAAS,WAAT,YAAAA,SAAS,CAAEuC,cAAX,CAA0B1O,QAA1B;AACH,GAFD;;AAIA,SAAO;AACHoO,eAAW,EAAXA,WADG;AAEHK,0BAAsB,EAAtBA;AAFG,GAAP;AAIH;;AAEc,SAASE,eAAT,CAAyBxT,KAAzB,EAIZ;AACC,MAAQgQ,MAAR,GAAgChQ,KAAhC,CAAQgQ,MAAR;AAAA,MAAgBI,GAAhB,GAAgCpQ,KAAhC,CAAgBoQ,GAAhB;AAAA,MAAqB3G,MAArB,GAAgCzJ,KAAhC,CAAqByJ,MAArB;AACA,MAAMX,MAAM,GAAGiK,4BAAS,CAAC/C,MAAD,EAAS,UAAAyD,CAAC;AAAA,WAAIA,CAAJ,aAAIA,CAAJ,uBAAIA,CAAC,CAAE3K,MAAP;AAAA,GAAV,CAAxB;AACA,MAAMI,OAAO,GAAG,CAACJ,MAAD,IAAWA,MAAM,KAAK6B,gBAAtC;AACA,MAAMI,OAAO,GAAGiF,MAAH,aAAGA,MAAH,uBAAGA,MAAM,CAAEjF,OAAxB;;AACA,kBAA0CvK,kBAAQ,CAAC,KAAD,CAAlD;AAAA,MAAOkT,aAAP;AAAA,MAAsBC,gBAAtB;;AACA,mBAAoCnT,kBAAQ,CAASsE,SAAT,CAA5C;AAAA,MAAO8O,UAAP;AAAA,MAAmBC,aAAnB;;AACA,MAAMC,OAAO,GAAGF,UAAU,KAAK,EAA/B;AACA,MAAMG,MAAM,GAAG,CAAC,EAACH,UAAD,aAACA,UAAD,eAACA,UAAU,CAAE9S,MAAb,CAAhB;AACA,MAAMkT,OAAO,GAAGC,6BAAU,EAA1B;AACA,MAAM9T,QAAQ,GAAGuT,aAAa,IAAI,CAAC1D,MAAnC;;AACA,8BACIgD,uBAAuB,CAACjI,OAAD,CAD3B;AAAA,MAAQkI,WAAR,yBAAQA,WAAR;AAAA,MAAqBK,sBAArB,yBAAqBA,sBAArB,CAXD,CAcC;;;AAEA,MAAMY,SAAS;AAAA,4FAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAEVP,8BAAgB,CAAC,IAAD,CAAhB;AACAE,2BAAa,CAAC/O,SAAD,CAAb;AAHU;AAAA,qBAIJsL,GAAG,EAJC;;AAAA;AAAA;AAMV,kBAAI4D,OAAO,EAAX,EAAeL,gBAAgB,CAAC,KAAD,CAAhB;AANL;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAATO,SAAS;AAAA;AAAA;AAAA,KAAf;;AASA,MAAMC,YAAY;AAAA,6FAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAEbR,8BAAgB,CAAC,IAAD,CAAhB;AAFa;AAAA,qBAGP3D,MAAM,CAAC/C,qBAAP,EAHO;;AAAA;AAIb4G,2BAAa,CAAC/O,SAAD,CAAb;AAJa;AAAA,qBAKP2E,MAAM,EALC;;AAAA;AAAA;AAOb,kBAAIuK,OAAO,EAAX,EAAeL,gBAAgB,CAAC,KAAD,CAAhB;AAPF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAZQ,YAAY;AAAA;AAAA;AAAA,KAAlB;;AAUA,MAAMC,YAAY;AAAA,6FAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAEbT,8BAAgB,CAAC,IAAD,CAAhB;AACAE,2BAAa,CAAC/O,SAAD,CAAb;AAHa;AAAA,qBAIPkL,MAAM,CAAC/C,qBAAP,EAJO;;AAAA;AAAA;AAAA,qBAKP+C,MAAM,CAACpC,WAAP,EALO;;AAAA;AAAA;AAOb,kBAAIoG,OAAO,EAAX,EAAeL,gBAAgB,CAAC,KAAD,CAAhB;AAPF;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAZS,YAAY;AAAA;AAAA;AAAA,KAAlB;;AAUA,MAAMC,WAAW;AAAA,6FAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAEZV,8BAAgB,CAAC,IAAD,CAAhB;AAFY;AAAA,qBAGN3D,MAAM,CAACnD,mBAAP,CAA2BoG,WAA3B,CAHM;;AAAA;AAAA;AAAA,qBAINjD,MAAM,CAACpC,WAAP,EAJM;;AAAA;AAKZiG,2BAAa,CAAC,EAAD,CAAb;;AALY;AAAA;AAOZ,kBAAIG,OAAO,EAAX,EAAeL,gBAAgB,CAAC,KAAD,CAAhB;AAPH;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAXU,WAAW;AAAA;AAAA;AAAA,KAAjB;;AAUA,MAAMC,UAAU,GAAG,SAAbA,UAAa;AAAA,WAAMtE,MAAM,CAACnH,SAAP,EAAN;AAAA,GAAnB,CAvDD,CAyDC;;;AACAwH,qBAAS,CACL;AAAA,WACIL,MADJ,aACIA,MADJ,uBACIA,MAAM,CAAE7D,SAAR,CACI9B,sBADJ,EAEI,UAACkK,IAAD,EAAenP,CAAf,EAA8BP,QAA9B,EAAoD;AAChD,UAAI0P,IAAI,KAAKhM,0CAAb,EAAgC;AAC5B,YAAIyL,OAAO,EAAX,EAAeH,aAAa,CAAChP,QAAD,CAAb;AAClB;AACJ,KANL,CADJ;AAAA,GADK,EAUL,CAACmL,MAAD,CAVK,CAAT,CA1DD,CAuEC;;AACAK,qBAAS,CAAC,YAAM;AACZiD,0BAAsB,CAACM,UAAD,CAAtB;AACA,WAAO;AAAA,aAAMN,sBAAsB,CAACxO,SAAD,CAA5B;AAAA,KAAP;AACH,GAHQ,EAGN,CAAC8O,UAAD,CAHM,CAAT,CAxED,CA6EC;;AACAvD,qBAAS,CAAC;AAAA,WAAMwD,aAAa,CAAC/O,SAAD,CAAnB;AAAA,GAAD,EAAiC,CAACkL,MAAD,CAAjC,CAAT;AAEA,sBACI,uDACI,oBAAC,mBAAD;AAAM,QAAI;AAAV,kBACI,oBAAC,oCAAD;AACI,SAAK,EAAE+D,MAAM,GAAG,QAAH,GAAc7K,OAAO,GAAG,OAAH,GAAa,MADnD;AAEI,YAAQ,EAAE/I,QAFd;AAGI,SAAK,EAAE+I,OAAO,GAAG,SAAH,GAAe,SAHjC;AAII,WAAO,EACH6K,MAAM,GACAK,YADA,GAEAlL,OAAO,GACPgL,SADO,GAEPC;AATd,KAYKJ,MAAM,IAAI7K,OAAV,gBAAoB,oBAAC,wBAAD,OAApB,gBAAwC,oBAAC,mBAAD,OAZ7C,CADJ,EAc6B,GAd7B,CADJ,eAiBI,oBAAC,mBAAD;AAAM,QAAI;AAAV,kBACI,oBAAC,qCAAD;AACI,SAAK,EAAE4K,OAAO,GAAG,cAAH,GAAoBC,MAAM,GAAG,MAAH,GAAY,OADxD;AAEI,YAAQ,EAAE5T,QAFd;AAGI,iBAAa,EAAE2T,OAHnB;AAII,WAAO,EACHA,OAAO,GACDM,YADC,GAEDL,MAAM,GACNO,UADM,GAEND;AATd,KAYKN,MAAM,gBAAG,oBAAC,0BAAD,OAAH,gBAAyB,oBAAC,oBAAD,OAZpC,CADJ,CAjBJ,EAiCK,CAACD,OAAO,IAAIC,MAAZ,kBACG,oBAAC,mBAAD;AAAM,QAAI;AAAV,kBACI,oBAAC,mBAAD;AACI,QAAI,eAAE,oBAAC,wBAAD,OADV;AAEI,SAAK,EAAED,OAAO,GAAG,SAAH,GAAe,QAFjC;AAGI,SAAK,EAAE;AAHX,IADJ,CAlCR,CADJ;AA6CH,C;;;;ACxKD;AACA;AACA;AACA;AACA;AAEe,SAASU,sBAAT,GAAkC;AAC7C,oBAAwC5E,oBAAU,CAACE,0BAAD,CAAlD;AAAA,MAAQ2E,2BAAR,eAAQA,2BAAR;;AACA,sBACI,oBAAC,oCAAD;AACI,SAAK,EAAC,iBADV;AAEI,WAAO,EAAEA;AAFb,kBAII,oBAAC,kBAAD,OAJJ,CADJ;AAQH,C;;;;;;;;;;;;;AChBD;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AAEA,SAASC,UAAT,GAAsB;AAClB,oBAAsB9E,oBAAU,CAACmB,2BAAD,CAAhC;AAAA,MAAQC,SAAR,eAAQA,SAAR;;AACA,qBAAqBpB,oBAAU,CAACE,0BAAD,CAA/B;AAAA,MAAQC,QAAR,gBAAQA,QAAR;;AACA,MAAM5P,QAAQ,GAAG,CAAC6Q,SAAlB;;AAEA,MAAM2D,WAAW;AAAA,4FAAG,iBAAO9T,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACV+T,kBADU,GACH/T,KADG,aACHA,KADG,uBACHA,KAAK,CAAG,CAAH,CADF;;AAAA,kBAEX+T,IAFW;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA,qBAKOA,IAAI,CAAC3U,IAAL,EALP;;AAAA;AAKNA,kBALM;AAMN4U,oBANM,GAMGjE,IAAI,CAACkE,KAAL,CAAW7U,IAAX,CANH;AAOZyL,qBAAO,CAAC+B,KAAR,kBAA+BoH,MAA/B;AACME,iBARM,GAQAF,MARA,aAQAA,MARA,uBAQAA,MAAM,CAAEE,GARR;;AAAA,oBASR,OAAOA,GAAP,KAAe,QATP;AAAA;AAAA;AAAA;;AAAA,oBASuB,IAAI5O,KAAJ,CAAU,qBAAV,CATvB;;AAAA;AAWZ;AACM6O,iBAZM,GAYAC,qBAAA,CAAcF,GAAd,CAZA,EAcZ;;AACA/D,uBAAS,CAACkE,KAAV;AACAD,wCAAA,CAAmBD,GAAnB,EAAwBhE,SAAxB;AAhBY;AAAA;;AAAA;AAAA;AAAA;AAkBZjB,sBAAQ,aAAR;;AAlBY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAX4E,WAAW;AAAA;AAAA;AAAA,KAAjB;;AAqBA,sBACI,oBAAC,oBAAD;AACI,QAAI,EAAC,SADT;AAEI,QAAI,EAAE,IAFV;AAGI,YAAQ,EAAExU,QAHd;AAII,iBAAa,EAAE,CAAC,kBAAD,CAJnB;AAKI,mBAAe,EAAEwU,WALrB;AAMI,cAAU,EAAE;AANhB,IADJ;AAUH;;AAED,SAASQ,UAAT,GAAsB;AAClB,qBAAyBvF,oBAAU,CAACmB,2BAAD,CAAnC;AAAA,MAAQqE,YAAR,gBAAQA,YAAR,CADkB,CAElB;;;AACA,MAAMC,IAAI,GAAG;AACTN,OAAG,EAAEK;AADI,GAAb;AAIA,MAAME,GAAG,4CAA0CC,kBAAkB,CACjE3E,IAAI,CAACC,SAAL,CAAewE,IAAf,CADiE,CAArE;AAIA,sBACI,oBAAC,6BAAD;AAAM,YAAQ,EAAC,oBAAf;AAAoC,QAAI,EAAEC;AAA1C,kBACI,oBAAC,uBAAD;AAAS,SAAK,EAAE;AAAhB,kBACI,oBAAC,mCAAD,qBACI,oBAAC,mBAAD,OADJ,CADJ,CADJ,CADJ;AASH;;AAEc,SAASE,gBAAT,GAA4B;AACvC,sBACI,uDACI,oBAAC,mBAAD;AAAM,QAAI;AAAV,kBACI,oBAAC,UAAD,OADJ,CADJ,eAII,oBAAC,mBAAD;AAAM,QAAI;AAAV,kBACI,oBAAC,UAAD,OADJ,CAJJ,CADJ;AAUH,C;;ACjFD;AACA;AAEA;AACA;AACA;AACA;AAEe,SAASC,SAAT,CAAmBzV,KAAnB,EAIZ;AACC,MAAQgQ,MAAR,GAAgChQ,KAAhC,CAAQgQ,MAAR;AAAA,MAAgBI,GAAhB,GAAgCpQ,KAAhC,CAAgBoQ,GAAhB;AAAA,MAAqB3G,MAArB,GAAgCzJ,KAAhC,CAAqByJ,MAArB;AACA,sBACI,oBAAC,mBAAD;AACI,aAAS,MADb;AAEI,aAAS,EAAC,KAFd;AAGI,WAAO,EAAE,CAHb;AAII,cAAU,EAAC,QAJf;AAKI,gBAAY,EAAC;AALjB,kBAOI,oBAAC,gBAAD,OAPJ,eAQI,oBAAC,eAAD;AAAiB,UAAM,EAAEuG,MAAzB;AAAiC,OAAG,EAAEI,GAAtC;AAA2C,UAAM,EAAE3G;AAAnD,IARJ,eASI,oBAAC,mBAAD;AAAM,QAAI;AAAV,kBACI,oBAAC,sBAAD,OADJ,CATJ,eAYI,oBAAC,UAAD,OAZJ,CADJ;AAgBH,C;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrBD;AAEA;AACA;AAIA;AAGA,IAAMiM,GAAG,GAAG;AACRC,KAAG,EAAE,IADG;AAERC,IAAE,EAAE,IAFI;AAGRC,IAAE,EAAE,KAHI;AAIRC,KAAG,EAAE,KAJG;AAKRC,IAAE,EAAE,GALI;AAMRC,IAAE,EAAE,GANI;AAORC,KAAG,EAAE,IAPG;AAQRC,KAAG,EAAE,IARG;AASRC,KAAG,EAAE,GATG;AAURC,KAAG,EAAE,GAVG;AAWRC,UAAQ,EAAE,GAXF;AAYRC,QAAM,EAAE,GAZA;AAaRC,OAAK,EAAE;AAbC,CAAZ;AA0BO,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,KAAD,EAAmBlT,OAAnB,EAAoD;AAC1E,SAAO;AACHsB,YAAQ,EAAE4R,KAAK,CAACxV,EADb;AAEHK,QAAI,EAAE,KAFH;AAGHiC,WAAO,EAAPA;AAHG,GAAP;AAKH,CANM;AAQA,IAAMmT,aAAa,GAAG,SAAhBA,aAAgB,CAACD,KAAD,EAAmBzT,MAAnB,EAAyC;AAClE,SAAOA,MAAM,CAACH,GAAP,CAAW,UAAC+B,CAAD,EAAgB;AAC9B,WAAO;AACHC,cAAQ,EAAED,CAAC,CAACC,QAAF,GAAaD,CAAC,CAACC,QAAf,GAA0B4R,KAAK,CAACxV,EADvC;AAEH8D,aAAO,EAAEH,CAAC,CAACG;AAFR,KAAP;AAIH,GALM,CAAP;AAMH,CAPM;AASQ,SAAS4R,wBAAT,CACX3F,SADW,EAEX4F,IAFW,EAGF;AACTlL,SAAO,CAAC+B,KAAR,eAA4B;AAAEuD,aAAS,EAATA,SAAF;AAAa4F,QAAI,EAAJA;AAAb,GAA5B;AAEA,MAAI,CAAC5F,SAAL,EAAgB,OAAOlM,SAAP;AAEhB,MAAMnC,KAAe,GAAGqO,SAAS,CAAC6F,SAAV,CACnBzD,MADmB,CACZ,UAAA0D,CAAC;AAAA,WAAIC,6CAAA,CAAsBD,CAAC,CAACxV,IAAxB,IAAgC,CAApC;AAAA,GADW,EAEnBuB,GAFmB,CAEf,UAAAiU,CAAC;AAAA,WAAK;AAAE9S,UAAI,EAAE8S,CAAC,CAAC1X,IAAV;AAAgBkF,oBAAc,EAAEwS,CAAC,CAACxV;AAAlC,KAAL;AAAA,GAFc,CAAxB;;AALS,MASH0V,eATG;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA,qDASqB7Q,KATrB;;AAWT,MAAM8Q,iBAGmB,GAAG,SAHtBA,iBAGsB,CAAClP,EAAD,EAAgBmP,OAAhB,EAAuC;AAC/D,QAAMlU,MAAiB,GAAG,EAA1B;;AAEA,QAAMmU,sBAAsB,GAAG,SAAzBA,sBAAyB,CAACpP,EAAD,EAAgB0O,KAAhB,EAAqC;AAChE,UAAI,CAACA,KAAL,EAAY;AACR,cAAM,IAAIO,eAAJ,EAAN;AACH;;AACD,UAAQ1V,IAAR,GAAgCmV,KAAhC,CAAQnV,IAAR;AAAA,UAAcoL,KAAd,GAAgC+J,KAAhC,CAAc/J,KAAd;AAAA,UAAqB0K,MAArB,GAAgCX,KAAhC,CAAqBW,MAArB;AACA1L,aAAO,CAAC2L,GAAR,YAAuB;AAAEtP,UAAE,EAAFA,EAAF;AAAM0O,aAAK,EAALA,KAAN;AAAanV,YAAI,EAAJA,IAAb;AAAmBoL,aAAK,EAALA,KAAnB;AAA0B0K,cAAM,EAANA;AAA1B,OAAvB;AAEA,UAAI1K,KAAK,KAAK5H,SAAd,EACI;AACA,eAAqB;AACjBxD,cAAI,EAAE,SADW;AAEjBoL,eAAK,EAAEA,KAFU;AAGjB4K,aAAG,EAAE5K,KAAK,GAAG;AAHI,SAArB;;AAMJ,cAAQpL,IAAR;AACI,aAAK,aAAL,CADJ,CACwB;;AACpB,aAAK,oBAAL;AAA2B;AACvB,gBAAMiW,QAAQ,GAAGJ,sBAAsB,CAACpP,EAAD,EAAKqP,MAAM,CAAC,CAAD,CAAN,CAAUI,KAAf,CAAvC;AACA,gBAAMC,EAAE,GAAGL,MAAM,CAAC,CAAD,CAAN,CAAUrY,MAAV,CAAiB,IAAjB,EAAuB2N,KAAlC;AACA,mBAA6B;AACzBpL,kBAAI,EAAE,iBADmB;AAEzBoW,sBAAQ,EAAEhC,GAAG,CAAC+B,EAAD,CAAH,IAAWA,EAFI;AAGzBF,sBAAQ,EAARA,QAHyB;AAIzBI,oBAAM,EAAE,KAJiB,CAIV;;AAJU,aAA7B;AAMH;;AACD,aAAK,iBAAL,CAZJ,CAY4B;;AACxB,aAAK,wBAAL;AAA+B;AAC3B,gBAAMC,IAAI,GAAGT,sBAAsB,CAACpP,EAAD,EAAKqP,MAAM,CAAC,CAAD,CAAN,CAAUI,KAAf,CAAnC;AACA,gBAAMK,KAAK,GAAGV,sBAAsB,CAACpP,EAAD,EAAKqP,MAAM,CAAC,CAAD,CAAN,CAAUI,KAAf,CAApC;AACA,gBAAMC,GAAE,GAAGL,MAAM,CAAC,CAAD,CAAN,CAAUrY,MAAV,CAAiB,IAAjB,EAAuB2N,KAAlC;AACA,mBAA8B;AAC1BpL,kBAAI,EAAE,kBADoB;AAE1BoW,sBAAQ,EAAEhC,GAAG,CAAC+B,GAAD,CAAH,IAAWA,GAFK;AAG1BG,kBAAI,EAAJA,IAH0B;AAI1BC,mBAAK,EAALA;AAJ0B,aAA9B;AAMH;;AACD,aAAK,iBAAL;AAAwB;AACpB,gBAAMD,KAAI,GAAGT,sBAAsB,CAACpP,EAAD,EAAKqP,MAAM,CAAC,CAAD,CAAN,CAAUI,KAAf,CAAnC;;AACA,gBAAMK,MAAK,GAAGV,sBAAsB,CAACpP,EAAD,EAAKqP,MAAM,CAAC,CAAD,CAAN,CAAUI,KAAf,CAApC;;AACA,gBAAMC,IAAE,GAAGL,MAAM,CAAC,CAAD,CAAN,CAAUrY,MAAV,CAAiB,IAAjB,EAAuB2N,KAAlC;AACA,mBAA+B;AAC3BpL,kBAAI,EAAE,mBADqB;AAE3BoW,sBAAQ,EAAEhC,GAAG,CAAC+B,IAAD,CAAH,IAAWA,IAFM;AAG3BG,kBAAI,EAAJA,KAH2B;AAI3BC,mBAAK,EAALA;AAJ2B,aAA/B;AAMH;;AACD,aAAK,cAAL;AAAqB;AACjB,gBAAMN,SAAQ,GAAGJ,sBAAsB,CAACpP,EAAD,EAAKqP,MAAM,CAAC,CAAD,CAAN,CAAUI,KAAf,CAAvC;;AACA,mBAA6B;AACzBlW,kBAAI,EAAE,iBADmB;AAEzBoW,sBAAQ,EAAE,GAFe;AAGzBH,sBAAQ,EAARA,SAHyB;AAIzBI,oBAAM,EAAE,KAJiB,CAIV;;AAJU,aAA7B;AAMH;;AACD,aAAK,eAAL;AAAsB;AAClB,gBAAMC,MAAI,GAAGT,sBAAsB,CAACpP,EAAD,EAAKqP,MAAM,CAAC,CAAD,CAAN,CAAUI,KAAf,CAAnC;;AACA,gBAAMK,OAAK,GAAGV,sBAAsB,CAACpP,EAAD,EAAKqP,MAAM,CAAC,CAAD,CAAN,CAAUI,KAAf,CAApC;;AACA,gBAAMC,IAAE,GAAGL,MAAM,CAAC,CAAD,CAAN,CAAUrY,MAAV,CAAiB,IAAjB,EAAuB2N,KAAlC;AACA,mBAA8B;AAC1BpL,kBAAI,EAAE,kBADoB;AAE1BoW,sBAAQ,EAAEhC,GAAG,CAAC+B,IAAD,CAAH,IAAWA,IAFK;AAG1BG,kBAAI,EAAJA,MAH0B;AAI1BC,mBAAK,EAALA;AAJ0B,aAA9B;AAMH;;AACD;AAAS;AACL,gBAAMC,UAAU,GAAGC,iDAA6B,CAACzW,IAAD,CAAhD;;AACA,gBAAI,CAACwW,UAAL,EAAiB;AACbpM,qBAAO,CAACC,IAAR,oBAA8BrK,IAA9B,EAAsC;AAClCA,oBAAI,EAAJA,IADkC;AAElCyG,kBAAE,EAAFA,EAFkC;AAGlC0O,qBAAK,EAALA,KAHkC;AAIlCuB,iBAAC,EAAEC,0BAAA,CAAe3W,IAAf;AAJ+B,eAAtC;AAMH,aAPD,MAOO;AAAA;;AACH;AACA,kBAAa4W,OAAb,GAAyBJ,UAAzB,CAAQK,GAAR;AACA,kBAAMA,GAAG,GAAGvB,IAAI,CAAC1S,IAAL,CAAU,UAAA8T,CAAC;AAAA,uBAAIA,CAAC,CAAC/W,EAAF,KAASiX,OAAb;AAAA,eAAX,CAAZ;AACA,kBAAME,GAAG,GAAGD,GAAH,aAAGA,GAAH,gDAAGA,GAAG,CAAEE,qBAAR,0DAAG,2BAAAF,GAAG,EAA0B;AACrCrS,qBAAK,EAAEiC,EAD8B;AAErC+P,0BAAU,EAAVA,UAFqC;AAGrCrB,qBAAK,EAALA,KAHqC;AAIrCU,sCAAsB,EAAtBA;AAJqC,eAA1B,CAAf;;AAMA,kBAAIiB,GAAJ,EAAS;AACL,oBAAIA,GAAG,CAACpV,MAAR,EACIoV,GAAG,CAACpV,MAAJ,CAAWd,OAAX,CAAmB,UAAA0C,CAAC;AAAA,yBAAI5B,MAAM,CAACM,IAAP,CAAYsB,CAAZ,CAAJ;AAAA,iBAApB;AACJ,uBAAOwT,GAAG,CAAC1U,IAAX;AACH;;AAED,kBAAQ4U,QAAR,GAAqBR,UAArB,CAAQQ,QAAR;;AACA,sBAAQA,QAAR;AACI,qBAAK,QAAL;AAAe;AACX,wBAAM7W,KAAK,GAAG2V,MAAM,CAAC,CAAD,CAAN,CAAUrY,MAAV,CAAiB,OAAjB,CAAd;AACA,wBAAM+X,CAAC,GAAGrV,KAAK,CAACiL,KAAhB;AACA,2BAAqB;AACjBpL,0BAAI,EAAE,SADW;AAEjBoL,2BAAK,EAAEoK,CAFU;AAGjBQ,yBAAG,EAAER,CAAC,GAAG;AAHQ,qBAArB;AAKH;;AACD;AAAS;AACLpL,2BAAO,CAACC,IAAR,iCACkC2M,QADlC,aACkDhX,IADlD,EAEI;AAAEyG,wBAAE,EAAFA,EAAF;AAAM0O,2BAAK,EAALA;AAAN,qBAFJ;AAIA;AACH;AAhBL;;AAkBA;AACH;AACJ;AArGL;;AAuGA,YAAM,IAAIO,eAAJ,EAAN;AACH,KAvHD;;AAwHA,WAAO;AACHtT,UAAI,EAAEyT,sBAAsB,CAACpP,EAAD,EAAKmP,OAAL,CADzB;AAEHlU,YAAM,EAANA;AAFG,KAAP;AAIH,GAlID;;AAoIA,MAAMuV,cAAc,GAAG,SAAjBA,cAAiB,CACnBzS,KADmB,EAEnB2Q,KAFmB,EAGH;AAChB,QAAQnV,IAAR,GAAyBmV,KAAzB,CAAQnV,IAAR;AAAA,QAAc8V,MAAd,GAAyBX,KAAzB,CAAcW,MAAd;AACA1L,WAAO,CAAC+B,KAAR,YAAyB;AAAE3H,WAAK,EAALA,KAAF;AAASxE,UAAI,EAAJA,IAAT;AAAemV,WAAK,EAALA,KAAf;AAAsBW,YAAM,EAANA;AAAtB,KAAzB;;AACA,YAAQ9V,IAAR;AACI,WAAK,YAAL;AAAmB;AAAA;;AACf,cAAMkX,WAAsB,GAAG;AAC3BvW,oBAAQ,EAAE,EADiB;AAE3Be,kBAAM,EAAE;AAFmB,WAA/B;AAIA,cAAMyV,WAAsB,GAAG;AAC3BxW,oBAAQ,EAAE,EADiB;AAE3Be,kBAAM,EAAE;AAFmB,WAA/B;AAIA,cAAMyQ,CAAC,eAAG2D,MAAM,CAAC,CAAD,CAAT,6CAAG,SAAWI,KAArB;AACA,cAAM5S,CAAC,gBAAGwS,MAAM,CAAC,CAAD,CAAT,8CAAG,UAAWI,KAArB;;AACA,cAAI/D,CAAJ,EAAO;AACHiF,uBAAW,CACP5S,KADO,GAEN2N,CAFM,8CAECA,CAAC,CAACkF,QAAF,GAAalF,CAAC,CAACkF,QAAf,GAA0B,EAF3B,IAGPH,WAHO,CAAX;AAKH;;AACD,cAAI5T,CAAJ,EAAO;AACH8T,uBAAW,CACP5S,KADO,GAENlB,CAFM,8CAECA,CAAC,CAAC+T,QAAF,GAAa/T,CAAC,CAAC+T,QAAf,GAA0B,EAF3B,IAGPF,WAHO,CAAX;AAKH;;AACD,cAAIG,UAAgC,GAAG9T,SAAvC;;AACA,cAAI;AAAA;;AACA8T,sBAAU,GAAG3B,iBAAiB,CAACnR,KAAD,eAAQsR,MAAM,CAAC,CAAD,CAAd,8CAAQ,UAAWI,KAAnB,CAA9B;AACH,WAFD,CAEE,OAAO5S,CAAP,EAAU;AACR,gBAAIA,CAAC,YAAYoS,eAAjB,EAAkC;AAC9B4B,wBAAU,GAAG;AACTlV,oBAAI,EAAE;AACFpC,sBAAI,EAAE,SADJ;AAEFoL,uBAAK,EAAE,KAFL;AAGF4K,qBAAG,EAAE;AAHH,iBADG;AAMTtU,sBAAM,EAAE;AANC,eAAb;AAQH,aATD,MASO;AACH,oBAAM4B,CAAN;AACH;AACJ;;AACD,4BAAyBgU,UAAzB;AAAA,cAAQlV,IAAR,eAAQA,IAAR;AAAA,cAAcV,MAAd,eAAcA,MAAd;AAEA,cAAM6V,UAAwB,GAAG;AAC7BhU,oBAAQ,EAAE4R,KAAK,CAACxV,EADa;AAE7BK,gBAAI,EAAE,KAFuB;AAG7BoC,gBAAI,EAAJA,IAH6B;AAI7BnB,gBAAI,EAAEiW,WAAW,CAACvW,QAJW;AAK7BK,gBAAI,EAAEmW,WAAW,CAACxW;AALW,WAAjC;AAOA,iBAAO;AACH4B,eAAG,EAAEgV,UADF;AAEH7V,kBAAM,EAAE0T,aAAa,CACjBD,KADiB,EAEjBzT,MAAM,CACD8V,MADL,CACYN,WAAW,CAACxV,MADxB,EAEK8V,MAFL,CAEYL,WAAW,CAACzV,MAFxB,CAFiB;AAFlB,WAAP;AASH;AACD;;AACA;AAAS;AACL,cAAM8U,UAAU,GAAGC,iDAA6B,CAACzW,IAAD,CAAhD;;AACA,cAAIwW,UAAJ,EAAgB;AAAA;;AACZ,gBAAaI,OAAb,GAAyBJ,UAAzB,CAAQK,GAAR;AACA,gBAAMA,GAAG,GAAGvB,IAAI,CAAC1S,IAAL,CAAU,UAAAiU,GAAG;AAAA,qBAAIA,GAAG,CAAClX,EAAJ,KAAWiX,OAAf;AAAA,aAAb,CAAZ;AACA,gBAAMa,MAAM,GAAGZ,GAAH,aAAGA,GAAH,gDAAGA,GAAG,CAAEa,kBAAR,0DAAG,2BAAAb,GAAG,EAAuB;AACrCrS,mBAAK,EAALA,KADqC;AAErC2Q,mBAAK,EAALA,KAFqC;AAGrCqB,wBAAU,EAAVA,UAHqC;AAIrCb,+BAAiB,EAAjBA;AAJqC,aAAvB,CAAlB;;AAMA,gBAAI8B,MAAJ,EAAY;AACRA,oBAAM,CAAC/V,MAAP,GAAgB0T,aAAa,CAACD,KAAD,EAAQsC,MAAM,CAAC/V,MAAf,CAA7B;AACA,qBAAO+V,MAAP;AACH;;AAEDrN,mBAAO,CAACC,IAAR,wBAAkCrK,IAAlC,EAA0C;AAAEmV,mBAAK,EAALA;AAAF,aAA1C;AACA,mBAAO;AACH5S,iBAAG,EAAEiB,SADF;AAEH9B,oBAAM,EAAE;AAFL,aAAP;AAIH;AACJ;AArFL;AAuFH,GA7FD;;AA+FA,MAAMiW,GAAG,GAAG;AACR3X,QAAI,EAAE,gBADE;AAERmC,aAAS,EAAE,EAFH;AAGRD,UAAM,EAAEnC,YAAY,CAAC,KAAD;AAHZ,GAAZ;;AAMA,MAAMqX,WAAW,GAAG,SAAdA,WAAc,CAChB5S,KADgB,EAEhBoT,MAFgB,EAGhBpX,OAHgB,EAIf;AACDoX,UAAM,SAAN,IAAAA,MAAM,WAAN,YAAAA,MAAM,CAAEhX,OAAR,CAAgB,UAAAsV,KAAK,EAAI;AACrB,UAAIA,KAAJ,EAAW;AACP,YAAI;AACA,gCAAwBe,cAAc,CAACzS,KAAD,EAAQ0R,KAAR,CAAtC;AAAA,cAAQ3T,GAAR,mBAAQA,GAAR;AAAA,cAAab,MAAb,mBAAaA,MAAb;;AACA,cAAIa,GAAJ,EAAS/B,OAAO,CAACG,QAAR,CAAiBqB,IAAjB,CAAsBO,GAAtB;AACTb,gBAAM,CAACd,OAAP,CAAe,UAAA0C,CAAC;AAAA,mBAAI9C,OAAO,CAACkB,MAAR,CAAeM,IAAf,CAAoBsB,CAApB,CAAJ;AAAA,WAAhB;AACH,SAJD,CAIE,OAAOA,CAAP,EAAU;AACR,cAAIA,CAAC,YAAYoS,eAAjB,EAAkC;AAC9BlV,mBAAO,CAACG,QAAR,CAAiBqB,IAAjB,CAAsB;AAClBuB,sBAAQ,EAAE2S,KAAK,CAACvW,EADE;AAElBK,kBAAI,EAAE,KAFY;AAGlBiC,qBAAO,EAAE0V;AAHS,aAAtB;AAKH,WAND,MAMO;AACHvN,mBAAO,CAAC+B,KAAR,CAAc7I,CAAd;AACH;AACJ;AACJ;AACJ,KAlBD;AAmBH,GAxBD;;AA0BA,MAAMhC,QAAqB,GAAGoO,SAAS,CAACkI,MAAV,CACzBrW,GADyB,CACrB,UAAAsW,GAAG,EAAI;AAAA;;AACR,QAAQ7X,IAAR,GAAiB6X,GAAjB,CAAQ7X,IAAR;AACA,QAAIiC,OAAJ;AACA,QAAI6V,QAAJ;AACA,QAAIC,SAAJ;AACA,QAAIC,OAAO,GAAG,KAAd;AACA,QAAMxB,UAAU,GAAGC,iDAA6B,CAACzW,IAAD,CAAhD;AACAqC,4BAAM,CAAC,CAAC,CAACmU,UAAH,CAAN;AACA,QAAQQ,QAAR,GAAmCR,UAAnC,CAAQQ,QAAR;AAAA,QAAuBJ,OAAvB,GAAmCJ,UAAnC,CAAkBK,GAAlB;AACA,QAAMA,GAAG,GAAGD,OAAO,KAAItB,IAAJ,aAAIA,IAAJ,uBAAIA,IAAI,CAAE1S,IAAN,CAAW,UAAA8T,CAAC;AAAA,aAAIA,CAAC,CAAC/W,EAAF,KAASiX,OAAb;AAAA,KAAZ,CAAJ,CAAnB;;AAEA,QAAI;AAAA;;AACA,iBACI,CAAAC,GAAG,SAAH,IAAAA,GAAG,WAAH,qCAAAA,GAAG,CAAEoB,gBAAL,qFAAApB,GAAG,EAAqB;AACpB1B,aAAK,EAAE0C,GADa;AAEpBrB,kBAAU,EAAVA,UAFoB;AAGpBb,yBAAiB,EAAjBA;AAHoB,OAArB,CAAH,KAIM,EALV;AAAA,UAAQuC,UAAR,QAAQA,UAAR;AAAA,UAAoBxW,MAApB,QAAoBA,MAApB;AAAA,UAA4B8C,KAA5B,QAA4BA,KAA5B;AAAA,UAAmCuN,IAAnC,QAAmCA,IAAnC;;AAMA9P,aAAO,GAAGiW,UAAV;AACAH,eAAS,GAAGrW,MAAZ;AACAoW,cAAQ,GAAGtT,KAAX;AACAwT,aAAO,GAAGjG,IAAV,CAVA,CAYA;;AACA,UAAI,CAAC9P,OAAD,IAAY,gBAAC8V,SAAD,uCAAC,WAAWvY,MAAZ,CAAhB,EAAoC;AAChC,gBAAQwX,QAAR;AACI,eAAK,MAAL;AAAa;AACT;AACH;;AACD;AAAS;AACL5M,qBAAO,CAACC,IAAR,mCACoC2M,QADpC,aACoDhX,IADpD,EAEI;AAAE6X,mBAAG,EAAHA;AAAF,eAFJ;AAIA;AACH;AAVL;AAYH;AACJ,KA3BD,CA2BE,OAAOvU,CAAP,EAAU;AACR8G,aAAO,CAAC+B,KAAR,CAAc7I,CAAd;;AACA,UAAIA,CAAC,YAAYoS,eAAjB,EAAkC;AAC9B,eAAOlS,SAAP;AACH,OAFD,MAEO;AACH,cAAMF,CAAN;AACH;AACJ,KA7CO,CA+CR;;;AACA,QAAI,CAACrB,OAAD,IAAY,iBAAC8V,SAAD,wCAAC,YAAWvY,MAAZ,CAAhB,EAAoC,OAAOgE,SAAP;AAEpC,QAAMhD,OAAkB,GAAG;AACvBG,cAAQ,EAAE,CACN;AACI4C,gBAAQ,EAAEsU,GAAG,CAAClY,EADlB;AAEIK,YAAI,EAAE,KAFV;AAGIiC,eAAO,EAAPA;AAHJ,OADM,CADa;AAQvBP,YAAM,EAAEqW,SAAS,IAAI,EARE;AASvBhG,UAAI,EAAE,CAAC,CAACiG;AATe,KAA3B;AAYAZ,eAAW,CAACU,QAAD,EAAWD,GAAG,CAACR,QAAf,EAAyB7W,OAAzB,CAAX;AACA,WAAOA,OAAP;AACH,GAjEyB,EAkEzBsR,MAlEyB,CAkElB,UAAAtR,OAAO;AAAA,WAAI,CAAC,CAACA,OAAN;AAAA,GAlEW,CAA9B;AAoEA,SAAO;AACHa,SAAK,EAALA,KADG;AAEHC,YAAQ,EAARA;AAFG,GAAP;AAIH,C;;;;;ACtZD;AACA;AAIA;AAoBA;AACA;AAQA;AAMA;AAKA;AACA;AACA;AACA;AACA;AACA;AAqBA;;AAUA,SAAS6W,cAAT,CAAwBhY,KAAxB,EAAoD;AAChD,SAAOA,KAAK,CAACH,IAAN,KAAe,MAAtB;AACH;;AACD,SAASoY,aAAT,CAAuBjY,KAAvB,EAAmD;AAC/C,SAAOA,KAAK,CAACH,IAAN,KAAe,QAAtB;AACH;;AACD,SAASqY,aAAT,CAAuBlY,KAAvB,EAAmD;AAC/C,SAAOgY,cAAc,CAAChY,KAAD,CAAd,GACD,SADC,GAEDiY,aAAa,CAACjY,KAAD,CAAb,GACA,QADA,GAEAmY,gCAAa,CAACnY,KAAD,CAAb,GACA,QADA,GAEAqD,SANN;AAOH;;AACD,SAAS+U,QAAT,CAAkBC,GAAlB,EAA2CrY,KAA3C,EAAuE;AAAA;;AACnE,MAAMmD,CAAC,iBAAGkV,GAAG,CAACC,KAAP,+CAAG,WAAYtY,KAAK,CAACH,IAAlB,CAAV;AACA,SAAOsD,CAAP;AACH;;AAED,IAAMoV,eAAe,GAAG,CACpBC,8BADoB,EAEpBC,6BAFoB,EAGpBC,mCAHoB,EAIpBC,iCAJoB,EAKpBC,+BALoB,EAMpBC,iCANoB,CAAxB;AAQA,IAAMC,aAAa,GAAG,CAACC,kEAAD,CAAtB;AACA,IAAMC,iBAAiB,GAAG,CACtBC,4CADsB,EAEtBA,wCAFsB,EAGtBA,gDAHsB,CAA1B;AAMA,IAAMC,cAAc,GAAG,CACnB;AACIpW,SAAO,EAAEqW,+BADb;AAEIhV,UAAQ,EAAEiV,kDAFd;AAGIpZ,OAAK,EAAE,SAHX;AAIIqZ,KAAG,EAAE;AAJT,CADmB,CAAvB;AASA,IAAMC,YAAY,GAAG,SAArB;AAEO,IAAMC,mCAAb;AAAA;AAAA,SAGI/Z,EAHJ,GAGS,gBAHT;AAAA,SAIIga,iBAJJ,GAI8C,EAJ9C;AAAA;;AAAA;;AAAA,SASYC,kBATZ,GASI,4BAA2BC,KAA3B,EAAyC;AACrC,QAAMC,WAAW,GAAGD,KAAK,CAACE,OAAN,CAAcC,OAAd,CAAsBC,IAA1C;AACA,QAAMC,UAAU,GAAGL,KAAK,CAACE,OAAN,CAActX,IAAd,CAAmBwX,IAAtC;;AACA,QAAME,YAAY,GAAG,SAAfA,YAAe,CAAC3B,GAAD;AAAA,aACjB4B,yBAAQ,CAAC5B,GAAD,CAAR,GAAgBsB,WAAhB,GAA8BI,UADb;AAAA,KAArB;;AAEA,WAAOC,YAAP;AACH,GAfL;;AAAA,SAiBIE,YAjBJ,GAiBI,sBAAaC,OAAb,EAA2C;AACvC,QAAQT,KAAR,GAAkBS,OAAlB,CAAQT,KAAR;AACA,QAAMM,YAAY,GAAG,KAAKP,kBAAL,CAAwBC,KAAxB,CAArB,CAFuC,CAGvC;;AACA,QAAMU,aAAa,GAAG,CAClB;AACIC,kBAAY,EAAEC,4BADlB;AAEIC,UAAI,EAAE,IAFV;AAGIC,gBAAU,EAAEC,uCAHhB;AAIIza,WAAK,EAAE,GAJX;AAKI0a,YAAM,EAAmB;AACrBH,YAAI,EAAE,OADe;AAErB1a,YAAI,EAAE8a,sDAA2B9a;AAFZ;AAL7B,KADkB,EAWlB;AACIwa,kBAAY,EAAEO,6BADlB;AAEIL,UAAI,EAAE,SAFV;AAGIC,gBAAU,EAAEK,8CAHhB;AAII7a,WAAK,EAAE,WAJX;AAKI0a,YAAM,EAAmB;AACrBH,YAAI,EAAE,OADe;AAErB1a,YAAI,EAAEib,gDAAqBjb;AAFN;AAL7B,KAXkB,CAAtB;;AAsBA,QAAMkb,kBAAkB,GAAG,SAArBA,kBAAqB,CACvBjY,OADuB,EAEvBR,IAFuB,EAGvBtC,KAHuB;AAAA;;AAAA,oCAKvBoa,aAAa,CAAC3X,IAAd,CACI,UAAAuY,EAAE;AAAA,eACEA,EAAE,CAACX,YAAH,KAAoBvX,OAAO,CAACgN,eAA5B,IACAkL,EAAE,CAACT,IAAH,IAAWjY,IAAI,CAACiY,IADhB,IAEAS,EAAE,CAACR,UAAH,KAAkBlY,IAAI,CAACkY,UAFvB,IAGAQ,EAAE,CAAChb,KAAH,IAAYA,KAAK,CAACrC,IAJpB;AAAA,OADN,CALuB,wDAKvB,oBAMG+c,MAXoB;AAAA,KAA3B;;AAaA,QAAMO,WAAW,GAAG,SAAdA,WAAc,CAACnY,OAAD;AAAA,aAChBoY,mCAAU,gBAAcpY,OAAO,CAACN,OAAtB,CADM;AAAA,KAApB;;AAEA,QAAM2Y,eAAe,GAAG,SAAlBA,eAAkB,CAACC,GAAD;AAAA,aACpBA,GAAG,CAAC9d,MAAJ,CAAW+d,KAAX,CAAiBnD,aAAjB,CADoB;AAAA,KAAxB;;AAEA,QAAMoD,SAAS,GAAG,SAAZA,SAAY,CACd9U,GADc,EAEdxG,KAFc;AAAA,aAGZA,KAAK,CAACrC,IAAN,KAAe,GAAf,GAAqB6I,GAAG,CAAC7I,IAAzB,GAAgCqC,KAAK,CAACrC,IAH1B;AAAA,KAAlB;;AAIA,QAAM4d,aAAa,GAAG,SAAhBA,aAAgB,CAClBzY,OADkB,EAElBR,IAFkB,EAGlBtC,KAHkB;AAAA,aAKlB+a,kBAAkB,CAACjY,OAAD,EAAUR,IAAV,EAAgBtC,KAAhB,CAAlB,KACCgY,cAAc,CAAChY,KAAD,CAAd,GACK;AAAEua,YAAI,EAAE,OAAR;AAAiB1a,YAAI,EAAE;AAAvB,OADL,GAEKoY,aAAa,CAACjY,KAAD,CAAb,GACA;AAAEua,YAAI,EAAE,OAAR;AAAiB1a,YAAI,EAAE;AAAvB,OADA,GAEAG,KAAK,CAACwb,IAAN,KAAe,GAAf,GACA;AACIjB,YAAI,EAAE,OADV;AAEI1a,YAAI,EAAE;AAFV,OADA,GAKAG,KAAK,CAACwb,IAAN,KAAe,GAAf,GACA;AAAEjB,YAAI,EAAE,OAAR;AAAiB1a,YAAI,EAAE;AAAvB,OADA,GAEA,KAAK/B,IAAL,CAAUkC,KAAK,CAACwb,IAAhB,IACA;AAAEjB,YAAI,EAAE,OAAR;AAAiB1a,YAAI,EAAE;AAAvB,OADA,GAEAG,KAAK,CAACH,IAAN,KAAe,IAAf,GACA;AAAE0a,YAAI,EAAE,OAAR;AAAiB1a,YAAI,EAAE;AAAvB,OADA,GAEA;AACI0a,YAAI,EAAE,OADV;AAEI1a,YAAI,EAAE,aAFV;AAGIoL,aAAK,EAAEjL,KAAK,CAACyb,YAAN,IAAsB,CAHjC;AAIIC,WAAG,EAAE1b,KAAK,CAAC2b,UAAN,IAAoB3b,KAAK,CAAC4b,WAJnC;AAKIC,WAAG,EAAE7b,KAAK,CAAC8b,UAAN,IAAoB9b,KAAK,CAAC+b;AALnC,OAhBN,CALkB;AAAA,KAAtB;;AA4BA,QAAMC,YAAY,GAAG,SAAfA,YAAe,CAAC3D,GAAD;AAAA,aACd4D,2BAAQ,CAAC5D,GAAG,CAAC6D,SAAL,CAAR,CAAwBne,WAAxB,EADc;AAAA,KAArB;;AAEA,QAAMoe,aAAa,GAAG,SAAhBA,aAAgB,CAClBrZ,OADkB;AAAA,aAES;AAC3BjD,YAAI,EAAE,gBADqB;AAE3BlC,YAAI,EAAE,MAFqB;AAG3B4S,gBAAQ,EAAEyL,YAAY,CAAClZ,OAAD,CAHK;AAI3BsZ,qBAAa,EAAE,CAACtZ,OAAO,CAACN,OAAT,CAJY;AAK3B6Z,mBAAW,EAAEvZ,OAAO,CAACN;AALM,OAFT;AAAA,KAAtB;;AASA,QAAM8Z,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACha,IAAD;AAAA,aACxBA,IAAI,CAAChF,MAAL,CAAY8D,GAAZ,CAAgB,UAAApB,KAAK;AAAA,eAAK;AACtBH,cAAI,EAAE,aADgB;AAEtBlC,cAAI,EAAE2d,SAAS,CAAChZ,IAAD,EAAOtC,KAAP,CAFO;AAGtBuc,eAAK,EAAErE,aAAa,CAAClY,KAAD;AAHE,SAAL;AAAA,OAArB,CADwB;AAAA,KAA5B;;AAMA,QAAMwc,cAAc,GAAG,SAAjBA,cAAiB,CACnB1Z,OADmB,EAEnBR,IAFmB;AAAA,aAInBma,uBAAK,CACDna,IAAI,CAAChF,MADJ,EAED,UAAA0C,KAAK;AAAA,eAAIsb,SAAS,CAAChZ,IAAD,EAAOtC,KAAP,CAAb;AAAA,OAFJ,EAGD,UAAAA,KAAK;AAAA,eAAIub,aAAa,CAACzY,OAAD,EAAUR,IAAV,EAAgBtC,KAAhB,CAAjB;AAAA,OAHJ,CAJc;AAAA,KAAvB;;AASA,QAAM0c,eAAe,GAAG,SAAlBA,eAAkB,CAACpa,IAAD;AAAA,aACpBA,IAAI,CAAChF,MAAL,CACK8D,GADL,CACS,UAACpB,KAAD,EAAQ2c,CAAR;AAAA,eAAiBV,2BAAQ,CAACjc,KAAK,CAACrC,IAAP,CAAzB,WAA0C,IAAIgf,CAA9C;AAAA,OADT,EAEKC,IAFL,CAEU,GAFV,CADoB;AAAA,KAAxB;;AAIA,QAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACva,IAAD;AAAA,aACtBA,IAAI,CAAChF,MAAL,CAAY+B,MAAZ,KAAuB,CAAvB,IACAiD,IAAI,CAAChF,MAAL,CAAY,CAAZ,EAAeuC,IAAf,KAAwB,MADxB,IAEAyC,IAAI,CAAC3E,IAAL,KAAc,SAHQ;AAAA,KAA1B;;AAIA,QAAMmf,aAAa,GAAG,SAAhBA,aAAgB,CAClBzE,GADkB,EAElB7R,GAFkB,EAGlBxG,KAHkB;AAAA,aAKlBkZ,cAAc,CAACzW,IAAf,CACI,UAAAiO,CAAC;AAAA,eACGA,CAAC,CAAC5N,OAAF,KAAcuV,GAAG,CAACvI,eAAlB,IACAY,CAAC,CAACvM,QAAF,KAAeqC,GAAG,CAACgU,UADnB,IAEA9J,CAAC,CAAC1Q,KAAF,KAAYA,KAAK,CAACrC,IAHrB;AAAA,OADL,CALkB;AAAA,KAAtB;;AAYA,QAAMof,WAAW,GAAGC,sCAAqB,EAAzC;AACA,SAAKxD,iBAAL,GAAyBuD,WAAW,CAC/BpL,MADoB,CAEjB,UAAA7O,OAAO;AAAA,aACH,CAAC,KAAKhF,IAAL,CAAUgF,OAAO,CAACN,OAAlB,CAAD,IACAM,OAAO,CAACuE,MAAR,KAAmB,YAFhB;AAAA,KAFU,EAMpBsK,MANoB,CAOjB,UAAA7O,OAAO;AAAA,aAAIyV,eAAe,CAAChL,OAAhB,CAAwBzK,OAAO,CAACgN,eAAhC,IAAmD,CAAvD;AAAA,KAPU,CAAzB;;AASA,QAAMmN,cAAc,GAAG,SAAjBA,cAAiB,CAACC,GAAD;AAAA,aACnBH,WAAW,CAACpL,MAAZ,CAAmB,UAAA0G,GAAG;AAAA,eAAIA,GAAG,CAACvI,eAAJ,KAAwBoN,GAA5B;AAAA,OAAtB,CADmB;AAAA,KAAvB;;AAEA,QAAMnZ,SAAS,GAAG2N,iCAAe,CAC7B,KAAK8H,iBAAL,CAAuBpY,GAAvB,CAA2B,UAAA0B,OAAO;AAAA,aAC9BA,OAAO,CAACqa,OAAR,CACKxL,MADL,CAEQ,UAAAyJ,GAAG;AAAA,eACCgC,2BAAU,CAAChC,GAAD,CAAV,IACA,CAACA,GAAG,CAACiC,QADL,IAEArE,iBAAiB,CAACzL,OAAlB,CAA0B6N,GAAG,CAACZ,UAA9B,IAA4C,CAAC,CAH9C;AAAA,OAFX,EAOKpZ,GAPL,CAOS,UAAA+C,QAAQ;AAAA,eAAK;AACdrB,iBAAO,EAAPA,OADc;AAEdqB,kBAAQ,EAARA;AAFc,SAAL;AAAA,OAPjB,CAD8B;AAAA,KAAlC,CAD6B,CAAjC;AAeA,QAAMC,MAAM,GAAG,KAAKoV,iBAAL,CACVpY,GADU,CACN,UAAA0B,OAAO;AAAA,aAAK;AACbA,eAAO,EAAPA,OADa;AAEbsB,cAAM,EAAEtB,OAAO,CAACqa,OAAR,CAAgBxL,MAAhB,CACJ,UAAAyJ,GAAG;AAAA,iBACCkC,wBAAO,CAAClC,GAAD,CAAP,IACA,CAACA,GAAG,CAACiC,QADL,IAEAvE,aAAa,CAACvL,OAAd,CAAsB6N,GAAG,CAACZ,UAA1B,IAAwC,CAHzC;AAAA,SADC;AAFK,OAAL;AAAA,KADD,EAUV7I,MAVU,CAUH,UAAA4L,EAAE;AAAA,aAAI,CAAC,CAACA,EAAE,CAACnZ,MAAH,CAAU/E,MAAhB;AAAA,KAVC,CAAf;AAWA,QAAMmB,QAAQ,GAAGkR,iCAAe,CAC5B,KAAK8H,iBAAL,CAAuBpY,GAAvB,CAA2B,UAAA0B,OAAO;AAAA,aAC9BA,OAAO,CAACqa,OAAR,CACKxL,MADL,CAEQ,UAAAyJ,GAAG;AAAA,eACCoC,0BAAS,CAACpC,GAAD,CAAT,IACA,CAACA,GAAG,CAACiC,QADL,IAEAlC,eAAe,CAACC,GAAD,CAHhB;AAAA,OAFX,EAOKha,GAPL,CAOS,UAAAga,GAAG;AAAA,eAAK;AACTtY,iBAAO,EAAPA,OADS;AAEThB,iBAAO,EAAEsZ;AAFA,SAAL;AAAA,OAPZ,CAD8B;AAAA,KAAlC,CAD4B,CAAhC;AAgBA,QAAMqC,sBAA+C,GAAG,+CACjDR,cAAc,CAACS,mCAAD,CAAd,CAAiCtc,GAAjC,CACC,UAAA0B,OAAO;AAAA,aACoB;AACnByX,YAAI,EAAE,OADa;AAEnB1a,YAAI,OAFe;AAGnB8d,gBAAQ,kBAHW;AAInBC,aAAK,EAAE,CACHzB,aAAa,CAACrZ,OAAD,CADV,EAEH;AACIjD,cAAI,EAAEge,uCADV;AAEIlgB,cAAI,EAAE;AAFV,SAFG,CAJY;AAWnBmgB,cAAM,EAAE9D,YAAY,CAAClX,OAAD,CAXD;AAYnBib,oBAAY,EAAE,IAZK;AAanBC,yBAAiB,EAAEC,mCAbA;AAcnBC,qBAAa,EAAED,mCAdI;AAenBE,eAAO,6BAfY;AAgBnBC,eAAO,EAAEnD,WAAW,CAACnY,OAAD,CAhBD;AAiBnBA,eAAO,EAAPA,OAjBmB;AAkBnBiV,kBAAU,8CAlBS;AAmBnBlB,gBAAQ,EAAE;AAnBS,OADpB;AAAA,KADR,CADiD,wCAyBjDoG,cAAc,CAACoB,0BAAD,CAAd,CAAwBjd,GAAxB,CACC,UAAA0B,OAAO;AAAA,aACoB;AACnByX,YAAI,EAAE,OADa;AAEnB1a,YAAI,QAFe;AAGnB8d,gBAAQ,6BAHW;AAInBC,aAAK,EAAE,CACHzB,aAAa,CAACrZ,OAAD,CADV,EAEH;AACIjD,cAAI,EAAE,aADV;AAEIlC,cAAI,EAAE,OAFV;AAGI4e,eAAK,EAAE;AAHX,SAFG,EAOH;AACI1c,cAAI,EAAE,aADV;AAEIlC,cAAI,EAAE,OAFV;AAGI4e,eAAK,EAAE;AAHX,SAPG,CAJY;AAiBnBvW,cAAM,EAAE;AACJsY,eAAK,EAAE;AACH/D,gBAAI,EAAE,OADH;AAEH1a,gBAAI,EAAE0e,oDAAyB1e;AAF5B,WADH;AAKJ2e,eAAK,EAAE;AACHjE,gBAAI,EAAE,OADH;AAEH1a,gBAAI,EAAE,cAFH;AAGH6a,kBAAM,EAAE;AAHL;AALH,SAjBW;AA4BnBoD,cAAM,EAAE9D,YAAY,CAAClX,OAAD,CA5BD;AA6BnBib,oBAAY,EAAE,IA7BK;AA8BnBC,yBAAiB,EAAEC,mCA9BA;AA+BnBC,qBAAa,EAAED,mCA/BI;AAgCnBE,eAAO,kBAhCY;AAiCnBC,eAAO,EAAEnD,WAAW,CAACnY,OAAD,CAjCD;AAkCnBA,eAAO,EAAPA,OAlCmB;AAmCnBiV,kBAAU,8FAnCS;AAoCnBlB,gBAAQ,EAAE;AApCS,OADpB;AAAA,KADR,CAzBiD,wCAkEjDoG,cAAc,CAACwB,4CAAD,CAAd,CAA0Crd,GAA1C,CACC,UAAA0B,OAAO;AAAA,aACoB;AACnByX,YAAI,EAAE,OADa;AAEnB1a,YAAI,cAFe;AAGnB8d,gBAAQ,uBAHW;AAInBC,aAAK,EAAE,CACHzB,aAAa,CAACrZ,OAAD,CADV,EAEH;AACIjD,cAAI,EAAE,aADV;AAEIlC,cAAI,EAAE,QAFV;AAGI4e,eAAK,EAAE;AAHX,SAFG,CAJY;AAYnBvW,cAAM,EAAE;AACJ0Y,gBAAM,EAAE;AACJnE,gBAAI,EAAE,OADF;AAEJ1a,gBAAI,EAAE;AAFF;AADJ,SAZW;AAkBnBie,cAAM,EAAE9D,YAAY,CAAClX,OAAD,CAlBD;AAmBnBib,oBAAY,EAAE,IAnBK;AAoBnBC,yBAAiB,EAAEC,mCApBA;AAqBnBC,qBAAa,EAAED,mCArBI;AAsBnBE,eAAO,kCAtBY;AAuBnBC,eAAO,EAAEnD,WAAW,CAACnY,OAAD,CAvBD;AAwBnBA,eAAO,EAAPA,OAxBmB;AAyBnB;AACA+T,gBAAQ,EAAE;AA1BS,OADpB;AAAA,KADR,CAlEiD,wCAiGjDoG,cAAc,CAAC0B,iCAAD,CAAd,CAA+Bvd,GAA/B,CACC,UAAA0B,OAAO;AAAA,aACoB;AACnByX,YAAI,EAAE,OADa;AAEnB1a,YAAI,aAFe;AAGnB8d,gBAAQ,mBAHW;AAInBC,aAAK,EAAE,CACHzB,aAAa,CAACrZ,OAAD,CADV,EAEH;AACIjD,cAAI,EAAE+e,qCADV;AAEIjhB,cAAI,EAAE;AAFV,SAFG,CAJY;AAWnBmgB,cAAM,EAAE9D,YAAY,CAAClX,OAAD,CAXD;AAYnBib,oBAAY,EAAE,IAZK;AAanBC,yBAAiB,EAAEC,mCAbA;AAcnBC,qBAAa,EAAED,mCAdI;AAenBE,eAAO,kCAfY;AAgBnBC,eAAO,EAAEnD,WAAW,CAACnY,OAAD,CAhBD;AAiBnBA,eAAO,EAAPA,OAjBmB;AAkBnB;AACA+T,gBAAQ,EAAE;AAnBS,OADpB;AAAA,KADR,CAjGiD,GAyHtDzV,GAzHsD,CAyHlD,UAAAuB,GAAG,EAAI;AACTA,SAAG,CAAC9C,IAAJ,sBAA4B8C,GAAG,CAACG,OAAJ,CAAYN,OAAZ,CAAoBzE,WAApB,EAA5B,SACI4E,GAAG,CAAC9C,IADR;AAGA,aAAO8C,GAAP;AACH,KA9HuD,CAAxD;AAgIA,QAAMkc,WAAW,GAAGza,MAAM,CAAChD,GAAP,CAChB;AAAA,UAAG0B,OAAH,QAAGA,OAAH;AAAA,UAAYsB,MAAZ,QAAYA,MAAZ;AAAA,aAA0B;AACtBmW,YAAI,EAAE,OADgB;AAEtB1a,YAAI,qBAAmBiD,OAAO,CAACN,OAFT;AAGtBmb,gBAAQ,YAHc;AAItBC,aAAK,EAAE,CACHzB,aAAa,CAACrZ,OAAD,CADV,EAEc;AACbjD,cAAI,EAAE,gBADO;AAEblC,cAAI,EAAE,OAFO;AAGbwc,iBAAO,EAAE/V,MAAM,CAAChD,GAAP,CAAW,UAAAiD,KAAK;AAAA,mBAAI,CACzB4X,2BAAQ,CAAC5X,KAAK,CAAC1G,IAAP,CADiB,EAEzB0G,KAAK,CAAC1G,IAFmB,CAAJ;AAAA,WAAhB;AAHI,SAFd,CAJe;AAetBmgB,cAAM,EAAE9D,YAAY,CAAClX,OAAD,CAfE;AAgBtBib,oBAAY,EAAE,IAhBQ;AAiBtBG,qBAAa,EAAED,mCAjBO;AAkBtBE,eAAO,sBAAoBrb,OAAO,CAACnF,IAA5B,aAlBe;AAmBtBygB,eAAO,EAAEnD,WAAW,CAACnY,OAAD,CAnBE;AAoBtBA,eAAO,EAAPA,OApBsB;AAqBtBsB,cAAM,EAANA,MArBsB;AAsBtByS,gBAAQ,EAAE;AAtBY,OAA1B;AAAA,KADgB,CAApB;AA2BA,QAAMiI,2BAA2B,GAAG/a,SAAS,CACxC4N,MAD+B,CAE5B;AAAA,UAAG7O,OAAH,SAAGA,OAAH;AAAA,aACI,CAACA,OAAO,CAACqa,OAAR,CAAgB4B,IAAhB,CACG,UAAA3D,GAAG;AAAA,eACCkC,wBAAO,CAAClC,GAAD,CAAP,IACAtC,aAAa,CAACvL,OAAd,CAAsB6N,GAAG,CAACZ,UAA1B,IAAwC,CAFzC;AAAA,OADN,CADL;AAAA,KAF4B,EAS/B7I,MAT+B,CAU5B;AAAA,UAAGxN,QAAH,SAAGA,QAAH;AAAA,aACIA,QAAQ,CAAC7G,MAAT,CAAgB+B,MAAhB,KAA2B,CAA3B,IACA8Y,gCAAa,CAAChU,QAAQ,CAAC7G,MAAT,CAAgB,CAAhB,CAAD,CADb,IAEA6G,QAAQ,CAACqW,UAAT,KAAwBvB,gDAH5B;AAAA,KAV4B,EAe/B7X,GAf+B,CAeF;AAAA,UAAG0B,OAAH,SAAGA,OAAH;AAAA,UAAYqB,QAAZ,SAAYA,QAAZ;AAAA,aAA4B;AACtDoW,YAAI,EAAE,OADgD;AAEtD1a,YAAI,+BAA6BiD,OAAO,CAACN,OAArC,SAAgD2B,QAAQ,CAACxG,IAFP;AAGtDggB,gBAAQ,aAAW1B,2BAAQ,CAAC9X,QAAQ,CAACxG,IAAV,CAAnB,kBAH8C;AAItDigB,aAAK,EAAE,CACHzB,aAAa,CAACrZ,OAAD,CADV,8CAEAwZ,mBAAmB,CAACnY,QAAD,CAFnB,GAGLwN,MAHK,CAGE,UAAA0D,CAAC;AAAA,iBAAI,CAAC,CAACA,CAAN;AAAA,SAHH,CAJ+C;AAQtDrP,cAAM,EAAEwW,cAAc,CAAC1Z,OAAD,EAAUqB,QAAV,CARgC;AAStD4Z,oBAAY,EAAE,IATwC;AAUtDG,qBAAa,EAAED,mCAVuC;AAWtDH,cAAM,EAAE9D,YAAY,CAAClX,OAAD,CAXkC;AAYtDqb,eAAO,yBAAuBha,QAAQ,CAACxG,IAAhC,aAZ+C;AAatDygB,eAAO,EAAEnD,WAAW,CAACnY,OAAD,CAbkC;AActDA,eAAO,EAAPA,OAdsD;AAetDqB,gBAAQ,EAARA,QAfsD;AAiBtD0S,gBAAQ,EAAE;AAjB4C,OAA5B;AAAA,KAfE,CAApC;;AAmCA,uBAA8CmI,6BAAW,CACrDjb,SADqD,EAErD,UAAAyC,GAAG;AAAA,aAAIA,GAAG,CAACrC,QAAJ,CAAa7G,MAAb,CAAoB+B,MAApB,IAA8B,CAAlC;AAAA,KAFkD,CAAzD;AAAA,QAAO4f,eAAP;AAAA,QAAwBC,kBAAxB;;AAIA,wBAAoDF,6BAAW,CAC3DC,eAD2D,EAE3D;AAAA,UAAG9a,QAAH,SAAGA,QAAH;AAAA,aAAkB,CAAC,CAAC+T,aAAa,CAAC/T,QAAQ,CAAC7G,MAAT,CAAgB,CAAhB,CAAD,CAAjC;AAAA,KAF2D,CAA/D;AAAA,QAAO6hB,mBAAP;AAAA,QAA4BC,oBAA5B;;AAIA,QAAMC,wBAAwB,GAC1BF,mBAAmB,CAAC/d,GAApB,CACI;AAAA;;AAAA,UAAG0B,OAAH,SAAGA,OAAH;AAAA,UAAYqB,QAAZ,SAAYA,QAAZ;AAAA,aAA4B;AACxBoW,YAAI,EAAE,OADkB;AAExB1a,YAAI,yBAAuBiD,OAAO,CAACN,OAA/B,SAA0C2B,QAAQ,CAACxG,IAF/B;AAGxBggB,gBAAQ,EACJ,mBAAAb,aAAa,CAACha,OAAD,EAAUqB,QAAV,EAAoBA,QAAQ,CAAC7G,MAAT,CAAgB,CAAhB,CAApB,CAAb,kEACM+b,GADN,aACmB4C,2BAAQ,CAAC9X,QAAQ,CAACxG,IAAV,CALP;AAMxBigB,aAAK,EAAE,CAACzB,aAAa,CAACrZ,OAAD,CAAd,CANiB;AAOxBib,oBAAY,EAAE,IAPU;AAQxBuB,cAAM,EAAEpH,aAAa,CAAC/T,QAAQ,CAAC7G,MAAT,CAAgB,CAAhB,CAAD,CARG;AASxBwgB,cAAM,EAAE9D,YAAY,CAAClX,OAAD,CATI;AAUxBqb,eAAO,EAAEha,QAAQ,CAACob,WAVM;AAWxBnB,eAAO,EAAEnD,WAAW,CAACnY,OAAD,CAXI;AAYxBA,eAAO,EAAPA,OAZwB;AAaxBqB,gBAAQ,EAARA,QAbwB;AAcxBnE,aAAK,EAAEmE,QAAQ,CAAC7G,MAAT,CAAgB,CAAhB,CAdiB;AAgBxBuZ,gBAAQ,EAAE;AAhBc,OAA5B;AAAA,KADJ,CADJ;AAqBA,QAAM2I,uBAAuB,GAAGJ,oBAAoB,CAC/CzN,MAD2B,CAExB;AAAA,UAAG7O,OAAH,SAAGA,OAAH;AAAA,UAAYqB,QAAZ,SAAYA,QAAZ;AAAA,aACI,CAAC,CAACiU,QAAQ,CAACtV,OAAD,EAAUqB,QAAQ,CAAC7G,MAAT,CAAgB,CAAhB,CAAV,CADd;AAAA,KAFwB,EAK3B8D,GAL2B,CAKvB;AAAA,UAAG0B,OAAH,SAAGA,OAAH;AAAA,UAAYqB,QAAZ,SAAYA,QAAZ;AAAA,aAA4B;AAC7BrB,eAAO,EAAPA,OAD6B;AAE7BqB,gBAAQ,EAARA,QAF6B;AAG7BnE,aAAK,EAAEmE,QAAQ,CAAC7G,MAAT,CAAgB,CAAhB,CAHsB;AAI7BmiB,aAAK,EAAErH,QAAQ,CAACtV,OAAD,EAAUqB,QAAQ,CAAC7G,MAAT,CAAgB,CAAhB,CAAV;AAJc,OAA5B;AAAA,KALuB,CAAhC;AAWA,QAAMoiB,0BAA0B,GAAGhO,iCAAe,CAC9CwN,kBAAkB,CAAC9d,GAAnB,CAAuB;AAAA,UAAG0B,OAAH,SAAGA,OAAH;AAAA,UAAYqB,QAAZ,SAAYA,QAAZ;AAAA,aACnBA,QAAQ,CAAC7G,MAAT,CACK8D,GADL,CACS,UAAApB,KAAK;AAAA,eAAK;AACX8C,iBAAO,EAAPA,OADW;AAEXqB,kBAAQ,EAARA,QAFW;AAGXnE,eAAK,EAALA,KAHW;AAIXyf,eAAK,EAAErH,QAAQ,CAACtV,OAAD,EAAU9C,KAAV;AAJJ,SAAL;AAAA,OADd,EAOK2R,MAPL,CAOY;AAAA,YAAG8N,KAAH,UAAGA,KAAH;AAAA,eAAe,CAAC,CAACA,KAAjB;AAAA,OAPZ,CADmB;AAAA,KAAvB,CAD8C,CAAlD;AAYA,QAAME,qBAAqB,GAAG,+CACvBH,uBADuB,wCAEvBE,0BAFuB,GAG5Bte,GAH4B,CAI1B;AAAA;;AAAA,UAAG0B,OAAH,UAAGA,OAAH;AAAA,UAAYqB,QAAZ,UAAYA,QAAZ;AAAA,UAAsBnE,KAAtB,UAAsBA,KAAtB;AAAA,UAA6Byf,KAA7B,UAA6BA,KAA7B;AAAA,aAA0C;AACtClF,YAAI,EAAE,OADgC;AAEtC1a,YAAI,uBAAqBiD,OAAO,CAACN,OAA7B,SAAwC2B,QAAQ,CAACxG,IAAjD,SAAyDqC,KAAK,CAACrC,IAF7B;AAGtCggB,gBAAQ,EACJ,oBAAAb,aAAa,CAACha,OAAD,EAAUqB,QAAV,EAAoBnE,KAApB,CAAb,oEAAyCqZ,GAAzC,aACM4C,2BAAQ,CAAC9X,QAAQ,CAACxG,IAAV,CADd,IAEIqC,KAAK,CAACrC,IAAN,KAAe,GAAf,GAAqB,EAArB,SAA8BqC,KAAK,CAACrC,IAFxC,SAJkC;AAQtCigB,aAAK,EAAE,CACHzB,aAAa,CAACrZ,OAAD,CADV,EAEqB;AACpBjD,cAAI,EAAE,gBADc;AAEpBlC,cAAI,EAAEqC,KAAK,CAACrC,IAFQ;AAGpBwc,iBAAO,EAAEyF,MAAM,CAACC,IAAP,CAAYJ,KAAK,CAACK,OAAlB,EAA2B1e,GAA3B,CAA+B,UAAA2e,MAAM;AAAA,mBAAI,CAC9C9D,2BAAQ,CAAC8D,MAAD,CADsC,EAE9CA,MAF8C,CAAJ;AAAA,WAArC;AAHW,SAFrB,CAR+B;AAmBtChC,oBAAY,EAAE,IAnBwB;AAoBtCuB,cAAM,EAAE,SApB8B;AAqBtCxB,cAAM,EAAE9D,YAAY,CAAClX,OAAD,CArBkB;AAsBtCqb,eAAO,EAAEha,QAAQ,CAACob,WAtBoB;AAuBtCnB,eAAO,EAAEnD,WAAW,CAACnY,OAAD,CAvBkB;AAwBtCA,eAAO,EAAPA,OAxBsC;AAyBtCqB,gBAAQ,EAARA,QAzBsC;AA0BtCnE,aAAK,EAALA,KA1BsC;AA4BtC6W,gBAAQ,EAAE;AA5B4B,OAA1C;AAAA,KAJ0B,CAA9B;AAoCA,QAAMmJ,yBAAyB,GAAGd,kBAAkB,CAC/CvN,MAD6B,CACtB,UAAAsO,EAAE;AAAA,aAAIA,EAAE,CAAC9b,QAAH,CAAY7G,MAAZ,CAAmByhB,IAAnB,CAAwB5G,4BAAxB,CAAJ;AAAA,KADoB,EAE7B/W,GAF6B,CAEA;AAAA,UAAG0B,OAAH,UAAGA,OAAH;AAAA,UAAYqB,QAAZ,UAAYA,QAAZ;AAAA,aAA4B;AACtDoW,YAAI,EAAE,OADgD;AAEtD1a,YAAI,2BAAyBiD,OAAO,CAACN,OAAjC,SAA4C2B,QAAQ,CAACxG,IAFH;AAGtDggB,gBAAQ,UAAQ1B,2BAAQ,CAAC9X,QAAQ,CAACxG,IAAV,CAAhB,IACJwG,QAAQ,CAAC7G,MAAT,CAAgB+B,MAAhB,GAAyB,CAAzB,WAAqC,EADjC,CAH8C;AAMtDue,aAAK,EAAE,CACHzB,aAAa,CAACrZ,OAAD,CADV,EAEHqB,QAAQ,CAAC7G,MAAT,CAAgB+B,MAAhB,GAAyB,CAAzB,GAC8B;AACpBQ,cAAI,EAAE,gBADc;AAEpBlC,cAAI,EAAE,OAFc;AAGpBwc,iBAAO,EAAEhW,QAAQ,CAAC7G,MAAT,CACJqU,MADI,CACG,UAAAvB,CAAC;AAAA,mBAAI+H,gCAAa,CAAC/H,CAAD,CAAjB;AAAA,WADJ,EAEJhP,GAFI,CAEA,UAAApB,KAAK;AAAA,mBAAI,CACVic,2BAAQ,CAACjc,KAAK,CAACrC,IAAP,CADE,EAEV2d,SAAS,CAACnX,QAAD,EAAWnE,KAAX,CAFC,CAAJ;AAAA,WAFL;AAHW,SAD9B,GAWMqD,SAbH,EAcLsO,MAdK,CAcE,UAAA0D,CAAC;AAAA,iBAAI,CAAC,CAACA,CAAN;AAAA,SAdH,CAN+C;AAqBtD0I,oBAAY,EAAE,IArBwC;AAsBtDuB,cAAM,EAAE,QAtB8C;AAuBtDxB,cAAM,EAAE9D,YAAY,CAAClX,OAAD,CAvBkC;AAwBtDqb,eAAO,EAAEha,QAAQ,CAACob,WAxBoC;AAyBtDnB,eAAO,EAAEnD,WAAW,CAACnY,OAAD,CAzBkC;AA0BtDA,eAAO,EAAPA,OA1BsD;AA2BtDqB,gBAAQ,EAARA,QA3BsD;AA6BtD0S,gBAAQ,EAAE;AA7B4C,OAA5B;AAAA,KAFA,CAAlC;AAkCA,QAAMqJ,iBAAiB,GAAGnc,SAAS,CAC9B4N,MADqB,CACd;AAAA,UAAGxN,QAAH,UAAGA,QAAH;AAAA,aAAkBA,QAAQ,CAACoW,IAAT,KAAkB,IAApC;AAAA,KADc,EAErB5I,MAFqB,CAEd;AAAA,UAAGxN,QAAH,UAAGA,QAAH;AAAA,aAAkBgX,eAAe,CAAChX,QAAD,CAAjC;AAAA,KAFc,EAGrB/C,GAHqB,CAGQ;AAAA,UAAG0B,OAAH,UAAGA,OAAH;AAAA,UAAYqB,QAAZ,UAAYA,QAAZ;AAAA,aAA4B;AACtDoW,YAAI,EAAE,OADgD;AAEtD1a,YAAI,kBAAgBiD,OAAO,CAACN,OAAxB,SAAmC2B,QAAQ,CAACxG,IAFM;AAGtDggB,gBAAQ,EAAEd,iBAAiB,CAAC1Y,QAAD,CAAjB,6BAEMA,QAAQ,CAACxG,IAFf,aAGAwG,QAAQ,CAAC7G,MAAT,CAAgB+B,MAAhB,KAA2B,CAA3B,GACM,IADN,GAEMqd,eAAe,CAACvY,QAAD,CALrB,CAH4C;AAUtDyZ,aAAK,GACDzB,aAAa,CAACrZ,OAAD,CADZ,8CAEEwZ,mBAAmB,CAACnY,QAAD,CAFrB,EAViD;AActD6B,cAAM,EAAEwW,cAAc,CAAC1Z,OAAD,EAAUqB,QAAV,CAdgC;AAetD4Z,oBAAY,EAAE,IAfwC;AAgBtDD,cAAM,EAAE9D,YAAY,CAAClX,OAAD,CAhBkC;AAiBtDqb,eAAO,EAAEha,QAAQ,CAACob,WAjBoC;AAkBtDnB,eAAO,EAAEnD,WAAW,CAACnY,OAAD,CAlBkC;AAmBtDA,eAAO,EAAPA,OAnBsD;AAoBtDqB,gBAAQ,EAARA,QApBsD;AAqBtD6Z,yBAAiB,EAAEC,mCArBmC;AAsBtDC,qBAAa,EAAED,mCAtBuC;AAwBtDpH,gBAAQ,EAAE;AAxB4C,OAA5B;AAAA,KAHR,CAA1B;AA8BA,QAAMsJ,aAAa,GAAG3f,QAAQ,CAACY,GAAT,CAClB;AAAA,UAAG0B,OAAH,UAAGA,OAAH;AAAA,UAAYhB,OAAZ,UAAYA,OAAZ;AAAA,aAA2B;AACvByY,YAAI,EAAE,OADiB;AAEvB1a,YAAI,sBAAoBiD,OAAO,CAACN,OAA5B,SAAuCV,OAAO,CAACnE,IAF5B;AAGvBggB,gBAAQ,EAAE,CAAC7b,OAAO,CAACxE,MAAR,CAAe+B,MAAhB,GACD4c,2BAAQ,CAACna,OAAO,CAACnE,IAAT,CADP,WAEDse,2BAAQ,CAACna,OAAO,CAACnE,IAAT,CAFP,iBAEiC+e,eAAe,CAChD5a,OADgD,CALnC;AAQvB8b,aAAK,GACDzB,aAAa,CAACrZ,OAAD,CADZ,8CAEEwZ,mBAAmB,CAACxa,OAAD,CAFrB,EARkB;AAYvBkE,cAAM,EAAEwW,cAAc,CAAC1Z,OAAD,EAAUhB,OAAV,CAZC;AAavBic,oBAAY,EAAE,IAbS;AAcvBD,cAAM,EAAE9D,YAAY,CAAClX,OAAD,CAdG;AAevBqb,eAAO,EAAErc,OAAO,CAACyd,WAfM;AAgBvBnB,eAAO,EAAEnD,WAAW,CAACnY,OAAD,CAhBG;AAiBvBA,eAAO,EAAPA,OAjBuB;AAkBvBhB,eAAO,EAAPA,OAlBuB;AAmBvBkc,yBAAiB,EAAEC,mCAnBI;AAoBvBC,qBAAa,EAAED,mCApBQ;AAsBvBpH,gBAAQ,EAAE;AAtBa,OAA3B;AAAA,KADkB,CAAtB;AA2BA,SAAKuJ,cAAL,kDACOvB,WADP,wCAEOC,2BAFP,wCAGOO,wBAHP,wCAIOM,qBAJP,wCAKOK,yBALP,wCAMOE,iBANP,wCAOOzC,sBAPP,wCAQO0C,aARP,GAhiBuC,CA2iBvC;;AACA,SAAKE,iBAAL,GAAyB3O,iCAAe,CACpCtN,MAAM,CAAChD,GAAP,CAAW;AAAA,UAAG0B,OAAH,UAAGA,OAAH;AAAA,UAAYsB,MAAZ,UAAYA,MAAZ;AAAA,aACPA,MAAM,CACDuN,MADL,CAEQ,UAAAtN,KAAK;AAAA,eAAIA,KAAK,CAAC/G,MAAN,CAAaqU,MAAb,CAAoBwG,4BAApB,EAAmC9Y,MAAnC,GAA4C,CAAhD;AAAA,OAFb,EAIK+B,GAJL,CAIS,UAAAiD,KAAK;AAAA,eAAK;AAAEvB,iBAAO,EAAPA,OAAF;AAAWuB,eAAK,EAALA;AAAX,SAAL;AAAA,OAJd,EAKKjD,GALL,CAMQ;AAAA,YAAG0B,OAAH,UAAGA,OAAH;AAAA,YAAYuB,KAAZ,UAAYA,KAAZ;AAAA,eAC0B;AAClBkW,cAAI,EAAE,OADY;AAElB1a,cAAI,0BAAwBiD,OAAO,CAACN,OAAhC,SAA2C6B,KAAK,CAAC1G,IAFnC;AAGlBggB,kBAAQ,EAAKtZ,KAAK,CAAC1G,IAAX,QAHU;AAIlBigB,eAAK,EAAE,CACc;AACb/d,gBAAI,EAAE,gBADO;AAEblC,gBAAI,EAAE,OAFO;AAGbwc,mBAAO,EAAE9V,KAAK,CAAC/G,MAAN,CAAa8D,GAAb,CAAiB,UAAApB,KAAK;AAAA,qBAAI,CAC/Bic,2BAAQ,CAACjc,KAAK,CAACrC,IAAP,CADuB,EAE/BqC,KAAK,CAACrC,IAFyB,CAAJ;AAAA,aAAtB;AAHI,WADd,CAJW;AAclBmgB,gBAAM,EAAE9D,YAAY,CAAClX,OAAD,CAdF;AAelBib,sBAAY,EAAE,IAfI;AAgBlBI,iBAAO,0BAAwB9Z,KAAK,CAAC1G,IAA9B,WAhBW;AAiBlBygB,iBAAO,EAAEnD,WAAW,CAACnY,OAAD,CAjBF;AAkBlBA,iBAAO,EAAPA,OAlBkB;AAmBlBuB,eAAK,EAALA,KAnBkB;AAoBlBib,gBAAM,EAAE,QApBU;AAqBlBzI,kBAAQ,EAAE;AArBQ,SAD1B;AAAA,OANR,CADO;AAAA,KAAX,CADoC,CAAxC;AAoCA,SAAKyJ,cAAL,GAAsB,CAClB;AACI/F,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE0gB,gCAFV;AAGI5C,cAAQ,EAAE,UAHd;AAIIC,WAAK,EAAE,CACsB;AACrB/d,YAAI,EAAE,gBADe;AAErBlC,YAAI,EAAE,MAFe;AAGrB4S,gBAAQ,EAAE,KAHW;AAIrB6L,qBAAa,GACT,QADS,8CAEN,KAAK5C,iBAAL,CAAuBpY,GAAvB,CACC,UAAA0B,OAAO;AAAA,iBAAIA,OAAO,CAACN,OAAZ;AAAA,SADR,CAFM,EAJQ;AAUrB6Z,mBAAW,EAAE;AAVQ,OADtB,EAaqB;AACpBxc,YAAI,EAAE,gBADc;AAEpBlC,YAAI,EAAE,OAFc;AAGpBwc,eAAO,EAAE,CACL,CAAC,WAAD,EAAc,WAAd,CADK,EAEL,CAAC,cAAD,EAAiB,cAAjB,CAFK;AAHW,OAbrB,CAJX;AA0BI4D,kBAAY,EAAE,IA1BlB;AA2BIG,mBAAa,EAAED,mCA3BnB;AA4BIH,YAAM,EAAExE,YA5BZ;AA6BI6E,aAAO,EAAE,oDA7Bb;AA8BIC,aAAO,EAAE,EA9Bb;AA+BIvH,cAAQ,EAAE;AA/Bd,KADkB,EAkClB;AACI0D,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE2gB,+BAFV;AAGI7C,cAAQ,EAAE,cAHd;AAIIC,WAAK,EAAE,CACsB;AACrB/d,YAAI,EAAE,gBADe;AAErBlC,YAAI,EAAE,MAFe;AAGrB4S,gBAAQ,EAAE,KAHW;AAIrB6L,qBAAa,GACT,QADS,8CAEN,KAAK5C,iBAAL,CAAuBpY,GAAvB,CACC,UAAA0B,OAAO;AAAA,iBAAIA,OAAO,CAACN,OAAZ;AAAA,SADR,CAFM,EAJQ;AAUrB6Z,mBAAW,EAAE;AAVQ,OADtB,CAJX;AAkBIiD,YAAM,EAAE,SAlBZ;AAmBIvB,kBAAY,EAAE,IAnBlB;AAoBID,YAAM,EAAExE,YApBZ;AAqBI6E,aAAO,EAAE,oDArBb;AAsBIC,aAAO,EAAE,EAtBb;AAuBIvH,cAAQ,EAAE;AAvBd,KAlCkB,EA2DlB;AACI0D,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE4gB,sCAFV;AAGI9C,cAAQ,EAAE,2BAHd;AAIIC,WAAK,EAAE,CACsB;AACrB/d,YAAI,EAAE,gBADe;AAErBlC,YAAI,EAAE,MAFe;AAGrB4S,gBAAQ,EAAE,KAHW;AAIrB6L,qBAAa,GACT,QADS,8CAEN,KAAK5C,iBAAL,CAAuBpY,GAAvB,CACC,UAAA0B,OAAO;AAAA,iBAAIA,OAAO,CAACN,OAAZ;AAAA,SADR,CAFM,EAJQ;AAUrB6Z,mBAAW,EAAE;AAVQ,OADtB,EAamB;AAClBxc,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,OAFY;AAGlB4e,aAAK,EAAE;AAHW,OAbnB,CAJX;AAuBIvW,YAAM,EAAE;AACJsY,aAAK,EAAE;AACH/D,cAAI,EAAE,OADH;AAEH1a,cAAI,EAAE0e,oDAAyB1e;AAF5B;AADH,OAvBZ;AA6BIke,kBAAY,EAAE,IA7BlB;AA8BIC,uBAAiB,EAAEC,mCA9BvB;AA+BIC,mBAAa,EAAED,mCA/BnB;AAgCIH,YAAM,EAAExE,YAhCZ;AAiCI6E,aAAO,EAAE,oCAjCb;AAkCIC,aAAO,EAAE;AAlCb,KA3DkB,CAAtB;AAiGA,0DACO,KAAKgC,cADZ,wCAEO,KAAKC,iBAFZ,wCAGO,KAAKC,cAHZ;AAKH,GAvsBL;;AAAA,SAysBII,cAzsBJ,GAysBI,wBAAevG,OAAf,EAA+C;AAAA;AAAA;;AAC3C,QAAQT,KAAR,GAAwCS,OAAxC,CAAQT,KAAR;AAAA,QAAeiH,MAAf,GAAwCxG,OAAxC,CAAewG,MAAf;AAAA,QAAuBC,YAAvB,GAAwCzG,OAAxC,CAAuByG,YAAvB;AACA,QAAM5G,YAAY,GAAG,KAAKP,kBAAL,CAAwBC,KAAxB,CAArB;AAEA,QAAMmH,aAAa,GACf,CAAAF,MAAM,SAAN,IAAAA,MAAM,WAAN,YAAAA,MAAM,CAAEvL,SAAR,CACKhU,GADL,CACS,UAAAiU,CAAC;AAAA,aAAIA,CAAC,CAACxV,IAAN;AAAA,KADV,EAEK8R,MAFL,CAEY,UAAA9R,IAAI;AAAA,aAAI,CAAC,CAAC+C,6CAA4B,CAAC/C,IAAD,CAAlC;AAAA,KAFhB,MAE6D,EAHjE;AAIA,QAAMihB,UAAkC,GAAG,IAAIC,GAAJ,CACvCJ,MADuC,aACvCA,MADuC,yCACvCA,MAAM,CAAElJ,MAD+B,mDACvC,eACMrW,GADN,CACU,UAAA4T,KAAK;AAAA,aAAK;AACZA,aAAK,EAALA,KADY;AAEZqB,kBAAU,EAAEC,iDAA6B,CAACtB,KAAK,CAACnV,IAAP;AAF7B,OAAL;AAAA,KADf,EAKK8R,MALL,CAKY;AAAA,UAAG0E,UAAH,UAAGA,UAAH;AAAA,aAAoBA,UAAU,CAACQ,QAAX,KAAwB,OAA5C;AAAA,KALZ,EAMKzV,GANL,CAMS,kBAA2B;AAAA,UAAxB4T,KAAwB,UAAxBA,KAAwB;AAAA,UAAjBqB,UAAiB,UAAjBA,UAAiB;AAC5B,UAAM2K,SAAS,GAAGhM,KAAK,CAACW,MAAN,CAAa,CAAb,EAAgBrY,MAAhB,CAAuB,OAAvB,EACb2N,KADL;AAEA,aAAQoL,UAAD,CAAqCjS,MAArC,CAA4C3B,IAA5C,CACH,UAAA6D,EAAE;AAAA,eAAIA,EAAE,CAAC3I,IAAH,KAAYqjB,SAAhB;AAAA,OADC,CAAP;AAGH,KAZL,EAaKrP,MAbL,CAaY,UAAArL,EAAE;AAAA,aAAI,CAAC,CAACA,EAAN;AAAA,KAbd,CADuC,CAA3C;;AAgBA,QAAM2a,QAAQ,GAAG,KAAKb,cAAL,CAAoBzO,MAApB,CAA2B,UAAAqD,KAAK;AAAA,aAAI,CAAC,CAACA,KAAK,CAAClS,OAAZ;AAAA,KAAhC,CAAjB;;AACA,QAAMoe,QAAQ,GAAGC,2BAAS,CACtBF,QADsB,EAEtB,UAAAjM,KAAK;AAAA,aAAIA,KAAK,CAAClS,OAAN,CAAcN,OAAlB;AAAA,KAFiB,EAGtB,UAAAwS,KAAK;AAAA,aAAIA,KAAK,CAAClS,OAAV;AAAA,KAHiB,CAA1B;AAMA,QAAMse,eAAqC,GAAGD,2BAAS,CACnDlS,4CAAA,GACMiS,QADN,kDAGaL,aAAa,CACXzf,GADF,CACM,UAAAigB,KAAK;AAAA,aACNH,QAAQ,CAACze,IAAT,CACI,UAAAK,OAAO;AAAA,eAAIA,OAAO,CAACN,OAAR,KAAoB6e,KAAxB;AAAA,OADX,CADM;AAAA,KADX,EAME1P,MANF,CAMS,UAAA0G,GAAG;AAAA,aAAI,CAAC,CAACA,GAAN;AAAA,KANZ,CAHb,wCAUauI,YAAY,CAACxf,GAAb,CAAiB,UAAAiX,GAAG;AAAA,aAAIA,GAAG,CAAC1I,aAAR;AAAA,KAApB,CAVb,EADmD,EAanD,UAAA0I,GAAG;AAAA,aAAIA,GAAG,CAAC7V,OAAR;AAAA,KAbgD,EAcnD,UAAA6V,GAAG;AAAA,aAAIA,GAAJ;AAAA,KAdgD,CAAT,CAgBzC1G,MAhByC,CAiBtC,UAAA0G,GAAG;AAAA,aAAIA,GAAG,IAAIE,eAAe,CAAChL,OAAhB,CAAwB8K,GAAG,CAACvI,eAA5B,IAA+C,CAA1D;AAAA,KAjBmC,EAmBzC3R,IAnByC,CAmBpC,UAACmjB,CAAD,EAAI1T,CAAJ;AAAA,aAAU0T,CAAC,CAAC3jB,IAAF,CAAO4jB,aAAP,CAAqB3T,CAAC,CAACjQ,IAAvB,CAAV;AAAA,KAnBoC,CAA9C;AAqBA,QAAM6jB,kBAAwC,GAAGJ,eAAe,CAC3DhgB,GAD4C,CACxC,UAAA0B,OAAO;AAAA,aAAK;AACbA,eAAO,EAAPA,OADa;AAEb2e,qBAAa,EAAE,KAAI,CAACrB,cAAL,CAAoBzO,MAApB,CACX,UAAAqD,KAAK;AAAA,iBAAIA,KAAK,CAAClS,OAAN,KAAkBA,OAAtB;AAAA,SADM;AAFF,OAAL;AAAA,KADiC,EAO5C1B,GAP4C,CAOpB;AAAA,UAAG0B,OAAH,UAAGA,OAAH;AAAA,UAAY2e,aAAZ,UAAYA,aAAZ;AAAA,aAAiC;AACtDlH,YAAI,EAAE,UADgD;AAEtD5c,YAAI,EAAEmF,OAAO,CAACnF,IAFwC;AAGtDmgB,cAAM,EAAE9D,YAAY,CAAClX,OAAD,CAHkC;AAItD4e,gBAAQ,iDACDD,aAAa,CAACrgB,GAAd,CAAmC,UAAA4T,KAAK;AAAA,iBAAK;AAC5CuF,gBAAI,EAAE,OADsC;AAE5C1a,gBAAI,EAAEmV,KAAK,CAACnV,IAFgC;AAG5CmG,kBAAM,EAAEgP,KAAK,CAAChP;AAH8B,WAAL;AAAA,SAAxC,CADC,wCAMD,KAAI,CAACqa,iBAAL,CACE1O,MADF,CAEK,UAAArL,EAAE;AAAA,iBACEA,EAAE,CAACxD,OAAH,KAAeA,OAAf,IACAge,UAAU,CAACa,GAAX,CAAerb,EAAE,CAACjC,KAAlB,CAFF;AAAA,SAFP,EAMEjD,GANF,CAMuB,UAAA4T,KAAK;AAAA,iBAAK;AAC5BuF,gBAAI,EAAE,OADsB;AAE5B1a,gBAAI,EAAEmV,KAAK,CAACnV,IAFgB;AAG5BmG,kBAAM,EAAEgP,KAAK,CAAChP;AAHc,WAAL;AAAA,SAN5B,CANC,EAJ8C;AAsBtD4b,cAAM,EAAE;AACJrH,cAAI,EAAE,QADF;AAEJ/b,cAAI,WAASsE,OAAO,CAACnF,IAAjB,UAFA;AAGJkkB,qBAAW,gCAA8B/e,OAAO,CAACN,OAH7C;AAIJM,iBAAO,EAAPA;AAJI;AAtB8C,OAAjC;AAAA,KAPoB,EAoC5C6O,MApC4C,CAoCrC,UAAAmQ,GAAG;AAAA;;AAAA,aAAI,CAAC,mBAACA,GAAG,CAACJ,QAAL,0CAAC,cAAcriB,MAAf,CAAL;AAAA,KApCkC,CAAjD;AAsCA,QAAM0iB,cAAkC,GAAG;AACvCxH,UAAI,EAAE,UADiC;AAEvC5c,UAAI,EAAE,UAFiC;AAGvCmgB,YAAM,EAAExE,YAH+B;AAIvCoI,cAAQ,EAAE,CACW;AACbnH,YAAI,EAAE,OADO;AAEb1a,YAAI,EAAE0gB,gCAAgBA;AAFT,OADX,EAKW;AACbhG,YAAI,EAAE,OADO;AAEb1a,YAAI,EAAE2gB,+BAAeA;AAFR,OALX,EASW;AACbjG,YAAI,EAAE,OADO;AAEb1a,YAAI,EAAE4gB,sCAFO;AAGbza,cAAM,EAAE;AACJsY,eAAK,EAAE;AACH/D,gBAAI,EAAE,OADH;AAEH1a,gBAAI,EAAE0e,oDAAyB1e;AAF5B;AADH;AAHK,OATX;AAJ6B,KAA3C;AA0BA,0DACO2hB,kBADP,IAEIO,cAFJ,EAGyB;AACjBxH,UAAI,EAAE;AADW,KAHzB;AAOH,GAp0BL;;AAAA,SAs0BIzC,gBAt0BJ,GAs0BI,0BAAiBqC,OAAjB,EAA2E;AACvE,QAAQnF,KAAR,GAAiDmF,OAAjD,CAAQnF,KAAR;AAAA,QAAeqB,UAAf,GAAiD8D,OAAjD,CAAe9D,UAAf;AAAA,QAA2Bb,iBAA3B,GAAiD2E,OAAjD,CAA2B3E,iBAA3B;AACA,QAAQG,MAAR,GAAmBX,KAAnB,CAAQW,MAAR;AACA,QAAQkB,QAAR,GAAqBR,UAArB,CAAQQ,QAAR;;AAEA,YAAQA,QAAR;AACI,WAAK,OAAL;AAAc;AACV,cAAetU,IAAf,GAAwBoT,MAAM,CAAC,CAAD,CAAN,CAAUrY,MAAV,CAAiB,MAAjB,CAAxB,CAAQ2N,KAAR;AACA,cAAe+V,SAAf,GAA6BrL,MAAM,CAAC,CAAD,CAAN,CAAUrY,MAAV,CAAiB,OAAjB,CAA7B,CAAQ2N,KAAR;AACA,iBAA+B;AAC3B8M,sBAAU,EAAuB;AAC7BlY,kBAAI,EAAE,gBADuB;AAE7BmC,uBAAS,EAAE,CACPlC,kBAAkB,CACdyC,IAAI,CAACyf,QAAL,EADc,EAEdhB,SAAS,CAACgB,QAAV,EAFc,CADX,CAFkB;AAQ7BjgB,oBAAM,EAAEnC,YAAY,CAAC,YAAD;AARS,aADN;AAW3ByE,iBAAK,EAAE;AACH9B,kBAAI,EAAEA,IAAI,CAACyf,QAAL,EADH;AAEH3d,mBAAK,EAAE2c,SAAS,CAACgB,QAAV;AAFJ;AAXoB,WAA/B;AAgBH;;AACD,WAAK,uBAAL;AAA8B;AAC1B,cAAezf,KAAf,GAAwBoT,MAAM,CAAC,CAAD,CAAN,CAAUrY,MAAV,CAAiB,MAAjB,CAAxB,CAAQ2N,KAAR;AACA,uBAAqBoL,UAArB;AAAA,cAAQlS,QAAR,UAAQA,QAAR;;AACA,mCAAyBqR,iBAAiB,CACtCnS,SADsC,EAEtCsS,MAAM,CAAC,CAAD,CAAN,CAAUI,KAF4B,CAA1C;AAAA,cAAQ9T,IAAR,sBAAQA,IAAR;AAAA,cAAcV,MAAd,sBAAcA,MAAd;;AAIA,iBAA+B;AAC3BwW,sBAAU,EAAuB;AAC7BlY,kBAAI,EAAE,gBADuB;AAE7BmC,uBAAS,EAAE,CACPlC,kBAAkB,CAACyC,KAAI,CAACyf,QAAL,EAAD,EAAkB7d,QAAQ,CAACxG,IAA3B,CADX,EAEPsE,IAFO,CAFkB;AAM7BF,oBAAM,EAAEnC,YAAY,CAAC,aAAD;AANS,aADN;AAS3B2B,kBAAM,EAANA;AAT2B,WAA/B;AAWH;AAvCL;;AA0CA,WAAO8B,SAAP;AACH,GAt3BL;;AAAA,SAw3BIuT,qBAx3BJ,GAw3BI,+BACIuD,OADJ,EAEwB;AACpB,QAAQ9V,KAAR,GAAqC8V,OAArC,CAAQ9V,KAAR;AAAA,QAAegS,UAAf,GAAqC8D,OAArC,CAAe9D,UAAf;AAAA,QAA2BrB,KAA3B,GAAqCmF,OAArC,CAA2BnF,KAA3B;AACA,QAAQW,MAAR,GAAuBX,KAAvB,CAAQW,MAAR;AAAA,QAAgBnW,EAAhB,GAAuBwV,KAAvB,CAAgBxV,EAAhB;AACA,QAAQqX,QAAR,GAAqBR,UAArB,CAAQQ,QAAR;;AACA,YAAQA,QAAR;AACI,WAAK,cAAL;AAAqB;AACjB,uBAAqBR,UAArB;AAAA,cAAQlS,QAAR,UAAQA,QAAR;AACA,cAAe5B,IAAf,GAAwBoT,MAAM,CAAC,CAAD,CAAN,CAAUrY,MAAV,CAAiB,MAAjB,CAAxB,CAAQ2N,KAAR;AACA,cAAMjL,KAAK,GAAG2V,MAAM,CAAC,CAAD,CAAN,CAAUrY,MAAV,CAAiB,OAAjB,CAAd;AACA,iBAAO;AACH2E,gBAAI,EAAEnC,kBAAkB,CACpByC,IADoB,EAEpBvC,KAAK,GACCF,kBAAkB,CACdqE,QAAQ,CAACxG,IADK,EAEdqC,KAAK,CAACiL,KAFQ,CADnB,GAKC9G,QAAQ,CAACxG,IAPK,CADrB;AAUH4D,kBAAM,EAAE;AAVL,WAAP;AAYH;;AACD,WAAK,aAAL;AAAoB;AAChB,uBAA6B8U,UAA7B;AAAA,cAAe4L,SAAf,UAAQ5d,KAAR;AACA,cAAM9C,MAAiB,GAAG,EAA1B;;AACA,cAAI8C,KAAK,CAACA,KAAN,KAAgB4d,SAAS,CAACtkB,IAA9B,EAAoC;AAChC4D,kBAAM,CAACM,IAAP,CAAY;AACRuB,sBAAQ,EAAE5D,EADF;AAER8D,qBAAO,aAAW2e,SAAS,CAACtkB,IAArB;AAFC,aAAZ;AAIH;;AACD,cAAMqC,MAAK,GAAG2V,MAAM,CAAC,CAAD,CAAN,CAAUrY,MAAV,CAAiB,OAAjB,CAAd;AACA,iBAAO;AACH2E,gBAAI,EAAEnC,kBAAkB,CACpBuE,KAAK,CAAC9B,IADc,EAEpBzC,kBAAkB,CAACuE,KAAK,CAACA,KAAP,EAAcrE,MAAK,CAACiL,KAApB,CAFE,CADrB;AAKH1J,kBAAM,EAANA;AALG,WAAP;AAOH;;AACD;AACI,eAAO8B,SAAP;AArCR;AAuCH,GAr6BL;;AAAA,SAu6BIkU,kBAv6BJ,GAu6BI,4BAAmB4C,OAAnB,EAAuD;AACnD,QAAQ9V,KAAR,GAAwD8V,OAAxD,CAAQ9V,KAAR;AAAA,QAAe2Q,KAAf,GAAwDmF,OAAxD,CAAenF,KAAf;AAAA,QAAsBqB,UAAtB,GAAwD8D,OAAxD,CAAsB9D,UAAtB;AAAA,QAAkCb,iBAAlC,GAAwD2E,OAAxD,CAAkC3E,iBAAlC;AACA,QAAQqB,QAAR,GAAqBR,UAArB,CAAQQ,QAAR;AACA,QAAQlB,MAAR,GAAmBX,KAAnB,CAAQW,MAAR;;AACA,YAAQkB,QAAR;AACI,WAAK,cAAL;AAAqB;AACjB,uBAAqBR,UAArB;AAAA,cAAQlS,QAAR,UAAQA,QAAR;;AACA,oCAAyBqR,iBAAiB,CACtCnR,KADsC,EAEtCsR,MAAM,CAAC,CAAD,CAAN,CAAUI,KAF4B,CAA1C;AAAA,cAAQ9T,IAAR,uBAAQA,IAAR;AAAA,cAAcV,MAAd,uBAAcA,MAAd;;AAIA,cAAegB,IAAf,GAAwBoT,MAAM,CAAC,CAAD,CAAN,CAAUrY,MAAV,CAAiBiF,IAAzC,CAAQ0I,KAAR;AACA,iBAAO;AACH7I,eAAG,EAAE2S,UAAU,CAACC,KAAD,EAAQ;AACnBnV,kBAAI,EAAE,gBADa;AAEnBmC,uBAAS,EAAE,CACPlC,kBAAkB,CAACyC,IAAD,EAAiB4B,QAAQ,CAACxG,IAA1B,CADX,EAEPsE,IAFO,CAFQ;AAMnBF,oBAAM,EAAEnC,YAAY,CAAC,eAAD;AAND,aAAR,CADZ;AASH2B,kBAAM,EAANA;AATG,WAAP;AAWH;;AACD,WAAK,SAAL;AAAgB;AACZ,uBACI8U,UADJ;AAAA,cAAiB6L,cAAjB,UAAQpgB,OAAR;AAEA,cAAeS,MAAf,GAAwBoT,MAAM,CAAC,CAAD,CAAN,CAAUrY,MAAV,CAAiBiF,IAAzC,CAAQ0I,KAAR;AACA,cAAMkX,WAAW,GAAGxM,MAAM,CAACvU,GAAP,CAAW,UAAA6E,CAAC;AAAA,mBAC5BuP,iBAAiB,CAACnR,KAAD,EAAQ4B,CAAC,CAAC8P,KAAV,CADW;AAAA,WAAZ,CAApB;AAGA,iBAAO;AACH3T,eAAG,EAAE2S,UAAU,CAACC,KAAD,EAAQ;AACnBnV,kBAAI,EAAE,gBADa;AAEnBmC,uBAAS,EAAEmgB,WAAW,CAAC/gB,GAAZ,CAAgB,UAAAyK,CAAC;AAAA,uBAAIA,CAAC,CAAC5J,IAAN;AAAA,eAAjB,CAFQ;AAGnBF,oBAAM,EAAEjC,kBAAkB,CACtByC,MADsB,EAEtB2f,cAAc,CAACvkB,IAFO;AAHP,aAAR,CADZ;AASH4D,kBAAM,EAAE4gB,WAAW,CAACC,OAAZ,CAAoB,UAAAvW,CAAC;AAAA,qBAAIA,CAAC,CAACtK,MAAN;AAAA,aAArB;AATL,WAAP;AAWH;AAtCL;;AAyCA,WAAO8B,SAAP;AACH,GAr9BL;;AAAA;AAAA;AAu9BA,IAAMgf,WAAW,GAAG,IAAI9I,mCAAJ,EAApB;AACA,gDAAe8I,WAAf,E;;;ACxlCA;AAYA,IAAMvE,MAAM,GAAG,SAAf;;IACMwE,sC;;SAGF9iB,E,GAAK,a;;;;;SAEL0a,Y,GAAA,wBAAe;AACX,WAAQ,KAAKqI,OAAL,GAAe,CACnB;AACIhI,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE,+BAFV;AAGI8d,cAAQ,EAAE,oCAHd;AAIIC,WAAK,EAAE,EAJX;AAKIM,mBAAa,EAAED,mCALnB;AAMIH,YAAM,EAANA;AANJ,KADmB,EASnB;AACIvD,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE,sCAFV;AAGI8d,cAAQ,EAAE,oBAHd;AAIIC,WAAK,EAAE,CACkB;AACjB/d,YAAI,EAAE,aADW;AAEjBlC,YAAI,EAAE,MAFW;AAGjBa,YAAI,EAAE;AAHW,OADlB,CAJX;AAWI8gB,YAAM,EAAE,QAXZ;AAYIxB,YAAM,EAANA;AAZJ,KATmB,EAuBnB;AACIvD,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE,sCAFV;AAGI8d,cAAQ,EAAE,oBAHd;AAIIC,WAAK,EAAE,CACkB;AACjB/d,YAAI,EAAE,aADW;AAEjBlC,YAAI,EAAE,MAFW;AAGjBa,YAAI,EAAE;AAHW,OADlB,CAJX;AAWI8gB,YAAM,EAAE,QAXZ;AAYIxB,YAAM,EAANA;AAZJ,KAvBmB,EAqCnB;AACIvD,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE,4BAFV;AAGI8d,cAAQ,EAAE,oCAHd;AAIIC,WAAK,EAAE,CACmB;AAClB/d,YAAI,EAAE;AADY,OADnB,EAIuB;AACtBA,YAAI,EAAE,iBADgB;AAEtBlC,YAAI,EAAE;AAFgB,OAJvB,CAJX;AAaIqgB,uBAAiB,EAAEC,mCAbvB;AAcIC,mBAAa,EAAED,mCAdnB;AAeIH,YAAM,EAANA;AAfJ,KArCmB,EAsDnB;AACIvD,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE,kCAFV;AAGI8d,cAAQ,EAAE,cAHd;AAIIC,WAAK,EAAE,CACkB;AACjB/d,YAAI,EAAE,aADW;AAEjBlC,YAAI,EAAE,MAFW;AAGjBa,YAAI,EAAE;AAHW,OADlB,EAMmB;AAClBqB,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,OAFY;AAGlB4e,aAAK,EAAEiG,+BAAeA;AAHJ,OANnB,CAJX;AAgBIxE,uBAAiB,EAAEC,mCAhBvB;AAiBIC,mBAAa,EAAED,mCAjBnB;AAkBIH,YAAM,EAANA;AAlBJ,KAtDmB,CAAvB;AA2EH,G;;SACD4C,c,GAAA,0BAAuC;AACnC,WAAO,CACH;AACInG,UAAI,EAAE,UADV;AAEI5c,UAAI,EAAE,eAFV;AAGImgB,YAAM,EAANA,MAHJ;AAII4D,cAAQ,EAAE,qCACH,KAAKa,OAAL,CAAanhB,GAAb,CACC;AAAA,YAAGvB,IAAH,QAAGA,IAAH;AAAA,eACqB;AACb0a,cAAI,EAAE,OADO;AAEb1a,cAAI,EAAJA;AAFa,SADrB;AAAA,OADD,CADC;AAJZ,KADG,CAAP;AAgBH,G;;;;;AAGL,IAAM4iB,cAA2C,GAC7C,IAAIH,sCAAJ,EADJ;AAGA,mDAAeG,cAAf,E;;;;;ACtHA;AACA;AAUO,IAAMC,0BAA0B,GAAG,4BAAnC;AACA,IAAMC,4BAA4B,GAAG,wBAArC;AACA,IAAMC,0BAA0B,GAAG,sBAAnC;AAEA,IAAMC,yBAAyB,GAAG,oBAAlC;AACA,IAAMC,sBAAsB,GAAG,iBAA/B;AAEP,IAAMhF,oBAAM,GAAG,SAAf;AACA,IAAMiF,qBAAqB,GAAG,mBAA9B;AACA,IAAMC,0BAA0B,GAAG,wBAAnC;AACA,IAAMC,4BAA4B,GAAG,0BAArC;AACA,IAAMC,uBAAuB,GAAG,CAACH,qBAAD,CAAhC;AACA,IAAMI,mCAAmC,GAAG,CAACH,0BAAD,CAA5C;AACA,IAAMI,qCAAqC,IACvCH,4BADuC,SAEpCE,mCAFoC,CAA3C;;IAKME,qC;;SAGF7jB,E,GAAK,Y;;;;;SAEL0a,Y,GAAA,wBAAe;AACX,WAAQ,KAAKqI,OAAL,GAAe,CACnB;AACIhI,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE8iB,4BAFV;AAGIhF,cAAQ,EAAE,aAHd;AAIIC,WAAK,EAAE,EAJX;AAKIG,kBAAY,EAAE,IALlB;AAMIG,mBAAa,EAAEgF,uBANnB;AAOIpF,YAAM,EAANA,oBAAMA;AAPV,KADmB,EAUnB;AACIvD,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE+iB,0BAFV;AAGIjF,cAAQ,EAAE,mBAHd;AAIIC,WAAK,EAAE,CACsB;AACrB/d,YAAI,EAAE,gBADe;AAErBlC,YAAI,EAAE,MAFe;AAGrB4S,gBAAQ,EAAE,YAHW;AAIrB6L,qBAAa,EAAE,CAACyG,yBAAD,CAJM;AAKrBxG,mBAAW,EAAEwG;AALQ,OADtB,EAQH;AACIhjB,YAAI,EAAE;AADV,OARG,EAWuB;AACtBA,YAAI,EAAE,iBADgB;AAEtBlC,YAAI,EAAE,SAFgB;AAGtB4e,aAAK,EAAE6G;AAHe,OAXvB,CAJX;AAqBIpF,uBAAiB,EAAEkF,uBArBvB;AAsBIhF,mBAAa,EAAEgF,uBAtBnB;AAuBIpF,YAAM,EAANA,oBAvBJ;AAwBIC,kBAAY,EAAE;AAxBlB,KAVmB,EAoCnB;AACA;AACIxD,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE,mCAFV;AAGI8d,cAAQ,EAAE,gBAHd;AAIIC,WAAK,EAAE,CACsB;AACrB/d,YAAI,EAAE,gBADe;AAErBlC,YAAI,EAAE,UAFe;AAGrB4S,gBAAQ,EAAE,SAHW;AAIrB6L,qBAAa,EAAE,CAAC0G,sBAAD,CAJM;AAKrBzG,mBAAW,EAAEyG;AALQ,OADtB,EAQqB;AACpBjjB,YAAI,EAAE,gBADc;AAEpBlC,YAAI,EAAE,MAFc;AAGpBwc,eAAO,EAAEjc,0BAAS,GAAGkD,GAAZ,CAAgB,UAAAoa,IAAI;AAAA,iBAAI,CAACA,IAAD,EAAOA,IAAP,CAAJ;AAAA,SAApB;AAHW,OARrB,EAaH;AACI3b,YAAI,EAAE,aADV;AAEIlC,YAAI,EAAE;AAFV,OAbG,CAJX;AAsBIqgB,uBAAiB,EAAEmF,mCAtBvB;AAuBIjF,mBAAa,EAAEiF,mCAvBnB;AAwBIrF,YAAM,EAANA,oBAxBJ;AAyBIC,kBAAY,EAAE;AAzBlB,KArCmB,EAgEnB;AACA;AACIxD,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE,6BAFV;AAGI8d,cAAQ,EAAE,uBAHd;AAIIC,WAAK,EAAE,CACsB;AACrB/d,YAAI,EAAE,gBADe;AAErBlC,YAAI,EAAE,MAFe;AAGrB4S,gBAAQ,EAAE,YAHW;AAIrB6L,qBAAa,EAAE,CAACyG,yBAAD,CAJM;AAKrBxG,mBAAW,EAAEwG;AALQ,OADtB,CAJX;AAaI3E,mBAAa,EAAED,mCAbnB;AAcIH,YAAM,EAANA,oBAAMA;AAdV,KAjEmB,CAAvB;AAkFH,G;;SACD4C,c,GAAA,0BAAuC;AACnC,WAAO,CACH;AACInG,UAAI,EAAE,UADV;AAEI5c,UAAI,EAAE,aAFV;AAGImgB,YAAM,EAANA,oBAHJ;AAII4D,cAAQ,EAAE,qCACH,KAAKa,OAAL,CAAanhB,GAAb,CACC;AAAA,YAAGvB,IAAH,QAAGA,IAAH;AAAA,eACqB;AACb0a,cAAI,EAAE,OADO;AAEb1a,cAAI,EAAJA;AAFa,SADrB;AAAA,OADD,CADC;AAJZ,KADG,CAAP;AAgBH,G;;;;;AAGL,IAAMyjB,aAA0C,GAC5C,IAAID,qCAAJ,EADJ;AAGA,kDAAeC,aAAf,E;;;;;;;;;AC7IA;AACA;AACA;AACA;AACA;AASA;AAEA,IAAMxF,eAAM,GAAG,MAAf;AAEA,IAAMyF,QAAqC,GAAG;AAC1C/jB,IAAE,EAAE,OADsC;AAE1C0a,cAAY,EAAE;AAAA,WAAM,CAChB;AACIK,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAEoQ,0BAFV;AAGI0N,cAAQ,iBAHZ;AAIIC,WAAK,EAAE,CACsB;AACrB/d,YAAI,EAAE,gBADe;AAErBlC,YAAI,EAAE,MAFe;AAGrB4S,gBAAQ,EAAE,MAHW;AAIrB6L,qBAAa,GACT,QADS,8CAENiG,iCAAA,CACC,UAAAvf,OAAO;AAAA,iBAAIA,OAAO,CAACN,OAAZ;AAAA,SADR,CAFM,EAJQ;AAUrB6Z,mBAAW,EAAE;AAVQ,OADtB,EAaH;AACIxc,YAAI,EAAE;AADV,OAbG,EAgBc;AACbA,YAAI,EAAE2jB,gCADO;AAEb7lB,YAAI,EAAE;AAFO,OAhBd,CAJX;AAyBImgB,YAAM,EAANA,eAzBJ;AA0BIC,kBAAY,EAAE,KA1BlB;AA2BII,aAAO,gCA3BX;AA4BIC,aAAO,EAAE,EA5Bb;AA6BIvH,cAAQ,EAAE;AA7Bd,KADgB,EAgChB;AACI0D,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE4jB,6BAFV;AAGI9F,cAAQ,oBAHZ;AAIIC,WAAK,EAAE,CACsB;AACrB/d,YAAI,EAAE,gBADe;AAErBlC,YAAI,EAAE,MAFe;AAGrB4S,gBAAQ,EAAE,MAHW;AAIrB6L,qBAAa,GACT,QADS,8CAENiG,iCAAA,CACC,UAAAvf,OAAO;AAAA,iBAAIA,OAAO,CAACN,OAAZ;AAAA,SADR,CAFM,EAJQ;AAUrB6Z,mBAAW,EAAE;AAVQ,OADtB,EAaH;AACIxc,YAAI,EAAE;AADV,OAbG,EAgBc;AACbA,YAAI,EAAE6jB,oCADO;AAEb/lB,YAAI,EAAE;AAFO,OAhBd,CAJX;AAyBImgB,YAAM,EAANA,eAzBJ;AA0BIC,kBAAY,EAAE,KA1BlB;AA2BII,aAAO,qBA3BX;AA4BIC,aAAO,EAAE,EA5Bb;AA6BIvH,cAAQ,EAAE;AA7Bd,KAhCgB,EA+DhB;AACI0D,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE8jB,2BAFV;AAGIhG,cAAQ,eAHZ;AAIIC,WAAK,EAAE,CACc;AACb/d,YAAI,EAAE,aADO;AAEblC,YAAI,EAAE,OAFO;AAGb4e,aAAK,EAAE,CAAC,QAAD,EAAW,SAAX,EAAsB,QAAtB;AAHM,OADd,EAMc;AACb1c,YAAI,EAAE+jB,sCADO;AAEbjmB,YAAI,EAAE;AAFO,OANd,CAJX;AAeImgB,YAAM,EAANA,eAfJ;AAgBIC,kBAAY,EAAE,IAhBlB;AAiBII,aAAO,+BAjBX;AAkBIC,aAAO,EAAE;AAlBb,KA/DgB,CAAN;AAAA,GAF4B;AAsF1CsC,gBAAc,EAAE;AAAA,WAAM,CAClB;AACInG,UAAI,EAAE,UADV;AAEI5c,UAAI,EAAE,OAFV;AAGImgB,YAAM,EAAEA,eAHZ;AAII4D,cAAQ,EAAE,CACW;AACbnH,YAAI,EAAE,OADO;AAEb1a,YAAI,EAAE8jB,2BAAWA;AAFJ,OADX,EAKW;AACbpJ,YAAI,EAAE,OADO;AAEb1a,YAAI,EAAEoQ,0BAAUA;AAFH,OALX,EASW;AACbsK,YAAI,EAAE,OADO;AAEb1a,YAAI,EAAE4jB,6BAAaA;AAFN,OATX;AAJd,KADkB,CAAN;AAAA,GAtF0B;AA4G1C3L,kBAAgB,EAAE,gCAAkC;AAAA,QAA/B9C,KAA+B,QAA/BA,KAA+B;AAAA,QAAxBQ,iBAAwB,QAAxBA,iBAAwB;AAChD,QAAQ3V,IAAR,GAAiBmV,KAAjB,CAAQnV,IAAR;;AACA,QAAIA,IAAI,KAAK8jB,2BAAb,EAA0B;AACtB,UAAQhO,MAAR,GAAmBX,KAAnB,CAAQW,MAAR;;AACA,+BAAyBH,iBAAiB,CACtCnS,SADsC,EAEtCsS,MAAM,CAAC,CAAD,CAAN,CAAUI,KAF4B,CAA1C;AAAA,UAAQ9T,IAAR,sBAAQA,IAAR;AAAA,UAAcV,MAAd,sBAAcA,MAAd;;AAIA,aAAO;AACHwW,kBAAU,EAAuB;AAC7BlY,cAAI,EAAE,gBADuB;AAE7BmC,mBAAS,EAAE,CAACC,IAAD,CAFkB;AAG7BF,gBAAM,EAAEnC,YAAY,CAAC,OAAD;AAHS,SAD9B;AAMH2B,cAAM,EAANA,MANG;AAOHqQ,YAAI,EAAE;AAPH,OAAP;AASH;;AAED,WAAOvO,SAAP;AACH;AAhIyC,CAA9C;AAmIA,6CAAekgB,QAAf,E;;ACpJA;AAEA;AAUA;AAGA,IAAMzF,eAAM,GAAG,SAAf;AACA,IAAM+F,QAAqC,GAAG;AAC1CrkB,IAAE,EAAE,OADsC;AAE1C0a,cAAY,EAAE;AAAA,WAAM,CAChB;AACIK,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAEikB,0BAFV;AAGInG,cAAQ,EAAE,WAHd;AAIIC,WAAK,EAAE,CACmB;AAClB/d,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,MAFY;AAGlB4e,aAAK,EAAE;AAHW,OADnB,CAJX;AAWIwB,kBAAY,EAAE,IAXlB;AAYIC,uBAAiB,EAAEC,mCAZvB;AAaIC,mBAAa,EAAED,mCAbnB;AAcIH,YAAM,EAANA,eAdJ;AAeIK,aAAO,EAAE,uBAfb;AAgBIC,aAAO,EAAE;AAhBb,KADgB,EAmBhB;AACI7D,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAEkkB,kCAFV;AAGIpG,cAAQ,oBAHZ;AAIIC,WAAK,EAAE,CACc;AACb/d,YAAI,EAAE,aADO;AAEblC,YAAI,EAAE,UAFO;AAGb4e,aAAK,EAAE;AAHM,OADd,CAJX;AAWIuB,YAAM,EAANA,eAXJ;AAYIC,kBAAY,EAAE,IAZlB;AAaII,aAAO,+CAbX;AAcIC,aAAO,EAAE,EAdb;AAeIF,mBAAa,EAAED,mCAAmBA;AAftC,KAnBgB,CAAN;AAAA,GAF4B;AAwC1CyC,gBAAc,EAAE;AAAA,WAAM,CACG;AACjBnG,UAAI,EAAE;AADW,KADH,EAIE;AAChBA,UAAI,EAAE,UADU;AAEhB5c,UAAI,EAAE,UAFU;AAGhBqmB,WAAK,EAAE,CAHS;AAIhBlG,YAAM,EAANA,eAJgB;AAKhB4D,cAAQ,EAAE,CACW;AACbnH,YAAI,EAAE,OADO;AAEb1a,YAAI,EAAEkkB,kCAFO;AAGb/d,cAAM,EAAE;AACJie,kBAAQ,EAAE;AAAE1J,gBAAI,EAAE,OAAR;AAAiB1a,gBAAI,EAAE;AAAvB;AADN;AAHK,OADX,EAQW;AACb0a,YAAI,EAAE,OADO;AAEb1a,YAAI,EAAEikB,0BAFO;AAGb9d,cAAM,EAAE;AACJrE,cAAI,EAAE;AAAE4Y,gBAAI,EAAE,OAAR;AAAiB1a,gBAAI,EAAE;AAAvB;AADF;AAHK,OARX,EAeR8R,MAfQ,CAeD,UAAApG,CAAC;AAAA,eAAI,CAAC,CAACA,CAAN;AAAA,OAfA;AALM,KAJF,CAAN;AAAA,GAxC0B;AAmE1CuM,kBAAgB,EAAE,gCAAkC;AAAA,QAA/B9C,KAA+B,QAA/BA,KAA+B;AAAA,QAAxBQ,iBAAwB,QAAxBA,iBAAwB;AAChD,QAAQ3V,IAAR,GAAiBmV,KAAjB,CAAQnV,IAAR;;AACA,QAAIA,IAAI,KAAKkkB,kCAAb,EAAiC;AAC7B,UAAQpO,MAAR,GAAmBX,KAAnB,CAAQW,MAAR;;AACA,+BAA+BH,iBAAiB,CAC5CnS,SAD4C,EAE5CsS,MAAM,CAAC,CAAD,CAAN,CAAUI,KAFkC,CAAhD;AAAA,UAAcpU,IAAd,sBAAQM,IAAR;AAAA,UAAoBV,MAApB,sBAAoBA,MAApB;;AAIA,aAAO;AACHwW,kBAAU,EACNhD,UAAU,CAACC,KAAD,EAAQ;AACdnV,cAAI,EAAE,gBADQ;AAEdmC,mBAAS,EAAE,CAACL,IAAD,CAFG;AAGdI,gBAAM,EAAEnC,YAAY,CAAC,MAAD;AAHN,SAAR,CADF,CAMVkC,OAPC;AAQHP,cAAM,EAAE0T,aAAa,CAACD,KAAD,EAAQzT,MAAR;AARlB,OAAP;AAUH;;AACD,WAAO8B,SAAP;AACH,GAvFyC;AAwF1CkU,oBAAkB,EAAE,mCAAyC;AAAA,QAAtClT,KAAsC,SAAtCA,KAAsC;AAAA,QAA/B2Q,KAA+B,SAA/BA,KAA+B;AAAA,QAAxBQ,iBAAwB,SAAxBA,iBAAwB;AACzD,QAAQ3V,IAAR,GAAiBmV,KAAjB,CAAQnV,IAAR;;AACA,QAAIA,IAAI,KAAKikB,0BAAb,EAAyB;AACrB,UAAQnO,MAAR,GAAmBX,KAAnB,CAAQW,MAAR;AACA;AACI,kCAA+BH,iBAAiB,CAC5CnR,KAD4C,EAE5CsR,MAAM,CAAC,CAAD,CAAN,CAAUI,KAFkC,CAAhD;AAAA,YAAcpU,IAAd,uBAAQM,IAAR;AAAA,YAAoBV,MAApB,uBAAoBA,MAApB;;AAIA,eAAO;AACHa,aAAG,EAAE2S,UAAU,CAACC,KAAD,EAAQ;AACnBnV,gBAAI,EAAE,gBADa;AAEnBmC,qBAAS,EAAE,CAACL,IAAD,CAFQ;AAGnBI,kBAAM,EAAEnC,YAAY,CAAC,MAAD;AAHD,WAAR,CADZ;AAMH2B,gBAAM,EAAE0T,aAAa,CAACD,KAAD,EAAQzT,MAAR;AANlB,SAAP;AAQH;AACJ;;AACD,WAAO8B,SAAP;AACH;AA5GyC,CAA9C;AA8GA,6CAAewgB,QAAf,E;;AC5HA,IAAMK,QAAqC,GAAG;AAC1C1kB,IAAE,EAAE,OADsC;AAE1CkhB,gBAAc,EAAE;AAAA,WAAM,CAClB;AACInG,UAAI,EAAE,UADV;AAEI5c,UAAI,EAAE,OAFV;AAGImgB,YAAM,EAAE,kBAHZ;AAII4D,cAAQ,EAAE,CACN;AACInH,YAAI,EAAE,OADV;AAEI1a,YAAI,EAAE;AAFV,OADM,EAKN;AACI0a,YAAI,EAAE,OADV;AAEI1a,YAAI,EAAE,eAFV;AAGImG,cAAM,EAAE;AACJme,WAAC,EAAE;AAAE5J,gBAAI,EAAE,OAAR;AAAiB1a,gBAAI,EAAE;AAAvB,WADC;AAEJukB,WAAC,EAAE;AAAE7J,gBAAI,EAAE,OAAR;AAAiB1a,gBAAI,EAAE;AAAvB;AAFC;AAHZ,OALM,EAaN;AACI0a,YAAI,EAAE,OADV;AAEI1a,YAAI,EAAE,iBAFV;AAGImG,cAAM,EAAE;AACJme,WAAC,EAAE;AAAE5J,gBAAI,EAAE,OAAR;AAAiB1a,gBAAI,EAAE;AAAvB,WADC;AAEJukB,WAAC,EAAE;AAAE7J,gBAAI,EAAE,OAAR;AAAiB1a,gBAAI,EAAE;AAAvB;AAFC;AAHZ,OAbM,EAqBN;AACI0a,YAAI,EAAE,OADV;AAEI1a,YAAI,EAAE,cAFV;AAGImG,cAAM,EAAE;AACJqe,cAAI,EAAE;AAAE9J,gBAAI,EAAE,OAAR;AAAiB1a,gBAAI,EAAE;AAAvB;AADF;AAHZ,OArBM,EA4BN;AACI0a,YAAI,EAAE,OADV;AAEI1a,YAAI,EAAE;AAFV,OA5BM;AAJd,KADkB,CAAN;AAAA;AAF0B,CAA9C;AA2CA,6CAAeqkB,QAAf,E;;ACtCA,IAAMI,OAAoC,GAAG;AACzC9kB,IAAE,EAAE,YADqC;AAEzC0a,cAAY,EAAE;AAAA,WAAM,CAChB;AACIK,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE,wBAFV;AAGI8d,cAAQ,EAAE,UAHd;AAIIC,WAAK,EAAE,CACmB;AAClB/d,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,GAFY;AAGlB4e,aAAK,EAAE;AAHW,OADnB,EAMqB;AACpB1c,YAAI,EAAE,gBADc;AAEpBlC,YAAI,EAAE,IAFc;AAGpBwc,eAAO,EAAE,CACL,CAAC,6BAAD,EAAgC,KAAhC,CADK,EAEL,CAAC,gCAAD,EAAmC,OAAnC,CAFK,EAGL,CAAC,mCAAD,EAAsC,UAAtC,CAHK,EAIL,CAAC,6BAAD,EAAgC,QAAhC,CAJK;AAHW,OANrB,EAgBmB;AAClBta,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,GAFY;AAGlB4e,aAAK,EAAE;AAHW,OAhBnB,CAJX;AA0BIwB,kBAAY,EAAE,IA1BlB;AA2BIuB,YAAM,EAAE,QA3BZ;AA4BIiF,WAAK,EAAE,aA5BX;AA6BInG,aAAO,EAAE,gCA7Bb;AA8BIoG,gBAAU,EAAE,CAAC,iBAAD;AA9BhB,KADgB,EAiChB;AACIjK,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE,oBAFV;AAGI8d,cAAQ,EAAE,OAHd;AAIIC,WAAK,EAAE,CACqB;AACpB/d,YAAI,EAAE,gBADc;AAEpBlC,YAAI,EAAE,IAFc;AAGpBwc,eAAO,EAAE,CACL,CAAC,GAAD,EAAM,KAAN,CADK,EAEL,CAAC,gCAAD,EAAmC,KAAnC,CAFK;AAHW,OADrB,EASmB;AAClBta,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,KAFY;AAGlB4e,aAAK,EAAE;AAHW,OATnB,CAJX;AAmBI+C,YAAM,EAAE,QAnBZ;AAoBIiF,WAAK,EAAE,aApBX;AAqBInG,aAAO,EAAE,4BArBb;AAsBIoG,gBAAU,EAAE,CAAC,iBAAD;AAtBhB,KAjCgB,EAyDhB;AACIjK,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE,oBAFV;AAGI8d,cAAQ,EAAE,QAHd;AAIIC,WAAK,EAAE,EAJX;AAKI0B,YAAM,EAAE,QALZ;AAMIiF,WAAK,EAAE;AANX,KAzDgB,EAiEhB;AACIhK,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE,0BAFV;AAGI8d,cAAQ,EAAE,sBAHd;AAIIC,WAAK,EAAE,CACmB;AAClB/d,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,KAFY;AAGlB4e,aAAK,EAAE;AAHW,OADnB,EAMmB;AAClB1c,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,KAFY;AAGlB4e,aAAK,EAAE;AAHW,OANnB,CAJX;AAgBI+C,YAAM,EAAE,QAhBZ;AAiBIiF,WAAK,EAAE,aAjBX;AAkBIxG,kBAAY,EAAE;AAlBlB,KAjEgB,EAqFhB;AACIxD,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE,mBAFV;AAGI8d,cAAQ,EAAE,sBAHd;AAIIC,WAAK,EAAE,CACmB;AAClB/d,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,OAFY;AAGlB4e,aAAK,EAAE;AAHW,OADnB,EAMmB;AAClB1c,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,cAFY;AAGlB4e,aAAK,EAAE;AAHW,OANnB,EAWmB;AAClB1c,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,cAFY;AAGlB4e,aAAK,EAAE;AAHW,OAXnB,CAJX;AAqBI+C,YAAM,EAAE,QArBZ;AAsBIiF,WAAK,EAAE;AAtBX,KArFgB,EA6GhB;AACIhK,UAAI,EAAE,OADV;AAEI1a,UAAI,EAAE,iBAFV;AAGI8d,cAAQ,EAAE,kCAHd;AAIIC,WAAK,EAAE,CACmB;AAClB/d,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,OAFY;AAGlB4e,aAAK,EAAE;AAHW,OADnB,EAMmB;AAClB1c,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,SAFY;AAGlB4e,aAAK,EAAE;AAHW,OANnB,EAWmB;AAClB1c,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,SAFY;AAGlB4e,aAAK,EAAE;AAHW,OAXnB,EAgBmB;AAClB1c,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,OAFY;AAGlB4e,aAAK,EAAE;AAHW,OAhBnB,EAqBmB;AAClB1c,YAAI,EAAE,aADY;AAElBlC,YAAI,EAAE,OAFY;AAGlB4e,aAAK,EAAE;AAHW,OArBnB,CAJX;AA+BI+C,YAAM,EAAE,QA/BZ;AAgCIiF,WAAK,EAAE;AAhCX,KA7GgB,CAAN;AAAA,GAF2B;AAkJzC7D,gBAAc,EAAE;AAAA,WAAM,CACE;AAChBnG,UAAI,EAAE,UADU;AAEhB5c,UAAI,EAAE,MAFU;AAGhBmgB,YAAM,EAAE,iBAHQ;AAIhB4D,cAAQ,EAAE,CACN;AACInH,YAAI,EAAE,OADV;AAEI1a,YAAI,EAAE,wBAFV;AAGImG,cAAM,EAAE;AACJme,WAAC,EAAE;AAAE5J,gBAAI,EAAE,OAAR;AAAiB1a,gBAAI,EAAE;AAAvB,WADC;AAEJukB,WAAC,EAAE;AAAE7J,gBAAI,EAAE,OAAR;AAAiB1a,gBAAI,EAAE;AAAvB;AAFC;AAHZ,OADM,EASN;AACI0a,YAAI,EAAE,OADV;AAEI1a,YAAI,EAAE,oBAFV;AAGImG,cAAM,EAAE;AACJye,aAAG,EAAE;AACDlK,gBAAI,EAAE,OADL;AAED1a,gBAAI,EAAE;AAFL;AADD;AAHZ,OATM,EAmBN;AAAE0a,YAAI,EAAE,OAAR;AAAiB1a,YAAI,EAAE;AAAvB,OAnBM,EAoBN;AAAE0a,YAAI,EAAE,OAAR;AAAiB1a,YAAI,EAAE;AAAvB,OApBM,EAqBN;AAAE0a,YAAI,EAAE,OAAR;AAAiB1a,YAAI,EAAE;AAAvB,OArBM,EAsBN;AAAE0a,YAAI,EAAE,OAAR;AAAiB1a,YAAI,EAAE;AAAvB,OAtBM;AAJM,KADF,CAAN;AAAA;AAlJyB,CAA7C;AAmLA,4CAAeykB,OAAf,E;;;;;;;;;;AC1LA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA,IAAMI,qBAAqB,GAAG,gBAA9B;;AACA,SAASC,mBAAT,GAA+B;AAC3B,oBACIxW,oBAAU,CAACmB,2BAAD,CADd;AAAA,MAAQ6F,IAAR,eAAQA,IAAR;AAAA,MAAc5F,SAAd,eAAcA,SAAd;AAAA,MAAyBqV,aAAzB,eAAyBA,aAAzB;AAAA,MAAwCvb,WAAxC,eAAwCA,WAAxC;;AAEA,kBAA8BtK,kBAAQ,EAAtC;AAAA,MAAOuK,OAAP;AAAA,MAAgBub,UAAhB;;AACA,MAAMC,SAAS,GAAG,IAAlB;;AACA,qBAAgC7W,WAAW,CAAC5E,WAAD,EAAcC,OAAd,EAAuBwb,SAAvB,CAA3C;AAAA,MAAQvW,MAAR,gBAAQA,MAAR;AAAA,MAAgBI,GAAhB,gBAAgBA,GAAhB;AAAA,MAAqB3G,MAArB,gBAAqBA,MAArB;;AAEA4G,qBAAS,CAAC,YAAM;AACZ,QAAI;AACA,UAAM3N,UAAU,GAAGiU,wBAAwB,CAAC0P,aAAD,EAAgBzP,IAAhB,CAA3C;AACA,UAAIhG,IAAI,CAACC,SAAL,CAAenO,UAAf,MAA+BkO,IAAI,CAACC,SAAL,CAAe9F,OAAf,CAAnC,EACIub,UAAU,CAAC5jB,UAAD,CAAV;AACP,KAJD,CAIE,OAAOkC,CAAP,EAAU;AACR8G,aAAO,CAAC8a,KAAR,CAAc5hB,CAAd;AACA0hB,gBAAU,CAACxhB,SAAD,CAAV;AACH;AACJ,GATQ,EASN,CAAC8R,IAAD,EAAOyP,aAAP,CATM,CAAT;AAUAhW,qBAAS,CACL;AAAA,WAAMtF,OAAO,KAAID,WAAJ,aAAIA,WAAJ,uBAAIA,WAAW,CAAE6C,QAAb,CAAsB5C,OAAO,CAACpI,KAA9B,CAAJ,CAAb;AAAA,GADK,EAEL,CAACmI,WAAD,EAAcC,OAAd,CAFK,CAAT;AAKAsF,qBAAS,CAAC,YAAM;AACZ;AACA,QAAMoW,EAAE,GAAGzV,SAAX;AACA,QAAM2R,QAAQ,GAAG8D,EAAH,aAAGA,EAAH,uBAAGA,EAAE,CAAEC,cAArB;;AACA,QAAI/D,QAAJ,EAAc;AACVA,cAAQ,CAAC3S,MAAT,GAAkBA,MAAlB;AACH;AACJ,GAPQ,EAON,CAACgB,SAAD,EAAYhB,MAAZ,CAPM,CAAT;AASA,sBACI,oBAAC,mBAAD;AAAM,aAAS,MAAf;AAAgB,aAAS,EAAC,QAA1B;AAAmC,WAAO,EAAE;AAA5C,kBACI,oBAAC,mBAAD;AAAM,QAAI,MAAV;AAAW,MAAE,EAAE;AAAf,kBACI,oBAAC,SAAD;AAAW,UAAM,EAAEA,MAAnB;AAA2B,OAAG,EAAEI,GAAhC;AAAqC,UAAM,EAAE3G;AAA7C,IADJ,CADJ,eAII,oBAAC,mBAAD;AAAM,QAAI,MAAV;AAAW,MAAE,EAAE;AAAf,kBACI,oBAAC,0BAAD,OADJ,CAJJ,EAOKiH,4CAAA,iBACG,uDACI,oBAAC,aAAD;AAAe,WAAO,EAAE3F;AAAxB,IADJ,eAEI,oBAAC,+BAAD,OAFJ,CARR,CADJ;AAgBH;;AAEc,SAAS4b,QAAT,GAAoB;AAC/B,MAAM/P,IAAI,GAAG1D,iBAAO,CAAC,YAAM;AACvB,WAAO,CACH4Q,WADG,EAEHI,cAFG,EAGHa,aAHG,EAIHC,QAJG,EAKHM,QALG,EAMHK,QANG,EAOHI,OAPG,EAQHa,2BARG,EASHC,wBATG,EAUHC,wBAVG,CAAP;AAYH,GAbmB,EAajB,EAbiB,CAApB;AAeA,sBACI,oBAAC,oBAAD,qBACI,oBAAC,iCAAD;AAAe,cAAU,EAAEX,qBAA3B;AAAkD,QAAI,EAAEvP;AAAxD,kBACI,oBAAC,mBAAD,OADJ,CADJ,CADJ;AAOH,C;;AChGD;AACA;AAEe,SAASmQ,IAAT,GAAgB;AAC3B,sBAAO,oBAAC,QAAD,OAAP;AACH,C","file":"component---src-pages-tools-vm-editor-tsx-cd8d34167ed647398c3f.js","sourcesContent":["import * as React from 'react';\nimport createSvgIcon from '../../utils/createSvgIcon';\n/**\n * @ignore - internal component.\n */\n\nexport default createSvgIcon( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z\"\n}), 'Cancel');","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport CancelIcon from '../internal/svg-icons/Cancel';\nimport withStyles from '../styles/withStyles';\nimport { emphasize, fade } from '../styles/colorManipulator';\nimport useForkRef from '../utils/useForkRef';\nimport unsupportedProp from '../utils/unsupportedProp';\nimport capitalize from '../utils/capitalize';\nimport ButtonBase from '../ButtonBase';\nexport var styles = function styles(theme) {\n  var backgroundColor = theme.palette.type === 'light' ? theme.palette.grey[300] : theme.palette.grey[700];\n  var deleteIconColor = fade(theme.palette.text.primary, 0.26);\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      fontFamily: theme.typography.fontFamily,\n      fontSize: theme.typography.pxToRem(13),\n      display: 'inline-flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      height: 32,\n      color: theme.palette.getContrastText(backgroundColor),\n      backgroundColor: backgroundColor,\n      borderRadius: 32 / 2,\n      whiteSpace: 'nowrap',\n      transition: theme.transitions.create(['background-color', 'box-shadow']),\n      // label will inherit this from root, then `clickable` class overrides this for both\n      cursor: 'default',\n      // We disable the focus ring for mouse, touch and keyboard users.\n      outline: 0,\n      textDecoration: 'none',\n      border: 'none',\n      // Remove `button` border\n      padding: 0,\n      // Remove `button` padding\n      verticalAlign: 'middle',\n      boxSizing: 'border-box',\n      '&$disabled': {\n        opacity: 0.5,\n        pointerEvents: 'none'\n      },\n      '& $avatar': {\n        marginLeft: 5,\n        marginRight: -6,\n        width: 24,\n        height: 24,\n        color: theme.palette.type === 'light' ? theme.palette.grey[700] : theme.palette.grey[300],\n        fontSize: theme.typography.pxToRem(12)\n      },\n      '& $avatarColorPrimary': {\n        color: theme.palette.primary.contrastText,\n        backgroundColor: theme.palette.primary.dark\n      },\n      '& $avatarColorSecondary': {\n        color: theme.palette.secondary.contrastText,\n        backgroundColor: theme.palette.secondary.dark\n      },\n      '& $avatarSmall': {\n        marginLeft: 4,\n        marginRight: -4,\n        width: 18,\n        height: 18,\n        fontSize: theme.typography.pxToRem(10)\n      }\n    },\n\n    /* Styles applied to the root element if `size=\"small\"`. */\n    sizeSmall: {\n      height: 24\n    },\n\n    /* Styles applied to the root element if `color=\"primary\"`. */\n    colorPrimary: {\n      backgroundColor: theme.palette.primary.main,\n      color: theme.palette.primary.contrastText\n    },\n\n    /* Styles applied to the root element if `color=\"secondary\"`. */\n    colorSecondary: {\n      backgroundColor: theme.palette.secondary.main,\n      color: theme.palette.secondary.contrastText\n    },\n\n    /* Pseudo-class applied to the root element if `disabled={true}`. */\n    disabled: {},\n\n    /* Styles applied to the root element if `onClick` is defined or `clickable={true}`. */\n    clickable: {\n      userSelect: 'none',\n      WebkitTapHighlightColor: 'transparent',\n      cursor: 'pointer',\n      '&:hover, &:focus': {\n        backgroundColor: emphasize(backgroundColor, 0.08)\n      },\n      '&:active': {\n        boxShadow: theme.shadows[1]\n      }\n    },\n\n    /* Styles applied to the root element if `onClick` and `color=\"primary\"` is defined or `clickable={true}`. */\n    clickableColorPrimary: {\n      '&:hover, &:focus': {\n        backgroundColor: emphasize(theme.palette.primary.main, 0.08)\n      }\n    },\n\n    /* Styles applied to the root element if `onClick` and `color=\"secondary\"` is defined or `clickable={true}`. */\n    clickableColorSecondary: {\n      '&:hover, &:focus': {\n        backgroundColor: emphasize(theme.palette.secondary.main, 0.08)\n      }\n    },\n\n    /* Styles applied to the root element if `onDelete` is defined. */\n    deletable: {\n      '&:focus': {\n        backgroundColor: emphasize(backgroundColor, 0.08)\n      }\n    },\n\n    /* Styles applied to the root element if `onDelete` and `color=\"primary\"` is defined. */\n    deletableColorPrimary: {\n      '&:focus': {\n        backgroundColor: emphasize(theme.palette.primary.main, 0.2)\n      }\n    },\n\n    /* Styles applied to the root element if `onDelete` and `color=\"secondary\"` is defined. */\n    deletableColorSecondary: {\n      '&:focus': {\n        backgroundColor: emphasize(theme.palette.secondary.main, 0.2)\n      }\n    },\n\n    /* Styles applied to the root element if `variant=\"outlined\"`. */\n    outlined: {\n      backgroundColor: 'transparent',\n      border: \"1px solid \".concat(theme.palette.type === 'light' ? 'rgba(0, 0, 0, 0.23)' : 'rgba(255, 255, 255, 0.23)'),\n      '$clickable&:hover, $clickable&:focus, $deletable&:focus': {\n        backgroundColor: fade(theme.palette.text.primary, theme.palette.action.hoverOpacity)\n      },\n      '& $avatar': {\n        marginLeft: 4\n      },\n      '& $avatarSmall': {\n        marginLeft: 2\n      },\n      '& $icon': {\n        marginLeft: 4\n      },\n      '& $iconSmall': {\n        marginLeft: 2\n      },\n      '& $deleteIcon': {\n        marginRight: 5\n      },\n      '& $deleteIconSmall': {\n        marginRight: 3\n      }\n    },\n\n    /* Styles applied to the root element if `variant=\"outlined\"` and `color=\"primary\"`. */\n    outlinedPrimary: {\n      color: theme.palette.primary.main,\n      border: \"1px solid \".concat(theme.palette.primary.main),\n      '$clickable&:hover, $clickable&:focus, $deletable&:focus': {\n        backgroundColor: fade(theme.palette.primary.main, theme.palette.action.hoverOpacity)\n      }\n    },\n\n    /* Styles applied to the root element if `variant=\"outlined\"` and `color=\"secondary\"`. */\n    outlinedSecondary: {\n      color: theme.palette.secondary.main,\n      border: \"1px solid \".concat(theme.palette.secondary.main),\n      '$clickable&:hover, $clickable&:focus, $deletable&:focus': {\n        backgroundColor: fade(theme.palette.secondary.main, theme.palette.action.hoverOpacity)\n      }\n    },\n    // TODO v5: remove\n\n    /* Styles applied to the `avatar` element. */\n    avatar: {},\n\n    /* Styles applied to the `avatar` element if `size=\"small\"`. */\n    avatarSmall: {},\n\n    /* Styles applied to the `avatar` element if `color=\"primary\"`. */\n    avatarColorPrimary: {},\n\n    /* Styles applied to the `avatar` element if `color=\"secondary\"`. */\n    avatarColorSecondary: {},\n\n    /* Styles applied to the `icon` element. */\n    icon: {\n      color: theme.palette.type === 'light' ? theme.palette.grey[700] : theme.palette.grey[300],\n      marginLeft: 5,\n      marginRight: -6\n    },\n\n    /* Styles applied to the `icon` element if `size=\"small\"`. */\n    iconSmall: {\n      width: 18,\n      height: 18,\n      marginLeft: 4,\n      marginRight: -4\n    },\n\n    /* Styles applied to the `icon` element if `color=\"primary\"`. */\n    iconColorPrimary: {\n      color: 'inherit'\n    },\n\n    /* Styles applied to the `icon` element if `color=\"secondary\"`. */\n    iconColorSecondary: {\n      color: 'inherit'\n    },\n\n    /* Styles applied to the label `span` element. */\n    label: {\n      overflow: 'hidden',\n      textOverflow: 'ellipsis',\n      paddingLeft: 12,\n      paddingRight: 12,\n      whiteSpace: 'nowrap'\n    },\n\n    /* Styles applied to the label `span` element if `size=\"small\"`. */\n    labelSmall: {\n      paddingLeft: 8,\n      paddingRight: 8\n    },\n\n    /* Styles applied to the `deleteIcon` element. */\n    deleteIcon: {\n      WebkitTapHighlightColor: 'transparent',\n      color: deleteIconColor,\n      height: 22,\n      width: 22,\n      cursor: 'pointer',\n      margin: '0 5px 0 -6px',\n      '&:hover': {\n        color: fade(deleteIconColor, 0.4)\n      }\n    },\n\n    /* Styles applied to the `deleteIcon` element if `size=\"small\"`. */\n    deleteIconSmall: {\n      height: 16,\n      width: 16,\n      marginRight: 4,\n      marginLeft: -4\n    },\n\n    /* Styles applied to the deleteIcon element if `color=\"primary\"` and `variant=\"default\"`. */\n    deleteIconColorPrimary: {\n      color: fade(theme.palette.primary.contrastText, 0.7),\n      '&:hover, &:active': {\n        color: theme.palette.primary.contrastText\n      }\n    },\n\n    /* Styles applied to the deleteIcon element if `color=\"secondary\"` and `variant=\"default\"`. */\n    deleteIconColorSecondary: {\n      color: fade(theme.palette.secondary.contrastText, 0.7),\n      '&:hover, &:active': {\n        color: theme.palette.secondary.contrastText\n      }\n    },\n\n    /* Styles applied to the deleteIcon element if `color=\"primary\"` and `variant=\"outlined\"`. */\n    deleteIconOutlinedColorPrimary: {\n      color: fade(theme.palette.primary.main, 0.7),\n      '&:hover, &:active': {\n        color: theme.palette.primary.main\n      }\n    },\n\n    /* Styles applied to the deleteIcon element if `color=\"secondary\"` and `variant=\"outlined\"`. */\n    deleteIconOutlinedColorSecondary: {\n      color: fade(theme.palette.secondary.main, 0.7),\n      '&:hover, &:active': {\n        color: theme.palette.secondary.main\n      }\n    }\n  };\n};\n\nfunction isDeleteKeyboardEvent(keyboardEvent) {\n  return keyboardEvent.key === 'Backspace' || keyboardEvent.key === 'Delete';\n}\n/**\n * Chips represent complex entities in small blocks, such as a contact.\n */\n\n\nvar Chip = /*#__PURE__*/React.forwardRef(function Chip(props, ref) {\n  var avatarProp = props.avatar,\n      classes = props.classes,\n      className = props.className,\n      clickableProp = props.clickable,\n      _props$color = props.color,\n      color = _props$color === void 0 ? 'default' : _props$color,\n      ComponentProp = props.component,\n      deleteIconProp = props.deleteIcon,\n      _props$disabled = props.disabled,\n      disabled = _props$disabled === void 0 ? false : _props$disabled,\n      iconProp = props.icon,\n      label = props.label,\n      onClick = props.onClick,\n      onDelete = props.onDelete,\n      onKeyDown = props.onKeyDown,\n      onKeyUp = props.onKeyUp,\n      _props$size = props.size,\n      size = _props$size === void 0 ? 'medium' : _props$size,\n      _props$variant = props.variant,\n      variant = _props$variant === void 0 ? 'default' : _props$variant,\n      other = _objectWithoutProperties(props, [\"avatar\", \"classes\", \"className\", \"clickable\", \"color\", \"component\", \"deleteIcon\", \"disabled\", \"icon\", \"label\", \"onClick\", \"onDelete\", \"onKeyDown\", \"onKeyUp\", \"size\", \"variant\"]);\n\n  var chipRef = React.useRef(null);\n  var handleRef = useForkRef(chipRef, ref);\n\n  var handleDeleteIconClick = function handleDeleteIconClick(event) {\n    // Stop the event from bubbling up to the `Chip`\n    event.stopPropagation();\n\n    if (onDelete) {\n      onDelete(event);\n    }\n  };\n\n  var handleKeyDown = function handleKeyDown(event) {\n    // Ignore events from children of `Chip`.\n    if (event.currentTarget === event.target && isDeleteKeyboardEvent(event)) {\n      // will be handled in keyUp, otherwise some browsers\n      // might init navigation\n      event.preventDefault();\n    }\n\n    if (onKeyDown) {\n      onKeyDown(event);\n    }\n  };\n\n  var handleKeyUp = function handleKeyUp(event) {\n    // Ignore events from children of `Chip`.\n    if (event.currentTarget === event.target) {\n      if (onDelete && isDeleteKeyboardEvent(event)) {\n        onDelete(event);\n      } else if (event.key === 'Escape' && chipRef.current) {\n        chipRef.current.blur();\n      }\n    }\n\n    if (onKeyUp) {\n      onKeyUp(event);\n    }\n  };\n\n  var clickable = clickableProp !== false && onClick ? true : clickableProp;\n  var small = size === 'small';\n  var Component = ComponentProp || (clickable ? ButtonBase : 'div');\n  var moreProps = Component === ButtonBase ? {\n    component: 'div'\n  } : {};\n  var deleteIcon = null;\n\n  if (onDelete) {\n    var customClasses = clsx(color !== 'default' && (variant === \"default\" ? classes[\"deleteIconColor\".concat(capitalize(color))] : classes[\"deleteIconOutlinedColor\".concat(capitalize(color))]), small && classes.deleteIconSmall);\n    deleteIcon = deleteIconProp && /*#__PURE__*/React.isValidElement(deleteIconProp) ? /*#__PURE__*/React.cloneElement(deleteIconProp, {\n      className: clsx(deleteIconProp.props.className, classes.deleteIcon, customClasses),\n      onClick: handleDeleteIconClick\n    }) : /*#__PURE__*/React.createElement(CancelIcon, {\n      className: clsx(classes.deleteIcon, customClasses),\n      onClick: handleDeleteIconClick\n    });\n  }\n\n  var avatar = null;\n\n  if (avatarProp && /*#__PURE__*/React.isValidElement(avatarProp)) {\n    avatar = /*#__PURE__*/React.cloneElement(avatarProp, {\n      className: clsx(classes.avatar, avatarProp.props.className, small && classes.avatarSmall, color !== 'default' && classes[\"avatarColor\".concat(capitalize(color))])\n    });\n  }\n\n  var icon = null;\n\n  if (iconProp && /*#__PURE__*/React.isValidElement(iconProp)) {\n    icon = /*#__PURE__*/React.cloneElement(iconProp, {\n      className: clsx(classes.icon, iconProp.props.className, small && classes.iconSmall, color !== 'default' && classes[\"iconColor\".concat(capitalize(color))])\n    });\n  }\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (avatar && icon) {\n      console.error('Material-UI: The Chip component can not handle the avatar ' + 'and the icon prop at the same time. Pick one.');\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(Component, _extends({\n    role: clickable || onDelete ? 'button' : undefined,\n    className: clsx(classes.root, className, color !== 'default' && [classes[\"color\".concat(capitalize(color))], clickable && classes[\"clickableColor\".concat(capitalize(color))], onDelete && classes[\"deletableColor\".concat(capitalize(color))]], variant !== \"default\" && [classes.outlined, {\n      'primary': classes.outlinedPrimary,\n      'secondary': classes.outlinedSecondary\n    }[color]], disabled && classes.disabled, small && classes.sizeSmall, clickable && classes.clickable, onDelete && classes.deletable),\n    \"aria-disabled\": disabled ? true : undefined,\n    tabIndex: clickable || onDelete ? 0 : undefined,\n    onClick: onClick,\n    onKeyDown: handleKeyDown,\n    onKeyUp: handleKeyUp,\n    ref: handleRef\n  }, moreProps, other), avatar || icon, /*#__PURE__*/React.createElement(\"span\", {\n    className: clsx(classes.label, small && classes.labelSmall)\n  }, label), deleteIcon);\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiChip'\n})(Chip);","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M20 8h-2.81c-.45-.78-1.07-1.45-1.82-1.96L17 4.41 15.59 3l-2.17 2.17C12.96 5.06 12.49 5 12 5c-.49 0-.96.06-1.41.17L8.41 3 7 4.41l1.62 1.63C7.88 6.55 7.26 7.22 6.81 8H4v2h2.09c-.05.33-.09.66-.09 1v1H4v2h2v1c0 .34.04.67.09 1H4v2h2.81c1.04 1.79 2.97 3 5.19 3s4.15-1.21 5.19-3H20v-2h-2.09c.05-.33.09-.66.09-1v-1h2v-2h-2v-1c0-.34-.04-.67-.09-1H20V8zm-6 8h-4v-2h4v2zm0-4h-4v-2h4v2z\"\n}), 'BugReport');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z\"\n}), 'Cancel');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h4v-2H5V8h14v10h-4v2h4c1.1 0 2-.9 2-2V6c0-1.1-.89-2-2-2zm-7 6l-4 4h3v6h2v-6h3l-4-4z\"\n}), 'OpenInBrowser');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M6 19h4V5H6v14zm8-14v14h4V5h-4z\"\n}), 'Pause');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M8 5v14l11-7z\"\n}), 'PlayArrow');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M11 5v5.59H7.5l4.5 4.5 4.5-4.5H13V5h-2zm-5 9c0 3.31 2.69 6 6 6s6-2.69 6-6h-2c0 2.21-1.79 4-4 4s-4-1.79-4-4H6z\"\n}), 'PlayForWork');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z\"\n}), 'Save');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M6 6h12v12H6z\"\n}), 'Stop');\n\nexports.default = _default;","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar create = require('../internals/object-create');\nvar definePropertyModule = require('../internals/object-define-property');\n\nvar UNSCOPABLES = wellKnownSymbol('unscopables');\nvar ArrayPrototype = Array.prototype;\n\n// Array.prototype[@@unscopables]\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\nif (ArrayPrototype[UNSCOPABLES] == undefined) {\n  definePropertyModule.f(ArrayPrototype, UNSCOPABLES, {\n    configurable: true,\n    value: create(null)\n  });\n}\n\n// add a key to Array.prototype[@@unscopables]\nmodule.exports = function (key) {\n  ArrayPrototype[UNSCOPABLES][key] = true;\n};\n","var isObject = require('../internals/is-object');\nvar isArray = require('../internals/is-array');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `ArraySpeciesCreate` abstract operation\n// https://tc39.es/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray, length) {\n  var C;\n  if (isArray(originalArray)) {\n    C = originalArray.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    else if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return new (C === undefined ? Array : C)(length === 0 ? 0 : length);\n};\n","'use strict';\nvar isArray = require('../internals/is-array');\nvar toLength = require('../internals/to-length');\nvar bind = require('../internals/function-bind-context');\n\n// `FlattenIntoArray` abstract operation\n// https://tc39.github.io/proposal-flatMap/#sec-FlattenIntoArray\nvar flattenIntoArray = function (target, original, source, sourceLen, start, depth, mapper, thisArg) {\n  var targetIndex = start;\n  var sourceIndex = 0;\n  var mapFn = mapper ? bind(mapper, thisArg, 3) : false;\n  var element;\n\n  while (sourceIndex < sourceLen) {\n    if (sourceIndex in source) {\n      element = mapFn ? mapFn(source[sourceIndex], sourceIndex, original) : source[sourceIndex];\n\n      if (depth > 0 && isArray(element)) {\n        targetIndex = flattenIntoArray(target, original, element, toLength(element.length), targetIndex, depth - 1) - 1;\n      } else {\n        if (targetIndex >= 0x1FFFFFFFFFFFFF) throw TypeError('Exceed the acceptable array length');\n        target[targetIndex] = element;\n      }\n\n      targetIndex++;\n    }\n    sourceIndex++;\n  }\n  return targetIndex;\n};\n\nmodule.exports = flattenIntoArray;\n","var aFunction = require('../internals/a-function');\n\n// optional / simple context binding\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 0: return function () {\n      return fn.call(that);\n    };\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('document', 'documentElement');\n","var classof = require('../internals/classof-raw');\n\n// `IsArray` abstract operation\n// https://tc39.es/ecma262/#sec-isarray\n// eslint-disable-next-line es/no-array-isarray -- safe\nmodule.exports = Array.isArray || function isArray(arg) {\n  return classof(arg) == 'Array';\n};\n","var anObject = require('../internals/an-object');\nvar defineProperties = require('../internals/object-define-properties');\nvar enumBugKeys = require('../internals/enum-bug-keys');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar html = require('../internals/html');\nvar documentCreateElement = require('../internals/document-create-element');\nvar sharedKey = require('../internals/shared-key');\n\nvar GT = '>';\nvar LT = '<';\nvar PROTOTYPE = 'prototype';\nvar SCRIPT = 'script';\nvar IE_PROTO = sharedKey('IE_PROTO');\n\nvar EmptyConstructor = function () { /* empty */ };\n\nvar scriptTag = function (content) {\n  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;\n};\n\n// Create object with fake `null` prototype: use ActiveX Object with cleared prototype\nvar NullProtoObjectViaActiveX = function (activeXDocument) {\n  activeXDocument.write(scriptTag(''));\n  activeXDocument.close();\n  var temp = activeXDocument.parentWindow.Object;\n  activeXDocument = null; // avoid memory leak\n  return temp;\n};\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar NullProtoObjectViaIFrame = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var JS = 'java' + SCRIPT + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  // https://github.com/zloirock/core-js/issues/475\n  iframe.src = String(JS);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(scriptTag('document.F=Object'));\n  iframeDocument.close();\n  return iframeDocument.F;\n};\n\n// Check for document.domain and active x support\n// No need to use active x approach when document.domain is not set\n// see https://github.com/es-shims/es5-shim/issues/150\n// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n// avoid IE GC bug\nvar activeXDocument;\nvar NullProtoObject = function () {\n  try {\n    /* global ActiveXObject -- old IE */\n    activeXDocument = document.domain && new ActiveXObject('htmlfile');\n  } catch (error) { /* ignore */ }\n  NullProtoObject = activeXDocument ? NullProtoObjectViaActiveX(activeXDocument) : NullProtoObjectViaIFrame();\n  var length = enumBugKeys.length;\n  while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];\n  return NullProtoObject();\n};\n\nhiddenKeys[IE_PROTO] = true;\n\n// `Object.create` method\n// https://tc39.es/ecma262/#sec-object.create\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    EmptyConstructor[PROTOTYPE] = anObject(O);\n    result = new EmptyConstructor();\n    EmptyConstructor[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = NullProtoObject();\n  return Properties === undefined ? result : defineProperties(result, Properties);\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar anObject = require('../internals/an-object');\nvar objectKeys = require('../internals/object-keys');\n\n// `Object.defineProperties` method\n// https://tc39.es/ecma262/#sec-object.defineproperties\n// eslint-disable-next-line es/no-object-defineproperties -- safe\nmodule.exports = DESCRIPTORS ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) definePropertyModule.f(O, key = keys[index++], Properties[key]);\n  return O;\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","var requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar flattenIntoArray = require('../internals/flatten-into-array');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar aFunction = require('../internals/a-function');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\n// `Array.prototype.flatMap` method\n// https://tc39.es/ecma262/#sec-array.prototype.flatmap\n$({ target: 'Array', proto: true }, {\n  flatMap: function flatMap(callbackfn /* , thisArg */) {\n    var O = toObject(this);\n    var sourceLen = toLength(O.length);\n    var A;\n    aFunction(callbackfn);\n    A = arraySpeciesCreate(O, 0);\n    A.length = flattenIntoArray(A, O, O, sourceLen, 0, 1, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return A;\n  }\n});\n","// this method was added to unscopables after implementation\n// in popular engines, so it's moved to a separate module\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('flatMap');\n","/***\n *  DTDL specification: https://github.com/Azure/opendigitaltwins-dtdl/blob/master/DTDL/v2/dtdlv2.md.\n */\nexport const DTDL_REFERENCE_URL =\n    \"https://github.com/Azure/opendigitaltwins-dtdl/blob/master/DTDL/v2/dtdlv2.md\"\nexport const DTDL_NAME = \"Digital Twins Definition Language\"\nexport const DTDL_CONTEXT = \"dtmi:dtdl:context;2\"\n\n// warps fields into an object\nexport function objectSchema(schemas: DTDLSchema[]): DTDLSchema {\n    return {\n        \"@type\": \"Object\",\n        fields: schemas,\n    }\n}\n\n// wraps a schema into an array\nexport function arraySchema(schema: string | DTDLSchema): DTDLSchema {\n    return {\n        \"@type\": \"Array\",\n        elementSchema: schema,\n    }\n}\n\nexport interface DTDLNode {\n    \"@type\"?: string\n    \"@id\"?: string\n    // 1-64 characters\n    // ^[a-zA-Z](?:[a-zA-Z0-9_]*[a-zA-Z0-9])?$\n    name?: string\n    displayName?: string\n    description?: string\n}\n\nexport interface DTDLSchema extends DTDLNode {\n    fields?: DTDLSchema[]\n    schema?: string | DTDLSchema\n    elementSchema?: string | DTDLSchema\n}\n\nexport interface DTDLContent extends DTDLNode {\n    \"@type\": \"Property\" | \"Command\" | \"Component\" | \"Interface\"\n    unit?: string\n    schema?: string | DTDLSchema\n}\n\nexport interface DTDLInterface extends DTDLContent {\n    contents: DTDLContent[]\n    extends?: string | string[]\n    schemas?: (DTDLSchema | DTDLInterface)[]\n    \"@context\"?: string\n}\n\nexport function escapeName(name: string) {\n    name = name.trim().replace(/[^a-zA-Z0-9_]/g, \"_\")\n    if (!/^[a-zA-Z]/.test(name)) name = \"a\" + name\n    name = name[0].toLowerCase() + name.slice(1)\n    return name.slice(0, 64)\n}\n\nexport function escapeDisplayName(name: string) {\n    return name.slice(0, 64)\n}\n\nexport function DTDLUnits() {\n    return [\n        \"metrePerSecondSquared\",\n        \"centimetrePerSecondSquared\",\n        \"gForce\",\n        \"radian\",\n        \"degreeOfArc\",\n        \"minuteOfArc\",\n        \"secondOfArc\",\n        \"turn\",\n        \"radianPerSecondSquared\",\n        \"radianPerSecond\",\n        \"degreePerSecond\",\n        \"revolutionPerSecond\",\n        \"revolutionPerMinute\",\n        \"squareMetre\",\n        \"squareCentimetre\",\n        \"squareMillimetre\",\n        \"squareKilometre\",\n        \"hectare\",\n        \"squareFoot\",\n        \"squareInch\",\n        \"acre\",\n        \"farad\",\n        \"millifarad\",\n        \"microfarad\",\n        \"nanofarad\",\n        \"picofarad\",\n        \"ampere\",\n        \"microampere\",\n        \"milliampere\",\n        \"bitPerSecond\",\n        \"kibibitPerSecond\",\n        \"mebibitPerSecond\",\n        \"gibibitPerSecond\",\n        \"tebibitPerSecond\",\n        \"exbibitPerSecond\",\n        \"zebibitPerSecond\",\n        \"yobibitPerSecond\",\n        \"bytePerSecond\",\n        \"kibibytePerSecond\",\n        \"mebibytePerSecond\",\n        \"gibibytePerSecond\",\n        \"tebibytePerSecond\",\n        \"exbibytePerSecond\",\n        \"zebibytePerSecond\",\n        \"yobibytePerSecond\",\n        \"bit\",\n        \"kibibit\",\n        \"mebibit\",\n        \"gibibit\",\n        \"tebibit\",\n        \"exbibit\",\n        \"zebibit\",\n        \"yobibit\",\n        \"byte\",\n        \"kibibyte\",\n        \"mebibyte\",\n        \"gibibyte\",\n        \"tebibyte\",\n        \"exbibyte\",\n        \"zebibyte\",\n        \"yobibyte\",\n        \"kilogramPerCubicMetre\",\n        \"gramPerCubicMetre\",\n        \"metre\",\n        \"centimetre\",\n        \"millimetre\",\n        \"micrometre\",\n        \"nanometre\",\n        \"kilometre\",\n        \"foot\",\n        \"inch\",\n        \"mile\",\n        \"nauticalMile\",\n        \"astronomicalUnit\",\n        \"coulomb\",\n        \"joule\",\n        \"kilojoule\",\n        \"megajoule\",\n        \"gigajoule\",\n        \"electronvolt\",\n        \"megaelectronvolt\",\n        \"kilowattHour\",\n        \"newton\",\n        \"pound\",\n        \"ounce\",\n        \"ton\",\n        \"hertz\",\n        \"kilohertz\",\n        \"megahertz\",\n        \"gigahertz\",\n        \"kilogramPerCubicMetre\",\n        \"gramPerCubicMetre\",\n        \"lux\",\n        \"footcandle\",\n        \"henry\",\n        \"millihenry\",\n        \"microhenry\",\n        \"radian\",\n        \"degreeOfArc\",\n        \"minuteOfArc\",\n        \"secondOfArc\",\n        \"turn\",\n        \"radian\",\n        \"degreeOfArc\",\n        \"minuteOfArc\",\n        \"secondOfArc\",\n        \"turn\",\n        \"metre\",\n        \"centimetre\",\n        \"millimetre\",\n        \"micrometre\",\n        \"nanometre\",\n        \"kilometre\",\n        \"foot\",\n        \"inch\",\n        \"mile\",\n        \"nauticalMile\",\n        \"astronomicalUnit\",\n        \"candelaPerSquareMetre\",\n        \"watt\",\n        \"microwatt\",\n        \"milliwatt\",\n        \"kilowatt\",\n        \"megawatt\",\n        \"gigawatt\",\n        \"horsepower\",\n        \"kilowattHourPerYear\",\n        \"lumen\",\n        \"candela\",\n        \"weber\",\n        \"maxwell\",\n        \"tesla\",\n        \"kilogram\",\n        \"gram\",\n        \"milligram\",\n        \"microgram\",\n        \"tonne\",\n        \"slug\",\n        \"gramPerSecond\",\n        \"kilogramPerSecond\",\n        \"gramPerHour\",\n        \"kilogramPerHour\",\n        \"watt\",\n        \"microwatt\",\n        \"milliwatt\",\n        \"kilowatt\",\n        \"megawatt\",\n        \"gigawatt\",\n        \"horsepower\",\n        \"kilowattHourPerYear\",\n        \"pascal\",\n        \"kilopascal\",\n        \"bar\",\n        \"millibar\",\n        \"millimetresOfMercury\",\n        \"poundPerSquareInch\",\n        \"inchesOfMercury\",\n        \"inchesOfWater\",\n        \"unity percent\",\n        \"ohm\",\n        \"milliohm\",\n        \"kiloohm\",\n        \"megaohm\",\n        \"decibel\",\n        \"bel\",\n        \"kelvin\",\n        \"degreeCelsius\",\n        \"degreeFahrenheit\",\n        \"newton\",\n        \"pound\",\n        \"ounce\",\n        \"ton\",\n        \"second\",\n        \"millisecond\",\n        \"microsecond\",\n        \"nanosecond\",\n        \"minute\",\n        \"hour\",\n        \"day\",\n        \"year\",\n        \"newtonMetre\",\n        \"metrePerSecond\",\n        \"centimetrePerSecond\",\n        \"kilometrePerSecond\",\n        \"metrePerHour\",\n        \"kilometrePerHour\",\n        \"milePerHour\",\n        \"milePerSecond\",\n        \"knot\",\n        \"volt\",\n        \"millivolt\",\n        \"microvolt\",\n        \"kilovolt\",\n        \"megavolt\",\n        \"cubicMetre\",\n        \"cubicCentimetre\",\n        \"litre\",\n        \"millilitre\",\n        \"cubicFoot\",\n        \"cubicInch\",\n        \"fluidOunce\",\n        \"gallon\",\n        \"litrePerSecond\",\n        \"millilitrePerSecond\",\n        \"litrePerHour\",\n        \"millilitrePerHour\",\n    ].sort()\n}\n","import React, { lazy, useState } from \"react\"\nimport { Box, Button } from \"@material-ui/core\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport OpenInBrowserIcon from \"@material-ui/icons/OpenInBrowser\"\nimport IconButtonWithTooltip from \"./ui/IconButtonWithTooltip\"\nimport Suspense from \"./ui/Suspense\"\nconst DropzoneDialog = lazy(() => import(\"./ui/DropzoneDialog\"))\n\nexport default function ImportButton(props: {\n    icon?: boolean\n    text: string\n    onFilesUploaded: (files: File[]) => void\n    disabled?: boolean\n    acceptedFiles?: string[]\n    filesLimit?: number\n    className?: string\n}) {\n    const {\n        text,\n        onFilesUploaded,\n        disabled,\n        acceptedFiles,\n        icon,\n        filesLimit,\n        className,\n    } = props\n    const [open, setOpen] = useState(false)\n\n    const handleOpen = () => {\n        setOpen(true)\n    }\n    const handleSave = (files: File[]) => {\n        if (files?.length) onFilesUploaded(files)\n        setOpen(false)\n    }\n    const handleClose = () => setOpen(false)\n\n    return (\n        <Box className={className}>\n            {icon && (\n                <IconButtonWithTooltip title={text} onClick={handleOpen}>\n                    <OpenInBrowserIcon />\n                </IconButtonWithTooltip>\n            )}\n            {!icon && (\n                <Button\n                    disabled={disabled}\n                    variant=\"outlined\"\n                    onClick={handleOpen}\n                    startIcon={<OpenInBrowserIcon />}\n                >\n                    {text}\n                </Button>\n            )}\n            {open && (\n                <Suspense>\n                    <DropzoneDialog\n                        open={open}\n                        onSave={handleSave}\n                        maxFileSize={5000000}\n                        onClose={handleClose}\n                        acceptedFiles={acceptedFiles}\n                        clearOnUnmount={true}\n                        filesLimit={filesLimit || 1}\n                        submitButtonText={\"import\"}\n                    />\n                </Suspense>\n            )}\n        </Box>\n    )\n}\n","export interface VMError {\n    sourceId?: string\n    code?: number\n    message: string\n}\n\nexport interface VMBase {\n    type: \"ite\" | \"cmd\"\n    sourceId?: string\n}\n\nexport interface VMIfThenElse extends VMBase {\n    type: \"ite\"\n    expr: jsep.Expression\n    then?: VMBase[]\n    else?: VMBase[]\n}\n\nexport interface VMCommand extends VMBase {\n    type: \"cmd\"\n    command: jsep.CallExpression\n}\n\nexport interface VMHandler {\n    commands: VMBase[]\n    roles?: string[]\n    errors?: VMError[]\n    // this handler support the editing experience but\n    // should not be compiled down or debugged\n    meta?: boolean\n}\n\nexport interface VMRole {\n    role: string\n    serviceShortId: string\n}\n\nexport interface VMProgram {\n    roles: VMRole[]\n    handlers: VMHandler[]\n}\n\nexport type VMFunctionNames =\n    | \"awaitEvent\"\n    | \"awaitRegister\"\n    | \"awaitChange\"\n    | \"awaitCondition\"\n    | \"wait\"\n    | \"writeRegister\"\n    | \"writeLocal\"\n    | \"halt\"\n    | \"label\"\n    | \"jump\"\n    | \"branchOnCondition\"\n    | \"watch\"\n\nexport const VMFunctions: jdtest.TestFunctionDescription[] = [\n    {\n        id: \"label\",\n        args: [\"Identifier\"],\n        prompt: `label target {1}`,\n        context: \"command\",\n    },\n    {\n        id: \"jump\",\n        args: [\"Identifier\"],\n        prompt: `jump to label {1}`,\n        context: \"command\",\n    },\n    {\n        id: \"branchOnCondition\",\n        args: [\"boolean\", \"Identifier\"],\n        prompt: `if {1} then jump to label {2}`,\n        context: \"command\",\n    },\n    {\n        id: \"awaitRegister\",\n        args: [\"register\"],\n        prompt: `wait on register {1} to change value`,\n        context: \"command\",\n    },\n    {\n        id: \"awaitChange\",\n        args: [\"register\", \"number\"],\n        prompt: `wait for register {1} to change by {2}`,\n        context: \"command\",\n    },\n    {\n        id: \"wait\",\n        args: [\"number\"],\n        prompt: `wait for {1} milliseconds`,\n        context: \"command\",\n    },\n    {\n        id: \"watch\",\n        args: [\"number\"],\n        prompt: `watch expression {1}`,\n        context: \"command\",\n    },\n    {\n        id: \"awaitEvent\",\n        args: [\"event\", [\"boolean\", true]],\n        prompt: `wait for event {1} and then check {2} (other events ignored)`,\n        context: \"command\",\n    },\n    {\n        id: \"awaitCondition\",\n        args: [\"boolean\"],\n        prompt: `wait for condition {1}`,\n        context: \"command\",\n    },\n    {\n        id: \"writeRegister\",\n        args: [\"register\", \"number\"],\n        prompt: `write value {2:val} to {1}`,\n        context: \"command\",\n    },\n    {\n        id: \"writeLocal\",\n        args: [\"register\", \"number\"],\n        prompt: `write value {2:val} to {1}`,\n        context: \"command\",\n    },\n    {\n        id: \"halt\",\n        args: [],\n        prompt: `terminates the current handler`,\n        context: \"command\",\n    },\n    {\n        id: \"nop\",\n        args: [],\n        prompt: `no operation`,\n        context: \"command\",\n    },\n    {\n        id: \"onRoleConnected\",\n        args: [\"Identifier\"],\n        prompt: `fires when a role is connected`,\n        context: \"command\",\n    },\n    {\n        id: \"onRoleDisconnected\",\n        args: [\"Identifier\"],\n        prompt: `fires when a role is disconnected`,\n        context: \"command\",\n    },\n]\n","import { serviceSpecificationFromName } from \"../jdom/spec\"\nimport {\n    VMBase,\n    VMCommand,\n    VMError,\n    VMHandler,\n    VMIfThenElse,\n    VMProgram,\n    VMFunctions\n} from \"./ir\"\nimport {\n    VMChecker,\n    SpecSymbolResolver,\n} from \"../../jacdac-spec/spectool/jdutils\"\nimport { assert } from \"../jdom/utils\"\n\nexport function toIdentifier(id: string) {\n    return {\n        type: \"Identifier\",\n        name: id,\n    } as jsep.Identifier\n}\n\nexport function toMemberExpression(\n    root: string,\n    field: string | jsep.Expression\n) {\n    return {\n        type: \"MemberExpression\",\n        object: toIdentifier(root),\n        property: typeof field === \"string\" ? toIdentifier(field) : field,\n        computed: false,\n    } as jsep.MemberExpression\n}\n\nfunction handlerVisitor(\n    handler: VMHandler,\n    visitITE: (ite: VMIfThenElse, time: number) => void,\n    visitCommand: (c: VMCommand) => void\n) {\n    handler.commands.forEach(visitBase)\n\n    function visitBase(base: VMBase) {\n        switch (base.type) {\n            case \"cmd\": {\n                if (visitCommand) visitCommand(base as VMCommand)\n                break\n            }\n            case \"ite\": {\n                const ite = base as VMIfThenElse\n                if (visitITE) visitITE(ite, 0)\n                ite?.else?.forEach(visitBase)\n                if (visitITE) visitITE(ite, 1)\n                ite?.then?.forEach(visitBase)\n                if (visitITE) visitITE(ite, 2)\n            }\n        }\n    }\n}\n\nexport function compileProgram(prog: VMProgram) {\n    const newProgram: VMProgram = { roles: prog.roles.slice(0), handlers: [] }\n    newProgram.handlers = prog.handlers.map(h => {\n        return { commands: removeIfThenElse(h), errors: h?.errors }\n    })\n    return newProgram\n}\n\nfunction removeIfThenElse(handler: VMHandler): VMBase[] {\n    const newSequence: VMCommand[] = []\n    const labels: { then: string; end: string }[] = []\n    let labelId = 1\n    handlerVisitor(\n        handler,\n        (ite, time) => {\n            switch (time) {\n                case 0: {\n                    // create the labels and branch instruction\n                    const then = `then_${labelId}`\n                    const end = `end_${labelId}`\n                    labels.push({ then, end })\n                    labelId++\n                    newSequence.push({\n                        type: \"cmd\",\n                        command: {\n                            type: \"CallExpression\",\n                            callee: toIdentifier(\"branchOnCondition\"),\n                            arguments: [ite.expr, toIdentifier(then)],\n                        },\n                    })\n                    break\n                }\n                case 1: {\n                    // insert the jump and then label\n                    const { then, end } = labels[labels.length - 1]\n                    newSequence.push({\n                        type: \"cmd\",\n                        command: {\n                            type: \"CallExpression\",\n                            callee: toIdentifier(\"jump\"),\n                            arguments: [toIdentifier(end)],\n                        },\n                    })\n                    newSequence.push({\n                        type: \"cmd\",\n                        command: {\n                            type: \"CallExpression\",\n                            callee: toIdentifier(\"label\"),\n                            arguments: [toIdentifier(then)],\n                        },\n                    })\n                    break\n                }\n                case 2: {\n                    assert(labels.length > 0)\n                    const { end } = labels[labels.length - 1]\n                    newSequence.push({\n                        type: \"cmd\",\n                        command: {\n                            type: \"CallExpression\",\n                            callee: toIdentifier(\"label\"),\n                            arguments: [toIdentifier(end)],\n                        },\n                    })\n                    labels.pop()\n                }\n            }\n        },\n        cmd => {\n            newSequence.push(cmd)\n        }\n    )\n    return newSequence\n}\n\nexport interface RoleRegister {\n    role: string\n    register: string\n}\n\nexport interface RoleEvent {\n    role: string\n    event: string\n}\n\nexport const getServiceFromRole = (info: VMProgram) => (role: string) => {\n    // lookup in roles first\n    const shortId = info.roles.find(pair => pair.role === role)\n    if (shortId) {\n        // must succeed\n        const def = serviceSpecificationFromName(shortId.serviceShortId)\n        assert(!!def, `service ${shortId.serviceShortId} not resolved`)\n        return def\n    } else {\n        const service = serviceSpecificationFromName(role)\n        return service\n    }\n}\n\nexport function checkProgram(prog: VMProgram): {\n    registers: RoleRegister[]\n    events: RoleEvent[]\n    errors: VMError[]\n} {\n    const allErrors: VMError[] = []\n    const goodHandlers: VMHandler[] = []\n    const errorFun = (e: string) => {\n        allErrors.push({ sourceId: undefined, message: e })\n    }\n    const symbolResolver = new SpecSymbolResolver(\n        undefined,\n        getServiceFromRole(prog),\n        errorFun\n    )\n    const checker = new VMChecker(symbolResolver, _ => true, errorFun)\n    prog.handlers.forEach(h => {\n        if (h?.errors.length) {\n            h?.errors.forEach(e => allErrors.push(e))\n            return\n        }\n        const errorCount = allErrors.length\n        symbolResolver.roles = []\n        handlerVisitor(h, undefined, c =>\n            checker.checkCommand(c.command, VMFunctions)\n        )\n        if (h?.errors.length === 0 && allErrors.length === errorCount) {\n            h.roles = symbolResolver.roles\n            goodHandlers.push(h)\n        } else {\n            h?.errors.forEach(e => allErrors.push(e))\n        }\n    })\n    prog.handlers = goodHandlers\n\n    return {\n        registers: symbolResolver.registers.map(s => {\n            const [root, fld] = s.split(\".\")\n            return { role: root, register: fld }\n        }),\n        events: symbolResolver.events.map(e => {\n            const [root, fld] = e.split(\".\")\n            return { role: root, event: fld }\n        }),\n        errors: allErrors,\n    }\n}\n","import { VMProgram, VMHandler, VMCommand, VMRole } from \"./ir\"\nimport RoleManager from \"../servers/rolemanager\"\nimport { VMEnvironment, VMRoleNoServiceException } from \"./environment\"\nimport { VMExprEvaluator, unparse } from \"./expr\"\nimport { JDBus } from \"../jdom/bus\"\nimport { JDEventSource } from \"../jdom/eventsource\"\nimport { CHANGE, ROLE_BOUND, ROLE_UNBOUND, TRACE } from \"../jdom/constants\"\nimport { checkProgram, compileProgram } from \"./compile\"\nimport { VM_EVENT, VMCode } from \"./events\"\nimport { VMError, Mutex } from \"./utils\"\nimport { assert, SMap } from \"../jdom/utils\"\nimport { JDClient } from \"../jdom/client\"\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type VMTraceContext = any\n\nenum VMInternalStatus {\n    Ready = \"ready\", // the pc is at this instruction, but pre-condition not met\n    Enabled = \"enabled\", // the instruction pre-conditions are met (is this needed?)\n    Running = \"running\", // the instruction has started running (may need retries)\n    Sleeping = \"sleep\", // waiting to be woken by timer\n    Completed = \"completed\", // the instruction completed successfully\n    Stopped = \"stopped\", // halt instruction encountered, handler stopped\n}\n\nconst VM_WAKE_SLEEPER = \"vmWakeSleeper\"\n\nexport interface VMEnvironmentInterface {\n    writeRegisterAsync: (\n        e: jsep.MemberExpression | string,\n        v: any\n    ) => Promise<void>\n    sendCommandAsync: (\n        command: jsep.MemberExpression,\n        values: any[]\n    ) => Promise<void>\n    refreshRegistersAsync: () => Promise<void>\n    lookup: (e: jsep.MemberExpression | string) => any\n    writeLocal: (e: jsep.MemberExpression | string, v: any) => boolean\n    hasEvent: (e: jsep.MemberExpression | string) => boolean\n    unsubscribe: () => void\n}\n\nclass VMJumpException extends Error {\n    constructor(public label: string) {\n        super()\n    }\n}\n\nclass VMTimerException extends Error {\n    constructor(public ms: number) {\n        super()\n    }\n}\n\nclass VMCommandEvaluator {\n    private _regSaved: number = undefined\n    private _changeSaved: number = undefined\n    private _started = false\n    constructor(\n        public parent: VMCommandRunner,\n        private readonly env: VMEnvironment,\n        private readonly gc: VMCommand\n    ) {}\n\n    trace(msg: string, context: VMTraceContext = {}) {\n        this.parent.trace(msg, { command: this.gc.command.type, ...context })\n    }\n\n    private get inst() {\n        return (this.gc.command.callee as jsep.Identifier)?.name\n    }\n\n    private evalExpression(e: jsep.Expression) {\n        const expr = new VMExprEvaluator(e => this.env.lookup(e), undefined)\n        return expr.eval(e)\n    }\n\n    private checkExpression(e: jsep.Expression) {\n        return this.evalExpression(e) ? true : false\n    }\n\n    private start() {\n        if (\n            this.gc.command.callee.type !== \"MemberExpression\" &&\n            (this.inst === \"awaitRegister\" || this.inst === \"awaitChange\")\n        ) {\n            // need to capture register value for awaitChange/awaitRegister\n            const args = this.gc.command.arguments\n            this._regSaved = this.evalExpression(args[0])\n            if (this.inst === \"awaitChange\")\n                this._changeSaved = this.evalExpression(args[1])\n            return true\n        }\n        return false\n    }\n\n    public async evaluate(): Promise<VMInternalStatus> {\n        if (!this._started) {\n            const neededStart = this.start()\n            this._started = true\n            if (neededStart) return VMInternalStatus.Running\n        }\n        const args = this.gc.command.arguments\n        if (this.gc.command.callee.type === \"MemberExpression\") {\n            // interpret as a service command (role.comand)\n            const expr = new VMExprEvaluator(e => this.env.lookup(e), undefined)\n            const values = this.gc.command.arguments.map(a => expr.eval(a))\n            await this.env.sendCommandAsync(\n                this.gc.command.callee as jsep.MemberExpression,\n                values\n            )\n            return VMInternalStatus.Completed\n        }\n        switch (this.inst) {\n            case \"branchOnCondition\": {\n                const expr = this.checkExpression(args[0])\n                if (expr) {\n                    throw new VMJumpException((args[1] as jsep.Identifier).name)\n                }\n                return VMInternalStatus.Completed\n            }\n            case \"jump\": {\n                throw new VMJumpException((args[0] as jsep.Identifier).name)\n            }\n            case \"label\": {\n                return VMInternalStatus.Completed\n            }\n            case \"awaitEvent\": {\n                const event = args[0] as jsep.MemberExpression\n                if (this.env.hasEvent(event)) {\n                    return this.checkExpression(args[1])\n                        ? VMInternalStatus.Completed\n                        : VMInternalStatus.Running\n                }\n                return VMInternalStatus.Running\n            }\n            case \"awaitCondition\": {\n                return this.checkExpression(args[0])\n                    ? VMInternalStatus.Completed\n                    : VMInternalStatus.Running\n            }\n            case \"awaitChange\":\n            case \"awaitRegister\": {\n                const regValue = this.evalExpression(args[0])\n                if (\n                    (this.inst === \"awaitRegister\" &&\n                        regValue !== this._regSaved) ||\n                    (this.inst === \"awaitChange\" &&\n                        ((this._changeSaved === 0 &&\n                            regValue !== this._regSaved) ||\n                            (this._changeSaved < 0 &&\n                                regValue <=\n                                    this._regSaved + this._changeSaved) ||\n                            (this._changeSaved > 0 &&\n                                regValue >=\n                                    this._regSaved + this._changeSaved)))\n                ) {\n                    return VMInternalStatus.Completed\n                }\n                return VMInternalStatus.Running\n            }\n            case \"writeRegister\":\n            case \"writeLocal\": {\n                const expr = new VMExprEvaluator(\n                    e => this.env.lookup(e),\n                    undefined\n                )\n                const ev = expr.eval(args[1])\n                this.trace(\"eval-end\", { expr: unparse(args[1]) })\n                const reg = args[0] as jsep.MemberExpression\n                if (this.inst === \"writeRegister\") {\n                    await this.env.writeRegisterAsync(reg, ev)\n                    this.trace(\"write-after-wait\", {\n                        reg: unparse(reg),\n                        expr: ev,\n                    })\n                } else this.env.writeLocal(reg, ev)\n                return VMInternalStatus.Completed\n            }\n            case \"watch\": {\n                const expr = new VMExprEvaluator(\n                    e => this.env.lookup(e),\n                    undefined\n                )\n                const ev = expr.eval(args[0])\n                this.parent.watch(this.gc?.sourceId, ev)\n                return VMInternalStatus.Completed\n            }\n            case \"halt\": {\n                return VMInternalStatus.Stopped\n            }\n            case \"nop\": {\n                return VMInternalStatus.Completed\n            }\n            case \"wait\": {\n                const expr = new VMExprEvaluator(\n                    e => this.env.lookup(e),\n                    undefined\n                )\n                const ev = expr.eval(args[0])\n                throw new VMTimerException(ev * 1000)\n            }\n            case \"onRoleConnected\": {\n                // first time fires based on state\n                // after that, only on transitions\n                return VMInternalStatus.Completed\n            }\n            case \"onRoleDisonnected\": {\n                // first time fires based on state\n                // after that, only on transitions\n                return VMInternalStatus.Completed\n            }\n            default:\n                throw new VMError(\n                    VMCode.InternalError,\n                    `Unknown instruction ${this.inst}`\n                )\n        }\n    }\n}\n\nclass VMCommandRunner {\n    private _eval: VMCommandEvaluator\n    private _status: VMInternalStatus = VMInternalStatus.Running\n    constructor(\n        public readonly parent: VMHandlerRunner,\n        private handlerId: number,\n        env: VMEnvironment,\n        public gc: VMCommand\n    ) {\n        this._eval = new VMCommandEvaluator(this, env, gc)\n    }\n\n    trace(msg: string, context: VMTraceContext = {}) {\n        this.parent.trace(msg, { handler: this.handlerId, ...context })\n    }\n\n    watch(id: string, val: any) {\n        this.parent.watch(id, val)\n    }\n\n    get status() {\n        return this._status\n    }\n\n    set status(s: VMInternalStatus) {\n        this._status = s\n    }\n\n    async stepAsync() {\n        if (this.status === VMInternalStatus.Running) {\n            this.trace(unparse(this.gc.command))\n            this.status = await this._eval.evaluate()\n        }\n    }\n}\n\nclass VMHandlerRunner extends JDEventSource {\n    private _commandIndex: number = undefined\n    private _currentCommand: VMCommandRunner = undefined\n    private stopped = false\n    private _labelToIndex: SMap<number> = {}\n\n    constructor(\n        public readonly parent: VMProgramRunner,\n        public readonly id: number,\n        public readonly env: VMEnvironment,\n        public readonly handler: VMHandler\n    ) {\n        super()\n        // find the label commands (targets of jumps)\n        this.handler.commands.forEach((c, index) => {\n            const cmd = c as VMCommand\n            const id = cmd.command?.callee as jsep.Identifier\n            if (id?.name === \"label\") {\n                const label = cmd.command.arguments[0] as jsep.Identifier\n                this._labelToIndex[label.name] = index\n            }\n        })\n        this.reset()\n    }\n\n    trace(msg: string, context: VMTraceContext = {}) {\n        this.parent.trace(msg, { id: this.id, ...context })\n    }\n\n    watch(id: string, val: any) {\n        this.parent.watch(id, val)\n    }\n\n    get status() {\n        return this.stopped\n            ? VMInternalStatus.Stopped\n            : this._commandIndex === undefined\n            ? VMInternalStatus.Ready\n            : this._currentCommand.status\n    }\n\n    get command() {\n        return this._currentCommand\n    }\n\n    get atTop() {\n        return (\n            this.status === VMInternalStatus.Running && this._commandIndex === 0\n        )\n    }\n\n    gotoTop() {\n        if (\n            this.status === VMInternalStatus.Ready &&\n            this.handler.commands.length\n        )\n            this.commandIndex = 0\n    }\n\n    reset() {\n        this.commandIndex = undefined\n        this.stopped = false\n    }\n\n    cancel() {\n        this.stopped = true\n        this.env.unsubscribe()\n    }\n\n    wake() {\n        if (this._currentCommand) {\n            this._currentCommand.status = VMInternalStatus.Completed\n            this.next()\n        }\n    }\n\n    // run-to-completion semantics (true if breakpoint)\n    async runToCompletionAsync(singleStep = false) {\n        if (this.stopped || !this.handler.commands.length) return undefined\n        if (this.commandIndex === undefined) {\n            this.commandIndex = 0\n        }\n        if ((await this.singleStepCheckBreakAsync(singleStep)) && !singleStep)\n            return this._currentCommand\n        while (this.next()) {\n            if (singleStep || (await this.singleStepCheckBreakAsync()))\n                return this._currentCommand\n        }\n        return undefined\n    }\n\n    private next() {\n        if (\n            this._currentCommand.status === VMInternalStatus.Completed &&\n            this.commandIndex < this.handler.commands.length - 1\n        ) {\n            this.commandIndex++\n            return true\n        }\n        return false\n    }\n\n    private getCommand() {\n        const cmd = this.handler.commands[this._commandIndex]\n        if (cmd.type === \"ite\") {\n            throw new VMError(VMCode.InternalError, \"ite not compiled away\")\n        }\n        return cmd as VMCommand\n    }\n\n    private async singleStepCheckBreakAsync(singleStep = false) {\n        this.trace(\"step begin\")\n        const sid = this._currentCommand.gc?.sourceId\n        if (!singleStep && (await this.parent.breakpointOnAsync(sid))) {\n            return true\n        }\n        await this.singleStepAsync()\n        this.trace(\"step end\")\n        return false\n    }\n\n    private async singleStepAsync() {\n        const sid = this._currentCommand.gc.sourceId\n        this.parent.emit(VM_EVENT, VMCode.CommandStarted, sid)\n        try {\n            await this._currentCommand.stepAsync()\n        } catch (e) {\n            if (e instanceof VMJumpException) {\n                const { label } = e as VMJumpException\n                const index = this._labelToIndex[label]\n                this.commandIndex = index\n                this._currentCommand.status = VMInternalStatus.Completed\n            } else if (e instanceof VMTimerException) {\n                const vmt = e as VMTimerException\n                this._currentCommand.status = VMInternalStatus.Sleeping\n                await this.parent.sleepAsync(this, vmt.ms)\n            } else {\n                this.emit(\n                    VM_EVENT,\n                    VMCode.CommandFailed,\n                    this._currentCommand.gc.sourceId\n                )\n                throw e\n            }\n        }\n        if (this._currentCommand.status === VMInternalStatus.Completed)\n            this.parent.emit(\n                VM_EVENT,\n                VMCode.CommandCompleted,\n                this._currentCommand.gc.sourceId\n            )\n        if (this._currentCommand.status === VMInternalStatus.Stopped)\n            this.stopped = true\n    }\n\n    private set commandIndex(index: number) {\n        if (index === undefined) {\n            this._commandIndex = undefined\n            this._currentCommand = undefined\n        } else if (index !== this._commandIndex) {\n            this._commandIndex = index\n            this._currentCommand = new VMCommandRunner(\n                this,\n                this.id,\n                this.env,\n                this.getCommand()\n            )\n        }\n    }\n\n    private get commandIndex() {\n        return this._commandIndex\n    }\n}\n\nexport type WatchValueType = boolean | string | number\n\ninterface SleepingHandler {\n    ms: number\n    handlerRunner: VMHandlerRunner\n    handler?: VMHandler\n    id: NodeJS.Timeout\n}\n\nfunction isEveryHandler(h: VMHandler) {\n    assert(!!h)\n    if (h.commands.length) {\n        const cmd = (h.commands[0] as VMCommand).command\n            .callee as jsep.Identifier\n        return cmd.name === \"wait\"\n    }\n    return false\n}\n\nexport enum VMStatus {\n    Stopped = \"stopped\",\n    Running = \"running\",\n    Paused = \"paused\",\n}\n\nexport class VMProgramRunner extends JDClient {\n    // program, environment\n    private _handlerRunners: VMHandlerRunner[] = []\n    private _env: VMEnvironment\n    private _roles: VMRole[] = []\n    // running\n    private _status: VMStatus\n    private _waitQueue: VMHandlerRunner[] = []\n    private _everyQueue: VMHandlerRunner[] = []\n    private _runQueue: VMHandlerRunner[] = []\n    private _waitRunMutex: Mutex\n    private _sleepQueue: SleepingHandler[] = []\n    private _sleepMutex: Mutex\n    // debugging\n    private _watch: SMap<any> = {}\n    private _breaks: SMap<boolean> = {}\n    private _breaksMutex: Mutex\n\n    constructor(\n        readonly bus: JDBus,\n        readonly roleManager: RoleManager,\n        readonly program: VMProgram\n    ) {\n        super()\n        const compiled = compileProgram(program)\n        const { registers, events, errors } = checkProgram(compiled)\n        this._roles = compiled.roles\n        if (errors.length) {\n            console.warn(\"ERRORS\", errors)\n        }\n        // data structures for running program\n        this._status = VMStatus.Stopped\n        this._env = new VMEnvironment(registers, events)\n        this._handlerRunners = compiled.handlers.map(\n            (h, index) => new VMHandlerRunner(this, index, this._env, h)\n        )\n        // TODO: can't add multiple handlers until we have deduplicate CHANGE on Event\n        /*\n        const len = this._handlerRunners.length\n        compiled.handlers.forEach((h, index) =>\n            this._handlerRunners.push(\n                new VMHandlerRunner(this, len + index, this._env, h)\n            )\n        )*/\n\n        this._waitRunMutex = new Mutex()\n        this._breaksMutex = new Mutex()\n        this._sleepMutex = new Mutex()\n        // run on any change to environment\n        this.mount(\n            this._env.subscribe(CHANGE, () => {\n                this.waitingToRunning()\n            })\n        )\n        this.mount(\n            this.subscribe(\n                VM_WAKE_SLEEPER,\n                async (h: VMHandlerRunner | VMHandler) => {\n                    await this.wakeSleeper(h)\n                }\n            )\n        )\n        this.initializeRoleManagement()\n    }\n\n    // control of VM\n    get status() {\n        return this._status\n    }\n\n    private setStatus(s: VMStatus) {\n        if (s !== this._status) {\n            this._status = s\n            this.emit(CHANGE)\n        }\n    }\n\n    // debugging\n    trace(message: string, context: VMTraceContext = {}) {\n        this.emit(TRACE, { message, context })\n    }\n\n    // watch statement - watch an expression\n    watch(sourceId: string, value: WatchValueType) {\n        const oldValue = this._watch[sourceId]\n        if (oldValue !== value) {\n            this._watch[sourceId] = value\n            this.emit(VM_EVENT, VMCode.WatchChange, sourceId)\n        }\n    }\n\n    lookupWatch(sourceId: string) {\n        return this._watch[sourceId]\n    }\n\n    // breakpoints\n    async setBreakpointsAsync(breaks: string[]) {\n        await this._breaksMutex.acquire(async () => {\n            this._breaks = {}\n            breaks.forEach(b => {\n                this._breaks[b] = true\n            })\n        })\n    }\n\n    async clearBreakpointsAsync() {\n        await this._breaksMutex.acquire(async () => {\n            this._breaks = {}\n        })\n    }\n\n    async breakpointOnAsync(id: string) {\n        let ret = false\n        await this._breaksMutex.acquire(async () => {\n            ret = !!this._breaks?.[id]\n        })\n        return ret\n    }\n\n    // timers\n    async sleepAsync(\n        handlerRunner: VMHandlerRunner,\n        ms: number,\n        handler: VMHandler = undefined\n    ) {\n        await this._sleepMutex.acquire(async () => {\n            const id = setTimeout(() => {\n                this.emit(\n                    VM_WAKE_SLEEPER,\n                    handlerRunner ? handlerRunner : handler\n                )\n            }, ms)\n            this._sleepQueue.push({ ms, handlerRunner, id, handler })\n        })\n    }\n\n    private async wakeSleeper(h: VMHandlerRunner | VMHandler) {\n        try {\n            // let handlerMs: number = undefined\n            let handlerRunner: VMHandlerRunner = undefined\n            // let handler: VMHandler = undefined\n            await this._sleepMutex.acquire(async () => {\n                const index = this._sleepQueue.findIndex(\n                    p => p?.handlerRunner === h // || p?.handler === h\n                )\n                assert(index>=0)\n                if (index >= 0) {\n                    const p = this._sleepQueue[index]\n                    //  handlerMs = p.ms\n                    handlerRunner = p.handlerRunner\n                    // handler = p?.handler\n                    this._sleepQueue.splice(index, 1)\n                    // clearTimeout(p.id)\n                }\n            })\n            if (this.status === VMStatus.Stopped) return\n            // this logic is to deal with starting a handler rather than a runner\n            await this._waitRunMutex.acquire(async () => {\n                /*\n                if (!handlerRunner && isEveryHandler(handler)) {\n                    const index = this._everyQueue.findIndex(\n                        h => h.handler === handler\n                    )\n                    if (index >= 0) {\n                        handlerRunner = this._everyQueue[index]\n                        this._everyQueue.splice(index, 1)\n                        handlerRunner.gotoTop()\n                    }\n                }*/\n                if (handlerRunner) {\n                    // transition to the run queue\n                    handlerRunner.wake()\n                    this._runQueue.push(handlerRunner)\n                }\n            })\n            /*\n            const theHandler = handlerRunner?.handler || handler\n            if (isEveryHandler(theHandler)) {\n                // setup next\n                this.sleepAsync(undefined, handlerMs, theHandler)\n            }*/\n            if (handlerRunner) this.runAsync()\n        } catch (e) {\n            console.debug(e)\n            this.emit(VM_EVENT, VMCode.InternalError, e)\n        }\n    }\n\n    async startAsync() {\n        if (this.status !== VMStatus.Stopped) return // already running\n        this.trace(\"start\")\n        try {\n            this.roleManager.setRoles(this._roles)\n            await this._waitRunMutex.acquire(async () => {\n                this._waitQueue = this._handlerRunners.slice(0)\n                this._waitQueue.forEach(h => h.reset())\n                this._runQueue = []\n                this._everyQueue = []\n                // make sure to have another handler for every\n                /*\n                for (const h of this._waitQueue) {\n                    if (isEveryHandler(h.handler)) {\n                        const dup = new VMHandlerRunner(\n                            this,\n                            undefined,\n                            this._env,\n                            h.handler\n                        )\n                        dup.reset()\n                        this._everyQueue.push(dup)\n                    }\n                }*/\n            })\n            this.clearBreakpointsAsync()\n            this.setStatus(VMStatus.Running)\n            this.waitingToRunning()\n            this.runAsync()\n        } catch (e) {\n            console.debug(e)\n            this.emit(VM_EVENT, VMCode.InternalError, e)\n        }\n    }\n\n    cancel() {\n        if (this.status === VMStatus.Stopped) return // nothing to cancel\n        this.setStatus(VMStatus.Stopped)\n        this.trace(\"cancelled\")\n    }\n\n    async resumeAsync() {\n        if (this.status !== VMStatus.Paused) return\n        this.trace(\"resume\")\n        this.setStatus(VMStatus.Running)\n        await this.runAsync()\n    }\n\n    async stepAsync() {\n        if (this.status !== VMStatus.Paused) return\n        this.trace(\"step\")\n        const h = await this.getCurrentRunner()\n        if (h) {\n            await this.runHandlerAsync(h, true)\n            await this.postProcessHandler(h)\n            const newHead = await this.getCurrentRunner()\n            if (newHead && newHead !== h) {\n                this.emitBreakpoint(newHead)\n            }\n        }\n    }\n\n    private emitBreakpoint(h: VMHandlerRunner) {\n        this.emit(\n            VM_EVENT,\n            VMCode.Breakpoint,\n            h,\n            h.status === VMInternalStatus.Completed\n                ? \"\"\n                : h.command.gc?.sourceId\n        )\n    }\n\n    private async runHandlerAsync(h: VMHandlerRunner, oneStep = false) {\n        try {\n            const brkCommand = await h.runToCompletionAsync(oneStep)\n            if ((brkCommand && !oneStep) || this.status === VMStatus.Paused) {\n                this.setStatus(VMStatus.Paused)\n                this.emitBreakpoint(h)\n            }\n            if (h.status === VMInternalStatus.Completed) {\n                h.reset()\n            }\n        } catch (e) {\n            if (e instanceof VMRoleNoServiceException) {\n                this.emit(\n                    VM_EVENT,\n                    VMCode.RoleMissing,\n                    (e as VMRoleNoServiceException).role\n                )\n            } else {\n                console.debug(e)\n                this.emit(VM_EVENT, VMCode.InternalError, e)\n            }\n            // on handler error, reset the handler\n            h.reset()\n        }\n    }\n\n    private async postProcessHandler(h: VMHandlerRunner) {\n        if (\n            h.status === VMInternalStatus.Ready ||\n            h.status === VMInternalStatus.Sleeping\n        ) {\n            const moveToWait = h.status === VMInternalStatus.Ready\n            let done: VMHandlerRunner = undefined\n            await this._waitRunMutex.acquire(async () => {\n                if (this._runQueue.length) {\n                    assert(h === this._runQueue[0])\n                    done = this._runQueue.shift()\n                    if (moveToWait && !isEveryHandler(h.handler)) {\n                        this._waitQueue.push(done)\n                        done = undefined\n                    }\n                }\n            })\n            if (done && h.status === VMInternalStatus.Ready && isEveryHandler(h.handler)) {\n                await this.runHandlerAsync(h)\n            }\n        }\n    }\n\n    private _in_run = false\n    private async runAsync() {\n        if (this.status === VMStatus.Stopped) return\n        if (this._in_run) return\n        this.trace(\"run\")\n        this._in_run = true\n        try {\n            await this._env.refreshRegistersAsync()\n            let h: VMHandlerRunner = undefined\n            while (\n                this.status === VMStatus.Running &&\n                (h = await this.getCurrentRunner())\n            ) {\n                assert(!h.atTop)\n                await this.runHandlerAsync(h)\n                await this.postProcessHandler(h)\n            }\n        } catch (e) {\n            console.debug(e)\n            this.emit(VM_EVENT, VMCode.InternalError, e)\n        }\n        this._in_run = false\n        this.trace(\"run end\")\n    }\n\n    // call this whenever some event/change arises\n    private async waitingToRunning() {\n        if (this.status !== VMStatus.Stopped) {\n            let waitCopy: VMHandlerRunner[] = undefined\n            await this._waitRunMutex.acquire(async () => {\n                if (this.status === VMStatus.Paused && this._runQueue.length)\n                    return\n                waitCopy = this._waitQueue.slice(0)\n            })\n            if (!waitCopy)\n                return\n            const handlersStarted: VMHandler[] = []\n            const newRunners: VMHandlerRunner[] = []\n            const sleepingRunners: VMHandlerRunner[] = []\n            for (const h of waitCopy) {\n                await this.runHandlerAsync(h, true)\n                if (h.status === VMInternalStatus.Sleeping) {\n                    sleepingRunners.push(h)\n                } else if (\n                    !h.atTop &&\n                    handlersStarted.findIndex(hs => hs === h.handler) === -1\n                ) {\n                    newRunners.push(h)\n                    handlersStarted.push(h.handler)\n                }\n            }\n            await this._waitRunMutex.acquire(async () => {\n                newRunners.forEach(h => {\n                    this._runQueue.push(h)\n                    const index = this._waitQueue.indexOf(h)\n                    if (index >= 0)\n                        this._waitQueue.splice(index, 1)\n                })\n                sleepingRunners.forEach(h => {\n                    const index = this._waitQueue.indexOf(h)\n                    if (index >= 0)\n                        this._waitQueue.splice(index, 1)\n                })\n            })\n            this._env.consumeEvent()\n            this.runAsync()\n        }\n    }\n\n    private async getCurrentRunner() {\n        return await this._waitRunMutex.acquire(async () => {\n            if (this._runQueue.length) return this._runQueue[0]\n            return undefined\n        })\n    }\n\n    private initializeRoleManagement() {\n        // adding a (role,service) binding\n        const addRoleService = (role: string) => {\n            const service = this.roleManager.getService(role)\n            if (service) {\n                this._env.serviceChanged(role, service)\n            }\n        }\n        // initialize\n        this.roleManager.roles.forEach(r => {\n            if (this._roles.find(rv => rv.role === r.role)) {\n                addRoleService(r.role)\n            }\n        })\n        this.mount(\n            this.roleManager.subscribe(ROLE_BOUND, async (role: string) => {\n                addRoleService(role)\n            })\n        )\n        this.mount(\n            this.roleManager.subscribe(ROLE_UNBOUND, (role: string) => {\n                this._env.serviceChanged(role, undefined)\n            })\n        )\n    }\n}\n","import { useContext, useEffect, useState } from \"react\"\n// tslint:disable-next-line: match-default-export-name no-submodule-imports\nimport { VMProgram } from \"../../../jacdac-ts/src/vm/ir\"\nimport {\n    VMProgramRunner,\n    VMTraceContext,\n} from \"../../../jacdac-ts/src/vm/runner\"\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\"\nimport AppContext from \"../AppContext\"\nimport { ERROR, TRACE } from \"../../../jacdac-ts/src/jdom/constants\"\nimport Flags from \"../../../jacdac-ts/src/jdom/flags\"\nimport RoleManager from \"../../../jacdac-ts/src/servers/rolemanager\"\n\nexport default function useVMRunner(\n    roleManager: RoleManager,\n    program: VMProgram,\n    autoRun: boolean\n) {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const { setError } = useContext(AppContext)\n    const [runner, setRunner] = useState<VMProgramRunner>()\n    const [_autoStart, _setAutoStart] = useState<boolean>(!!autoRun)\n\n    const run = async () => {\n        _setAutoStart(!!autoRun)\n        await runner.startAsync()\n    }\n    const cancel = async () => {\n        _setAutoStart(false)\n        runner.cancel()\n    }\n\n    // auto start\n    useEffect(() => {\n        if (_autoStart && runner) runner.startAsync()\n        return () => runner?.cancel()\n    }, [runner, _autoStart])\n\n    // create runner\n    useEffect(() => {\n        try {\n            const newTestRunner =\n                program && new VMProgramRunner(bus, roleManager, program)\n            setRunner(newTestRunner)\n\n            return () => newTestRunner?.unmount()\n        } catch (e) {\n            console.debug(e)\n            setRunner(undefined)\n        }\n    }, [roleManager, program])\n\n    // errors\n    useEffect(() => runner?.subscribe(ERROR, e => setError(e)), [runner])\n    // traces\n    const handleTrace = (value: {\n        message: string\n        context: VMTraceContext\n    }) => {\n        const { message, context } = value\n        if (Flags.diagnostics) console.debug(`vm> ${message}`, context)\n    }\n    useEffect(\n        () =>\n            runner?.subscribe<{ message: string; context: VMTraceContext }>(\n                TRACE,\n                handleTrace\n            ),\n        [runner]\n    )\n\n    return { runner, run, cancel }\n}\n","import { Grid, Typography } from \"@material-ui/core\"\nimport React from \"react\"\nimport { VMProgram } from \"../../../jacdac-ts/src/vm/ir\"\nimport CodeBlock from \"../CodeBlock\"\n\nexport default function VMDiagnostics(props: { program: VMProgram }) {\n    const { program } = props\n    return (\n        <Grid item xs={12}>\n            <Typography variant=\"subtitle1\">VM</Typography>\n            <CodeBlock\n                className=\"json\"\n                downloadName={\"test.json.vm\"}\n                downloadText={JSON.stringify(program, null, 2)}\n            >\n                {JSON.stringify(program, null, 2)}\n            </CodeBlock>\n        </Grid>\n    )\n}\n","import React, { useContext } from \"react\"\nimport { Chip, Grid, Tooltip } from \"@material-ui/core\"\n// tslint:disable-next-line: match-default-export-name no-submodule-imports\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\"\nimport DeviceAvatar from \"../devices/DeviceAvatar\"\nimport { serviceSpecificationFromName } from \"../../../jacdac-ts/src/jdom/spec\"\nimport { JDService } from \"../../../jacdac-ts/src/jdom/service\"\nimport {\n    addServiceProvider,\n    serviceProviderDefinitionFromServiceClass,\n} from \"../../../jacdac-ts/src/servers/servers\"\nimport useChange from \"../../jacdac/useChange\"\nimport { BlockSvg, FieldVariable } from \"blockly\"\nimport { TWIN_BLOCK } from \"./toolbox\"\nimport useServiceServer from \"../hooks/useServiceServer\"\nimport CancelIcon from \"@material-ui/icons/Cancel\"\nimport BlockContext from \"./BlockContext\"\n\nfunction RoleChip(props: {\n    role: string\n    service: JDService\n    serviceShortId: string\n    handleRoleClick: () => void\n}) {\n    const { workspace } = useContext(BlockContext)\n    const { role, service, serviceShortId } = props\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const server = useServiceServer(service)\n    const handleRoleClick = () => {\n        // spin off simulator\n        if (!service) {\n            const specification = serviceSpecificationFromName(serviceShortId)\n            if (specification)\n                addServiceProvider(\n                    bus,\n                    serviceProviderDefinitionFromServiceClass(\n                        specification.classIdentifier\n                    )\n                )\n        }\n        // add twin block\n        if (workspace) {\n            // try to find existing twin block\n            let twinBlock = workspace\n                .getTopBlocks(false)\n                .find(\n                    b =>\n                        b.type === TWIN_BLOCK &&\n                        (\n                            b.inputList[0].fieldRow.find(\n                                f => f.name === \"role\"\n                            ) as FieldVariable\n                        )?.getVariable()?.name === role\n                ) as BlockSvg\n            if (!twinBlock) {\n                twinBlock = workspace.newBlock(TWIN_BLOCK) as BlockSvg\n                const variable = workspace.getVariable(role, serviceShortId)\n                const field = twinBlock.inputList[0].fieldRow.find(\n                    f => f.name === \"role\"\n                ) as FieldVariable\n                field.setValue(variable.getId())\n                const m = workspace.getMetrics()\n                twinBlock.moveBy(m.viewWidth / 2, m.viewHeight / 3)\n                twinBlock.initSvg()\n                twinBlock.render(false)\n            }\n            workspace.centerOnBlock(twinBlock.id)\n        }\n    }\n\n    const handleDelete = () => bus.removeServiceProvider(server.device)\n    return (\n        <Chip\n            label={role}\n            variant={service ? \"default\" : \"outlined\"}\n            avatar={service && <DeviceAvatar device={service.device} />}\n            onClick={handleRoleClick}\n            onDelete={server ? handleDelete : undefined}\n            deleteIcon={\n                <Tooltip title=\"stop simulator\">\n                    <CancelIcon />\n                </Tooltip>\n            }\n        />\n    )\n}\n\nexport default function BlockRoles() {\n    const { roleManager } = useContext(BlockContext)\n    const roles = useChange(roleManager, _ => _?.roles)\n\n    return (\n        <>\n            {roles?.map(({ role, service, serviceShortId }) => (\n                <Grid item key={role}>\n                    <RoleChip\n                        role={role}\n                        service={service}\n                        serviceShortId={serviceShortId}\n                    />\n                </Grid>\n            ))}\n        </>\n    )\n}\n","import React, { useContext, useEffect, useMemo, useState } from \"react\"\nimport useChange from \"../../jacdac/useChange\"\n// tslint:disable-next-line: match-default-export-name no-submodule-imports\nimport { VMProgramRunner, VMStatus } from \"../../../jacdac-ts/src/vm/runner\"\nimport PlayArrowIcon from \"@material-ui/icons/PlayArrow\"\nimport StopIcon from \"@material-ui/icons/Stop\"\nimport IconButtonWithTooltip from \"../ui/IconButtonWithTooltip\"\nimport { Chip, Grid } from \"@material-ui/core\"\nimport PauseIcon from \"@material-ui/icons/Pause\"\nimport { arrayConcatMany } from \"../../../jacdac-ts/src/jdom/utils\"\nimport { VM_EVENT, VMCode } from \"../../../jacdac-ts/src/vm/events\"\nimport { VMHandler, VMProgram } from \"../../../jacdac-ts/src/vm/ir\"\nimport PlayForWorkIcon from \"@material-ui/icons/PlayForWork\"\nimport useMounted from \"../hooks/useMounted\"\nimport IconButtonWithProgress from \"../ui/IconButtonWithProgress\"\nimport BugReportIcon from \"@material-ui/icons/BugReport\"\nimport BlockContext from \"../blockly/BlockContext\"\n\nfunction useWorkspaceBreakpoints(program: VMProgram) {\n    const { workspace } = useContext(BlockContext)\n    const breakpoints = useMemo(\n        () =>\n            arrayConcatMany(\n                program?.handlers\n                    ?.filter(h => !h.meta) // don't debug watch statements\n                    .map(h => h.commands.map(cmd => cmd.sourceId))\n            )?.filter(id => !!id) || [],\n        [program]\n    )\n    const setBreakpointHighlight = (sourceId: string) => {\n        workspace?.highlightBlock(sourceId)\n    }\n\n    return {\n        breakpoints,\n        setBreakpointHighlight,\n    }\n}\n\nexport default function VMRunnerButtons(props: {\n    runner: VMProgramRunner\n    run: () => Promise<void>\n    cancel: () => Promise<void>\n}) {\n    const { runner, run, cancel } = props\n    const status = useChange(runner, t => t?.status)\n    const stopped = !status || status === VMStatus.Stopped\n    const program = runner?.program\n    const [indeterminate, setIndeterminate] = useState(false)\n    const [breakpoint, setBreakpoint] = useState<string>(undefined)\n    const pausing = breakpoint === \"\"\n    const paused = !!breakpoint?.length\n    const mounted = useMounted()\n    const disabled = indeterminate || !runner\n    const { breakpoints, setBreakpointHighlight } =\n        useWorkspaceBreakpoints(program)\n\n    //console.log(\"runner status\", status)\n\n    const handleRun = async () => {\n        try {\n            setIndeterminate(true)\n            setBreakpoint(undefined)\n            await run()\n        } finally {\n            if (mounted()) setIndeterminate(false)\n        }\n    }\n    const handleCancel = async () => {\n        try {\n            setIndeterminate(true)\n            await runner.clearBreakpointsAsync()\n            setBreakpoint(undefined)\n            await cancel()\n        } finally {\n            if (mounted()) setIndeterminate(false)\n        }\n    }\n    const handleResume = async () => {\n        try {\n            setIndeterminate(true)\n            setBreakpoint(undefined)\n            await runner.clearBreakpointsAsync()\n            await runner.resumeAsync()\n        } finally {\n            if (mounted()) setIndeterminate(false)\n        }\n    }\n    const handlePause = async () => {\n        try {\n            setIndeterminate(true)\n            await runner.setBreakpointsAsync(breakpoints)\n            await runner.resumeAsync()\n            setBreakpoint(\"\")\n        } finally {\n            if (mounted()) setIndeterminate(false)\n        }\n    }\n    const handleStep = () => runner.stepAsync()\n\n    // register breakpoint handler\n    useEffect(\n        () =>\n            runner?.subscribe(\n                VM_EVENT,\n                (code: VMCode, _?: VMHandler, sourceId?: string) => {\n                    if (code === VMCode.Breakpoint) {\n                        if (mounted()) setBreakpoint(sourceId)\n                    }\n                }\n            ),\n        [runner]\n    )\n\n    // setting blockly breakpoint\n    useEffect(() => {\n        setBreakpointHighlight(breakpoint)\n        return () => setBreakpointHighlight(undefined)\n    }, [breakpoint])\n\n    // reset breakpoint in ui when runner, paused mode changes\n    useEffect(() => setBreakpoint(undefined), [runner])\n\n    return (\n        <>\n            <Grid item>\n                <IconButtonWithTooltip\n                    title={paused ? \"resume\" : stopped ? \"start\" : \"stop\"}\n                    disabled={disabled}\n                    color={stopped ? \"primary\" : \"default\"}\n                    onClick={\n                        paused\n                            ? handleResume\n                            : stopped\n                            ? handleRun\n                            : handleCancel\n                    }\n                >\n                    {paused || stopped ? <PlayArrowIcon /> : <StopIcon />}\n                </IconButtonWithTooltip>{\" \"}\n            </Grid>\n            <Grid item>\n                <IconButtonWithProgress\n                    title={pausing ? \"cancel pause\" : paused ? \"step\" : \"pause\"}\n                    disabled={disabled}\n                    indeterminate={pausing}\n                    onClick={\n                        pausing\n                            ? handleResume\n                            : paused\n                            ? handleStep\n                            : handlePause\n                    }\n                >\n                    {paused ? <PlayForWorkIcon /> : <PauseIcon />}\n                </IconButtonWithProgress>\n            </Grid>\n            {(pausing || paused) && (\n                <Grid item>\n                    <Chip\n                        icon={<BugReportIcon />}\n                        label={pausing ? \"pausing\" : \"paused\"}\n                        color={\"secondary\"}\n                    />\n                </Grid>\n            )}\n        </>\n    )\n}\n","import React from \"react\"\nimport IconButtonWithTooltip from \"../ui/IconButtonWithTooltip\"\nimport AddIcon from \"@material-ui/icons/Add\"\nimport { useContext } from \"react\"\nimport AppContext from \"../AppContext\"\n\nexport default function VMStartSimulatorButton() {\n    const { toggleShowDeviceHostsDialog } = useContext(AppContext)\n    return (\n        <IconButtonWithTooltip\n            title=\"start simulator\"\n            onClick={toggleShowDeviceHostsDialog}\n        >\n            <AddIcon />\n        </IconButtonWithTooltip>\n    )\n}\n","import React, { useContext } from \"react\"\nimport SaveIcon from \"@material-ui/icons/Save\"\nimport { Grid, Tooltip } from \"@material-ui/core\"\nimport { IconButton, Link } from \"gatsby-theme-material-ui\"\nimport ImportButton from \"../ImportButton\"\nimport AppContext from \"../AppContext\"\nimport { Xml } from \"blockly\"\nimport VMFile from \"../../../jacdac-ts/src/vm/file\"\nimport BlockContext from \"./BlockContext\"\n\nfunction LoadButton() {\n    const { workspace } = useContext(BlockContext)\n    const { setError } = useContext(AppContext)\n    const disabled = !workspace\n\n    const handleFiles = async (files: File[]) => {\n        const file = files?.[0]\n        if (!file) return\n\n        try {\n            const text = await file.text()\n            const jsfile = JSON.parse(text) as VMFile\n            console.debug(`imported file`, jsfile)\n            const xml = jsfile?.xml\n            if (typeof xml !== \"string\") throw new Error(\"Invalid file format\")\n\n            // try loading xml into a dummy blockly workspace\n            const dom = Xml.textToDom(xml)\n\n            // all good, load in workspace\n            workspace.clear()\n            Xml.domToWorkspace(dom, workspace)\n        } catch (e) {\n            setError(e)\n        }\n    }\n    return (\n        <ImportButton\n            text=\"Open...\"\n            icon={true}\n            disabled={disabled}\n            acceptedFiles={[\"application/json\"]}\n            onFilesUploaded={handleFiles}\n            filesLimit={1}\n        />\n    )\n}\n\nfunction SaveButton() {\n    const { workspaceXml } = useContext(BlockContext)\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const json = {\n        xml: workspaceXml,\n    }\n\n    const url = `data:application/json;charset=UTF-8,${encodeURIComponent(\n        JSON.stringify(json)\n    )}`\n\n    return (\n        <Link download=\"jacdac-blocks.json\" href={url}>\n            <Tooltip title={\"Save\"}>\n                <IconButton>\n                    <SaveIcon />\n                </IconButton>\n            </Tooltip>\n        </Link>\n    )\n}\n\nexport default function BlockFileButtons() {\n    return (\n        <>\n            <Grid item>\n                <SaveButton />\n            </Grid>\n            <Grid item>\n                <LoadButton />\n            </Grid>\n        </>\n    )\n}\n","import { Grid } from \"@material-ui/core\"\nimport React from \"react\"\nimport { VMProgramRunner } from \"../../../jacdac-ts/src/vm/runner\"\nimport BlockRoles from \"../blockly/BlockRoles\"\nimport VMRunnerButtons from \"./VMRunnerButtons\"\nimport VMStartSimulatorButton from \"./VMStartSimulatorButton\"\nimport BlockFileButtons from \"../blockly/BlockFileButtons\"\n\nexport default function VMToolbar(props: {\n    runner: VMProgramRunner\n    run: () => Promise<void>\n    cancel: () => Promise<void>\n}) {\n    const { runner, run, cancel } = props\n    return (\n        <Grid\n            container\n            direction=\"row\"\n            spacing={1}\n            alignItems=\"center\"\n            alignContent=\"center\"\n        >\n            <BlockFileButtons />\n            <VMRunnerButtons runner={runner} run={run} cancel={cancel} />\n            <Grid item>\n                <VMStartSimulatorButton />\n            </Grid>\n            <BlockRoles />\n        </Grid>\n    )\n}\n","import { BlockJSON, WorkspaceJSON } from \"../blockly/jsongenerator\"\nimport {\n    VMBase,\n    VMHandler,\n    VMProgram,\n    VMRole,\n    VMIfThenElse,\n    VMError,\n} from \"../../../jacdac-ts/src/vm/ir\"\nimport { toIdentifier, RoleEvent } from \"../../../jacdac-ts/src/vm/compile\"\n\nimport { assert } from \"../../../jacdac-ts/src/jdom/utils\"\nimport {\n    BUILTIN_TYPES,\n    resolveServiceBlockDefinition,\n} from \"../blockly/toolbox\"\nimport Blockly from \"blockly\"\nimport BlockDomainSpecificLanguage from \"../blockly/dsl/dsl\"\n\nconst ops = {\n    AND: \"&&\",\n    OR: \"||\",\n    EQ: \"===\",\n    NEQ: \"!==\",\n    LT: \"<\",\n    GT: \">\",\n    LTE: \"<=\",\n    GTE: \">=\",\n    NEG: \"-\",\n    ADD: \"+\",\n    MULTIPLY: \"*\",\n    DIVIDE: \"/\",\n    MINUS: \"-\",\n}\n\nexport interface ExpressionWithErrors {\n    expr: jsep.Expression\n    errors: VMError[]\n}\n\nexport interface CmdWithErrors {\n    cmd: VMBase\n    errors: VMError[]\n}\n\nexport const makeVMBase = (block: BlockJSON, command: jsep.CallExpression) => {\n    return {\n        sourceId: block.id,\n        type: \"cmd\",\n        command,\n    } as VMBase\n}\n\nexport const processErrors = (block: BlockJSON, errors: VMError[]) => {\n    return errors.map((e: VMError) => {\n        return {\n            sourceId: e.sourceId ? e.sourceId : block.id,\n            message: e.message,\n        }\n    })\n}\n\nexport default function workspaceJSONToVMProgram(\n    workspace: WorkspaceJSON,\n    dsls: BlockDomainSpecificLanguage[]\n): VMProgram {\n    console.debug(`compile vm`, { workspace, dsls })\n\n    if (!workspace) return undefined\n\n    const roles: VMRole[] = workspace.variables\n        .filter(v => BUILTIN_TYPES.indexOf(v.type) < 0)\n        .map(v => ({ role: v.name, serviceShortId: v.type }))\n\n    class EmptyExpression extends Error {}\n\n    const blockToExpression: (\n        ev: RoleEvent,\n        block: BlockJSON\n    ) => ExpressionWithErrors = (ev: RoleEvent, blockIn: BlockJSON) => {\n        const errors: VMError[] = []\n\n        const blockToExpressionInner = (ev: RoleEvent, block: BlockJSON) => {\n            if (!block) {\n                throw new EmptyExpression()\n            }\n            const { type, value, inputs } = block\n            console.log(`block2e`, { ev, block, type, value, inputs })\n\n            if (value !== undefined)\n                // literal\n                return <jsep.Literal>{\n                    type: \"Literal\",\n                    value: value,\n                    raw: value + \"\",\n                }\n\n            switch (type) {\n                case \"math_single\": // built-in blockly\n                case \"jacdac_math_single\": {\n                    const argument = blockToExpressionInner(ev, inputs[0].child)\n                    const op = inputs[0].fields[\"op\"].value as string\n                    return <jsep.UnaryExpression>{\n                        type: \"UnaryExpression\",\n                        operator: ops[op] || op,\n                        argument,\n                        prefix: false, // TODO:?\n                    }\n                }\n                case \"math_arithmetic\": // built-in blockly\n                case \"jacdac_math_arithmetic\": {\n                    const left = blockToExpressionInner(ev, inputs[0].child)\n                    const right = blockToExpressionInner(ev, inputs[1].child)\n                    const op = inputs[1].fields[\"op\"].value as string\n                    return <jsep.BinaryExpression>{\n                        type: \"BinaryExpression\",\n                        operator: ops[op] || op,\n                        left,\n                        right,\n                    }\n                }\n                case \"logic_operation\": {\n                    const left = blockToExpressionInner(ev, inputs[0].child)\n                    const right = blockToExpressionInner(ev, inputs[1].child)\n                    const op = inputs[1].fields[\"op\"].value as string\n                    return <jsep.LogicalExpression>{\n                        type: \"LogicalExpression\",\n                        operator: ops[op] || op,\n                        left,\n                        right,\n                    }\n                }\n                case \"logic_negate\": {\n                    const argument = blockToExpressionInner(ev, inputs[0].child)\n                    return <jsep.UnaryExpression>{\n                        type: \"UnaryExpression\",\n                        operator: \"!\",\n                        argument,\n                        prefix: false, // TODO:?\n                    }\n                }\n                case \"logic_compare\": {\n                    const left = blockToExpressionInner(ev, inputs[0].child)\n                    const right = blockToExpressionInner(ev, inputs[1].child)\n                    const op = inputs[1].fields[\"op\"].value as string\n                    return <jsep.BinaryExpression>{\n                        type: \"BinaryExpression\",\n                        operator: ops[op] || op,\n                        left,\n                        right,\n                    }\n                }\n                default: {\n                    const definition = resolveServiceBlockDefinition(type)\n                    if (!definition) {\n                        console.warn(`unknown block ${type}`, {\n                            type,\n                            ev,\n                            block,\n                            d: Blockly.Blocks[type],\n                        })\n                    } else {\n                        // try any DSL\n                        const { dsl: dslName } = definition\n                        const dsl = dsls.find(d => d.id === dslName)\n                        const res = dsl?.compileExpressionToVM?.({\n                            event: ev,\n                            definition,\n                            block,\n                            blockToExpressionInner,\n                        })\n                        if (res) {\n                            if (res.errors)\n                                res.errors.forEach(e => errors.push(e))\n                            return res.expr\n                        }\n\n                        const { template } = definition\n                        switch (template) {\n                            case \"shadow\": {\n                                const field = inputs[0].fields[\"value\"]\n                                const v = field.value\n                                return <jsep.Literal>{\n                                    type: \"Literal\",\n                                    value: v,\n                                    raw: v + \"\",\n                                }\n                            }\n                            default: {\n                                console.warn(\n                                    `unsupported block template ${template} for ${type}`,\n                                    { ev, block }\n                                )\n                                break\n                            }\n                        }\n                        break\n                    }\n                }\n            }\n            throw new EmptyExpression()\n        }\n        return {\n            expr: blockToExpressionInner(ev, blockIn),\n            errors,\n        }\n    }\n\n    const blockToCommand = (\n        event: RoleEvent,\n        block: BlockJSON\n    ): CmdWithErrors => {\n        const { type, inputs } = block\n        console.debug(`block2c`, { event, type, block, inputs })\n        switch (type) {\n            case \"dynamic_if\": {\n                const thenHandler: VMHandler = {\n                    commands: [],\n                    errors: [],\n                }\n                const elseHandler: VMHandler = {\n                    commands: [],\n                    errors: [],\n                }\n                const t = inputs[1]?.child\n                const e = inputs[2]?.child\n                if (t) {\n                    addCommands(\n                        event,\n                        [t, ...(t.children ? t.children : [])],\n                        thenHandler\n                    )\n                }\n                if (e) {\n                    addCommands(\n                        event,\n                        [e, ...(e.children ? e.children : [])],\n                        elseHandler\n                    )\n                }\n                let exprErrors: ExpressionWithErrors = undefined\n                try {\n                    exprErrors = blockToExpression(event, inputs[0]?.child)\n                } catch (e) {\n                    if (e instanceof EmptyExpression) {\n                        exprErrors = {\n                            expr: {\n                                type: \"Literal\",\n                                value: false,\n                                raw: \"false \",\n                            } as jsep.Literal,\n                            errors: [],\n                        }\n                    } else {\n                        throw e\n                    }\n                }\n                const { expr, errors } = exprErrors\n\n                const ifThenElse: VMIfThenElse = {\n                    sourceId: block.id,\n                    type: \"ite\",\n                    expr,\n                    then: thenHandler.commands,\n                    else: elseHandler.commands,\n                }\n                return {\n                    cmd: ifThenElse,\n                    errors: processErrors(\n                        block,\n                        errors\n                            .concat(thenHandler.errors)\n                            .concat(elseHandler.errors)\n                    ),\n                }\n            }\n            // more builts\n            default: {\n                const definition = resolveServiceBlockDefinition(type)\n                if (definition) {\n                    const { dsl: dslName } = definition\n                    const dsl = dsls.find(dsl => dsl.id === dslName)\n                    const dslRes = dsl?.compileCommandToVM?.({\n                        event,\n                        block,\n                        definition,\n                        blockToExpression,\n                    })\n                    if (dslRes) {\n                        dslRes.errors = processErrors(block, dslRes.errors)\n                        return dslRes\n                    }\n\n                    console.warn(`unsupported block ${type}`, { block })\n                    return {\n                        cmd: undefined,\n                        errors: [],\n                    }\n                }\n            }\n        }\n    }\n\n    const nop = {\n        type: \"CallExpression\",\n        arguments: [],\n        callee: toIdentifier(\"nop\"),\n    } as jsep.CallExpression\n\n    const addCommands = (\n        event: RoleEvent,\n        blocks: BlockJSON[],\n        handler: VMHandler\n    ) => {\n        blocks?.forEach(child => {\n            if (child) {\n                try {\n                    const { cmd, errors } = blockToCommand(event, child)\n                    if (cmd) handler.commands.push(cmd)\n                    errors.forEach(e => handler.errors.push(e))\n                } catch (e) {\n                    if (e instanceof EmptyExpression) {\n                        handler.commands.push({\n                            sourceId: child.id,\n                            type: \"cmd\",\n                            command: nop,\n                        } as VMBase)\n                    } else {\n                        console.debug(e)\n                    }\n                }\n            }\n        })\n    }\n\n    const handlers: VMHandler[] = workspace.blocks\n        .map(top => {\n            const { type } = top\n            let command: jsep.CallExpression\n            let topEvent: RoleEvent\n            let topErrors: VMError[]\n            let topMeta = false\n            const definition = resolveServiceBlockDefinition(type)\n            assert(!!definition)\n            const { template, dsl: dslName } = definition\n            const dsl = dslName && dsls?.find(d => d.id === dslName)\n\n            try {\n                const { expression, errors, event, meta } =\n                    dsl?.compileEventToVM?.({\n                        block: top,\n                        definition,\n                        blockToExpression,\n                    }) || {}\n                command = expression as jsep.CallExpression\n                topErrors = errors\n                topEvent = event\n                topMeta = meta\n\n                // if dsl didn't compile anything try again\n                if (!command && !topErrors?.length) {\n                    switch (template) {\n                        case \"meta\": {\n                            break\n                        }\n                        default: {\n                            console.warn(\n                                `unsupported handler template ${template} for ${type}`,\n                                { top }\n                            )\n                            break\n                        }\n                    }\n                }\n            } catch (e) {\n                console.debug(e)\n                if (e instanceof EmptyExpression) {\n                    return undefined\n                } else {\n                    throw e\n                }\n            }\n\n            // nothing to compile here\n            if (!command && !topErrors?.length) return undefined\n\n            const handler: VMHandler = {\n                commands: [\n                    {\n                        sourceId: top.id,\n                        type: \"cmd\",\n                        command,\n                    } as VMBase,\n                ],\n                errors: topErrors || [],\n                meta: !!topMeta,\n            }\n\n            addCommands(topEvent, top.children, handler)\n            return handler\n        })\n        .filter(handler => !!handler)\n\n    return {\n        roles,\n        handlers,\n    }\n}\n","import { Theme } from \"@material-ui/core\"\nimport { withPrefix } from \"gatsby\"\nimport {\n    humanify,\n    isNumericType,\n} from \"../../../../jacdac-ts/jacdac-spec/spectool/jdspec\"\nimport {\n    BuzzerCmd,\n    JoystickReg,\n    ServoReg,\n    SRV_BOOTLOADER,\n    SRV_BUZZER,\n    SRV_CONTROL,\n    SRV_HID_KEYBOARD,\n    SRV_JOYSTICK,\n    SRV_LED,\n    SRV_LED_MATRIX,\n    SRV_LOGGER,\n    SRV_PROTO_TEST,\n    SRV_ROLE_MANAGER,\n    SRV_SERVO,\n    SRV_SETTINGS,\n    SRV_SEVEN_SEGMENT_DISPLAY,\n    SystemEvent,\n    SystemReg,\n} from \"../../../../jacdac-ts/src/jdom/constants\"\nimport Flags from \"../../../../jacdac-ts/src/jdom/flags\"\nimport {\n    isCommand,\n    isEvent,\n    isRegister,\n    isSensor,\n    serviceSpecificationFromName,\n    serviceSpecifications,\n} from \"../../../../jacdac-ts/src/jdom/spec\"\nimport {\n    arrayConcatMany,\n    splitFilter,\n    toMap,\n    uniqueMap,\n} from \"../../../../jacdac-ts/src/jdom/utils\"\nimport {\n    toIdentifier,\n    toMemberExpression,\n} from \"../../../../jacdac-ts/src/vm/compile\"\nimport { VMError } from \"../../../../jacdac-ts/src/vm/ir\"\nimport KeyboardKeyField from \"../fields/KeyboardKeyField\"\nimport LEDColorField from \"../fields/LEDColorField\"\nimport LEDMatrixField from \"../fields/LEDMatrixField\"\nimport NoteField from \"../fields/NoteField\"\nimport ServoAngleField from \"../fields/ServoAngleField\"\nimport {\n    BlockDefinition,\n    BlockReference,\n    CategoryDefinition,\n    CODE_STATEMENT_TYPE,\n    CommandBlockDefinition,\n    CONNECTED_BLOCK,\n    CONNECTION_BLOCK,\n    CustomBlockDefinition,\n    EventBlockDefinition,\n    EventFieldDefinition,\n    InputDefinition,\n    OptionsInputDefinition,\n    RegisterBlockDefinition,\n    resolveServiceBlockDefinition,\n    SeparatorDefinition,\n    ServiceBlockDefinition,\n    SET_STATUS_LIGHT_BLOCK,\n    ValueInputDefinition,\n    VariableInputDefinition,\n} from \"../toolbox\"\nimport { ExpressionWithErrors, makeVMBase } from \"../../vm/VMgenerator\"\nimport BlockDomainSpecificLanguage, {\n    CompileCommandToVMOptions,\n    CompileEventToVMOptions,\n    CompileEventToVMResult,\n    CompileExpressionToVMOptions,\n    CreateBlocksOptions,\n    CreateCategoryOptions,\n} from \"./dsl\"\n\nfunction isBooleanField(field: jdspec.PacketMember) {\n    return field.type === \"bool\"\n}\nfunction isStringField(field: jdspec.PacketMember) {\n    return field.type === \"string\"\n}\nfunction toBlocklyType(field: jdspec.PacketMember) {\n    return isBooleanField(field)\n        ? \"Boolean\"\n        : isStringField(field)\n        ? \"String\"\n        : isNumericType(field)\n        ? \"Number\"\n        : undefined\n}\nfunction enumInfo(srv: jdspec.ServiceSpec, field: jdspec.PacketMember) {\n    const e = srv.enums?.[field.type]\n    return e\n}\n\nconst ignoredServices = [\n    SRV_CONTROL,\n    SRV_LOGGER,\n    SRV_ROLE_MANAGER,\n    SRV_PROTO_TEST,\n    SRV_SETTINGS,\n    SRV_BOOTLOADER,\n]\nconst ignoredEvents = [SystemEvent.StatusCodeChanged]\nconst includedRegisters = [\n    SystemReg.Reading,\n    SystemReg.Value,\n    SystemReg.Intensity,\n]\n\nconst customMessages = [\n    {\n        service: SRV_JOYSTICK,\n        register: JoystickReg.Direction,\n        field: \"buttons\",\n        get: \"is %1 %2 pressed\",\n    },\n]\n\nconst commandColor = \"#8c6a1d\"\n\nexport class ServicesBlockDomainSpecificLanguage\n    implements BlockDomainSpecificLanguage\n{\n    id = \"jacdacServices\"\n    supportedServices: jdspec.ServiceSpec[] = []\n    private _serviceBlocks: ServiceBlockDefinition[]\n    private _eventFieldBlocks: EventFieldDefinition[]\n    private _runtimeBlocks: BlockDefinition[]\n\n    private createServiceColor(theme: Theme) {\n        const sensorColor = theme.palette.success.main\n        const otherColor = theme.palette.info.main\n        const serviceColor = (srv: jdspec.ServiceSpec) =>\n            isSensor(srv) ? sensorColor : otherColor\n        return serviceColor\n    }\n\n    createBlocks(options: CreateBlocksOptions) {\n        const { theme } = options\n        const serviceColor = this.createServiceColor(theme)\n        // blocks\n        const customShadows = [\n            {\n                serviceClass: SRV_SERVO,\n                kind: \"rw\",\n                identifier: ServoReg.Angle,\n                field: \"_\",\n                shadow: <BlockDefinition>{\n                    kind: \"block\",\n                    type: ServoAngleField.SHADOW.type,\n                },\n            },\n            {\n                serviceClass: SRV_BUZZER,\n                kind: \"command\",\n                identifier: BuzzerCmd.PlayNote,\n                field: \"frequency\",\n                shadow: <BlockDefinition>{\n                    kind: \"block\",\n                    type: NoteField.SHADOW.type,\n                },\n            },\n        ]\n        const lookupCustomShadow = (\n            service: jdspec.ServiceSpec,\n            info: jdspec.PacketInfo,\n            field: jdspec.PacketMember\n        ) =>\n            customShadows.find(\n                cs =>\n                    cs.serviceClass === service.classIdentifier &&\n                    cs.kind == info.kind &&\n                    cs.identifier === info.identifier &&\n                    cs.field == field.name\n            )?.shadow\n\n        const serviceHelp = (service: jdspec.ServiceSpec) =>\n            withPrefix(`/services/${service.shortId}`)\n        const fieldsSupported = (pkt: jdspec.PacketInfo) =>\n            pkt.fields.every(toBlocklyType)\n        const fieldName = (\n            reg: jdspec.PacketInfo,\n            field: jdspec.PacketMember\n        ) => (field.name === \"_\" ? reg.name : field.name)\n        const fieldToShadow = (\n            service: jdspec.ServiceSpec,\n            info: jdspec.PacketInfo,\n            field: jdspec.PacketMember\n        ): BlockReference =>\n            lookupCustomShadow(service, info, field) ||\n            (isBooleanField(field)\n                ? { kind: \"block\", type: \"jacdac_on_off\" }\n                : isStringField(field)\n                ? { kind: \"block\", type: \"text\" }\n                : field.unit === \"°\"\n                ? {\n                      kind: \"block\",\n                      type: \"jacdac_angle\",\n                  }\n                : field.unit === \"/\"\n                ? { kind: \"block\", type: \"jacdac_ratio\" }\n                : /^%/.test(field.unit)\n                ? { kind: \"block\", type: \"jacdac_percent\" }\n                : field.type === \"u8\"\n                ? { kind: \"block\", type: \"jacdac_byte\" }\n                : {\n                      kind: \"block\",\n                      type: \"math_number\",\n                      value: field.defaultValue || 0,\n                      min: field.typicalMin || field.absoluteMin,\n                      max: field.typicalMax || field.absoluteMax,\n                  })\n        const variableName = (srv: jdspec.ServiceSpec) =>\n            `${humanify(srv.camelName).toLowerCase()} 1`\n        const fieldVariable = (\n            service: jdspec.ServiceSpec\n        ): VariableInputDefinition => ({\n            type: \"field_variable\",\n            name: \"role\",\n            variable: variableName(service),\n            variableTypes: [service.shortId],\n            defaultType: service.shortId,\n        })\n        const fieldsToFieldInputs = (info: jdspec.PacketInfo) =>\n            info.fields.map(field => ({\n                type: \"input_value\",\n                name: fieldName(info, field),\n                check: toBlocklyType(field),\n            }))\n        const fieldsToValues = (\n            service: jdspec.ServiceSpec,\n            info: jdspec.PacketInfo\n        ) =>\n            toMap<jdspec.PacketMember, BlockReference | BlockDefinition>(\n                info.fields,\n                field => fieldName(info, field),\n                field => fieldToShadow(service, info, field)\n            )\n        const fieldsToMessage = (info: jdspec.PacketInfo) =>\n            info.fields\n                .map((field, i) => `${humanify(field.name)} %${2 + i}`)\n                .join(\" \")\n        const isEnabledRegister = (info: jdspec.PacketInfo) =>\n            info.fields.length === 1 &&\n            info.fields[0].type === \"bool\" &&\n            info.name === \"enabled\"\n        const customMessage = (\n            srv: jdspec.ServiceSpec,\n            reg: jdspec.PacketInfo,\n            field: jdspec.PacketMember\n        ) =>\n            customMessages.find(\n                m =>\n                    m.service === srv.classIdentifier &&\n                    m.register === reg.identifier &&\n                    m.field === field.name\n            )\n\n        const allServices = serviceSpecifications()\n        this.supportedServices = allServices\n            .filter(\n                service =>\n                    !/^_/.test(service.shortId) &&\n                    service.status !== \"deprecated\"\n            )\n            .filter(\n                service => ignoredServices.indexOf(service.classIdentifier) < 0\n            )\n        const resolveService = (cls: number): jdspec.ServiceSpec[] =>\n            allServices.filter(srv => srv.classIdentifier === cls)\n        const registers = arrayConcatMany(\n            this.supportedServices.map(service =>\n                service.packets\n                    .filter(\n                        pkt =>\n                            isRegister(pkt) &&\n                            !pkt.lowLevel &&\n                            includedRegisters.indexOf(pkt.identifier) > -1\n                    )\n                    .map(register => ({\n                        service,\n                        register,\n                    }))\n            )\n        )\n        const events = this.supportedServices\n            .map(service => ({\n                service,\n                events: service.packets.filter(\n                    pkt =>\n                        isEvent(pkt) &&\n                        !pkt.lowLevel &&\n                        ignoredEvents.indexOf(pkt.identifier) < 0\n                ),\n            }))\n            .filter(kv => !!kv.events.length)\n        const commands = arrayConcatMany(\n            this.supportedServices.map(service =>\n                service.packets\n                    .filter(\n                        pkt =>\n                            isCommand(pkt) &&\n                            !pkt.lowLevel &&\n                            fieldsSupported(pkt)\n                    )\n                    .map(pkt => ({\n                        service,\n                        command: pkt,\n                    }))\n            )\n        )\n\n        const customBlockDefinitions: CustomBlockDefinition[] = [\n            ...resolveService(SRV_HID_KEYBOARD).map(\n                service =>\n                    <CustomBlockDefinition>{\n                        kind: \"block\",\n                        type: `key`,\n                        message0: `send %1 key %2`,\n                        args0: [\n                            fieldVariable(service),\n                            {\n                                type: KeyboardKeyField.KEY,\n                                name: \"combo\",\n                            },\n                        ],\n                        colour: serviceColor(service),\n                        inputsInline: true,\n                        previousStatement: CODE_STATEMENT_TYPE,\n                        nextStatement: CODE_STATEMENT_TYPE,\n                        tooltip: `Send a keyboard key combo`,\n                        helpUrl: serviceHelp(service),\n                        service,\n                        expression: `role.key(combo.selectors, combo.modifiers)`,\n                        template: \"custom\",\n                    }\n            ),\n            ...resolveService(SRV_LED).map(\n                service =>\n                    <CustomBlockDefinition>{\n                        kind: \"block\",\n                        type: `fade`,\n                        message0: `fade %1 to %2 at speed %3`,\n                        args0: [\n                            fieldVariable(service),\n                            {\n                                type: \"input_value\",\n                                name: \"color\",\n                                check: \"Number\",\n                            },\n                            {\n                                type: \"input_value\",\n                                name: \"speed\",\n                                check: \"Number\",\n                            },\n                        ],\n                        values: {\n                            color: {\n                                kind: \"block\",\n                                type: LEDColorField.SHADOW.type,\n                            },\n                            speed: {\n                                kind: \"block\",\n                                type: \"jacdac_ratio\",\n                                shadow: true,\n                            },\n                        },\n                        colour: serviceColor(service),\n                        inputsInline: true,\n                        previousStatement: CODE_STATEMENT_TYPE,\n                        nextStatement: CODE_STATEMENT_TYPE,\n                        tooltip: `Fade LED color`,\n                        helpUrl: serviceHelp(service),\n                        service,\n                        expression: `role.animate((color >> 16) & 0xff, (color >> 8) & 0xff, (color >> 0) & 0xff, speed * 0xff)`,\n                        template: \"custom\",\n                    }\n            ),\n            ...resolveService(SRV_SEVEN_SEGMENT_DISPLAY).map(\n                service =>\n                    <CustomBlockDefinition>{\n                        kind: \"block\",\n                        type: `set_digits`,\n                        message0: `set %1 digits to %2`,\n                        args0: [\n                            fieldVariable(service),\n                            {\n                                type: \"input_value\",\n                                name: \"digits\",\n                                check: \"Number\",\n                            },\n                        ],\n                        values: {\n                            digits: {\n                                kind: \"block\",\n                                type: \"math_number\",\n                            },\n                        },\n                        colour: serviceColor(service),\n                        inputsInline: true,\n                        previousStatement: CODE_STATEMENT_TYPE,\n                        nextStatement: CODE_STATEMENT_TYPE,\n                        tooltip: `Display a number of the screen`,\n                        helpUrl: serviceHelp(service),\n                        service,\n                        // encode digits\n                        template: \"custom\",\n                    }\n            ),\n            ...resolveService(SRV_LED_MATRIX).map(\n                service =>\n                    <CustomBlockDefinition>{\n                        kind: \"block\",\n                        type: `show_leds`,\n                        message0: `show %1 leds %2`,\n                        args0: [\n                            fieldVariable(service),\n                            {\n                                type: LEDMatrixField.KEY,\n                                name: \"leds\",\n                            },\n                        ],\n                        colour: serviceColor(service),\n                        inputsInline: true,\n                        previousStatement: CODE_STATEMENT_TYPE,\n                        nextStatement: CODE_STATEMENT_TYPE,\n                        tooltip: `Display LEDs on the LED matrix`,\n                        helpUrl: serviceHelp(service),\n                        service,\n                        // encode digits\n                        template: \"custom\",\n                    }\n            ),\n        ].map(def => {\n            def.type = `jacdac_custom_${def.service.shortId.toLowerCase()}_${\n                def.type\n            }`\n            return def\n        })\n\n        const eventBlocks = events.map<EventBlockDefinition>(\n            ({ service, events }) => ({\n                kind: \"block\",\n                type: `jacdac_events_${service.shortId}`,\n                message0: `on %1 %2`,\n                args0: [\n                    fieldVariable(service),\n                    <InputDefinition>{\n                        type: \"field_dropdown\",\n                        name: \"event\",\n                        options: events.map(event => [\n                            humanify(event.name),\n                            event.name,\n                        ]),\n                    },\n                ],\n                colour: serviceColor(service),\n                inputsInline: true,\n                nextStatement: CODE_STATEMENT_TYPE,\n                tooltip: `Events for the ${service.name} service`,\n                helpUrl: serviceHelp(service),\n                service,\n                events,\n                template: \"event\",\n            })\n        )\n\n        const registerChangeByEventBlocks = registers\n            .filter(\n                ({ service }) =>\n                    !service.packets.some(\n                        pkt =>\n                            isEvent(pkt) &&\n                            ignoredEvents.indexOf(pkt.identifier) < 0\n                    )\n            )\n            .filter(\n                ({ register }) =>\n                    register.fields.length === 1 &&\n                    isNumericType(register.fields[0]) &&\n                    register.identifier !== SystemReg.Intensity\n            )\n            .map<RegisterBlockDefinition>(({ service, register }) => ({\n                kind: \"block\",\n                type: `jacdac_change_by_events_${service.shortId}_${register.name}`,\n                message0: `on %1 ${humanify(register.name)} change by %2`,\n                args0: [\n                    fieldVariable(service),\n                    ...fieldsToFieldInputs(register),\n                ].filter(v => !!v),\n                values: fieldsToValues(service, register),\n                inputsInline: true,\n                nextStatement: CODE_STATEMENT_TYPE,\n                colour: serviceColor(service),\n                tooltip: `Event raised when ${register.name} changes`,\n                helpUrl: serviceHelp(service),\n                service,\n                register,\n\n                template: \"register_change_event\",\n            }))\n\n        const [registerSimples, registerComposites] = splitFilter(\n            registers,\n            reg => reg.register.fields.length == 1\n        )\n        const [registerSimpleTypes, registerSimpleOthers] = splitFilter(\n            registerSimples,\n            ({ register }) => !!toBlocklyType(register.fields[0])\n        )\n        const registerSimplesGetBlocks =\n            registerSimpleTypes.map<RegisterBlockDefinition>(\n                ({ service, register }) => ({\n                    kind: \"block\",\n                    type: `jacdac_get_simple_${service.shortId}_${register.name}`,\n                    message0:\n                        customMessage(service, register, register.fields[0])\n                            ?.get || `%1 ${humanify(register.name)}`,\n                    args0: [fieldVariable(service)],\n                    inputsInline: true,\n                    output: toBlocklyType(register.fields[0]),\n                    colour: serviceColor(service),\n                    tooltip: register.description,\n                    helpUrl: serviceHelp(service),\n                    service,\n                    register,\n                    field: register.fields[0],\n\n                    template: \"register_get\",\n                })\n            )\n        const registerSimpleEnumTypes = registerSimpleOthers\n            .filter(\n                ({ service, register }) =>\n                    !!enumInfo(service, register.fields[0])\n            )\n            .map(({ service, register }) => ({\n                service,\n                register,\n                field: register.fields[0],\n                einfo: enumInfo(service, register.fields[0]),\n            }))\n        const registerCompositeEnumTypes = arrayConcatMany(\n            registerComposites.map(({ service, register }) =>\n                register.fields\n                    .map(field => ({\n                        service,\n                        register,\n                        field,\n                        einfo: enumInfo(service, field),\n                    }))\n                    .filter(({ einfo }) => !!einfo)\n            )\n        )\n        const registerEnumGetBlocks = [\n            ...registerSimpleEnumTypes,\n            ...registerCompositeEnumTypes,\n        ].map<RegisterBlockDefinition>(\n            ({ service, register, field, einfo }) => ({\n                kind: \"block\",\n                type: `jacdac_get_enum_${service.shortId}_${register.name}_${field.name}`,\n                message0:\n                    customMessage(service, register, field)?.get ||\n                    `%1 ${humanify(register.name)}${\n                        field.name === \"_\" ? \"\" : ` ${field.name}`\n                    } %2`,\n                args0: [\n                    fieldVariable(service),\n                    <OptionsInputDefinition>{\n                        type: \"field_dropdown\",\n                        name: field.name,\n                        options: Object.keys(einfo.members).map(member => [\n                            humanify(member),\n                            member,\n                        ]),\n                    },\n                ],\n                inputsInline: true,\n                output: \"Boolean\",\n                colour: serviceColor(service),\n                tooltip: register.description,\n                helpUrl: serviceHelp(service),\n                service,\n                register,\n                field,\n\n                template: \"register_get\",\n            })\n        )\n\n        const registerNumericsGetBlocks = registerComposites\n            .filter(re => re.register.fields.some(isNumericType))\n            .map<RegisterBlockDefinition>(({ service, register }) => ({\n                kind: \"block\",\n                type: `jacdac_get_numerics_${service.shortId}_${register.name}`,\n                message0: `%1 ${humanify(register.name)}${\n                    register.fields.length > 1 ? ` %2` : \"\"\n                }`,\n                args0: [\n                    fieldVariable(service),\n                    register.fields.length > 1\n                        ? <OptionsInputDefinition>{\n                              type: \"field_dropdown\",\n                              name: \"field\",\n                              options: register.fields\n                                  .filter(f => isNumericType(f))\n                                  .map(field => [\n                                      humanify(field.name),\n                                      fieldName(register, field),\n                                  ]),\n                          }\n                        : undefined,\n                ].filter(v => !!v),\n                inputsInline: true,\n                output: \"Number\",\n                colour: serviceColor(service),\n                tooltip: register.description,\n                helpUrl: serviceHelp(service),\n                service,\n                register,\n\n                template: \"register_get\",\n            }))\n\n        const registerSetBlocks = registers\n            .filter(({ register }) => register.kind === \"rw\")\n            .filter(({ register }) => fieldsSupported(register))\n            .map<RegisterBlockDefinition>(({ service, register }) => ({\n                kind: \"block\",\n                type: `jacdac_set_${service.shortId}_${register.name}`,\n                message0: isEnabledRegister(register)\n                    ? `set %1 %2`\n                    : `set %1 ${register.name} to ${\n                          register.fields.length === 1\n                              ? \"%2\"\n                              : fieldsToMessage(register)\n                      }`,\n                args0: [\n                    fieldVariable(service),\n                    ...fieldsToFieldInputs(register),\n                ],\n                values: fieldsToValues(service, register),\n                inputsInline: true,\n                colour: serviceColor(service),\n                tooltip: register.description,\n                helpUrl: serviceHelp(service),\n                service,\n                register,\n                previousStatement: CODE_STATEMENT_TYPE,\n                nextStatement: CODE_STATEMENT_TYPE,\n\n                template: \"register_set\",\n            }))\n\n        const commandBlocks = commands.map<CommandBlockDefinition>(\n            ({ service, command }) => ({\n                kind: \"block\",\n                type: `jacdac_command_${service.shortId}_${command.name}`,\n                message0: !command.fields.length\n                    ? `${humanify(command.name)} %1`\n                    : `${humanify(command.name)} %1 with ${fieldsToMessage(\n                          command\n                      )}`,\n                args0: [\n                    fieldVariable(service),\n                    ...fieldsToFieldInputs(command),\n                ],\n                values: fieldsToValues(service, command),\n                inputsInline: true,\n                colour: serviceColor(service),\n                tooltip: command.description,\n                helpUrl: serviceHelp(service),\n                service,\n                command,\n                previousStatement: CODE_STATEMENT_TYPE,\n                nextStatement: CODE_STATEMENT_TYPE,\n\n                template: \"command\",\n            })\n        )\n\n        this._serviceBlocks = [\n            ...eventBlocks,\n            ...registerChangeByEventBlocks,\n            ...registerSimplesGetBlocks,\n            ...registerEnumGetBlocks,\n            ...registerNumericsGetBlocks,\n            ...registerSetBlocks,\n            ...customBlockDefinitions,\n            ...commandBlocks,\n        ]\n\n        // generate accessor blocks for event data with numbers\n        this._eventFieldBlocks = arrayConcatMany(\n            events.map(({ service, events }) =>\n                events\n                    .filter(\n                        event => event.fields.filter(isNumericType).length > 0\n                    )\n                    .map(event => ({ service, event }))\n                    .map(\n                        ({ service, event }) =>\n                            <EventFieldDefinition>{\n                                kind: \"block\",\n                                type: `jacdac_event_field_${service.shortId}_${event.name}`,\n                                message0: `${event.name} %1`,\n                                args0: [\n                                    <InputDefinition>{\n                                        type: \"field_dropdown\",\n                                        name: \"field\",\n                                        options: event.fields.map(field => [\n                                            humanify(field.name),\n                                            field.name,\n                                        ]),\n                                    },\n                                ],\n                                colour: serviceColor(service),\n                                inputsInline: true,\n                                tooltip: `Data fields of the ${event.name} event`,\n                                helpUrl: serviceHelp(service),\n                                service,\n                                event,\n                                output: \"Number\",\n                                template: \"event_field\",\n                            }\n                    )\n            )\n        )\n\n        this._runtimeBlocks = [\n            {\n                kind: \"block\",\n                type: CONNECTION_BLOCK,\n                message0: \"on %1 %2\",\n                args0: [\n                    <VariableInputDefinition>{\n                        type: \"field_variable\",\n                        name: \"role\",\n                        variable: \"any\",\n                        variableTypes: [\n                            \"client\",\n                            ...this.supportedServices.map(\n                                service => service.shortId\n                            ),\n                        ],\n                        defaultType: \"client\",\n                    },\n                    <OptionsInputDefinition>{\n                        type: \"field_dropdown\",\n                        name: \"event\",\n                        options: [\n                            [\"connected\", \"connected\"],\n                            [\"disconnected\", \"disconnected\"],\n                        ],\n                    },\n                ],\n                inputsInline: true,\n                nextStatement: CODE_STATEMENT_TYPE,\n                colour: commandColor,\n                tooltip: \"Runs code when a role is connected or disconnected\",\n                helpUrl: \"\",\n                template: \"connection\",\n            },\n            {\n                kind: \"block\",\n                type: CONNECTED_BLOCK,\n                message0: \"%1 connected\",\n                args0: [\n                    <VariableInputDefinition>{\n                        type: \"field_variable\",\n                        name: \"role\",\n                        variable: \"any\",\n                        variableTypes: [\n                            \"client\",\n                            ...this.supportedServices.map(\n                                service => service.shortId\n                            ),\n                        ],\n                        defaultType: \"client\",\n                    },\n                ],\n                output: \"Boolean\",\n                inputsInline: true,\n                colour: commandColor,\n                tooltip: \"Runs code when a role is connected or disconnected\",\n                helpUrl: \"\",\n                template: \"connected\",\n            },\n            {\n                kind: \"block\",\n                type: SET_STATUS_LIGHT_BLOCK,\n                message0: \"set %1 status light to %2\",\n                args0: [\n                    <VariableInputDefinition>{\n                        type: \"field_variable\",\n                        name: \"role\",\n                        variable: \"all\",\n                        variableTypes: [\n                            \"client\",\n                            ...this.supportedServices.map(\n                                service => service.shortId\n                            ),\n                        ],\n                        defaultType: \"client\",\n                    },\n                    <ValueInputDefinition>{\n                        type: \"input_value\",\n                        name: \"color\",\n                        check: \"Number\",\n                    },\n                ],\n                values: {\n                    color: {\n                        kind: \"block\",\n                        type: LEDColorField.SHADOW.type,\n                    },\n                },\n                inputsInline: true,\n                previousStatement: CODE_STATEMENT_TYPE,\n                nextStatement: CODE_STATEMENT_TYPE,\n                colour: commandColor,\n                tooltip: \"Sets the color on the status light\",\n                helpUrl: \"\",\n            },\n        ]\n\n        return [\n            ...this._serviceBlocks,\n            ...this._eventFieldBlocks,\n            ...this._runtimeBlocks,\n        ]\n    }\n\n    createCategory(options: CreateCategoryOptions) {\n        const { theme, source, liveServices } = options\n        const serviceColor = this.createServiceColor(theme)\n\n        const blockServices =\n            source?.variables\n                .map(v => v.type)\n                .filter(type => !!serviceSpecificationFromName(type)) || []\n        const usedEvents: Set<jdspec.PacketInfo> = new Set(\n            source?.blocks\n                ?.map(block => ({\n                    block,\n                    definition: resolveServiceBlockDefinition(block.type),\n                }))\n                .filter(({ definition }) => definition.template === \"event\")\n                .map(({ block, definition }) => {\n                    const eventName = block.inputs[0].fields[\"event\"]\n                        .value as string\n                    return (definition as EventBlockDefinition).events.find(\n                        ev => ev.name === eventName\n                    )\n                })\n                .filter(ev => !!ev)\n        )\n        const jdBlocks = this._serviceBlocks.filter(block => !!block.service)\n        const services = uniqueMap(\n            jdBlocks,\n            block => block.service.shortId,\n            block => block.service\n        )\n\n        const toolboxServices: jdspec.ServiceSpec[] = uniqueMap(\n            Flags.diagnostics\n                ? services\n                : [\n                      ...blockServices\n                          .map(srvid =>\n                              services.find(\n                                  service => service.shortId === srvid\n                              )\n                          )\n                          .filter(srv => !!srv),\n                      ...liveServices.map(srv => srv.specification),\n                  ],\n            srv => srv.shortId,\n            srv => srv\n        )\n            .filter(\n                srv => srv && ignoredServices.indexOf(srv.classIdentifier) < 0\n            )\n            .sort((l, r) => l.name.localeCompare(r.name))\n\n        const servicesCategories: CategoryDefinition[] = toolboxServices\n            .map(service => ({\n                service,\n                serviceBlocks: this._serviceBlocks.filter(\n                    block => block.service === service\n                ),\n            }))\n            .map<CategoryDefinition>(({ service, serviceBlocks }) => ({\n                kind: \"category\",\n                name: service.name,\n                colour: serviceColor(service),\n                contents: [\n                    ...serviceBlocks.map<BlockDefinition>(block => ({\n                        kind: \"block\",\n                        type: block.type,\n                        values: block.values,\n                    })),\n                    ...this._eventFieldBlocks\n                        .filter(\n                            ev =>\n                                ev.service === service &&\n                                usedEvents.has(ev.event)\n                        )\n                        .map<BlockDefinition>(block => ({\n                            kind: \"block\",\n                            type: block.type,\n                            values: block.values,\n                        })),\n                ],\n                button: {\n                    kind: \"button\",\n                    text: `Add ${service.name} role`,\n                    callbackKey: `jacdac_add_role_callback_${service.shortId}`,\n                    service,\n                },\n            }))\n            .filter(cat => !!cat.contents?.length)\n\n        const commonCategory: CategoryDefinition = {\n            kind: \"category\",\n            name: \"Services\",\n            colour: commandColor,\n            contents: [\n                <BlockDefinition>{\n                    kind: \"block\",\n                    type: CONNECTION_BLOCK,\n                },\n                <BlockDefinition>{\n                    kind: \"block\",\n                    type: CONNECTED_BLOCK,\n                },\n                <BlockDefinition>{\n                    kind: \"block\",\n                    type: SET_STATUS_LIGHT_BLOCK,\n                    values: {\n                        color: {\n                            kind: \"block\",\n                            type: LEDColorField.SHADOW.type,\n                        },\n                    },\n                },\n            ],\n        }\n\n        return [\n            ...servicesCategories,\n            commonCategory,\n            <SeparatorDefinition>{\n                kind: \"sep\",\n            },\n        ]\n    }\n\n    compileEventToVM(options: CompileEventToVMOptions): CompileEventToVMResult {\n        const { block, definition, blockToExpression } = options\n        const { inputs } = block\n        const { template } = definition\n\n        switch (template) {\n            case \"event\": {\n                const { value: role } = inputs[0].fields[\"role\"]\n                const { value: eventName } = inputs[0].fields[\"event\"]\n                return <CompileEventToVMResult>{\n                    expression: <jsep.CallExpression>{\n                        type: \"CallExpression\",\n                        arguments: [\n                            toMemberExpression(\n                                role.toString(),\n                                eventName.toString()\n                            ),\n                        ],\n                        callee: toIdentifier(\"awaitEvent\"),\n                    },\n                    event: {\n                        role: role.toString(),\n                        event: eventName.toString(),\n                    },\n                }\n            }\n            case \"register_change_event\": {\n                const { value: role } = inputs[0].fields[\"role\"]\n                const { register } = definition as RegisterBlockDefinition\n                const { expr, errors } = blockToExpression(\n                    undefined,\n                    inputs[0].child\n                )\n                return <CompileEventToVMResult>{\n                    expression: <jsep.CallExpression>{\n                        type: \"CallExpression\",\n                        arguments: [\n                            toMemberExpression(role.toString(), register.name),\n                            expr,\n                        ],\n                        callee: toIdentifier(\"awaitChange\"),\n                    },\n                    errors,\n                }\n            }\n        }\n\n        return undefined\n    }\n\n    compileExpressionToVM(\n        options: CompileExpressionToVMOptions\n    ): ExpressionWithErrors {\n        const { event, definition, block } = options\n        const { inputs, id } = block\n        const { template } = definition\n        switch (template) {\n            case \"register_get\": {\n                const { register } = definition as RegisterBlockDefinition\n                const { value: role } = inputs[0].fields[\"role\"]\n                const field = inputs[0].fields[\"field\"]\n                return {\n                    expr: toMemberExpression(\n                        role as string,\n                        field\n                            ? toMemberExpression(\n                                  register.name,\n                                  field.value as string\n                              )\n                            : register.name\n                    ),\n                    errors: [],\n                }\n            }\n            case \"event_field\": {\n                const { event: eventInfo } = definition as EventFieldDefinition\n                const errors: VMError[] = []\n                if (event.event !== eventInfo.name) {\n                    errors.push({\n                        sourceId: id,\n                        message: `Event ${eventInfo.name} is not available in this handler.`,\n                    })\n                }\n                const field = inputs[0].fields[\"field\"]\n                return {\n                    expr: toMemberExpression(\n                        event.role,\n                        toMemberExpression(event.event, field.value as string)\n                    ),\n                    errors,\n                }\n            }\n            default:\n                return undefined\n        }\n    }\n\n    compileCommandToVM(options: CompileCommandToVMOptions) {\n        const { event, block, definition, blockToExpression } = options\n        const { template } = definition\n        const { inputs } = block\n        switch (template) {\n            case \"register_set\": {\n                const { register } = definition as RegisterBlockDefinition\n                const { expr, errors } = blockToExpression(\n                    event,\n                    inputs[0].child\n                )\n                const { value: role } = inputs[0].fields.role\n                return {\n                    cmd: makeVMBase(block, {\n                        type: \"CallExpression\",\n                        arguments: [\n                            toMemberExpression(role as string, register.name),\n                            expr,\n                        ],\n                        callee: toIdentifier(\"writeRegister\"),\n                    }),\n                    errors,\n                }\n            }\n            case \"command\": {\n                const { command: serviceCommand } =\n                    definition as CommandBlockDefinition\n                const { value: role } = inputs[0].fields.role\n                const exprsErrors = inputs.map(a =>\n                    blockToExpression(event, a.child)\n                )\n                return {\n                    cmd: makeVMBase(block, {\n                        type: \"CallExpression\",\n                        arguments: exprsErrors.map(p => p.expr),\n                        callee: toMemberExpression(\n                            role as string,\n                            serviceCommand.name\n                        ),\n                    }),\n                    errors: exprsErrors.flatMap(p => p.errors),\n                }\n            }\n        }\n\n        return undefined\n    }\n}\nconst servicesDSL = new ServicesBlockDomainSpecificLanguage()\nexport default servicesDSL\n","import {\n    BlockDefinition,\n    CategoryDefinition,\n    CODE_STATEMENT_TYPE,\n    DummyInputDefinition,\n    PRIMITIVE_TYPES,\n    StatementInputDefinition,\n    TextInputDefinition,\n    ValueInputDefinition,\n} from \"../toolbox\"\nimport BlockDomainSpecificLanguage from \"./dsl\"\n\nconst colour = \"#8a57c2\"\nclass AzureIoTHubBlockDomainSpecificLanguage\n    implements BlockDomainSpecificLanguage\n{\n    id = \"azureiothub\"\n    private _blocks: BlockDefinition[]\n    createBlocks() {\n        return (this._blocks = [\n            {\n                kind: \"block\",\n                type: \"azureiothub_receive_telemetry\",\n                message0: \"on receive cloud-to-device message\",\n                args0: [],\n                nextStatement: CODE_STATEMENT_TYPE,\n                colour,\n            },\n            {\n                kind: \"block\",\n                type: \"azureiothub_receive_telemetry_number\",\n                message0: \"received number %1\",\n                args0: [\n                    <TextInputDefinition>{\n                        type: \"field_input\",\n                        name: \"name\",\n                        text: \"value\",\n                    },\n                ],\n                output: \"Number\",\n                colour,\n            },\n            {\n                kind: \"block\",\n                type: \"azureiothub_receive_telemetry_string\",\n                message0: \"received string %1\",\n                args0: [\n                    <TextInputDefinition>{\n                        type: \"field_input\",\n                        name: \"name\",\n                        text: \"value\",\n                    },\n                ],\n                output: \"String\",\n                colour,\n            },\n            {\n                kind: \"block\",\n                type: \"azureiothub_send_telemetry\",\n                message0: \"send device-to-cloud message %1 %2\",\n                args0: [\n                    <DummyInputDefinition>{\n                        type: \"input_dummy\",\n                    },\n                    <StatementInputDefinition>{\n                        type: \"input_statement\",\n                        name: \"fields\",\n                    },\n                ],\n                previousStatement: CODE_STATEMENT_TYPE,\n                nextStatement: CODE_STATEMENT_TYPE,\n                colour,\n            },\n            {\n                kind: \"block\",\n                type: \"azureiothub_send_telemetry_value\",\n                message0: \"with %1 = %2\",\n                args0: [\n                    <TextInputDefinition>{\n                        type: \"field_input\",\n                        name: \"name\",\n                        text: \"value\",\n                    },\n                    <ValueInputDefinition>{\n                        type: \"input_value\",\n                        name: \"value\",\n                        check: PRIMITIVE_TYPES,\n                    },\n                ],\n                previousStatement: CODE_STATEMENT_TYPE,\n                nextStatement: CODE_STATEMENT_TYPE,\n                colour,\n            },\n        ])\n    }\n    createCategory(): CategoryDefinition[] {\n        return [\n            {\n                kind: \"category\",\n                name: \"Azure IoT Hub\",\n                colour,\n                contents: [\n                    ...this._blocks.map(\n                        ({ type }) =>\n                            <BlockDefinition>{\n                                kind: \"block\",\n                                type,\n                            }\n                    ),\n                ],\n            },\n        ]\n    }\n}\n\nconst azureIoTHubDSL: BlockDomainSpecificLanguage =\n    new AzureIoTHubBlockDomainSpecificLanguage()\n\nexport default azureIoTHubDSL\n","import { DTDLUnits } from \"../../../../jacdac-ts/src/azure-iot/dtdl\"\nimport {\n    BlockDefinition,\n    CategoryDefinition,\n    CODE_STATEMENT_TYPE,\n    OptionsInputDefinition,\n    StatementInputDefinition,\n    VariableInputDefinition,\n} from \"../toolbox\"\nimport BlockDomainSpecificLanguage from \"./dsl\"\n\nexport const DEVICE_TWIN_SEND_TELEMETRY = \"device_twin_send_telemetry\"\nexport const DEVICE_TWIN_DEFINITION_BLOCK = \"device_twin_definition\"\nexport const DEVICE_TWIN_PROPERTY_BLOCK = \"device_twin_property\"\n\nexport const DEVICE_TWIN_PROPERTY_TYPE = \"DeviceTwinProperty\"\nexport const DEVICE_TWIN_VALUE_TYPE = \"DeviceTwinValue\"\n\nconst colour = \"#843ed0\"\nconst deviceTwinContentType = \"DeviceTwinContent\"\nconst deviceTwinCommonOptionType = \"DeviceTwinCommonOption\"\nconst deviceTwinPropertyOptionType = \"DeviceTwinPropertyOption\"\nconst deviceTwinStatementType = [deviceTwinContentType]\nconst deviceTwinCommonOptionStatementType = [deviceTwinCommonOptionType]\nconst deviceTwinPropertyOptionStatementType = [\n    deviceTwinPropertyOptionType,\n    ...deviceTwinCommonOptionStatementType,\n]\n\nclass DeviceTwinBlockDomainSpecificLanguage\n    implements BlockDomainSpecificLanguage\n{\n    id = \"devicetwin\"\n    private _blocks: BlockDefinition[]\n    createBlocks() {\n        return (this._blocks = [\n            {\n                kind: \"block\",\n                type: DEVICE_TWIN_DEFINITION_BLOCK,\n                message0: \"device twin\",\n                args0: [],\n                inputsInline: true,\n                nextStatement: deviceTwinStatementType,\n                colour,\n            },\n            {\n                kind: \"block\",\n                type: DEVICE_TWIN_PROPERTY_BLOCK,\n                message0: \"property %1 %2 %3\",\n                args0: [\n                    <VariableInputDefinition>{\n                        type: \"field_variable\",\n                        name: \"name\",\n                        variable: \"property 1\",\n                        variableTypes: [DEVICE_TWIN_PROPERTY_TYPE],\n                        defaultType: DEVICE_TWIN_PROPERTY_TYPE,\n                    },\n                    {\n                        type: \"input_dummy\",\n                    },\n                    <StatementInputDefinition>{\n                        type: \"input_statement\",\n                        name: \"options\",\n                        check: deviceTwinPropertyOptionStatementType,\n                    },\n                ],\n                previousStatement: deviceTwinStatementType,\n                nextStatement: deviceTwinStatementType,\n                colour,\n                inputsInline: false,\n            },\n            // options\n            {\n                kind: \"block\",\n                type: \"device_twin_option_property_field\",\n                message0: \"field %1 %2 %3\",\n                args0: [\n                    <VariableInputDefinition>{\n                        type: \"field_variable\",\n                        name: \"variable\",\n                        variable: \"value 1\",\n                        variableTypes: [DEVICE_TWIN_VALUE_TYPE],\n                        defaultType: DEVICE_TWIN_VALUE_TYPE,\n                    },\n                    <OptionsInputDefinition>{\n                        type: \"field_dropdown\",\n                        name: \"unit\",\n                        options: DTDLUnits().map(unit => [unit, unit]),\n                    },\n                    {\n                        type: \"input_value\",\n                        name: \"value\",\n                    },\n                ],\n                previousStatement: deviceTwinCommonOptionStatementType,\n                nextStatement: deviceTwinCommonOptionStatementType,\n                colour,\n                inputsInline: false,\n            },\n            // events\n            {\n                kind: \"block\",\n                type: \"device_twin_property_change\",\n                message0: \"on property %1 change\",\n                args0: [\n                    <VariableInputDefinition>{\n                        type: \"field_variable\",\n                        name: \"name\",\n                        variable: \"property 1\",\n                        variableTypes: [DEVICE_TWIN_PROPERTY_TYPE],\n                        defaultType: DEVICE_TWIN_PROPERTY_TYPE,\n                    },\n                ],\n                nextStatement: CODE_STATEMENT_TYPE,\n                colour,\n            },\n        ])\n    }\n    createCategory(): CategoryDefinition[] {\n        return [\n            {\n                kind: \"category\",\n                name: \"Device Twin\",\n                colour,\n                contents: [\n                    ...this._blocks.map(\n                        ({ type }) =>\n                            <BlockDefinition>{\n                                kind: \"block\",\n                                type,\n                            }\n                    ),\n                ],\n            },\n        ]\n    }\n}\n\nconst deviceTwinDSL: BlockDomainSpecificLanguage =\n    new DeviceTwinBlockDomainSpecificLanguage()\n\nexport default deviceTwinDSL\n","import { toIdentifier } from \"../../../../jacdac-ts/src/vm/compile\"\nimport JDomTreeField from \"../fields/JDomTreeField\"\nimport TwinField from \"../fields/TwinField\"\nimport WatchValueField from \"../fields/WatchValueField\"\nimport {\n    BlockDefinition,\n    InputDefinition,\n    INSPECT_BLOCK,\n    TWIN_BLOCK,\n    VariableInputDefinition,\n    WATCH_BLOCK,\n} from \"../toolbox\"\nimport BlockDomainSpecificLanguage from \"./dsl\"\nimport servicesDSL from \"./servicesdsl\"\n\nconst colour = \"#888\"\n\nconst toolsDSL: BlockDomainSpecificLanguage = {\n    id: \"tools\",\n    createBlocks: () => [\n        {\n            kind: \"block\",\n            type: TWIN_BLOCK,\n            message0: `view %1 %2 %3`,\n            args0: [\n                <VariableInputDefinition>{\n                    type: \"field_variable\",\n                    name: \"role\",\n                    variable: \"none\",\n                    variableTypes: [\n                        \"client\",\n                        ...servicesDSL.supportedServices.map(\n                            service => service.shortId\n                        ),\n                    ],\n                    defaultType: \"client\",\n                },\n                {\n                    type: \"input_dummy\",\n                },\n                <InputDefinition>{\n                    type: TwinField.KEY,\n                    name: \"twin\",\n                },\n            ],\n            colour,\n            inputsInline: false,\n            tooltip: `Twin of the selected service`,\n            helpUrl: \"\",\n            template: \"meta\",\n        },\n        {\n            kind: \"block\",\n            type: INSPECT_BLOCK,\n            message0: `inspect %1 %2 %3`,\n            args0: [\n                <VariableInputDefinition>{\n                    type: \"field_variable\",\n                    name: \"role\",\n                    variable: \"none\",\n                    variableTypes: [\n                        \"client\",\n                        ...servicesDSL.supportedServices.map(\n                            service => service.shortId\n                        ),\n                    ],\n                    defaultType: \"client\",\n                },\n                {\n                    type: \"input_dummy\",\n                },\n                <InputDefinition>{\n                    type: JDomTreeField.KEY,\n                    name: \"twin\",\n                },\n            ],\n            colour,\n            inputsInline: false,\n            tooltip: `Inspect a service`,\n            helpUrl: \"\",\n            template: \"meta\",\n        },\n        {\n            kind: \"block\",\n            type: WATCH_BLOCK,\n            message0: `watch %1 %2`,\n            args0: [\n                <InputDefinition>{\n                    type: \"input_value\",\n                    name: \"value\",\n                    check: [\"Number\", \"Boolean\", \"String\"],\n                },\n                <InputDefinition>{\n                    type: WatchValueField.KEY,\n                    name: \"watch\",\n                },\n            ],\n            colour,\n            inputsInline: true,\n            tooltip: `Watch a value in the editor`,\n            helpUrl: \"\",\n        },\n    ],\n    createCategory: () => [\n        {\n            kind: \"category\",\n            name: \"Tools\",\n            colour: colour,\n            contents: [\n                <BlockDefinition>{\n                    kind: \"block\",\n                    type: WATCH_BLOCK,\n                },\n                <BlockDefinition>{\n                    kind: \"block\",\n                    type: TWIN_BLOCK,\n                },\n                <BlockDefinition>{\n                    kind: \"block\",\n                    type: INSPECT_BLOCK,\n                },\n            ],\n        },\n    ],\n\n    compileEventToVM: ({ block, blockToExpression }) => {\n        const { type } = block\n        if (type === WATCH_BLOCK) {\n            const { inputs } = block\n            const { expr, errors } = blockToExpression(\n                undefined,\n                inputs[0].child\n            )\n            return {\n                expression: <jsep.CallExpression>{\n                    type: \"CallExpression\",\n                    arguments: [expr],\n                    callee: toIdentifier(\"watch\"),\n                },\n                errors,\n                meta: true\n            }\n        }\n\n        return undefined\n    },\n}\n\nexport default toolsDSL\n","import { toIdentifier } from \"../../../../jacdac-ts/src/vm/compile\"\nimport { VMCommand } from \"../../../../jacdac-ts/src/vm/ir\"\nimport {\n    BlockDefinition,\n    CategoryDefinition,\n    CODE_STATEMENT_TYPE,\n    InputDefinition,\n    REPEAT_EVERY_BLOCK,\n    SeparatorDefinition,\n    ValueInputDefinition,\n    WAIT_BLOCK,\n} from \"../toolbox\"\nimport { makeVMBase, processErrors } from \"../../vm/VMgenerator\"\nimport BlockDomainSpecificLanguage from \"./dsl\"\n\nconst colour = \"#4fbac9\"\nconst loopsDsl: BlockDomainSpecificLanguage = {\n    id: \"loops\",\n    createBlocks: () => [\n        {\n            kind: \"block\",\n            type: WAIT_BLOCK,\n            message0: \"wait %1 s\",\n            args0: [\n                <ValueInputDefinition>{\n                    type: \"input_value\",\n                    name: \"time\",\n                    check: \"Number\",\n                },\n            ],\n            inputsInline: true,\n            previousStatement: CODE_STATEMENT_TYPE,\n            nextStatement: CODE_STATEMENT_TYPE,\n            colour,\n            tooltip: \"Wait the desired time\",\n            helpUrl: \"\",\n        },\n        {\n            kind: \"block\",\n            type: REPEAT_EVERY_BLOCK,\n            message0: `repeat every %1s`,\n            args0: [\n                <InputDefinition>{\n                    type: \"input_value\",\n                    name: \"interval\",\n                    check: \"Number\",\n                },\n            ],\n            colour,\n            inputsInline: true,\n            tooltip: `Repeats code at a given interval in seconds`,\n            helpUrl: \"\",\n            nextStatement: CODE_STATEMENT_TYPE,\n        },\n    ],\n\n    createCategory: () => [\n        <SeparatorDefinition>{\n            kind: \"sep\",\n        },\n        <CategoryDefinition>{\n            kind: \"category\",\n            name: \"Commands\",\n            order: 4,\n            colour,\n            contents: [\n                <BlockDefinition>{\n                    kind: \"block\",\n                    type: REPEAT_EVERY_BLOCK,\n                    values: {\n                        interval: { kind: \"block\", type: \"jacdac_time_picker\" },\n                    },\n                },\n                <BlockDefinition>{\n                    kind: \"block\",\n                    type: WAIT_BLOCK,\n                    values: {\n                        time: { kind: \"block\", type: \"jacdac_time_picker\" },\n                    },\n                },\n            ].filter(b => !!b),\n        },\n    ],\n    compileEventToVM: ({ block, blockToExpression }) => {\n        const { type } = block\n        if (type === REPEAT_EVERY_BLOCK) {\n            const { inputs } = block\n            const { expr: time, errors } = blockToExpression(\n                undefined,\n                inputs[0].child\n            )\n            return {\n                expression: (\n                    makeVMBase(block, {\n                        type: \"CallExpression\",\n                        arguments: [time],\n                        callee: toIdentifier(\"wait\"),\n                    }) as VMCommand\n                ).command,\n                errors: processErrors(block, errors),\n            }\n        }\n        return undefined\n    },\n    compileCommandToVM: ({ event, block, blockToExpression }) => {\n        const { type } = block\n        if (type === WAIT_BLOCK) {\n            const { inputs } = block\n            {\n                const { expr: time, errors } = blockToExpression(\n                    event,\n                    inputs[0].child\n                )\n                return {\n                    cmd: makeVMBase(block, {\n                        type: \"CallExpression\",\n                        arguments: [time],\n                        callee: toIdentifier(\"wait\"),\n                    }),\n                    errors: processErrors(block, errors),\n                }\n            }\n        }\n        return undefined\n    },\n}\nexport default loopsDsl\n","import BlockDomainSpecificLanguage from \"./dsl\"\n\nconst logicDsl: BlockDomainSpecificLanguage = {\n    id: \"logic\",\n    createCategory: () => [\n        {\n            kind: \"category\",\n            name: \"Logic\",\n            colour: \"%{BKY_LOGIC_HUE}\",\n            contents: [\n                {\n                    kind: \"block\",\n                    type: \"dynamic_if\",\n                },\n                {\n                    kind: \"block\",\n                    type: \"logic_compare\",\n                    values: {\n                        A: { kind: \"block\", type: \"math_number\" },\n                        B: { kind: \"block\", type: \"math_number\" },\n                    },\n                },\n                {\n                    kind: \"block\",\n                    type: \"logic_operation\",\n                    values: {\n                        A: { kind: \"block\", type: \"logic_boolean\" },\n                        B: { kind: \"block\", type: \"logic_boolean\" },\n                    },\n                },\n                {\n                    kind: \"block\",\n                    type: \"logic_negate\",\n                    values: {\n                        BOOL: { kind: \"block\", type: \"logic_boolean\" },\n                    },\n                },\n                {\n                    kind: \"block\",\n                    type: \"logic_boolean\",\n                },\n            ],\n        },\n    ],\n}\nexport default logicDsl\n","import {\n    CategoryDefinition,\n    OptionsInputDefinition,\n    ValueInputDefinition,\n} from \"../toolbox\"\nimport BlockDomainSpecificLanguage from \"./dsl\"\n\nconst mathDSL: BlockDomainSpecificLanguage = {\n    id: \"jacdacmath\",\n    createBlocks: () => [\n        {\n            kind: \"block\",\n            type: \"jacdac_math_arithmetic\",\n            message0: \"%1 %2 %3\",\n            args0: [\n                <ValueInputDefinition>{\n                    type: \"input_value\",\n                    name: \"A\",\n                    check: \"Number\",\n                },\n                <OptionsInputDefinition>{\n                    type: \"field_dropdown\",\n                    name: \"OP\",\n                    options: [\n                        [\"%{BKY_MATH_ADDITION_SYMBOL}\", \"ADD\"],\n                        [\"%{BKY_MATH_SUBTRACTION_SYMBOL}\", \"MINUS\"],\n                        [\"%{BKY_MATH_MULTIPLICATION_SYMBOL}\", \"MULTIPLY\"],\n                        [\"%{BKY_MATH_DIVISION_SYMBOL}\", \"DIVIDE\"],\n                    ],\n                },\n                <ValueInputDefinition>{\n                    type: \"input_value\",\n                    name: \"B\",\n                    check: \"Number\",\n                },\n            ],\n            inputsInline: true,\n            output: \"Number\",\n            style: \"math_blocks\",\n            helpUrl: \"%{BKY_MATH_ARITHMETIC_HELPURL}\",\n            extensions: [\"math_op_tooltip\"],\n        },\n        {\n            kind: \"block\",\n            type: \"jacdac_math_single\",\n            message0: \"%1 %2\",\n            args0: [\n                <OptionsInputDefinition>{\n                    type: \"field_dropdown\",\n                    name: \"OP\",\n                    options: [\n                        [\"-\", \"NEG\"],\n                        [\"%{BKY_MATH_SINGLE_OP_ABSOLUTE}\", \"ABS\"],\n                    ],\n                },\n                <ValueInputDefinition>{\n                    type: \"input_value\",\n                    name: \"NUM\",\n                    check: \"Number\",\n                },\n            ],\n            output: \"Number\",\n            style: \"math_blocks\",\n            helpUrl: \"%{BKY_MATH_SINGLE_HELPURL}\",\n            extensions: [\"math_op_tooltip\"],\n        },\n        {\n            kind: \"block\",\n            type: \"jacdac_math_random\",\n            message0: \"random\",\n            args0: [],\n            output: \"Number\",\n            style: \"math_blocks\",\n        },\n        {\n            kind: \"block\",\n            type: \"jacdac_math_random_range\",\n            message0: \"random from %1 to %2\",\n            args0: [\n                <ValueInputDefinition>{\n                    type: \"input_value\",\n                    name: \"min\",\n                    check: \"Number\",\n                },\n                <ValueInputDefinition>{\n                    type: \"input_value\",\n                    name: \"max\",\n                    check: \"Number\",\n                },\n            ],\n            output: \"Number\",\n            style: \"math_blocks\",\n            inputsInline: true,\n        },\n        {\n            kind: \"block\",\n            type: \"jacdac_math_clamp\",\n            message0: \"clamp %1 in [%2, %3]\",\n            args0: [\n                <ValueInputDefinition>{\n                    type: \"input_value\",\n                    name: \"value\",\n                    check: \"Number\",\n                },\n                <ValueInputDefinition>{\n                    type: \"input_value\",\n                    name: \"minInclusive\",\n                    check: \"Number\",\n                },\n                <ValueInputDefinition>{\n                    type: \"input_value\",\n                    name: \"maxInclusive\",\n                    check: \"Number\",\n                },\n            ],\n            output: \"Number\",\n            style: \"math_blocks\",\n        },\n        {\n            kind: \"block\",\n            type: \"jacdac_math_map\",\n            message0: \"map %1 from [%2, %3] to [%4, %5]\",\n            args0: [\n                <ValueInputDefinition>{\n                    type: \"input_value\",\n                    name: \"value\",\n                    check: \"Number\",\n                },\n                <ValueInputDefinition>{\n                    type: \"input_value\",\n                    name: \"fromMin\",\n                    check: \"Number\",\n                },\n                <ValueInputDefinition>{\n                    type: \"input_value\",\n                    name: \"fromMax\",\n                    check: \"Number\",\n                },\n                <ValueInputDefinition>{\n                    type: \"input_value\",\n                    name: \"toMin\",\n                    check: \"Number\",\n                },\n                <ValueInputDefinition>{\n                    type: \"input_value\",\n                    name: \"toMax\",\n                    check: \"Number\",\n                },\n            ],\n            output: \"Number\",\n            style: \"math_blocks\",\n        },\n    ],\n    createCategory: () => [\n        <CategoryDefinition>{\n            kind: \"category\",\n            name: \"Math\",\n            colour: \"%{BKY_MATH_HUE}\",\n            contents: [\n                {\n                    kind: \"block\",\n                    type: \"jacdac_math_arithmetic\",\n                    values: {\n                        A: { kind: \"block\", type: \"math_number\" },\n                        B: { kind: \"block\", type: \"math_number\" },\n                    },\n                },\n                {\n                    kind: \"block\",\n                    type: \"jacdac_math_single\",\n                    values: {\n                        NUM: {\n                            kind: \"block\",\n                            type: \"math_number\",\n                        },\n                    },\n                },\n                { kind: \"block\", type: \"jacdac_math_random\" },\n                { kind: \"block\", type: \"jacdac_math_random_range\" },\n                { kind: \"block\", type: \"jacdac_math_map\" },\n                { kind: \"block\", type: \"math_number\" },\n            ],\n        },\n    ],\n}\n\nexport default mathDSL\n","import { Grid, NoSsr } from \"@material-ui/core\"\nimport React, { useContext, useEffect, useMemo, useState } from \"react\"\nimport Flags from \"../../../jacdac-ts/src/jdom/flags\"\nimport useVMRunner from \"./useVMRunner\"\nimport VMDiagnostics from \"./VMDiagnostics\"\nimport VMToolbar from \"./VMToolbar\"\nimport { VMProgram } from \"../../../jacdac-ts/src/vm/ir\"\nimport BlockContext, { BlockProvider } from \"../blockly/BlockContext\"\nimport BlockDiagnostics from \"../blockly/BlockDiagnostics\"\nimport servicesDSL from \"../blockly/dsl/servicesdsl\"\nimport azureIoTHubDSL from \"../blockly/dsl/azureiothubdsl\"\nimport deviceTwinDSL from \"../blockly/dsl/devicetwindsl\"\nimport toolsDSL from \"../blockly/dsl/toolsdsl\"\nimport loopsDsl from \"../blockly/dsl/loopsdsl\"\nimport logicDsl from \"../blockly/dsl/logicdsl\"\nimport mathDSL from \"../blockly/dsl/mathdsl\"\nimport variablesDsl from \"../blockly/dsl/variablesdsl\"\nimport shadowDsl from \"../blockly/dsl/shadowdsl\"\nimport fieldsDsl from \"../blockly/dsl/fieldsdsl\"\nimport workspaceJSONToVMProgram from \"./VMgenerator\"\nimport { BlocklyWorkspaceWithServices } from \"../blockly/WorkspaceContext\"\nimport BlockEditor from \"../blockly/BlockEditor\"\n\nconst VM_SOURCE_STORAGE_KEY = \"tools:vmeditor\"\nfunction VMEditorWithContext() {\n    const { dsls, workspace, workspaceJSON, roleManager } =\n        useContext(BlockContext)\n    const [program, setProgram] = useState<VMProgram>()\n    const autoStart = true\n    const { runner, run, cancel } = useVMRunner(roleManager, program, autoStart)\n\n    useEffect(() => {\n        try {\n            const newProgram = workspaceJSONToVMProgram(workspaceJSON, dsls)\n            if (JSON.stringify(newProgram) !== JSON.stringify(program))\n                setProgram(newProgram)\n        } catch (e) {\n            console.error(e)\n            setProgram(undefined)\n        }\n    }, [dsls, workspaceJSON])\n    useEffect(\n        () => program && roleManager?.setRoles(program.roles),\n        [roleManager, program]\n    )\n\n    useEffect(() => {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const ws = workspace as any as BlocklyWorkspaceWithServices\n        const services = ws?.jacdacServices\n        if (services) {\n            services.runner = runner\n        }\n    }, [workspace, runner])\n\n    return (\n        <Grid container direction=\"column\" spacing={1}>\n            <Grid item xs={12}>\n                <VMToolbar runner={runner} run={run} cancel={cancel} />\n            </Grid>\n            <Grid item xs={12}>\n                <BlockEditor />\n            </Grid>\n            {Flags.diagnostics && (\n                <>\n                    <VMDiagnostics program={program} />\n                    <BlockDiagnostics />\n                </>\n            )}\n        </Grid>\n    )\n}\n\nexport default function VMEditor() {\n    const dsls = useMemo(() => {\n        return [\n            servicesDSL,\n            azureIoTHubDSL,\n            deviceTwinDSL,\n            toolsDSL,\n            loopsDsl,\n            logicDsl,\n            mathDSL,\n            variablesDsl,\n            shadowDsl,\n            fieldsDsl,\n        ]\n    }, [])\n\n    return (\n        <NoSsr>\n            <BlockProvider storageKey={VM_SOURCE_STORAGE_KEY} dsls={dsls}>\n                <VMEditorWithContext />\n            </BlockProvider>\n        </NoSsr>\n    )\n}\n","import React from \"react\"\nimport VMEditor from \"../../components/vm/VMEditor\"\n\nexport default function Page() {\n    return <VMEditor />\n}\n"],"sourceRoot":""}