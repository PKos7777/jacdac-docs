{"version":3,"sources":["webpack://jacdac-docs/./node_modules/@material-ui/icons/GetApp.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/Launch.js","webpack://jacdac-docs/./jacdac-ts/src/azure-iot/dtdl.ts","webpack://jacdac-docs/./jacdac-ts/src/azure-iot/dtdlspec.ts","webpack://jacdac-docs/./src/components/hooks/useWindowEvent.ts","webpack://jacdac-docs/./src/components/makecode/useMakeCodeRenderer.ts","webpack://jacdac-docs/./src/components/makecode/MakeCodeSimulator.tsx","webpack://jacdac-docs/./src/components/makecode/MakeCodeSnippet.tsx","webpack://jacdac-docs/./src/components/CodeBlock.tsx","webpack://jacdac-docs/./src/components/ui/PaperBox.tsx","webpack://jacdac-docs/./src/components/ui/Snippet.tsx"],"names":["DTDL_REFERENCE_URL","DTDL_NAME","DTDL_CONTEXT","objectSchema","schemas","fields","arraySchema","schema","elementSchema","escapeName","name","trim","replace","test","toLowerCase","slice","escapeDisplayName","DTDLUnits","sort","toDTMI","segments","version","map","seg","undefined","toString","join","toUnit","pkt","length","field","unit","units","semantic","rad","m","m2","s","ms","us","K","C","F","g","mA","uA","A","mV","uV","V","indexOf","enumDTDI","srv","en","classIdentifier","enumSchema","dtdl","valueSchema","enumValues","Object","keys","members","k","displayName","enumValue","fieldType","type","isFloat","isSimpleType","shift","enums","toSchema","supportsArray","startRepeats","repeatIndex","findIndex","nonRepeat","repeats","packetToDTDL","types","const","rw","ro","event","kind","description","writable","serviceSpecificationToDTDL","serviceSpecificationDTMI","notes","contents","packets","filter","derived","internal","e","console","log","c","extends","id","serviceSpecificationFromName","hasEvents","find","hasEnums","push","concat","serviceSpecificationToComponent","deviceSpecificationDTMI","dev","DTMIToRoute","dtmi","route","deviceSpecificationToDTDL","options","services","serviceSpecificationFromClassIdentifier","uniqueServices","uniqueMap","names","forEach","shortId","shortName","count","i","inlineServices","useWindowEvent","listener","passive","deps","useEffect","window","addEventListener","removeEventListener","parseMakeCodeSnippet","source","ghost","code","meta","dependencies","front","parts","split","value","snippet","mkcds","makeCodeServices","info","src","client","qName","default","repo","dep","unique","useMakeCodeRenderer","useContext","MakeCodeSnippetContext","target","rendererUrl","lang","iframeId","pendingRequests","useMemo","sendRequest","req","iframe","document","getElementById","dataset","ready","contentWindow","postMessage","render","f","createElement","style","position","left","bottom","width","height","body","appendChild","Math","random","snippetMode","Promise","resolve","reject","handleMessage","ev","msg","data","r","useStyles","makeStyles","createStyles","root","root2","paddingTop","top","border","MakeCodeSimulator","props","simUrl","JacdacContext","bus","frameRef","useRef","classes","url","encodeURIComponent","origin","URL","subscribe","PACKET_SEND","PACKET_PROCESS","packetSent","channel","broadcast","toBuffer","sender","current","MakeCodeSnippet","renderedSource","JSON","parse","rendered","tabs","editor","setEditor","useState","tab","setTab","handleTabChange","newValue","withPrefix","TraceSnippet","lazy","CodeSandboxButton","HighlightedCode","children","codeSandbox","className","downloadName","downloadText","DarkModeContext","darkMode","language","theme","DARK_THEME","LIGHT_THEME","valueUri","defaultProps","tokens","getLineProps","getTokenProps","float","line","index","lineProps","key","token","CodeBlock","PaperBox","padding","elevation","bgcolor","others","useTheme","spacing","Snippet","mode","download","caption","v"],"mappings":"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","file":"96c2ed7eaf42f8923b2efb4d892f0c3892eddf0e-15a7d1920deaee04af3f.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z\"\n}), 'GetApp');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z\"\n}), 'Launch');\n\nexports.default = _default;","/***\n *  DTDL specification: https://github.com/Azure/opendigitaltwins-dtdl/blob/master/DTDL/v2/dtdlv2.md.\n */\nexport const DTDL_REFERENCE_URL =\n    \"https://github.com/Azure/opendigitaltwins-dtdl/blob/master/DTDL/v2/dtdlv2.md\"\nexport const DTDL_NAME = \"Digital Twins Definition Language\"\nexport const DTDL_CONTEXT = \"dtmi:dtdl:context;2\"\n\n// warps fields into an object\nexport function objectSchema(schemas: DTDLSchema[]): DTDLSchema {\n    return {\n        \"@type\": \"Object\",\n        fields: schemas,\n    }\n}\n\n// wraps a schema into an array\nexport function arraySchema(schema: string | DTDLSchema): DTDLSchema {\n    return {\n        \"@type\": \"Array\",\n        elementSchema: schema,\n    }\n}\n\nexport interface DTDLNode {\n    \"@type\"?: string\n    \"@id\"?: string\n    // 1-64 characters\n    // ^[a-zA-Z](?:[a-zA-Z0-9_]*[a-zA-Z0-9])?$\n    name?: string\n    displayName?: string\n    description?: string\n}\n\nexport interface DTDLSchema extends DTDLNode {\n    fields?: DTDLSchema[]\n    schema?: string | DTDLSchema\n    elementSchema?: string | DTDLSchema\n}\n\nexport interface DTDLContent extends DTDLNode {\n    \"@type\": \"Property\" | \"Command\" | \"Component\" | \"Interface\"\n    unit?: string\n    schema?: string | DTDLSchema\n}\n\nexport interface DTDLInterface extends DTDLContent {\n    contents: DTDLContent[]\n    extends?: string | string[]\n    schemas?: (DTDLSchema | DTDLInterface)[]\n    \"@context\"?: string\n}\n\nexport function escapeName(name: string) {\n    name = name.trim().replace(/[^a-zA-Z0-9_]/g, \"_\")\n    if (!/^[a-zA-Z]/.test(name)) name = \"a\" + name\n    name = name[0].toLowerCase() + name.slice(1)\n    return name.slice(0, 64)\n}\n\nexport function escapeDisplayName(name: string) {\n    return name.slice(0, 64)\n}\n\nexport function DTDLUnits() {\n    return [\n        \"metrePerSecondSquared\",\n        \"centimetrePerSecondSquared\",\n        \"gForce\",\n        \"radian\",\n        \"degreeOfArc\",\n        \"minuteOfArc\",\n        \"secondOfArc\",\n        \"turn\",\n        \"radianPerSecondSquared\",\n        \"radianPerSecond\",\n        \"degreePerSecond\",\n        \"revolutionPerSecond\",\n        \"revolutionPerMinute\",\n        \"squareMetre\",\n        \"squareCentimetre\",\n        \"squareMillimetre\",\n        \"squareKilometre\",\n        \"hectare\",\n        \"squareFoot\",\n        \"squareInch\",\n        \"acre\",\n        \"farad\",\n        \"millifarad\",\n        \"microfarad\",\n        \"nanofarad\",\n        \"picofarad\",\n        \"ampere\",\n        \"microampere\",\n        \"milliampere\",\n        \"bitPerSecond\",\n        \"kibibitPerSecond\",\n        \"mebibitPerSecond\",\n        \"gibibitPerSecond\",\n        \"tebibitPerSecond\",\n        \"exbibitPerSecond\",\n        \"zebibitPerSecond\",\n        \"yobibitPerSecond\",\n        \"bytePerSecond\",\n        \"kibibytePerSecond\",\n        \"mebibytePerSecond\",\n        \"gibibytePerSecond\",\n        \"tebibytePerSecond\",\n        \"exbibytePerSecond\",\n        \"zebibytePerSecond\",\n        \"yobibytePerSecond\",\n        \"bit\",\n        \"kibibit\",\n        \"mebibit\",\n        \"gibibit\",\n        \"tebibit\",\n        \"exbibit\",\n        \"zebibit\",\n        \"yobibit\",\n        \"byte\",\n        \"kibibyte\",\n        \"mebibyte\",\n        \"gibibyte\",\n        \"tebibyte\",\n        \"exbibyte\",\n        \"zebibyte\",\n        \"yobibyte\",\n        \"kilogramPerCubicMetre\",\n        \"gramPerCubicMetre\",\n        \"metre\",\n        \"centimetre\",\n        \"millimetre\",\n        \"micrometre\",\n        \"nanometre\",\n        \"kilometre\",\n        \"foot\",\n        \"inch\",\n        \"mile\",\n        \"nauticalMile\",\n        \"astronomicalUnit\",\n        \"coulomb\",\n        \"joule\",\n        \"kilojoule\",\n        \"megajoule\",\n        \"gigajoule\",\n        \"electronvolt\",\n        \"megaelectronvolt\",\n        \"kilowattHour\",\n        \"newton\",\n        \"pound\",\n        \"ounce\",\n        \"ton\",\n        \"hertz\",\n        \"kilohertz\",\n        \"megahertz\",\n        \"gigahertz\",\n        \"kilogramPerCubicMetre\",\n        \"gramPerCubicMetre\",\n        \"lux\",\n        \"footcandle\",\n        \"henry\",\n        \"millihenry\",\n        \"microhenry\",\n        \"radian\",\n        \"degreeOfArc\",\n        \"minuteOfArc\",\n        \"secondOfArc\",\n        \"turn\",\n        \"radian\",\n        \"degreeOfArc\",\n        \"minuteOfArc\",\n        \"secondOfArc\",\n        \"turn\",\n        \"metre\",\n        \"centimetre\",\n        \"millimetre\",\n        \"micrometre\",\n        \"nanometre\",\n        \"kilometre\",\n        \"foot\",\n        \"inch\",\n        \"mile\",\n        \"nauticalMile\",\n        \"astronomicalUnit\",\n        \"candelaPerSquareMetre\",\n        \"watt\",\n        \"microwatt\",\n        \"milliwatt\",\n        \"kilowatt\",\n        \"megawatt\",\n        \"gigawatt\",\n        \"horsepower\",\n        \"kilowattHourPerYear\",\n        \"lumen\",\n        \"candela\",\n        \"weber\",\n        \"maxwell\",\n        \"tesla\",\n        \"kilogram\",\n        \"gram\",\n        \"milligram\",\n        \"microgram\",\n        \"tonne\",\n        \"slug\",\n        \"gramPerSecond\",\n        \"kilogramPerSecond\",\n        \"gramPerHour\",\n        \"kilogramPerHour\",\n        \"watt\",\n        \"microwatt\",\n        \"milliwatt\",\n        \"kilowatt\",\n        \"megawatt\",\n        \"gigawatt\",\n        \"horsepower\",\n        \"kilowattHourPerYear\",\n        \"pascal\",\n        \"kilopascal\",\n        \"bar\",\n        \"millibar\",\n        \"millimetresOfMercury\",\n        \"poundPerSquareInch\",\n        \"inchesOfMercury\",\n        \"inchesOfWater\",\n        \"unity percent\",\n        \"ohm\",\n        \"milliohm\",\n        \"kiloohm\",\n        \"megaohm\",\n        \"decibel\",\n        \"bel\",\n        \"kelvin\",\n        \"degreeCelsius\",\n        \"degreeFahrenheit\",\n        \"newton\",\n        \"pound\",\n        \"ounce\",\n        \"ton\",\n        \"second\",\n        \"millisecond\",\n        \"microsecond\",\n        \"nanosecond\",\n        \"minute\",\n        \"hour\",\n        \"day\",\n        \"year\",\n        \"newtonMetre\",\n        \"metrePerSecond\",\n        \"centimetrePerSecond\",\n        \"kilometrePerSecond\",\n        \"metrePerHour\",\n        \"kilometrePerHour\",\n        \"milePerHour\",\n        \"milePerSecond\",\n        \"knot\",\n        \"volt\",\n        \"millivolt\",\n        \"microvolt\",\n        \"kilovolt\",\n        \"megavolt\",\n        \"cubicMetre\",\n        \"cubicCentimetre\",\n        \"litre\",\n        \"millilitre\",\n        \"cubicFoot\",\n        \"cubicInch\",\n        \"fluidOunce\",\n        \"gallon\",\n        \"litrePerSecond\",\n        \"millilitrePerSecond\",\n        \"litrePerHour\",\n        \"millilitrePerHour\",\n    ].sort()\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/***\n * Jacdac service/device specification to DTDL\n *\n *  DTDL specification: https://github.com/Azure/opendigitaltwins-dtdl/blob/master/DTDL/v2/dtdlv2.md.\n */\n\nimport {\n    serviceSpecificationFromClassIdentifier,\n    serviceSpecificationFromName,\n} from \"../jdom/spec\"\nimport { uniqueMap } from \"../jdom/utils\"\nimport {\n    arraySchema,\n    DTDLContent,\n    DTDLInterface,\n    DTDLSchema,\n    DTDL_CONTEXT,\n    escapeDisplayName,\n    escapeName,\n    objectSchema,\n} from \"./dtdl\"\n\n// https://github.com/Azure/digital-twin-model-identifier\n// ^dtmi:(?:_+[A-Za-z0-9]|[A-Za-z])(?:[A-Za-z0-9_]*[A-Za-z0-9])?(?::(?:_+[A-Za-z0-9]|[A-Za-z])(?:[A-Za-z0-9_]*[A-Za-z0-9])?)*;[1-9][0-9]{0,8}$\nfunction toDTMI(segments: (string | number)[], version?: number) {\n    return `dtmi:jacdac:${[...segments]\n        .map(seg =>\n            seg === undefined\n                ? \"???\"\n                : typeof seg === \"string\"\n                ? seg\n                : `x${seg.toString(16)}`\n        )\n        .map(seg => seg.replace(/(-|_)/g, \"\"))\n        .join(\":\")};${version !== undefined ? version : 1}`.toLowerCase()\n}\n\nfunction toUnit(pkt: jdspec.PacketInfo) {\n    if (pkt.fields.length !== 1) return undefined\n    const field = pkt.fields[0]\n    if (!field.unit) return undefined\n\n    /**\n     *     type Unit = \"m\" | \"kg\" | \"g\" | \"s\" | \"A\" | \"K\" | \"cd\" | \"mol\" | \"Hz\" | \"rad\" | \"sr\" | \"N\" | \"Pa\" | \"J\" | \"W\" | \"C\" | \"V\" | \"F\" | \"Ohm\"\n        | \"S\" | \"Wb\" | \"T\" | \"H\" | \"Cel\" | \"lm\" | \"lx\" | \"Bq\" | \"Gy\" | \"Sv\" | \"kat\" | \"m2\" | \"m3\" | \"l\" | \"m/s\" | \"m/s2\" | \"m3/s\" | \"l/s\"\n        | \"W/m2\" | \"cd/m2\" | \"bit\" | \"bit/s\" | \"lat\" | \"lon\" | \"pH\" | \"dB\" | \"dBW\" | \"Bspl\" | \"count\" | \"/\" | \"%RH\" | \"%EL\" | \"EL\"\n        | \"1/s\" | \"1/min\" | \"beat/min\" | \"beats\" | \"S/m\" | \"B\" | \"VA\" | \"VAs\" | \"var\" | \"vars\" | \"J/m\" | \"kg/m3\" | \"deg\";\n\n    type SecondaryUnit = \"ms\" | \"min\" | \"h\" | \"MHz\" | \"kW\" | \"kVA\" | \"kvar\" | \"Ah\" | \"Wh\" | \"kWh\"\n        | \"varh\" | \"kvarh\" | \"kVAh\" | \"Wh/km\" | \"KiB\" | \"GB\" | \"Mbit/s\" | \"B/s\" | \"MB/s\" | \"mV\" | \"mA\" | \"dBm\" | \"ug/m3\"\n        | \"mm/h\" | \"m/h\" | \"ppm\" | \"/100\" | \"/1000\" | \"hPa\" | \"mm\" | \"cm\" | \"km\" | \"km/h\";\n     */\n    const units: jdspec.SMap<{ semantic: string; unit: string }> = {\n        \"m/s2\": {\n            semantic: \"Acceleration\",\n            unit: \"metrePerSecondSquared\",\n        },\n        rad: {\n            semantic: \"Angle\",\n            unit: \"radian\",\n        },\n        \"rad/s\": {\n            semantic: \"AngularVelocity\",\n            unit: \"radianPerSecond\",\n        },\n        \"rad/s2\": {\n            semantic: \"AngularAcceleration\",\n            unit: \"radianPerSecondSquared\",\n        },\n        m: {\n            semantic: \"Length\",\n            unit: \"metre\",\n        },\n        m2: {\n            semantic: \"Area\",\n            unit: \"squareMetre\",\n        },\n        s: {\n            semantic: \"TimeSpan\",\n            unit: \"second\",\n        },\n        ms: {\n            semantic: \"TimeSpan\",\n            unit: \"millisecond\",\n        },\n        us: {\n            semantic: \"TimeSpan\",\n            unit: \"microsecond\",\n        },\n        K: {\n            semantic: \"Temperature\",\n            unit: \"kelvin\",\n        },\n        C: {\n            semantic: \"Temperature\",\n            unit: \"degreeCelsius\",\n        },\n        F: {\n            semantic: \"Temperature\",\n            unit: \"degreeFahrenheit\",\n        },\n        g: {\n            semantic: \"Acceleration\",\n            unit: \"gForce\",\n        },\n        mA: {\n            semantic: \"Current\",\n            unit: \"milliampere\",\n        },\n        uA: {\n            semantic: \"Current\",\n            unit: \"microampere\",\n        },\n        A: {\n            semantic: \"Current\",\n            unit: \"ampere\",\n        },\n        mV: {\n            semantic: \"Voltage\",\n            unit: \"millivolt\",\n        },\n        uV: {\n            semantic: \"Voltage\",\n            unit: \"microvolt\",\n        },\n        V: {\n            semantic: \"Voltage\",\n            unit: \"volt\",\n        },\n    }\n    const unit = units[field.unit]\n    if (unit) return unit\n\n    // ignoring some known units\n    if ([\"#\", \"/\"].indexOf(field.unit) > -1) return undefined\n\n    //console.warn(`unsupported unit ${field.unit}`)\n    return undefined\n}\n\n// https://github.com/Azure/opendigitaltwins-dtdl/blob/master/DTDL/v2/dtdlv2.md#primitive-schemas\n\nfunction enumDTDI(srv: jdspec.ServiceSpec, en: jdspec.EnumInfo): string {\n    return toDTMI([srv.classIdentifier, en.name])\n}\n\nfunction enumSchema(srv: jdspec.ServiceSpec, en: jdspec.EnumInfo): DTDLSchema {\n    const dtdl = {\n        \"@type\": \"Enum\",\n        \"@id\": enumDTDI(srv, en),\n        valueSchema: \"integer\",\n        enumValues: Object.keys(en.members).map(k => ({\n            name: escapeName(k),\n            displayName: k,\n            enumValue: en.members[k],\n        })),\n    }\n    return dtdl\n}\n\nfunction fieldType(\n    srv: jdspec.ServiceSpec,\n    pkt: jdspec.PacketInfo,\n    field: jdspec.PacketMember\n) {\n    let type: string\n    if (field.type == \"bool\") type = \"boolean\"\n    else if (field.isFloat) type = \"float\"\n    else if (field.isSimpleType) {\n        if (/^(u|i)/.test(field.type)) type = \"integer\"\n        else if (field.type === \"B\")\n            // base64 encoded binary data\n            type = \"string\"\n    } else if (field.type === \"string\" || field.type == \"string0\")\n        type = \"string\"\n    else if (field.shift && /^(u|i)/.test(field.type)) type = \"float\"\n    // decimal type\n    else {\n        const en = srv.enums[field.type]\n        if (en) type = enumDTDI(srv, en)\n    }\n\n    //if (!type)\n    //    console.warn(`unknown field type ${field.type}`, field)\n\n    return {\n        name: field.name == \"_\" ? pkt.name : field.name,\n        type: type,\n    }\n}\n\n// converts JADAC pkt data layout into a DTDL schema\nfunction toSchema(\n    srv: jdspec.ServiceSpec,\n    pkt: jdspec.PacketInfo,\n    supportsArray?: boolean\n): string | DTDLSchema {\n    const fields = pkt.fields.map(field => fieldType(srv, pkt, field))\n    if (!fields.length) return undefined\n\n    // a single data entry\n    if (fields.length === 1 && !pkt.fields[0].startRepeats)\n        return fields[0].type\n\n    // map fields into schema\n    const schemas: DTDLSchema[] = fields.map(field => ({\n        name: field.name,\n        schema: field.type,\n    }))\n\n    // is there an array?\n    const repeatIndex = pkt.fields.findIndex(field => field.startRepeats)\n\n    if (repeatIndex < 0) {\n        // no array\n        // wrap schemas into an object\n        return objectSchema(schemas)\n    }\n\n    // check if arrays are supported\n    if (!supportsArray) {\n        //console.warn(`arrays not supported in ${srv.shortName}.${pkt.name}`)\n        return undefined\n    }\n\n    if (repeatIndex == 0) {\n        // the whole structure is an array\n        return arraySchema(objectSchema(schemas))\n    } else {\n        // split fields into prelude and array data\n        const nonRepeat = schemas.slice(0, repeatIndex)\n        const repeats = schemas.slice(repeatIndex)\n        return objectSchema([\n            ...nonRepeat,\n            {\n                name: \"repeat\",\n                schema: arraySchema(\n                    repeats.length > 1 ? objectSchema(repeats) : repeats[0]\n                ),\n            },\n        ])\n    }\n}\n\nfunction packetToDTDL(\n    srv: jdspec.ServiceSpec,\n    pkt: jdspec.PacketInfo\n): DTDLContent {\n    const types: jdspec.SMap<string> = {\n        const: \"Property\",\n        rw: \"Property\",\n        ro: \"Telemetry\",\n        event: \"Telemetry\",\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const dtdl: any = {\n        \"@type\": types[pkt.kind] || `Unsupported${pkt.kind}`,\n        name: pkt.name,\n        \"@id\": toDTMI([srv.classIdentifier, pkt.kind, pkt.name]),\n        description: pkt.description,\n    }\n    switch (pkt.kind) {\n        case \"report\":\n        case \"command\":\n            // https://docs.microsoft.com/en-us/azure/digital-twins/concepts-models#azure-digital-twins-dtdl-implementation-specifics\n            return undefined\n        case \"const\":\n        case \"rw\":\n        case \"ro\":\n        case \"event\": {\n            const unit = toUnit(pkt)\n            if (unit) {\n                dtdl.unit = unit.unit\n            }\n            dtdl.schema = toSchema(srv, pkt, false)\n            if (pkt.kind === \"rw\") dtdl.writable = true\n            if (!dtdl.schema && pkt.kind === \"event\") {\n                // keep a count of the events\n                dtdl[\"@type\"] = [dtdl[\"@type\"], \"Event\"]\n                dtdl.schema = toDTMI([srv.classIdentifier, \"event\"])\n            } else if (unit && unit.semantic)\n                dtdl[\"@type\"] = [dtdl[\"@type\"], unit.semantic]\n            break\n        }\n        default:\n            //console.log(`unknown packet kind ${pkt.kind}`)\n            break\n    }\n\n    if (!dtdl.schema) {\n        //console.log(`unknown schema for ${srv.name}.${pkt.name}`);\n        return undefined\n    }\n\n    return dtdl\n}\n\nexport function serviceSpecificationToDTDL(\n    srv: jdspec.ServiceSpec\n): DTDLInterface {\n    const dtdl: DTDLInterface = {\n        \"@type\": \"Interface\",\n        \"@id\": serviceSpecificationDTMI(srv),\n        displayName: escapeDisplayName(srv.name),\n        description: srv.notes[\"short\"],\n        contents: srv.packets\n            .filter(pkt => !pkt.derived && !pkt.internal)\n            .map(pkt => {\n                try {\n                    return packetToDTDL(srv, pkt)\n                } catch (e) {\n                    console.log(`failed to generate DTDL for ${srv.name}`, e)\n                    return undefined\n                }\n            })\n            .filter(c => !!c),\n    }\n    if (srv.extends.length)\n        dtdl.extends = srv.extends.map(id =>\n            serviceSpecificationDTMI(serviceSpecificationFromName(id))\n        )\n\n    const hasEvents = srv.packets.find(pkt => pkt.kind === \"event\")\n    const hasEnums = Object.keys(srv.enums).length\n    if (hasEvents || hasEnums) {\n        dtdl.schemas = []\n        if (hasEvents)\n            dtdl.schemas.push({\n                \"@id\": toDTMI([srv.classIdentifier, \"event\"]),\n                \"@type\": \"Object\",\n                fields: [\n                    {\n                        name: \"count\",\n                        schema: \"integer\",\n                    },\n                ],\n            })\n        if (hasEnums)\n            dtdl.schemas = dtdl.schemas.concat(\n                Object.keys(srv.enums).map(en => enumSchema(srv, srv.enums[en]))\n            )\n    }\n    dtdl[\"@context\"] = DTDL_CONTEXT\n    return dtdl\n}\n\nexport function serviceSpecificationToComponent(\n    srv: jdspec.ServiceSpec,\n    name: string\n): any {\n    const dtdl = {\n        \"@type\": \"Component\",\n        name: name,\n        displayName: escapeDisplayName(srv.name),\n        schema: serviceSpecificationDTMI(srv),\n    }\n    return dtdl\n}\n\nexport interface DTDLGenerationOptions {\n    inlineServices?: boolean // generate all services\n}\n\nexport function serviceSpecificationDTMI(srv: jdspec.ServiceSpec) {\n    return toDTMI([\"services\", srv.classIdentifier])\n}\n\nexport function deviceSpecificationDTMI(dev: jdspec.DeviceSpec) {\n    return toDTMI([\"devices\", dev.id.replace(/-/g, \":\")])\n}\n\nexport function DTMIToRoute(dtmi: string) {\n    const route =\n        dtmi.toLowerCase().replace(/;/, \"-\").replace(/:/g, \"/\") + \".json\"\n    return route\n}\n\nexport function deviceSpecificationToDTDL(\n    dev: jdspec.DeviceSpec,\n    options?: DTDLGenerationOptions\n): any {\n    const services = dev.services.map(srv =>\n        serviceSpecificationFromClassIdentifier(srv)\n    )\n    const uniqueServices = uniqueMap(\n        services,\n        srv => srv.classIdentifier.toString(),\n        srv => srv\n    )\n    const schemas = uniqueServices.map(srv => serviceSpecificationToDTDL(srv))\n\n    // allocate names\n    const names: string[] = []\n    services.forEach(srv => {\n        const name = escapeName(srv.shortId || srv.shortName)\n        if (names.indexOf(name) < 0) names.push(name)\n        else {\n            let count = 2\n            while (names.indexOf(name + count) > -1) count++\n            names.push(name + count)\n        }\n    })\n\n    const dtdl: DTDLInterface = {\n        \"@type\": \"Interface\",\n        \"@id\": deviceSpecificationDTMI(dev),\n        displayName: escapeDisplayName(dev.name),\n        description: dev.description,\n        contents: services.map((srv, i) =>\n            serviceSpecificationToComponent(srv, names[i])\n        ),\n        \"@context\": DTDL_CONTEXT,\n    }\n    if (options?.inlineServices) return [dtdl, ...schemas]\n    else return dtdl\n}\n","import { DependencyList, useEffect } from \"react\"\n\nexport default function useWindowEvent<K extends keyof WindowEventMap>(type: K,\n    listener: (this: Window, ev: WindowEventMap[K]) => any,\n    passive = false,\n    deps: DependencyList) {\n    useEffect(() => {\n        if (typeof window === \"undefined\")\n            return undefined; // SSR\n\n        // initiate the event handler\n        window.addEventListener<K>(type, listener, passive)\n\n        // this will clean up the event every time the component is re-rendered\n        return () => {\n            window.removeEventListener<K>(type, listener)\n        }\n    }, [type, listener, passive].concat(deps || []))\n}","import { useMemo, useContext } from \"react\";\nimport { unique } from \"../../../jacdac-ts/src/jdom/utils\";\nimport { makeCodeServices } from \"../../../jacdac-ts/src/jdom/makecode\"\nimport useWindowEvent from \"../hooks/useWindowEvent\"\nimport MakeCodeSnippetContext from \"./MakeCodeSnippetContext\";\n\nexport interface MakeCodeSnippetSource {\n    code: string;\n    ghost?: string;\n    meta: {\n        editor?: string;\n        snippet?: boolean;\n        dependencies: string[];\n    }\n}\n\nexport interface MakeCodeSnippetRendered {\n    uri?: string;\n    width?: number;\n    height?: number;\n    error?: string;\n}\n\n\n\nexport function parseMakeCodeSnippet(source: string): MakeCodeSnippetSource {\n    let ghost: string;\n    let code: string;\n    const meta: {\n        editor?: string;\n        snippet?: boolean;\n        dependencies: string[];\n    } = {\n        dependencies: []\n    }\n\n    if (/^---\\n/.test(source)) {\n        let front: string;\n        const parts = source.replace(/^---\\n/, '').split(/---\\n/gm)\n        switch (parts.length) {\n            case 1: front = ghost = undefined; code = source; break;\n            case 2: [front, code] = parts; break;\n            default: [front, ghost, code] = parts; break;\n        }\n\n        // parse front matter\n        front?.replace(/(.+):\\s*(.+)\\s*\\n/g, (m, name, value) => {\n            switch (name) {\n                case \"dep\": meta.dependencies.push(value); break;\n                case \"snippet\": meta.snippet = !!value; break;\n                default: meta[name] = value;\n            }\n            return \"\";\n        })\n    } else {\n        code = source;\n    }\n\n    // sniff services\n    const mkcds = makeCodeServices()\n    mkcds.filter(info => {\n        const src = (ghost || \"\") + \"\\n\" + (code || \"\");\n        return src.indexOf(info.client.qName) > -1\n            || (info.client.default && src.indexOf(info.client.default) > -1);\n    }).map(info => `${info.client.name.replace(/^pxt-/, '')}=github:${info.client.repo}`)\n        .forEach(dep => meta.dependencies.push(dep));\n\n    // add jacdac by default\n    if (!meta.dependencies.length)\n        meta.dependencies.push(\"jacdac=github:microsoft/pxt-jacdac\");\n\n    // ensure unique deps\n    meta.dependencies = unique(meta.dependencies);\n\n    return {\n        code,\n        ghost,\n        meta\n    }\n}\n\ninterface RenderBlocksRequestMessage {\n    type: \"renderblocks\",\n    id: string;\n    code: string;\n    ghost?: string;\n    options?: {\n        packageId?: string;\n        package?: string;\n        snippetMode?: boolean;\n        dependencies?: string[];\n    }\n}\n\ninterface RenderBlocksResponseMessage {\n    source: \"makecode\",\n    type: \"renderblocks\",\n    id: string;\n    uri?: string;\n    css?: string;\n    svg?: string;\n    width?: number;\n    height?: number;\n    error?: string;\n}\n\ninterface RenderBlocksRequentResponse {\n    req: RenderBlocksRequestMessage,\n    resolve: (resp: RenderBlocksResponseMessage) => void,\n    reject: (e: unknown) => void\n}\n\nexport function useMakeCodeRenderer() {\n    const { target, rendererUrl } = useContext(MakeCodeSnippetContext);\n    const lang = \"\"\n    const iframeId = \"makecoderenderer\" + target;\n    const pendingRequests = useMemo<{\n        [index: string]: RenderBlocksRequentResponse\n    }>(() => ({}), [target, lang]);\n\n    const sendRequest = (req: RenderBlocksRequestMessage) => {\n        const iframe = typeof document !== \"undefined\" && document.getElementById(iframeId) as HTMLIFrameElement;\n        if (iframe?.dataset.ready)\n            iframe?.contentWindow.postMessage(req, rendererUrl);\n    }\n\n    const render = (source: MakeCodeSnippetSource): Promise<MakeCodeSnippetRendered> => {\n        const { code, ghost, meta } = source;\n        const { dependencies, snippet } = meta;\n\n        // spin up iframe on demans\n        if (typeof document !== \"undefined\" && !document.getElementById(iframeId)) {\n            console.log(`mkcd: loading iframe`)\n            const f = document.createElement(\"iframe\");\n            f.id = iframeId;\n            f.style.position = \"absolute\";\n            f.style.left = \"0\";\n            f.style.bottom = \"0\";\n            f.style.width = \"1px\";\n            f.style.height = \"1px\";\n            f.src = `${rendererUrl}?render=1${lang ? `&lang=${lang}` : ''}`;\n            document.body.appendChild(f);\n        }\n\n        const req: RenderBlocksRequestMessage = {\n            type: \"renderblocks\",\n            id: \"r\" + Math.random(),\n            code,\n            ghost,\n            options: {\n                dependencies,\n                snippetMode: snippet\n            }\n        }\n        return new Promise<RenderBlocksResponseMessage>((resolve, reject) => {\n            pendingRequests[req.id] = { req, resolve, reject }\n            sendRequest(req);\n        })\n    }\n\n    // listen for messages\n    const handleMessage = (ev: MessageEvent) => {\n        const msg = ev.data;\n        if (msg.source != \"makecode\") return;\n        switch (msg.type) {\n            case \"renderready\": {\n                console.log(`mkcd: renderer ready, ${Object.keys(pendingRequests).length} pending`)\n                const iframe = typeof document !== \"undefined\" && document.getElementById(iframeId)\n                if (iframe) {\n                    console.log(`flushing messages`)\n                    iframe.dataset.ready = \"1\"\n                    Object.keys(pendingRequests)\n                        .forEach(k => sendRequest(pendingRequests[k].req));\n                }\n                break;\n            }\n            case \"renderblocks\": {\n                const id = msg.id; // this is the id you sent\n                const r = pendingRequests[id];\n                if (!r) return;\n                delete pendingRequests[id];\n                r.resolve(msg as RenderBlocksResponseMessage);\n                break;\n            }\n        }\n    }\n\n    useWindowEvent(\"message\", handleMessage, false, [])\n\n    return {\n        render\n    }\n}\n","import { createStyles, makeStyles } from \"@material-ui/core\"\nimport React, { useContext, useEffect, useRef } from \"react\"\nimport {\n    PACKET_PROCESS,\n    PACKET_SEND,\n} from \"../../../jacdac-ts/src/jdom/constants\"\nimport { PacketMessage } from \"../../../jacdac-ts/src/jdom/iframebridgeclient\"\nimport Packet from \"../../../jacdac-ts/src/jdom/packet\"\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\"\nimport PaperBox from \"../ui/PaperBox\"\nimport MakeCodeSnippetContext from \"./MakeCodeSnippetContext\"\nimport { MakeCodeSnippetSource } from \"./useMakeCodeRenderer\"\n\nconst useStyles = makeStyles(() =>\n    createStyles({\n        root: {\n            width: \"100%\",\n        },\n        root2: {\n            position: \"relative\",\n            paddingTop: \"86.75%\",\n        },\n        iframe: {\n            position: \"absolute\",\n            left: 0,\n            top: 0,\n            border: \"none\",\n            width: \"100%\",\n            height: \"100%\",\n        },\n    })\n)\n\nexport default function MakeCodeSimulator(props: {\n    snippet: MakeCodeSnippetSource\n}) {\n    const { simUrl } = useContext(MakeCodeSnippetContext)\n    const { snippet } = props\n    const { code, ghost, meta } = snippet\n    const { dependencies } = meta\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const frameRef = useRef<HTMLIFrameElement>()\n    const classes = useStyles()\n\n    const src = `${ghost || \"\"}\\n${code || \"\"}`\n    const url = `${simUrl}#single=1&fullscren=1&nofooter=1&deps=${encodeURIComponent(\n        dependencies.join(\",\")\n    )}&code=${encodeURIComponent(src)}`\n    const origin = new URL(url).origin\n\n    useEffect(() =>\n        bus.subscribe([PACKET_SEND, PACKET_PROCESS], (pkt: Packet) => {\n            this.packetSent++\n            const msg: PacketMessage = {\n                type: \"messagepacket\",\n                channel: \"jacdac\",\n                broadcast: true,\n                data: pkt.toBuffer(),\n                sender: pkt.sender,\n            }\n            frameRef.current?.contentWindow?.postMessage(msg, origin)\n        })\n    )\n\n    return (\n        <PaperBox>\n            <div className={classes.root}>\n                <div className={classes.root2}>\n                    <iframe\n                        ref={frameRef}\n                        className={classes.iframe}\n                        src={url}\n                        aria-label=\"MakeCode rendering iframe to generate blocks images.\"\n                    />\n                </div>\n            </div>\n        </PaperBox>\n    )\n}\n","import React, { useState, useMemo, useContext } from \"react\";\nimport PaperBox from \"../ui/PaperBox\"\nimport { Tab, Tabs } from '@material-ui/core';\nimport CodeBlock from \"../CodeBlock\";\nimport TabPanel from '../ui/TabPanel';\nimport MakeCodeSnippetContext from \"./MakeCodeSnippetContext\";\nimport { parseMakeCodeSnippet } from \"./useMakeCodeRenderer\";\nimport MakeCodeSimulator from \"./MakeCodeSimulator\";\nimport { withPrefix } from \"gatsby\"\ninterface Rendered {\n    url: string;\n    width: number;\n    height: number;\n}\n\nexport default function MakeCodeSnippet(props: { renderedSource: string }) {\n    const { renderedSource } = props;\n    const { source, rendered } = JSON.parse(renderedSource) as { source: string; rendered: Rendered; }\n    const { height, width, url } = rendered || {};\n    const tabs = [\"blocks\", \"typescript\", \"sim\"]\n    const { editor, setEditor } = useContext(MakeCodeSnippetContext);\n    const [tab, setTab] = useState(tabs.indexOf(editor) || 0);\n    const handleTabChange = (event: React.ChangeEvent<unknown>, newValue: number) => {\n        if (newValue < tabs.length - 1)\n            setEditor(tabs[newValue]);\n        setTab(newValue);\n    };\n    const snippet = useMemo(() => parseMakeCodeSnippet(source), [source]);\n    const { code } = snippet;\n\n    return <PaperBox>\n        <Tabs value={tab} onChange={handleTabChange} aria-label=\"Select MakeCode editor\">\n            <Tab label={\"Blocks\"} />\n            <Tab label={\"JavaScript\"} />\n            <Tab label={\"Simulator\"} />\n        </Tabs>\n        <TabPanel value={tab} index={0}>\n            <img src={withPrefix(url)} alt={source} loading=\"lazy\" />\n        </TabPanel>\n        <TabPanel value={tab} index={1}>\n            <CodeBlock className=\"typescript\">{code}</CodeBlock>\n        </TabPanel>\n        <TabPanel value={tab} index={2}>\n            <MakeCodeSimulator snippet={snippet} />\n        </TabPanel>\n    </PaperBox>\n}\n","import React, { lazy, useContext } from \"react\"\nimport Highlight, {\n    defaultProps,\n    Language,\n    PrismTheme,\n} from \"prism-react-renderer\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport LIGHT_THEME from \"prism-react-renderer/themes/github\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport DARK_THEME from \"prism-react-renderer/themes/vsDark\"\nimport DarkModeContext from \"./ui/DarkModeContext\"\nimport { IconButton, Link } from \"gatsby-theme-material-ui\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport GetAppIcon from \"@material-ui/icons/GetApp\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport LaunchIcon from \"@material-ui/icons/Launch\"\nimport Tooltip from \"./ui/Tooltip\"\nimport MakeCodeSnippet from \"./makecode/MakeCodeSnippet\"\nimport Suspense from \"./ui/Suspense\"\n\nconst TraceSnippet = lazy(() => import(\"./TraceSnippet\"))\nconst CodeSandboxButton = lazy(() => import(\"./ui/CodeSandboxButton\"))\n\nfunction HighlightedCode(props: {\n    children: string\n    codeSandbox?: boolean\n    className?: string\n    downloadName?: string\n    downloadText?: string\n    url?: string\n}) {\n    const {\n        children,\n        codeSandbox,\n        className,\n        downloadName,\n        downloadText,\n        url,\n    } = props\n    const { darkMode } = useContext(DarkModeContext)\n    const language = className?.replace(/language-/, \"\") || \"\"\n    const theme = (darkMode === \"dark\" ? DARK_THEME : LIGHT_THEME) as PrismTheme\n    const valueUri =\n        !!downloadText &&\n        `data:application/json;charset=UTF-8,${encodeURIComponent(\n            downloadText\n        )}`\n\n    return (\n        <Highlight\n            {...defaultProps}\n            code={children?.replace(/[\\s\\r\\n]*$/g, \"\") || \"\"}\n            language={language as Language}\n            theme={theme}\n        >\n            {({ className, style, tokens, getLineProps, getTokenProps }) => (\n                <pre className={className} style={{ ...style }}>\n                    {!!url && (\n                        <Link style={{ float: \"right\" }} href={url}>\n                            <Tooltip title={`Open ${url}`}>\n                                <IconButton>\n                                    <LaunchIcon />\n                                </IconButton>\n                            </Tooltip>\n                        </Link>\n                    )}\n                    {!!downloadText && (\n                        <Link\n                            style={{ float: \"right\" }}\n                            href={valueUri}\n                            download={downloadName || \"download\"}\n                        >\n                            <Tooltip title=\"Download\">\n                                <IconButton>\n                                    <GetAppIcon />\n                                </IconButton>\n                            </Tooltip>\n                        </Link>\n                    )}\n                    {codeSandbox && (\n                        <div style={{ float: \"right\" }}>\n                            <Suspense>\n                                <CodeSandboxButton source={children} />\n                            </Suspense>\n                        </div>\n                    )}\n                    {tokens?.map((line, index) => {\n                        const lineProps = getLineProps({ line, key: index })\n                        return (\n                            <div key={index} {...lineProps}>\n                                {line.map((token, key) => (\n                                    <span\n                                        key={key}\n                                        {...getTokenProps({ token, key })}\n                                    />\n                                ))}\n                            </div>\n                        )\n                    })}\n                </pre>\n            )}\n        </Highlight>\n    )\n}\n\nexport default function CodeBlock(props: {\n    children: string\n    className?: string\n    downloadName?: string\n    downloadText?: string\n    url?: string\n}) {\n    const { children, className } = props\n    const language = className?.replace(/language-/, \"\") || \"\"\n\n    switch (language) {\n        case \"trace\":\n            return (\n                <Suspense>\n                    <TraceSnippet source={children} />\n                </Suspense>\n            )\n        case \"blocks\":\n            return <MakeCodeSnippet renderedSource={children} />\n        case \"vanilla\":\n            return (\n                <HighlightedCode\n                    {...props}\n                    className={\"javascript\"}\n                    codeSandbox={true}\n                />\n            )\n        default:\n            return <HighlightedCode {...props} />\n    }\n}\n","import { Box, BoxProps, Paper, PaperProps, useTheme } from \"@material-ui/core\";\nimport React from \"react\";\n\nexport default function PaperBox(props: { padding?: number; elevation?: number; bgcolor?: string } & BoxProps) {\n    const { children, padding, elevation, bgcolor, ...others } = props;\n    const theme = useTheme();\n\n    return <Box {...others} bgcolor={bgcolor} mb={theme.spacing(0.25)}>\n        <Paper square elevation={elevation}>\n            {padding !== 0 && <Box p={theme.spacing(padding || 0.25)}>\n                {children}\n            </Box>}\n            {padding === 0 && children}\n        </Paper>\n    </Box>\n}","import { Typography } from \"@material-ui/core\"\nimport React from \"react\"\nimport CodeBlock from \"../CodeBlock\"\n\nexport default function Snippet(props: {\n    value: string | (() => string)\n    mode?: string\n    download?: string\n    url?: string\n    caption?: string | JSX.Element | JSX.Element[]\n}) {\n    const { value, mode, download, url, caption } = props\n    const v: string = typeof value === \"function\" ? value() : value\n    const className = mode && `language-${mode === \"sts\" ? \"ts\" : mode}`\n    return (\n        <>\n            <CodeBlock\n                className={className}\n                downloadName={download}\n                downloadText={download && v}\n                url={url}\n            >\n                {v}\n            </CodeBlock>\n            {caption && <Typography variant=\"caption\">{caption}</Typography>}\n        </>\n    )\n}\n"],"sourceRoot":""}