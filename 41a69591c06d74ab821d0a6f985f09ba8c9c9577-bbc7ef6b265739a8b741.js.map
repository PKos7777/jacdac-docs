{"version":3,"file":"41a69591c06d74ab821d0a6f985f09ba8c9c9577-bbc7ef6b265739a8b741.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAiD;AACE;AACsB;AACtB;AACpC;AACf,SAAS,iCAAc,SAAS,kCAAe,SAAS,6CAA0B,SAAS,kCAAe;AAC1G;;;;;;;;;;;;;;;;;;;;;;ACN0D;AACA;AACY;AACoB;AAC3D;AACO;AACd;AAC4B;AACjB;AACN;AACiB;AACI;AACC;AAC5C;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;;AAEL,sDAAsD,MAAM;AAC5D;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,wDAAwD,KAAK;AAC7D,gBAAgB;;AAEhB,wDAAwD,KAAK;AAC7D;AACA;AACA;AACA,6BAA6B,gBAAgB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,uBAAQ;AACvE;AACA,cAAc,0CAAwB;;AAEtC,uBAAuB,gCAAa;AACpC;AACA;AACA;AACA;AACA,GAAG;AACH,wBAAwB,gCAAc;AACtC;AACA;;AAEA,qBAAqB,iBAAiB;AACtC;;AAEA;AACA;AACA;AACA,GAAG;;AAEH,8BAA8B,sBAAsB;AACpD,+BAA+B,QAAQ;AACvC;AACA;;AAEA,qBAAqB,aAAa;AAClC;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,sBAAsB,mBAAmB,CAAC,oBAAK,EAAE,8BAAQ;AACzD,eAAe,qBAAI;AACnB;AACA;AACA,GAAG,uBAAuB,mBAAmB,CAAC,iDAAyB;AACvE;AACA,GAAG,yBAAyB,mBAAmB,sBAAsB,8BAAQ;AAC7E;AACA;AACA,GAAG,iCAAiC,mBAAmB;AACvD;AACA;AACA;AA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","sources":["webpack://jacdac-docs/./node_modules/@babel/runtime/helpers/esm/toArray.js","webpack://jacdac-docs/./node_modules/@material-ui/core/esm/Accordion/Accordion.js","webpack://jacdac-docs/./node_modules/@material-ui/core/esm/Accordion/AccordionContext.js","webpack://jacdac-docs/./node_modules/@material-ui/core/esm/AccordionDetails/AccordionDetails.js","webpack://jacdac-docs/./node_modules/@material-ui/core/esm/AccordionSummary/AccordionSummary.js","webpack://jacdac-docs/./node_modules/@material-ui/core/esm/CardActions/CardActions.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/ExpandMore.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/FiberManualRecord.js","webpack://jacdac-docs/./src/components/ReadingFieldGrid.tsx","webpack://jacdac-docs/./src/components/model-editor/ModelOutput.tsx"],"sourcesContent":["import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _toArray(arr) {\n  return arrayWithHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableRest();\n}","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _toArray from \"@babel/runtime/helpers/esm/toArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport { isFragment } from 'react-is';\nimport clsx from 'clsx';\nimport { chainPropTypes } from '@material-ui/utils';\nimport Collapse from '../Collapse';\nimport Paper from '../Paper';\nimport withStyles from '../styles/withStyles';\nimport AccordionContext from './AccordionContext';\nimport useControlled from '../utils/useControlled';\nexport var styles = function styles(theme) {\n  var transition = {\n    duration: theme.transitions.duration.shortest\n  };\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      position: 'relative',\n      transition: theme.transitions.create(['margin'], transition),\n      '&:before': {\n        position: 'absolute',\n        left: 0,\n        top: -1,\n        right: 0,\n        height: 1,\n        content: '\"\"',\n        opacity: 1,\n        backgroundColor: theme.palette.divider,\n        transition: theme.transitions.create(['opacity', 'background-color'], transition)\n      },\n      '&:first-child': {\n        '&:before': {\n          display: 'none'\n        }\n      },\n      '&$expanded': {\n        margin: '16px 0',\n        '&:first-child': {\n          marginTop: 0\n        },\n        '&:last-child': {\n          marginBottom: 0\n        },\n        '&:before': {\n          opacity: 0\n        }\n      },\n      '&$expanded + &': {\n        '&:before': {\n          display: 'none'\n        }\n      },\n      '&$disabled': {\n        backgroundColor: theme.palette.action.disabledBackground\n      }\n    },\n\n    /* Styles applied to the root element if `square={false}`. */\n    rounded: {\n      borderRadius: 0,\n      '&:first-child': {\n        borderTopLeftRadius: theme.shape.borderRadius,\n        borderTopRightRadius: theme.shape.borderRadius\n      },\n      '&:last-child': {\n        borderBottomLeftRadius: theme.shape.borderRadius,\n        borderBottomRightRadius: theme.shape.borderRadius,\n        // Fix a rendering issue on Edge\n        '@supports (-ms-ime-align: auto)': {\n          borderBottomLeftRadius: 0,\n          borderBottomRightRadius: 0\n        }\n      }\n    },\n\n    /* Styles applied to the root element if `expanded={true}`. */\n    expanded: {},\n\n    /* Styles applied to the root element if `disabled={true}`. */\n    disabled: {}\n  };\n};\nvar Accordion = /*#__PURE__*/React.forwardRef(function Accordion(props, ref) {\n  var childrenProp = props.children,\n      classes = props.classes,\n      className = props.className,\n      _props$defaultExpande = props.defaultExpanded,\n      defaultExpanded = _props$defaultExpande === void 0 ? false : _props$defaultExpande,\n      _props$disabled = props.disabled,\n      disabled = _props$disabled === void 0 ? false : _props$disabled,\n      expandedProp = props.expanded,\n      onChange = props.onChange,\n      _props$square = props.square,\n      square = _props$square === void 0 ? false : _props$square,\n      _props$TransitionComp = props.TransitionComponent,\n      TransitionComponent = _props$TransitionComp === void 0 ? Collapse : _props$TransitionComp,\n      TransitionProps = props.TransitionProps,\n      other = _objectWithoutProperties(props, [\"children\", \"classes\", \"className\", \"defaultExpanded\", \"disabled\", \"expanded\", \"onChange\", \"square\", \"TransitionComponent\", \"TransitionProps\"]);\n\n  var _useControlled = useControlled({\n    controlled: expandedProp,\n    default: defaultExpanded,\n    name: 'Accordion',\n    state: 'expanded'\n  }),\n      _useControlled2 = _slicedToArray(_useControlled, 2),\n      expanded = _useControlled2[0],\n      setExpandedState = _useControlled2[1];\n\n  var handleChange = React.useCallback(function (event) {\n    setExpandedState(!expanded);\n\n    if (onChange) {\n      onChange(event, !expanded);\n    }\n  }, [expanded, onChange, setExpandedState]);\n\n  var _React$Children$toArr = React.Children.toArray(childrenProp),\n      _React$Children$toArr2 = _toArray(_React$Children$toArr),\n      summary = _React$Children$toArr2[0],\n      children = _React$Children$toArr2.slice(1);\n\n  var contextValue = React.useMemo(function () {\n    return {\n      expanded: expanded,\n      disabled: disabled,\n      toggle: handleChange\n    };\n  }, [expanded, disabled, handleChange]);\n  return /*#__PURE__*/React.createElement(Paper, _extends({\n    className: clsx(classes.root, className, expanded && classes.expanded, disabled && classes.disabled, !square && classes.rounded),\n    ref: ref,\n    square: square\n  }, other), /*#__PURE__*/React.createElement(AccordionContext.Provider, {\n    value: contextValue\n  }, summary), /*#__PURE__*/React.createElement(TransitionComponent, _extends({\n    in: expanded,\n    timeout: \"auto\"\n  }, TransitionProps), /*#__PURE__*/React.createElement(\"div\", {\n    \"aria-labelledby\": summary.props.id,\n    id: summary.props['aria-controls'],\n    role: \"region\"\n  }, children)));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiAccordion'\n})(Accordion);","import * as React from 'react';\n/**\n * @ignore - internal component.\n * @type {React.Context<{} | {expanded: boolean, disabled: boolean, toggle: () => void}>}\n */\n\nvar AccordionContext = React.createContext({});\n\nif (process.env.NODE_ENV !== 'production') {\n  AccordionContext.displayName = 'AccordionContext';\n}\n\nexport default AccordionContext;","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      display: 'flex',\n      padding: theme.spacing(1, 2, 2)\n    }\n  };\n};\nvar AccordionDetails = /*#__PURE__*/React.forwardRef(function AccordionDetails(props, ref) {\n  var classes = props.classes,\n      className = props.className,\n      other = _objectWithoutProperties(props, [\"classes\", \"className\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, className),\n    ref: ref\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiAccordionDetails'\n})(AccordionDetails);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\n/* eslint-disable jsx-a11y/aria-role */\n\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport { chainPropTypes } from '@material-ui/utils';\nimport ButtonBase from '../ButtonBase';\nimport IconButton from '../IconButton';\nimport withStyles from '../styles/withStyles';\nimport AccordionContext from '../Accordion/AccordionContext';\nexport var styles = function styles(theme) {\n  var transition = {\n    duration: theme.transitions.duration.shortest\n  };\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      display: 'flex',\n      minHeight: 8 * 6,\n      transition: theme.transitions.create(['min-height', 'background-color'], transition),\n      padding: theme.spacing(0, 2),\n      '&:hover:not($disabled)': {\n        cursor: 'pointer'\n      },\n      '&$expanded': {\n        minHeight: 64\n      },\n      '&$focused, &$focusVisible': {\n        backgroundColor: theme.palette.action.focus\n      },\n      '&$disabled': {\n        opacity: theme.palette.action.disabledOpacity\n      }\n    },\n\n    /* Pseudo-class applied to the root element, children wrapper element and `IconButton` component if `expanded={true}`. */\n    expanded: {},\n\n    /* Pseudo-class applied to the ButtonBase root element if the button is keyboard focused. */\n    focused: {},\n\n    /* Pseudo-class applied to the ButtonBase root element if the button is keyboard focused. */\n    focusVisible: {},\n\n    /* Pseudo-class applied to the root element if `disabled={true}`. */\n    disabled: {},\n\n    /* Styles applied to the children wrapper element. */\n    content: {\n      display: 'flex',\n      flexGrow: 1,\n      transition: theme.transitions.create(['margin'], transition),\n      margin: '12px 0',\n      '&$expanded': {\n        margin: '20px 0'\n      }\n    },\n\n    /* Styles applied to the `IconButton` component when `expandIcon` is supplied. */\n    expandIcon: {\n      transform: 'rotate(0deg)',\n      transition: theme.transitions.create('transform', transition),\n      '&:hover': {\n        // Disable the hover effect for the IconButton,\n        // because a hover effect should apply to the entire Expand button and\n        // not only to the IconButton.\n        backgroundColor: 'transparent'\n      },\n      '&$expanded': {\n        transform: 'rotate(180deg)'\n      }\n    }\n  };\n};\nvar AccordionSummary = /*#__PURE__*/React.forwardRef(function AccordionSummary(props, ref) {\n  var children = props.children,\n      classes = props.classes,\n      className = props.className,\n      expandIcon = props.expandIcon,\n      focusVisibleClassName = props.focusVisibleClassName,\n      _props$IconButtonProp = props.IconButtonProps,\n      IconButtonProps = _props$IconButtonProp === void 0 ? {} : _props$IconButtonProp,\n      onClick = props.onClick,\n      other = _objectWithoutProperties(props, [\"children\", \"classes\", \"className\", \"expandIcon\", \"focusVisibleClassName\", \"IconButtonProps\", \"onClick\"]);\n\n  var _React$useContext = React.useContext(AccordionContext),\n      _React$useContext$dis = _React$useContext.disabled,\n      disabled = _React$useContext$dis === void 0 ? false : _React$useContext$dis,\n      expanded = _React$useContext.expanded,\n      toggle = _React$useContext.toggle;\n\n  var handleChange = function handleChange(event) {\n    if (toggle) {\n      toggle(event);\n    }\n\n    if (onClick) {\n      onClick(event);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(ButtonBase, _extends({\n    focusRipple: false,\n    disableRipple: true,\n    disabled: disabled,\n    component: \"div\",\n    \"aria-expanded\": expanded,\n    className: clsx(classes.root, className, disabled && classes.disabled, expanded && classes.expanded),\n    focusVisibleClassName: clsx(classes.focusVisible, classes.focused, focusVisibleClassName),\n    onClick: handleChange,\n    ref: ref\n  }, other), /*#__PURE__*/React.createElement(\"div\", {\n    className: clsx(classes.content, expanded && classes.expanded)\n  }, children), expandIcon && /*#__PURE__*/React.createElement(IconButton, _extends({\n    className: clsx(classes.expandIcon, expanded && classes.expanded),\n    edge: \"end\",\n    component: \"div\",\n    tabIndex: null,\n    role: null,\n    \"aria-hidden\": true\n  }, IconButtonProps), expandIcon));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiAccordionSummary'\n})(AccordionSummary);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nexport var styles = {\n  /* Styles applied to the root element. */\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    padding: 8\n  },\n\n  /* Styles applied to the root element if `disableSpacing={false}`. */\n  spacing: {\n    '& > :not(:first-child)': {\n      marginLeft: 8\n    }\n  }\n};\nvar CardActions = /*#__PURE__*/React.forwardRef(function CardActions(props, ref) {\n  var _props$disableSpacing = props.disableSpacing,\n      disableSpacing = _props$disableSpacing === void 0 ? false : _props$disableSpacing,\n      classes = props.classes,\n      className = props.className,\n      other = _objectWithoutProperties(props, [\"disableSpacing\", \"classes\", \"className\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, className, !disableSpacing && classes.spacing),\n    ref: ref\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiCardActions'\n})(CardActions);","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z\"\n}), 'ExpandMore');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"circle\", {\n  cx: \"12\",\n  cy: \"12\",\n  r: \"8\"\n}), 'FiberManualRecord');\n\nexports.default = _default;","import {\n    Card,\n    CardActions,\n    CardContent,\n    CardHeader,\n    createStyles,\n    Grid,\n    makeStyles,\n} from \"@material-ui/core\"\nimport React from \"react\"\nimport JDRegister from \"../../jacdac-ts/src/jdom/register\"\nimport useGridBreakpoints from \"./useGridBreakpoints\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport FiberManualRecordIcon from \"@material-ui/icons/FiberManualRecord\"\nimport FieldDataSet from \"./FieldDataSet\"\nimport useDeviceName from \"./devices/useDeviceName\"\nimport SwitchWithLabel from \"./ui/SwitchWithLabel\"\n\nconst useStyles = makeStyles(() =>\n    createStyles({\n        vmiddle: {\n            verticalAlign: \"middle\",\n        },\n    })\n)\n\nfunction ReadingFieldGridItem(props: {\n    register: JDRegister\n    handleRegisterCheck: (register: JDRegister) => void\n    recording: boolean\n    registerChecked: boolean\n    liveDataSet?: FieldDataSet\n}) {\n    const {\n        register,\n        handleRegisterCheck,\n        recording,\n        registerChecked,\n        liveDataSet,\n    } = props\n    const { service } = register\n    const { device } = service\n    const gridBreakpoints = useGridBreakpoints()\n    const classes = useStyles()\n    const deviceName = useDeviceName(device)\n    const handleCheck = () => handleRegisterCheck(register)\n\n    return (\n        <Grid item {...gridBreakpoints} key={\"source\" + register.id}>\n            <Card>\n                <CardHeader\n                    subheader={register.service.name}\n                    title={`${deviceName}/${register.name}`}\n                />\n                <CardContent>\n                    {register.fields.map(field => (\n                        <span key={field.id}>\n                            <FiberManualRecordIcon\n                                className={classes.vmiddle}\n                                fontSize=\"large\"\n                                style={{\n                                    color:\n                                        (registerChecked &&\n                                            liveDataSet?.colorOf(field)) ||\n                                        \"#ccc\",\n                                }}\n                            />\n                            {field.name}\n                        </span>\n                    ))}\n                </CardContent>\n                <CardActions>\n                    <SwitchWithLabel\n                        disabled={recording}\n                        onChange={handleCheck}\n                        checked={registerChecked}\n                        label={`record ${deviceName}/${register.name}`}\n                    />\n                </CardActions>\n            </Card>\n        </Grid>\n    )\n}\n\nexport default function ReadingFieldGrid(props: {\n    readingRegisters: JDRegister[]\n    registerIdsChecked: string[]\n    recording?: boolean\n    handleRegisterCheck: (register: JDRegister) => void\n    liveDataSet?: FieldDataSet\n}) {\n    const {\n        readingRegisters,\n        registerIdsChecked,\n        recording,\n        handleRegisterCheck,\n        liveDataSet,\n    } = props\n\n    return (\n        <Grid container spacing={2}>\n            {readingRegisters.map(register => {\n                const registerChecked =\n                    registerIdsChecked.indexOf(register.id) > -1\n                return (\n                    <ReadingFieldGridItem\n                        key={register.id}\n                        register={register}\n                        registerChecked={registerChecked}\n                        recording={recording}\n                        handleRegisterCheck={handleRegisterCheck}\n                        liveDataSet={liveDataSet}\n                    />\n                )\n            })}\n        </Grid>\n    )\n}\n","import {\n    Accordion,\n    AccordionDetails,\n    AccordionSummary,\n    Grid,\n} from \"@material-ui/core\"\nimport Trend from \"../Trend\"\nimport FiberManualRecordIcon from \"@material-ui/icons/FiberManualRecord\"\n// tslint:disable-next-line: match-default-export-name no-submodule-imports\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\"\nimport React, { useContext, useEffect, useState } from \"react\"\n\nimport { predictRequest } from \"../blockly/dsl/workers/tf.proxy\"\nimport type {\n    TFModelPredictRequest,\n    TFModelPredictResponse,\n} from \"../../workers/tf/dist/node_modules/tf.worker\"\n\nimport useChange from \"../../jacdac/useChange\"\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\"\n\nimport { arrayConcatMany } from \"../../../jacdac-ts/src/jdom/utils\"\nimport JDRegister from \"../../../jacdac-ts/src/jdom/register\"\nimport { isSensor } from \"../../../jacdac-ts/src/jdom/spec\"\nimport JDBus from \"../../../jacdac-ts/src/jdom/bus\"\nimport { REPORT_UPDATE } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { throttle } from \"../../../jacdac-ts/src/jdom/utils\"\n\nimport ReadingFieldGrid from \"../ReadingFieldGrid\"\nimport FieldDataSet from \"../FieldDataSet\"\nimport { arraysEqual } from \"./MBDataSet\"\nimport MBModel from \"./MBModel\"\n\nconst LIVE_HORIZON = 100\n\nfunction createDataSet(\n    bus: JDBus,\n    registers: JDRegister[],\n    name: string,\n    palette: string[]\n) {\n    const fields = arrayConcatMany(registers.map(reg => reg.fields))\n    const colors = fields.map((f, i) => palette[i % palette.length])\n    const set = new FieldDataSet(bus, name, fields, colors)\n    set.maxRows = LIVE_HORIZON + 4\n\n    return set\n}\n\nexport default function ModelOutput(props: {\n    chartProps: any\n    reactStyle: any\n    chartPalette: string[]\n    model: MBModel\n}) {\n    const classes = props.reactStyle\n    const { chartPalette, model } = props\n\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const readingRegisters = useChange(bus, bus =>\n        arrayConcatMany(\n            bus.devices().map(device =>\n                device\n                    .services()\n                    .filter(srv => isSensor(srv.specification))\n                    .map(srv => srv.readingRegister)\n            )\n        )\n    )\n\n    useEffect(() => {\n        prepareTestingLogs()\n    }, [])\n\n    /* For loading page */\n    const prepareTestingLogs = () => {\n        // Create space to hold prediction data\n        const livePredictionDataSet = {\n            name: \"live-predictions\",\n            rows: [],\n            headers: model.labels,\n            units: model.labels.map(() => {\n                return \"/\"\n            }),\n            colors: model.labels.map(\n                (label, idx) => chartPalette[idx % chartPalette.length]\n            ),\n        }\n        setLivePredictions({\n            predictionData: FieldDataSet.createFromFile(livePredictionDataSet),\n            topClass: model.labels[0],\n        })\n    }\n\n    /* For predicting with model */\n    const [liveRecording, setLiveRecording] = useState<FieldDataSet>(undefined)\n    const [, setLiveDataTimestamp] = useState(0)\n\n    const [registerIdsChecked, setRegisterIdsChecked] = useState<string[]>([])\n    const [livePredictions, setLivePredictions] = useState({\n        predictionData: undefined,\n        topClass: \"\",\n    })\n\n    const recordingRegisters = readingRegisters.filter(\n        reg => registerIdsChecked.indexOf(reg.id) > -1\n    )\n    const liveRecordingMatchesModel = () => {\n        if (liveRecording) {\n            let matchingInputs = true\n            if (model.inputTypes) {\n                if (!arraysEqual(model.inputTypes, liveRecording.headers)) {\n                    matchingInputs = false\n                }\n            }\n            return matchingInputs\n        }\n        return false\n    }\n    const sensorsMatch =\n        !!recordingRegisters?.length && liveRecordingMatchesModel()\n\n    const handleRegisterCheck = (reg: JDRegister) => {\n        const i = registerIdsChecked.indexOf(reg.id)\n        if (i > -1) registerIdsChecked.splice(i, 1)\n        else registerIdsChecked.push(reg.id)\n\n        registerIdsChecked.sort()\n        setRegisterIdsChecked([...registerIdsChecked])\n        setLiveRecording(newRecording(registerIdsChecked))\n    }\n\n    const newRecording = (registerIds: string[]) =>\n        registerIds.length\n            ? createDataSet(\n                  bus,\n                  readingRegisters.filter(\n                      reg => registerIds.indexOf(reg.id) > -1\n                  ),\n                  `liveData`,\n                  chartPalette\n              )\n            : undefined\n\n    const updateLiveData = () => {\n        setLiveRecording(liveRecording)\n        setLiveDataTimestamp(bus.timestamp)\n        updatePrediction()\n    }\n    const throttleUpdate = throttle(() => updateLiveData(), 30)\n    // interval add data entry\n    const addRow = (values?: number[]) => {\n        if (liveRecording) {\n            liveRecording.addRow(values)\n            throttleUpdate()\n        }\n    }\n    const startStreamingRegisters = () => {\n        console.log(`start streaming`)\n        const streamers = recordingRegisters?.map(reg =>\n            reg.subscribe(REPORT_UPDATE, () => {})\n        )\n        return () => {\n            console.log(`stop streaming`)\n            streamers.map(streamer => streamer())\n        }\n    }\n    const updatePrediction = async () => {\n        // Use the model to do inference on a data point the model hasn't seen before:\n        if (!sensorsMatch) return\n\n        let data = liveRecording.data()\n        data = data.slice(data.length - model.inputShape[0])\n        const liveInput = [data]\n\n        let topLabel = model.labels[0]\n\n        if (data && data.length >= model.inputShape[0]) {\n            const liveOutput = []\n            // Get probability values from model\n            const predictMsg = {\n                worker: \"tf\",\n                type: \"predict\",\n                data: {\n                    zData: liveInput,\n                    model: model.toJSON(),\n                },\n            } as TFModelPredictRequest\n            const predResult = (await predictRequest(\n                predictMsg\n            )) as TFModelPredictResponse\n\n            if (predResult) {\n                // Save probability for each class in model object\n                const prediction = predResult.data.predictAll[0]\n                model.labels.forEach(label => {\n                    liveOutput.push(prediction[label])\n\n                    // update which class has highest confidence\n                    if (liveOutput[label] > liveOutput[topLabel])\n                        topLabel = label\n                })\n                livePredictions.predictionData.addData(liveOutput)\n                livePredictions.topClass = topLabel\n            }\n        }\n    }\n\n    useEffect(() => {\n        const interval = setInterval(() => addRow(), model.inputInterval)\n        const stopStreaming = startStreamingRegisters()\n\n        return () => {\n            clearInterval(interval)\n            stopStreaming()\n        }\n    }, [registerIdsChecked])\n\n    const [expanded, setExpanded] = React.useState<string | false>(false)\n    const handleExpandedSensorsChange =\n        (panel: string) =>\n        (event: React.ChangeEvent<unknown>, isExpanded: boolean) => {\n            setExpanded(isExpanded ? panel : false)\n        }\n\n    return (\n        <Grid container direction={\"column\"}>\n            <Grid item>\n                <h3>Live Testing</h3>\n                <div key=\"predict\">\n                    <span>\n                        {\" \"}\n                        Top Class:{\" \"}\n                        {model.status == \"trained\"\n                            ? livePredictions.topClass\n                            : \"--\"}{\" \"}\n                    </span>\n                    <br />\n                </div>\n                <div key=\"liveData\">\n                    {liveRecording && (\n                        <div>\n                            {model.labels.map(label => {\n                                return (\n                                    <span key={\"prediction-key-\" + label}>\n                                        <FiberManualRecordIcon\n                                            className={classes.vmiddle}\n                                            fontSize=\"small\"\n                                            style={{\n                                                color: livePredictions.predictionData.colorOf(\n                                                    undefined,\n                                                    label\n                                                ),\n                                            }}\n                                        />\n                                        {label}\n                                    </span>\n                                )\n                            })}\n                            <Trend\n                                key=\"live-data-predictions\"\n                                height={12}\n                                dataSet={livePredictions.predictionData}\n                                horizon={LIVE_HORIZON}\n                                dot={true}\n                                gradient={true}\n                            />\n                            <Trend\n                                key=\"live-data-trends\"\n                                height={12}\n                                dataSet={liveRecording}\n                                horizon={LIVE_HORIZON}\n                                dot={true}\n                                gradient={true}\n                            />\n                        </div>\n                    )}\n                </div>\n                <Accordion\n                    expanded={expanded === \"chooseSensors\"}\n                    onChange={handleExpandedSensorsChange(\"chooseSensors\")}\n                >\n                    <AccordionSummary expandIcon={<ExpandMoreIcon />}>\n                        <div>\n                            <h4>Select input sensors</h4>\n                            {!sensorsMatch && (\n                                <p>\n                                    Sensors should match:{\" \"}\n                                    {model.inputTypes.join(\", \")}{\" \"}\n                                </p>\n                            )}\n                        </div>\n                    </AccordionSummary>\n                    <AccordionDetails>\n                        <div key=\"sensors\">\n                            {!readingRegisters.length && (\n                                <span>Waiting for sensors...</span>\n                            )}\n                            {!!readingRegisters.length && (\n                                <ReadingFieldGrid\n                                    readingRegisters={readingRegisters}\n                                    registerIdsChecked={registerIdsChecked}\n                                    recording={false}\n                                    liveDataSet={liveRecording}\n                                    handleRegisterCheck={handleRegisterCheck}\n                                />\n                            )}\n                        </div>\n                    </AccordionDetails>\n                </Accordion>\n            </Grid>\n        </Grid>\n    )\n}\n"],"names":["Card","CardActions","CardContent","CardHeader","createStyles","Grid","makeStyles","React","useGridBreakpoints","FiberManualRecordIcon","useDeviceName","SwitchWithLabel","useStyles","vmiddle","verticalAlign","ReadingFieldGridItem","props","register","handleRegisterCheck","recording","registerChecked","liveDataSet","service","device","gridBreakpoints","classes","deviceName","handleCheck","id","name","fields","map","field","color","colorOf","ReadingFieldGrid","readingRegisters","registerIdsChecked","indexOf","Accordion","AccordionDetails","AccordionSummary","Trend","ExpandMoreIcon","useContext","useEffect","useState","predictRequest","useChange","JacdacContext","arrayConcatMany","isSensor","REPORT_UPDATE","throttle","FieldDataSet","arraysEqual","LIVE_HORIZON","createDataSet","bus","registers","palette","reg","colors","f","i","length","set","maxRows","ModelOutput","reactStyle","chartPalette","model","devices","services","filter","srv","specification","readingRegister","prepareTestingLogs","livePredictionDataSet","rows","headers","labels","units","label","idx","setLivePredictions","predictionData","createFromFile","topClass","liveRecording","setLiveRecording","undefined","setLiveDataTimestamp","setRegisterIdsChecked","livePredictions","recordingRegisters","liveRecordingMatchesModel","matchingInputs","inputTypes","sensorsMatch","splice","push","sort","newRecording","registerIds","updateLiveData","timestamp","updatePrediction","throttleUpdate","addRow","values","startStreamingRegisters","console","log","streamers","subscribe","streamer","data","slice","inputShape","liveInput","topLabel","liveOutput","predictMsg","worker","type","zData","toJSON","predResult","prediction","predictAll","forEach","addData","interval","setInterval","inputInterval","stopStreaming","clearInterval","expanded","setExpanded","handleExpandedSensorsChange","panel","event","isExpanded","status","join"],"sourceRoot":""}