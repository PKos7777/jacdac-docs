{"version":3,"sources":["webpack://jacdac-docs/./jacdac-ts/src/vm/events.ts","webpack://jacdac-docs/./src/components/data-science/datadsl.ts","webpack://jacdac-docs/./src/components/blockly/jsonvisitor.ts","webpack://jacdac-docs/./src/components/data-science/DSBlockEditor.tsx","webpack://jacdac-docs/./src/pages/tools/data-science-editor.tsx"],"names":["VM_EVENT","VMCode","colour","DataScienceBlockDomainSpecificLanguage","id","createBlocks","blocks","kind","type","message0","args0","inputsInline","nextStatement","output","createCategory","name","contents","dataDsl","visitBlock","block","visitor","inputs","children","forEach","input","visitInput","child","fields","Object","keys","map","k","visitField","field","visitWorkspace","workspace","DS_SOURCE_STORAGE_KEY","DSEditorWithContext","useContext","BlockContext","workspaceJSON","useEffect","console","log","value","Flags","DScienceEditor","dsls","useMemo","variablesDsl","shadowDsl","fieldsDsl","Page"],"mappings":"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","file":"component---src-pages-tools-data-science-editor-tsx-e016e276eed6f2ac8146.js","sourcesContent":["\nexport const VM_EVENT = \"vmEvent\"\n\nexport enum VMCode {\n    WatchChange = \"vmWatchChange\",\n    Breakpoint = \"vmBreakpoint\",\n    CommandStarted = \"vmCommandStarted\",\n    CommandCompleted = \"vmCommandCompleted\",\n    CommandFailed = \"vmCommandFailed\",\n    RoleMissing = \"vmRoleMissing\",\n    InternalError = \"vmInternalError\",\n}\n","import { BlockDefinition, CategoryDefinition } from \"../blockly/toolbox\"\nimport BlockDomainSpecificLanguage from \"../blockly/dsl/dsl\"\n\nconst colour = \"#123456\"\nexport class DataScienceBlockDomainSpecificLanguage\n    implements BlockDomainSpecificLanguage\n{\n    id = \"dataScience\"\n    createBlocks() {\n        const blocks: BlockDefinition[] = [\n            {\n                kind: \"block\",\n                type: \"ds_some_event\",\n                message0: \"some event\",\n                args0: [],\n                inputsInline: true,\n                nextStatement: null,\n                colour,\n            } as BlockDefinition,\n            {\n                kind: \"block\",\n                type: \"ds_some_block\",\n                message0: \"some block data\",\n                args0: [],\n                inputsInline: true,\n                output: \"Number\",\n                colour,\n            } as BlockDefinition,\n        ]\n        return blocks\n    }\n\n    createCategory() {\n        return [\n            <CategoryDefinition>{\n                kind: \"category\",\n                name: \"Data Science\",\n                colour,\n                contents: [\n                    {\n                        kind: \"block\",\n                        type: \"ds_some_event\",\n                    },\n                    {\n                        kind: \"block\",\n                        type: \"ds_some_block\",\n                    },\n                ],\n            },\n        ]\n    }\n}\n\nconst dataDsl = new DataScienceBlockDomainSpecificLanguage()\nexport default dataDsl\n","import { BlockJSON, FieldJSON, InputJSON, WorkspaceJSON } from \"./jsongenerator\"\n\nexport interface WorkspaceVisitor {\n    visitBlock?: (block: BlockJSON) => void\n    visitInput?: (input: InputJSON) => void\n    visitField?: (name: string, field: FieldJSON) => void\n}\n\nexport function visitBlock(block: BlockJSON, visitor: WorkspaceVisitor) {\n    if (!block) return\n    visitor.visitBlock?.(block)\n    const { inputs, children } = block\n    inputs?.forEach(input => visitInput(input, visitor))\n    children?.forEach(child => visitBlock(child, visitor))\n}\n\nexport function visitInput(input: InputJSON, visitor: WorkspaceVisitor) {\n    if (!input) return\n    visitor.visitInput?.(input)\n    const { fields, child } = input\n    if (fields) Object.keys(fields).map(k => visitField(k, fields[k], visitor))\n    visitBlock(child, visitor)\n}\n\nexport function visitField(\n    name: string,\n    field: FieldJSON,\n    visitor: WorkspaceVisitor\n) {\n    if (!field) return\n    visitor.visitField?.(name, field)\n}\n\nexport function visitWorkspace(\n    workspace: WorkspaceJSON,\n    visitor: WorkspaceVisitor\n) {\n    workspace?.blocks.forEach(block => visitBlock(block, visitor))\n}\n","import React, { useContext, useEffect, useMemo } from \"react\"\nimport { NoSsr } from \"@material-ui/core\"\nimport BlockContext, { BlockProvider } from \"../blockly/BlockContext\"\nimport BlockEditor from \"../blockly/BlockEditor\"\nimport variablesDsl from \"../blockly/dsl/variablesdsl\"\nimport shadowDsl from \"../blockly/dsl/shadowdsl\"\nimport dataDsl from \"./datadsl\"\nimport fieldsDsl from \"../blockly/dsl/fieldsdsl\"\nimport Flags from \"../../../jacdac-ts/src/jdom/flags\"\nimport BlockDiagnostics from \"../blockly/BlockDiagnostics\"\nimport { visitWorkspace } from \"../blockly/jsonvisitor\"\n\nconst DS_SOURCE_STORAGE_KEY = \"data-science-blockly-xml\"\n\nfunction DSEditorWithContext() {\n    // block context handles hosting blockly\n    const { workspaceJSON } = useContext(BlockContext)\n\n    // run this when workspaceJSON changes\n    useEffect(() => {\n        visitWorkspace(workspaceJSON, {\n            visitBlock: block => console.log(`block ${block.type}`, { block }),\n            visitInput: input => console.log(`input ${input.name}`, { input }),\n            visitField: (name, field) =>\n                console.log(`field ${name}: ${field.value}`, { field }),\n        })\n    }, [workspaceJSON])\n\n    return (\n        <>\n            <BlockEditor />\n            {Flags.diagnostics && <BlockDiagnostics />}\n        </>\n    )\n}\n\nexport default function DScienceEditor() {\n    const dsls = useMemo(() => {\n        return [dataDsl, variablesDsl, shadowDsl, fieldsDsl]\n    }, [])\n    return (\n        <NoSsr>\n            <BlockProvider storageKey={DS_SOURCE_STORAGE_KEY} dsls={dsls}>\n                <DSEditorWithContext />\n            </BlockProvider>\n        </NoSsr>\n    )\n}\n","import React from \"react\"\nimport DSBlockEditor from \"../../components/data-science/DSBlockEditor\"\n\nexport default function Page() {\n    return <DSBlockEditor />\n}\n"],"sourceRoot":""}