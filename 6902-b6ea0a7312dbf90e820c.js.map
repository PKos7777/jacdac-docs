{"version":3,"sources":["webpack://jacdac-docs/./src/components/dashboard/DashboardWindDirection.tsx"],"names":["DashboardWindDirection","props","service","directionRegister","useRegister","WindDirectionReg","useRegisterUnpackedValue","direction","server","useServiceServer","color","useWidgetTheme","background","controlBackground","active","arrowHeadId","useId","a","useThrottledValue","undefined","w","h","mw","mh","r","sw","cx","cy","cy2","handleChange","ev","newValue","reading","setValues","refresh"],"mappings":"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","file":"6902-b6ea0a7312dbf90e820c.js","sourcesContent":["import React from \"react\"\nimport { WindDirectionReg } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\"\nimport { useRegisterUnpackedValue } from \"../../jacdac/useRegisterValue\"\nimport SvgWidget from \"../widgets/SvgWidget\"\nimport useWidgetTheme from \"../widgets/useWidgetTheme\"\nimport useServiceServer from \"../hooks/useServiceServer\"\nimport { useId } from \"react-use-id-hook\"\nimport useThrottledValue from \"../hooks/useThrottledValue\"\nimport { Grid, Slider } from \"@material-ui/core\"\nimport SensorServer from \"../../../jacdac-ts/src/servers/sensorserver\"\nimport LoadingProgress from \"../ui/LoadingProgress\"\nimport useRegister from \"../hooks/useRegister\"\n\nexport default function DashboardWindDirection(props: DashboardServiceProps) {\n    const { service } = props\n\n    const directionRegister = useRegister(\n        service,\n        WindDirectionReg.WindDirection\n    )\n    const [direction] = useRegisterUnpackedValue<[number]>(\n        directionRegister,\n        props\n    )\n\n    const server = useServiceServer<SensorServer<[number]>>(service)\n    const color = server ? \"secondary\" : \"primary\"\n    const { background, controlBackground, active } = useWidgetTheme(color)\n    const arrowHeadId = useId()\n\n    const a = useThrottledValue(direction, 360)\n\n    if (direction === undefined) return <LoadingProgress />\n\n    const w = 64\n    const h = 64\n    const mw = 5\n    const mh = 4.5\n    const r = (w >> 1) - 4\n    const sw = 3\n    const cx = w >> 1\n    const cy = (h * 4) / 5\n    const cy2 = (h * 2) / 5\n\n    const handleChange = async (ev: unknown, newValue: number | number[]) => {\n        await server?.reading.setValues([newValue as number])\n        directionRegister.refresh()\n    }\n\n    return (\n        <Grid container direction=\"column\">\n            <Grid item xs={12}>\n                <SvgWidget width={w} height={h}>\n                    <defs>\n                        <marker\n                            id={arrowHeadId}\n                            markerWidth={mw}\n                            markerHeight={mh}\n                            refX={0}\n                            refY={mh / 2}\n                            orient=\"auto\"\n                        >\n                            <polygon\n                                fill={active}\n                                points={`0 0, ${mw} ${mh / 2}, 0 ${mh}`}\n                            />\n                        </marker>\n                    </defs>\n                    <g transform={`rotate(${a}, ${w >> 1}, ${h >> 1})`}>\n                        <circle\n                            cx={w >> 1}\n                            cy={h >> 1}\n                            r={r}\n                            fill={controlBackground}\n                            stroke={background}\n                            strokeWidth={sw}\n                        />\n                        <line\n                            x1={cx}\n                            y1={cy}\n                            x2={cx}\n                            y2={cy2}\n                            stroke={active}\n                            strokeWidth={sw}\n                            markerEnd={`url(#${arrowHeadId})`}\n                            aria-label={`arrow point at ${direction}Â°`}\n                        />\n                    </g>\n                </SvgWidget>\n            </Grid>\n            {server && (\n                <Grid item>\n                    <Slider\n                        color={color}\n                        valueLabelDisplay=\"auto\"\n                        min={0}\n                        max={360}\n                        step={5}\n                        value={direction}\n                        onChange={handleChange}\n                    />\n                </Grid>\n            )}\n        </Grid>\n    )\n}\n"],"sourceRoot":""}