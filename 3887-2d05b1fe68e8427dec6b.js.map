{"version":3,"sources":["webpack://jacdac-docs/./node_modules/@material-ui/icons/VoiceChat.js","webpack://jacdac-docs/./src/components/hooks/useAnalytics.ts","webpack://jacdac-docs/./src/components/CmdButton.tsx","webpack://jacdac-docs/./src/components/dashboard/DashboardSpeechSynthesis.tsx","webpack://jacdac-docs/./src/components/hooks/useMounted.tsx"],"names":["useAnalytics","page","track","ACK_RESET_DELAY","ERROR_RESET_DELAY","useStyles","makeStyles","theme","getBackgroundColor","palette","type","lighten","darken","createStyles","ack","color","fontWeight","typography","fontWeightMedium","backgroundColor","success","main","error","CmdButton","props","onClick","className","style","children","icon","title","disabled","disableReset","autoRun","trackName","trackProperties","ackResetDelay","others","useContext","AppContext","setAppError","setError","classes","useState","working","setWorking","setAck","undefined","mounted","useMounted","_disabled","run","delay","handleClick","ev","stopPropagation","statusIcon","modeClassName","elClassName","clsx","useEffect","DashboardSpeechSynthesis","service","enabled","register","SpeechSynthesisReg","text","setText","textId","useId","handleChange","newValue","target","value","handleSpeak","console","log","boolValue","sendSetAsync","jdpack","sendCmdAsync","SpeechSynthesisCmd","useRef","current"],"mappings":"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","file":"3887-2d05b1fe68e8427dec6b.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12l-4-3.2V14H6V6h8v3.2L18 6v8z\"\n}), 'VoiceChat');\n\nexports.default = _default;","/*\nrequires \"@microsoft/applicationinsights-web-basic\": \"^2.6.1\",\nimport { ApplicationInsights } from \"@microsoft/applicationinsights-web-basic\"\n\n// YOUR_INSTRUMENTATION_KEY_GOES_HERE\nconst instrumentationKey: string = undefined\nconst appInsights =\n    instrumentationKey &&\n    new ApplicationInsights({\n        instrumentationKey,\n        isStorageUseDisabled: true,\n        isCookieUseDisabled: true,\n    })\nconst page =\n    typeof window !== \"undefined\"\n        ? () =>\n              appInsights?.track({\n                  name: window.location.href,\n                  time: new Date().toUTCString(),\n                  baseType: \"PageData\",\n              })\n        : () => {}\nconst track =\n    typeof window !== \"undefined\"\n        ? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          (name: string, properties?: { [key: string]: any }) =>\n              appInsights?.track({\n                  name,\n                  time: new Date().toUTCString(),\n                  data: properties,\n                  baseType: \"EventData\",\n              })\n        : // eslint-disable-next-line @typescript-eslint/no-unused-vars\n          (name, properties) => {}\nif (typeof window !== \"undefined\") {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    ;(window as any).analytics = {\n        page,\n        track,\n    }\n}\n*/\n\nexport default function useAnalytics(): {\n    page: () => void\n    track: (name: string, properties?: { [key: string]: string | number }) => void\n} {\n    const page = () => {}\n    const track = () => {}\n    return {\n        page,\n        track,\n    }\n}\n","import {\n    createStyles,\n    darken,\n    lighten,\n    makeStyles,\n    Theme,\n} from \"@material-ui/core\"\nimport { Button } from \"gatsby-theme-material-ui\"\nimport React, {\n    CSSProperties,\n    ReactNode,\n    useContext,\n    useEffect,\n    useState,\n} from \"react\"\nimport AppContext from \"./AppContext\"\n// tslint:disable-next-line: match-default-export-name no-submodule-imports\nimport ErrorIcon from \"@material-ui/icons/Error\"\nimport { delay } from \"../../jacdac-ts/src/jdom/utils\"\nimport IconButtonWithTooltip from \"./ui/IconButtonWithTooltip\"\nimport useAnalytics from \"./hooks/useAnalytics\"\nimport useMounted from \"./hooks/useMounted\"\nimport clsx from \"clsx\"\n\nconst ACK_RESET_DELAY = 500\nconst ERROR_RESET_DELAY = 2000\n\nconst useStyles = makeStyles((theme: Theme) => {\n    const getBackgroundColor = theme.palette.type === \"light\" ? lighten : darken\n    return createStyles({\n        ack: {\n            color: \"#fff\",\n            fontWeight: theme.typography.fontWeightMedium,\n            backgroundColor: theme.palette.success.main,\n        },\n        error: {\n            color: \"#fff\",\n            backgroundColor: getBackgroundColor(theme.palette.error.main, 0.6),\n        },\n    })\n})\n\nexport default function CmdButton(props: {\n    onClick: () => Promise<void>\n    className?: string\n    style?: CSSProperties\n    title?: string\n    children?: ReactNode\n    icon?: JSX.Element\n    size?: \"small\" | undefined\n    variant?: \"outlined\" | \"contained\" | undefined\n    disabled?: boolean\n    disableReset?: boolean\n    autoRun?: boolean\n    trackName?: string\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    trackProperties?: { [key: string]: any }\n    ackResetDelay?: number\n    color?: \"primary\" | \"secondary\"\n}) {\n    const {\n        onClick,\n        className,\n        style,\n        children,\n        icon,\n        title,\n        disabled,\n        disableReset,\n        autoRun,\n        trackName,\n        trackProperties,\n        ackResetDelay,\n        color,\n        ...others\n    } = props\n\n    const { setError: setAppError } = useContext(AppContext)\n    const classes = useStyles()\n    const [working, setWorking] = useState(false)\n    const [ack, setAck] = useState(false)\n    const [error, setError] = useState(undefined)\n    const { track } = useAnalytics()\n    const mounted = useMounted()\n\n    const _disabled = disabled || working\n\n    const run = async () => {\n        if (working) return // already working\n\n        if (trackName) track(\"cmd.\" + trackName, trackProperties)\n        try {\n            setError(undefined)\n            setAck(false)\n            setWorking(true)\n            await onClick()\n            if (!mounted()) return\n            setAck(true)\n            if (!disableReset) {\n                await delay(ackResetDelay || ACK_RESET_DELAY)\n                if (!mounted) return\n                setAck(false)\n            }\n        } catch (e) {\n            if (!mounted()) return\n            setAppError(e)\n            setError(e)\n            if (!disableReset) {\n                await delay(ERROR_RESET_DELAY)\n                if (!mounted()) return\n                setError(undefined)\n            }\n        } finally {\n            if (mounted()) setWorking(false)\n        }\n    }\n\n    const handleClick = async (ev: React.MouseEvent<HTMLButtonElement>) => {\n        ev.stopPropagation()\n        run()\n    }\n\n    const statusIcon = error ? <ErrorIcon /> : undefined\n    const modeClassName = error ? classes.error : ack ? classes.ack : undefined\n    const elClassName = clsx(className, modeClassName)\n\n    // run once\n    useEffect(() => {\n        if (autoRun) run()\n    }, [autoRun])\n\n    if (!children && icon)\n        return (\n            <IconButtonWithTooltip\n                className={elClassName}\n                style={style}\n                onClick={handleClick}\n                aria-label={title}\n                title={title}\n                disabled={_disabled}\n                color={color}\n                {...others}\n            >\n                {statusIcon || icon}\n            </IconButtonWithTooltip>\n        )\n    else\n        return (\n            <Button\n                className={elClassName}\n                style={style}\n                startIcon={icon}\n                endIcon={statusIcon}\n                onClick={handleClick}\n                aria-label={title}\n                title={title}\n                disabled={_disabled}\n                color={color}\n                {...others}\n            >\n                {children}\n            </Button>\n        )\n}\n","import React, { useState } from \"react\"\nimport {\n    SpeechSynthesisCmd,\n    SpeechSynthesisReg,\n} from \"../../../jacdac-ts/src/jdom/constants\"\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\"\nimport { Grid, TextField } from \"@material-ui/core\"\nimport VoiceChatIcon from \"@material-ui/icons/VoiceChat\"\nimport CmdButton from \"../CmdButton\"\nimport { jdpack } from \"../../../jacdac-ts/src/jdom/pack\"\nimport { useId } from \"react-use-id-hook\"\n\nexport default function DashboardSpeechSynthesis(props: DashboardServiceProps) {\n    const { service } = props\n    const enabled = service.register(SpeechSynthesisReg.Enabled)\n    const [text, setText] = useState(\"jacdac\")\n    const textId = useId()\n\n    const handleChange = ev => {\n        const newValue = ev.target.value\n        setText(newValue)\n    }\n\n    const handleSpeak = async () => {\n        console.log(`speak ${text}`)\n        if (!enabled.boolValue)\n            await enabled.sendSetAsync(\n                jdpack<[boolean]>(\"u8\", [true]),\n                true\n            )\n        await service.sendCmdAsync(\n            SpeechSynthesisCmd.Speak,\n            jdpack<[string]>(\"s\", [text])\n        )\n    }\n\n    return (\n        <>\n            <Grid item xs={12}>\n                <TextField\n                    id={textId}\n                    spellCheck={false}\n                    value={text}\n                    label={\"speech synthesis\"}\n                    helperText={\"Enter text to speak out\"}\n                    onChange={handleChange}\n                    type={\"text\"}\n                />\n                <CmdButton\n                    disabled={!text}\n                    title=\"speak text\"\n                    onClick={handleSpeak}\n                    icon={<VoiceChatIcon />}\n                />\n            </Grid>\n        </>\n    )\n}\n","import { useEffect, useRef } from \"react\";\n\nexport default function useMounted(): () => boolean {\n    const mounted = useRef(false);\n    useEffect(() => {\n        mounted.current = true;\n        return () => { mounted.current = false; }\n    }, []);\n    return () => mounted.current;\n}"],"sourceRoot":""}