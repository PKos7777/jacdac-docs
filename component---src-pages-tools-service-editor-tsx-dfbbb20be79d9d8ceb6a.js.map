{"version":3,"sources":["webpack:///./src/components/PacketMembersChip.tsx","webpack:///./src/components/PacketSpecification.tsx","webpack:///./src/components/EnumSpecification.tsx","webpack:///./src/components/hooks/useDeviceHostFromServiceClass.ts","webpack:///./src/components/ServiceSpecification.tsx","webpack:///./src/components/tools/ServiceSpecificationEditor.tsx","webpack:///./src/pages/tools/service-editor.tsx","webpack:///./src/components/KindChip.tsx","webpack:///./src/components/IDChip.tsx","webpack:///./src/components/ui/HighlightTextField.tsx","webpack:///./node_modules/@material-ui/icons/Category.js"],"names":["PacketMembersChip","props","members","className","spec","length","label","packFormat","title","textDecoration","useStyles","makeStyles","theme","createStyles","root","marginBottom","spacing","field","verticalAlign","chip","margin","MemberType","member","classes","helperText","prettyMemberUnit","name","MembersType","repeatIndex","findIndex","m","startRepeats","beforeRepeat","slice","afterRepeat","map","i","PacketSpecification","serviceClass","packetInfo","reportInfo","pipeReportInfo","showDevices","useState","args","setArgs","toString","identifier","fields","isCmd","isCommand","kind","undefined","optional","derived","description","isRegister","isEvent","EnumSpecification","serviceSpecificationFromClassIdentifier","enums","Object","values","filter","en","e","isFlags","keys","useDeviceHostFromServiceClass","useContext","JacdacContext","bus","useEffect","devices","def","hostDefinitionFromServiceClass","host","addHost","services","removeDeviceHost","DashboardServiceDevices","useChange","b","device","id","ServiceSpecification","node","service","showSource","showDerived","shortId","classIdentifier","packets","pkt","registers","events","commands","reports","r","secondary","pipeReports","isPipeReport","others","indexOf","reportOf","find","rep","isReportOf","pipeReportOf","isPipeReportOf","notes","short","extends","extend","serviceSpecificationFromName","long","note","group","sort","l","SERVICE_SPECIFICATION_STORAGE_KEY","ServiceSpecificationEditor","useLocalStorage","source","setSource","json","useMemo","parseServiceSpecificationMarkdownToJSON","serviceMap","servicePath","camelName","toLowerCase","errors","Page","KindChip","PacketsContext","setFilter","AppContext","setDrawerType","icon","KindIcon","chipFilter","filtered","handleClick","replace","trim","DrawerType","Packets","kindName","IDChip","packetFilter","setPacketFilter","ids","handleFilterClick","GithubPullRequestButton","lazy","AnnotationTooltip","withStyles","arrow","color","palette","error","main","tooltip","backgroundColor","common","white","boxShadow","shadows","fontSize","typography","body2","Tooltip","HighlightTextField","code","onChange","language","annotations","pullRequestTitle","pullRequestPath","pullRequestDescription","DarkModeContext","darkMode","DARK_THEME","LIGHT_THEME","editorRef","useRef","useEditable","disabled","indentation","defaultProps","style","tokens","getTokenProps","minHeight","whiteSpace","line","annotation","a","message","el","borderBottom","token","empty","key"],"mappings":"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","file":"component---src-pages-tools-service-editor-tsx-dfbbb20be79d9d8ceb6a.js","sourcesContent":["import React from \"react\";\n// tslint:disable-next-line: no-submodule-imports\nimport Chip from '@material-ui/core/Chip';\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport CategoryIcon from '@material-ui/icons/Category';\nimport Tooltip from \"./ui/Tooltip\";\n\nexport default function PacketMembersChip(props: { spec: jdspec.PacketInfo, members: jdspec.PacketMember[], className?: string }) {\n    const { members, className, spec } = props;\n    if (!members?.length)\n        return null\n\n    const label = spec?.packFormat;\n    const title = \"pack format\";\n    return <Tooltip title={title}>\n        <Chip style={({ textDecoration: \"none\" })} href=\"/reference/pack-format/\" component=\"a\"\n            clickable className={className} size=\"small\" icon={<CategoryIcon />} label={label} />\n    </Tooltip>\n}\n","import { isRegister, isEvent, isCommand, tryParseMemberValue, serviceSpecificationFromClassIdentifier } from \"../../jacdac-ts/src/jdom/spec\"\n// tslint:disable-next-line: no-submodule-imports\nimport Alert from \"./ui/Alert\";\nimport React, { useState } from \"react\";\n// tslint:disable-next-line: no-submodule-imports\nimport Chip from '@material-ui/core/Chip';\nimport DeviceList from \"./DeviceList\";\nimport { makeStyles, createStyles, TextField } from \"@material-ui/core\";\nimport IDChip from \"./IDChip\";\nimport KindChip from \"./KindChip\";\nimport PacketMembersChip from \"./PacketMembersChip\";\nimport Markdown from \"./ui/Markdown\";\nimport { prettyMemberUnit, prettyUnit } from \"../../jacdac-ts/src/jdom/pretty\";\nimport { isSet } from \"../../jacdac-ts/src/jdom/utils\";\n\nconst useStyles = makeStyles((theme) => createStyles({\n    root: {\n        marginBottom: theme.spacing(1)\n    },\n    field: {\n        \"& > div\": { verticalAlign: \"middle\" }\n    },\n    chip: {\n        margin: theme.spacing(0.5),\n    },\n}),\n);\n\nfunction MemberType(props: { member: jdspec.PacketMember }) {\n    const { member } = props;\n    const classes = useStyles();\n    const helperText = prettyMemberUnit(member, true);\n\n    return <>\n        <li className={classes.field}>\n            {member.name !== \"_\" && `${member.name}: `}<code>{helperText}</code>\n        </li>\n    </>\n}\n\nfunction MembersType(props: { members: jdspec.PacketMember[], title?: string }) {\n    const { members, title } = props;\n\n    let repeatIndex = members.findIndex(m => !!m.startRepeats);\n    if (repeatIndex < 0) repeatIndex = members.length;\n    const beforeRepeat = members.slice(0, repeatIndex)\n    const afterRepeat = members.slice(repeatIndex)\n\n    return <>\n        {!!title && <h4>{title}</h4>}\n        {!!beforeRepeat.length && <ul>\n            {beforeRepeat\n                .map((member, i) => <MemberType key={`member${member.name}`} member={member} />)}\n        </ul>}\n        {!!afterRepeat.length && <>\n            <h5>starts repeating</h5>\n            <ul>\n                {afterRepeat\n                    .map((member, i) => <MemberType key={`member${member.name}`} member={member} />)}\n            </ul>\n        </>}\n    </>\n}\n\nexport default function PacketSpecification(props: {\n    serviceClass: number,\n    packetInfo: jdspec.PacketInfo,\n    reportInfo?: jdspec.PacketInfo,\n    pipeReportInfo?: jdspec.PacketInfo,\n    showDevices?: boolean\n}) {\n    const { serviceClass, packetInfo, reportInfo, pipeReportInfo, showDevices } = props;\n    const [args, setArgs] = useState<any[]>([])\n    const classes = useStyles();\n    if (!packetInfo)\n        return <Alert severity=\"error\">{`Unknown member ${serviceClass.toString(16)}:${packetInfo.identifier}`}</Alert>\n    const { fields } = packetInfo;\n    const isCmd = isCommand(packetInfo)\n\n    return <div className={classes.root}>\n        <h3 id={`${packetInfo.kind}:${packetInfo.identifier}`}>{packetInfo.name}\n            <PacketMembersChip spec={packetInfo} className={classes.chip} members={packetInfo.fields} />\n            {packetInfo.identifier !== undefined && <IDChip className={classes.chip} id={packetInfo.identifier} filter={`pkt:0x${packetInfo.identifier.toString(16)}`} />}\n            <KindChip className={classes.chip} kind={packetInfo.kind} />\n            {packetInfo.optional && <Chip className={classes.chip} size=\"small\" label=\"optional\" />}\n            {packetInfo.derived && <Chip className={classes.chip} size=\"small\" label=\"derived\" />}\n        </h3>\n        <Markdown source={packetInfo.description} />\n        {!!fields.length && <MembersType members={fields} title={isCmd && \"Arguments\"} />}\n        {!!reportInfo && <MembersType members={reportInfo.fields} title=\"Report\" />}\n        {!!pipeReportInfo && <MembersType members={pipeReportInfo.fields} title=\"Pipe report\" />}\n        {showDevices && isCommand(packetInfo) && <DeviceList serviceClass={serviceClass} commandIdentifier={packetInfo.identifier} />}\n        {showDevices && isRegister(packetInfo) && <DeviceList serviceClass={serviceClass} registerIdentifiers={[packetInfo.identifier]} />}\n        {showDevices && isEvent(packetInfo) && <DeviceList serviceClass={serviceClass} eventIdentifiers={[packetInfo.identifier]} />}\n    </div>\n}","import React, { Fragment } from \"react\"\nimport { serviceSpecificationFromClassIdentifier } from \"../../jacdac-ts/src/jdom/spec\"\nimport { Chip } from \"@material-ui/core\"\n\nexport default function EnumSpecification(props: { serviceClass: number }) {\n    const { serviceClass } = props\n    const spec = serviceSpecificationFromClassIdentifier(serviceClass)\n    const enums = Object.values(spec?.enums || {}).filter(en => !en.derived)\n    if (!enums.length)\n        return <></>\n\n    return <Fragment>\n        <h2>Enums</h2>\n        {enums.map(e => <Fragment key={e.name}>\n            <h3>{e.name} {e.isFlags && <Chip label=\"flags\" size=\"small\" />}</h3>\n            <ul>\n                {Object.keys(e.members).map(en => <li key={en}>{en}: <code>0x{e.members[en].toString(16)}</code></li>)}\n            </ul>\n        </Fragment>)}\n    </Fragment>\n}\n","import { useContext, useEffect } from \"react\";\nimport { addHost, hostDefinitionFromServiceClass } from \"../../../jacdac-ts/src/hosts/hosts\";\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\";\n\nexport default function useDeviceHostFromServiceClass(serviceClass: number): void {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext);\n\n    // run once\n    useEffect(() => {\n        const devices = bus.devices({ serviceClass });\n        const def = !devices.length && hostDefinitionFromServiceClass(serviceClass);\n        const host = def && addHost(bus, def.services());\n        return () => bus.removeDeviceHost(host);\n    }, [serviceClass]);\n}","import React, { Fragment, useContext, useEffect } from \"react\";\nimport { Link } from 'gatsby-theme-material-ui';\nimport { serviceSpecificationFromName, isRegister, isEvent, isCommand, isPipeReport, isReportOf, isPipeReportOf, deviceSpecificationsForService } from \"../../jacdac-ts/src/jdom/spec\"\nimport PacketSpecification from \"../components/PacketSpecification\"\nimport IDChip from \"./IDChip\";\nimport ServiceSpecificationSource from \"./ServiceSpecificationSource\"\nimport Markdown from \"./ui/Markdown\";\nimport EnumSpecification from \"./EnumSpecification\";\nimport { Box, Grid } from \"@material-ui/core\";\nimport ServiceSpecificationStatusAlert from \"./ServiceSpecificationStatusAlert\"\nimport DeviceSpecificationList from \"./DeviceSpecificationList\"\nimport useDeviceHostFromServiceClass from \"./hooks/useDeviceHostFromServiceClass\";\nimport JacdacContext, { JacdacContextProps } from \"../jacdac/Context\";\nimport useChange from \"../jacdac/useChange\";\nimport DashbardDeviceItem from \"./dashboard/DashboardDeviceItem\"\n\nfunction DashboardServiceDevices(props: { serviceClass: number }) {\n    const { serviceClass } = props;\n    const { bus } = useContext<JacdacContextProps>(JacdacContext);\n    const devices = useChange(bus, b => b.devices({ serviceClass }));\n    return <Grid container spacing={2}>\n        {devices.map(device => <DashbardDeviceItem\n            key={device.id}\n            device={device}\n            showAvatar={true}\n            showHeader={true}\n        />)}\n    </Grid >\n}\n\nexport default function ServiceSpecification(props: {\n    service: jdspec.ServiceSpec,\n    showSource?: boolean,\n    showDevices?: boolean,\n    showDerived?: boolean\n}) {\n    const { service: node, showSource, showDevices, showDerived } = props;\n    const { shortId, name, classIdentifier } = node;\n    const packets = node.packets.filter(pkt => showDerived || !pkt.derived);\n    const registers = packets.filter(isRegister)\n    const events = packets.filter(isEvent)\n    const commands = packets.filter(isCommand)\n    const reports = packets.filter(r => r.secondary)\n    const pipeReports = packets.filter(isPipeReport)\n    const others = packets.filter(r => registers.indexOf(r) < 0\n        && events.indexOf(r) < 0\n        && commands.indexOf(r) < 0\n        && reports.indexOf(r) < 0\n        && pipeReports.indexOf(r) < 0\n    )\n    // spin up host on demand\n    useDeviceHostFromServiceClass(node.classIdentifier);\n\n    const reportOf = (pkt: jdspec.PacketInfo) => reports.find(rep => isReportOf(pkt, rep))\n    const pipeReportOf = (pkt: jdspec.PacketInfo) => pipeReports.find(rep => isPipeReportOf(pkt, rep))\n\n    return (<Fragment key={`servicespec${shortId}`}>\n        <h1 key=\"title\">{name}\n            <Box ml={1} component=\"span\">\n                <IDChip id={node.classIdentifier} filter={`srv:${shortId}`} />\n            </Box>\n        </h1>\n        <ServiceSpecificationStatusAlert specification={node} />\n        <Markdown key=\"notesshort\" source={node.notes.short} />\n        {!!node.extends?.length &&\n            <p key=\"extends\">\n                <span>Extends </span>\n                {node.extends.map((extend, i) => <Fragment key={`extend${extend}`}>\n                    {i > 0 && <span>, </span>}\n                    <Link key={`extend${extend}`} to={`/services/${extend}/`}>{serviceSpecificationFromName(extend).name}</Link>\n                </Fragment>)}\n    .</p>}\n        <Markdown key=\"noteslong\" source={node.notes.long || \"\"} />\n        <DashboardServiceDevices serviceClass={classIdentifier} />\n        <EnumSpecification key=\"enums\" serviceClass={classIdentifier} />\n        {[\n            { name: \"Registers\", packets: registers, note: node.notes[\"registers\"] },\n            { name: \"Events\", packets: events, note: node.notes[\"events\"] },\n            { name: \"Commands\", packets: commands, note: node.notes[\"commands\"] },\n            { name: \"Others\", packets: others, note: node.notes[\"others\"] }\n        ].filter(group => group.packets.length)\n            .map(group => <Fragment key={`group${group.name}`}>\n                <h2>{group.name}</h2>\n                {group.note && <Markdown key={`node${group.name}`} source={group.note} />}\n                {group.packets\n                    .sort((l, r) => (l.derived ? 1 : -1) - (r.derived ? 1 : -1))\n                    .map((pkt, i) => <PacketSpecification\n                        key={`pkt${pkt.name}`}\n                        serviceClass={node.classIdentifier}\n                        packetInfo={pkt}\n                        reportInfo={reportOf(pkt)}\n                        pipeReportInfo={pipeReportOf(pkt)}\n                        showDevices={true}\n                    />)}\n            </Fragment>)\n        }\n    </Fragment>\n    )\n}","import React, { useMemo } from \"react\"\nimport { Grid } from \"@material-ui/core\"\nimport { parseServiceSpecificationMarkdownToJSON } from \"../../../jacdac-ts/jacdac-spec/spectool/jdspec\"\nimport { serviceMap } from \"../../../jacdac-ts/src/jdom/spec\"\nimport RandomGenerator from \"../RandomGenerator\"\nimport useLocalStorage from \"../useLocalStorage\"\nimport HighlightTextField from \"../ui/HighlightTextField\"\nimport ServiceSpecification from \"../ServiceSpecification\"\n\nconst SERVICE_SPECIFICATION_STORAGE_KEY =\n    \"jacdac:servicespecificationeditorsource\"\n\nexport default function ServiceSpecificationEditor() {\n    const [source, setSource] = useLocalStorage(\n        SERVICE_SPECIFICATION_STORAGE_KEY,\n        \"\"\n    )\n    const json = useMemo(\n        () => parseServiceSpecificationMarkdownToJSON(source, serviceMap()),\n        [source]\n    )\n    const servicePath =\n        json &&\n        `services/${(\n            json.camelName ||\n            json.shortId ||\n            `0x${json.classIdentifier.toString(16)}`\n        ).toLowerCase()}`\n    return (\n        <Grid spacing={1} container>\n            <Grid item xs={12}>\n                <HighlightTextField\n                    code={source}\n                    language={\"markdown\"}\n                    onChange={setSource}\n                    annotations={json?.errors}\n                    pullRequestTitle={json && `Service: ${json.name}`}\n                    pullRequestPath={servicePath}\n                    pullRequestDescription={`This pull request defines a new service.`}\n                />\n            </Grid>\n            <Grid item>\n                <RandomGenerator device={false} />\n                {json && <ServiceSpecification service={json} />}\n            </Grid>\n        </Grid>\n    )\n}\n","import { Link } from \"gatsby-theme-material-ui\"\nimport React from \"react\"\nimport ServiceSpecificationEditor from '../../components/tools/ServiceSpecificationEditor'\n\nexport default function Page() {\n    return <>\n        <h1>Service Specification Editor</h1>\n        <p>\n\n            Read the <Link to=\"/reference/service-specification\">service specifiation</Link> documentation.\nUse the packet console to monitor packets from your devices.\n        </p>\n        <ServiceSpecificationEditor />\n    </>\n}","import React, { useContext } from \"react\"\nimport { Chip } from \"@material-ui/core\";\nimport KindIcon, { kindName } from \"./KindIcon\";\nimport PacketsContext from \"./PacketsContext\"\nimport AppContext, { DrawerType } from \"./AppContext\"\nimport Tooltip from \"./ui/Tooltip\";\n\nexport default function KindChip(props: { kind: string, className?: string }) {\n    const { kind, className } = props;\n    const { filter, setFilter } = useContext(PacketsContext);\n    const { setDrawerType } = useContext(AppContext)\n    const icon = KindIcon({ kind })\n    const chipFilter = `kind:${kind}`\n    const filtered = filter && filter.indexOf(chipFilter) > -1\n    const handleClick = () => {\n        if (filtered)\n            setFilter(filter?.replace(chipFilter, '')?.trim())\n        else\n            setFilter(filter?.trim() + ' ' + chipFilter)\n        setDrawerType(DrawerType.Packets)\n    }\n    return <Tooltip title={filtered ? `remove filter ${chipFilter}` : `add filter ${chipFilter}`}>\n        <span>\n            <Chip onClick={handleClick} className={className} size=\"small\" label={kindName(kind)} icon={icon} />\n        </span>\n    </Tooltip>\n\n}","import React, { useContext } from \"react\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport FingerprintIcon from '@material-ui/icons/Fingerprint';\nimport { Chip, IconButton } from '@material-ui/core';\nimport PacketsContext from \"./PacketsContext\";\nimport AppContext, { DrawerType } from \"./AppContext\";\nimport Tooltip from \"./ui/Tooltip\";\n\nexport default function IDChip(props: { id: number | string, className?: string, filter?: string }) {\n    const { id, className, filter } = props\n    const { filter: packetFilter, setFilter: setPacketFilter } = useContext(PacketsContext);\n    const { setDrawerType } = useContext(AppContext)\n\n    const ids = typeof id === \"string\" ? id : `0x${id !== undefined ? (id as number).toString(16) : \"???\"}`\n    const filtered = packetFilter && packetFilter.indexOf(filter) > -1\n    const handleFilterClick = () => {\n        if (filtered)\n            setPacketFilter(packetFilter?.replace(filter, '')?.trim())\n        else\n            setPacketFilter(packetFilter?.trim() + ' ' + filter)\n        setDrawerType(DrawerType.Packets)\n    }\n    const icon = <FingerprintIcon />;\n    const title = filtered ? `remove filter ${filter}` : `add filter ${filter}`;\n    if (filter)\n        return <Tooltip title={filtered ? `remove filter ${filter}` : `add filter ${filter}`}>\n            <span>\n                <Chip className={className} size=\"small\" icon={\n                    <IconButton aria-label={title} onClick={handleFilterClick}>\n                        {icon}\n                    </IconButton>\n                } label={ids} />\n            </span>\n        </Tooltip>\n    else\n        return <Chip aria-label={title} className={className} size=\"small\" icon={icon} title={`identifier ${ids}`} label={ids} />;\n}","/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable react/jsx-key */\nimport React, { useContext, useRef, lazy } from \"react\"\nimport Highlight, {\n    defaultProps,\n    Language,\n    PrismTheme,\n} from \"prism-react-renderer\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport LIGHT_THEME from \"prism-react-renderer/themes/github\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport DARK_THEME from \"prism-react-renderer/themes/vsDark\"\nimport DarkModeContext from \"./DarkModeContext\"\nimport { useEditable } from \"use-editable\"\nimport { Alert } from \"@material-ui/lab\"\nimport { Grid, Tooltip, withStyles } from \"@material-ui/core\"\nimport Suspense from \"../ui/Suspense\";\nconst GithubPullRequestButton = lazy(() => import('../GithubPullRequestButton'));\n\nconst AnnotationTooltip = withStyles(theme => ({\n    arrow: {\n        color: theme.palette.error.main,\n    },\n    tooltip: {\n        backgroundColor: theme.palette.error.main,\n        color: theme.palette.common.white,\n        boxShadow: theme.shadows[1],\n        fontSize: theme.typography.body2.fontSize,\n    },\n}))(Tooltip)\n\nexport default function HighlightTextField(props: {\n    language: string\n    code: string\n    onChange: (newValue: string) => void\n    annotations?: jdspec.Diagnostic[]\n    pullRequestTitle?: string\n    pullRequestPath?: string\n    pullRequestDescription?: string\n}) {\n    const {\n        code,\n        onChange,\n        language,\n        annotations,\n        pullRequestTitle,\n        pullRequestPath,\n        pullRequestDescription,\n    } = props\n    const { darkMode } = useContext(DarkModeContext)\n    const theme = (darkMode === \"dark\" ? DARK_THEME : LIGHT_THEME) as PrismTheme\n    const editorRef = useRef(null)\n\n    useEditable(editorRef, onChange, {\n        disabled: false,\n        indentation: 4,\n    })\n    return (\n        <Grid container spacing={1} direction=\"row\">\n            <Grid item xs={12}>\n                <Highlight\n                    {...defaultProps}\n                    code={code}\n                    language={language as Language}\n                    theme={theme}\n                >\n                    {({ className, style, tokens, getTokenProps }) => (\n                        <pre\n                            ref={editorRef}\n                            className={className}\n                            spellCheck={false}\n                            style={{\n                                ...style,\n                                ...{\n                                    minHeight: \"12rem\",\n                                    whiteSpace: \"pre-wrap\",\n                                },\n                            }}\n                        >\n                            {tokens.map((line, i) => {\n                                const annotation = annotations?.find(\n                                    a => a.line === i + 1\n                                )\n                                const title = annotation?.message\n                                const el = (\n                                    <span\n                                        key={i}\n                                        style={\n                                            annotation && {\n                                                borderBottom: \"dashed 1px red\",\n                                            }\n                                        }\n                                    >\n                                        {line\n                                            .filter(token => !token.empty)\n                                            .map((token, key) => (\n                                                <span\n                                                    {...getTokenProps({\n                                                        token,\n                                                        key,\n                                                    })}\n                                                />\n                                            ))}\n                                        {i < tokens.length - 1 ? \"\\n\" : null}\n                                    </span>\n                                )\n                                return title ? (\n                                    <AnnotationTooltip\n                                        title={title}\n                                        arrow\n                                        key={i}\n                                    >\n                                        {el}\n                                    </AnnotationTooltip>\n                                ) : (\n                                    el\n                                )\n                            })}\n                        </pre>\n                    )}\n                </Highlight>\n            </Grid>\n            {!!annotations?.length && (\n                <Grid item xs={12}>\n                    <Alert severity=\"error\">\n                        <ul>\n                            {annotations.map((a, i) => (\n                                <li key={i}>\n                                    line {a.line}: {a.message}\n                                </li>\n                            ))}\n                        </ul>\n                    </Alert>\n                </Grid>\n            )}\n            {pullRequestTitle && pullRequestPath && (\n                <Grid item>\n                    <Suspense>\n                        <GithubPullRequestButton\n                            title={pullRequestTitle}\n                            head={pullRequestPath}\n                            description={pullRequestDescription}\n                            files={{\n                                [pullRequestPath + \".md\"]: code,\n                            }}\n                        />\n                    </Suspense>\n                </Grid>\n            )}\n        </Grid>\n    )\n}\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 2l-5.5 9h11z\"\n}), /*#__PURE__*/React.createElement(\"circle\", {\n  cx: \"17.5\",\n  cy: \"17.5\",\n  r: \"4.5\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M3 13.5h8v8H3z\"\n})), 'Category');\n\nexports.default = _default;"],"sourceRoot":""}