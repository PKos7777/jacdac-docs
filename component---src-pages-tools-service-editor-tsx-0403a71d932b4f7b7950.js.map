{"version":3,"sources":["webpack:///./node_modules/@material-ui/icons/Check.js","webpack:///./src/components/EnumSpecification.tsx","webpack:///./src/components/hooks/useServiceProviderFromServiceClass.ts","webpack:///./src/components/ServiceSpecification.tsx","webpack:///./src/components/tools/ServiceSpecificationEditor.tsx","webpack:///./src/pages/tools/service-editor.tsx","webpack:///./src/components/dashboard/DashboardDeviceItem.tsx","webpack:///./src/components/RandomGenerator.tsx","webpack:///./node_modules/use-editable/dist/use-editable.es.js","webpack:///./src/components/ui/HighlightTextField.tsx"],"names":["EnumSpecification","props","serviceClass","spec","serviceSpecificationFromClassIdentifier","enums","Object","values","filter","en","derived","length","map","e","name","isFlags","keys","members","toString","useServiceProviderFromServiceClass","useContext","JacdacContext","bus","useEffect","devices","def","serviceProviderDefinitionFromServiceClass","provider","addServiceProvider","removeServiceProvider","DashboardServiceDevices","useChange","b","device","id","ServiceSpecification","node","service","showSource","showDevices","showDerived","shortId","classIdentifier","packets","pkt","registers","isRegister","events","isEvent","commands","isCommand","reports","r","secondary","pipeReports","isPipeReport","others","indexOf","reportOf","find","rep","isReportOf","pipeReportOf","isPipeReportOf","notes","short","extends","extend","i","serviceSpecificationFromName","long","note","group","sort","l","SERVICE_SPECIFICATION_STORAGE_KEY","ServiceSpecificationEditor","useLocalStorage","source","setSource","json","useMemo","parseServiceSpecificationMarkdownToJSON","serviceMap","servicePath","camelName","toLowerCase","errors","Page","DashboardDeviceItem","expanded","toggleExpanded","variant","other","AppContext","drawerType","breakpoints","breakpointWeight","services","srv","dashboardServiceWeight","readingRegister","valueRegister","intensityRegister","reduce","c","v","DrawerType","None","xs","sm","md","lg","xl","looksRandom","n","s","h","hh","test","genServId","cryptoRandomUint32","undefined","genFirmwareId","toFullHex","slice","join","uniqueServiceId","uniqueDeviceId","uniqueFirmwareId","deviceSpecificationFromFirmwareIdentifier","useStyles","makeStyles","createStyles","root","minWidth","marginBottom","title","fontSize","RandomGenerator","firmware","labelId","useId","fieldId","classes","useState","value","setValue","copySuccess","setCopySuccess","handleRegenerate","handleCopy","navigator","clipboard","writeText","GithubPullRequestButton","lazy","AnnotationTooltip","withStyles","theme","arrow","color","palette","error","main","tooltip","backgroundColor","common","white","boxShadow","shadows","typography","body2","Tooltip","HighlightTextField","code","onChange","language","annotations","pullRequestTitle","pullRequestPath","pullRequestDescription","DarkModeContext","darkMode","DARK_THEME","LIGHT_THEME","editorRef","useRef","useEditable","disabled","indentation","defaultProps","className","style","tokens","getTokenProps","minHeight","whiteSpace","line","annotation","a","message","el","borderBottom","token","empty","key"],"mappings":"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AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA,EAAE,gCAAe;AACjB;;AAEA;AACA;AACA;AACA,GAAG;AACH,EAAE,gCAAe;AACjB;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,wBAAwB,gBAAgB;AACxC;;AAEA,+CAA+C,QAAQ;AACvD;AACA;;AAEA,6CAA6C,QAAQ;AACrD;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,C;;;;;;;;;;;;;;;;;;;;;;;AC3PA;;AACA;AACA;CAMA;;CAEA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAMK,uBAAuB,gBAAGC,qBAAI,CAAC;AAAA,SAAM,6HAAN;AAAA,CAAD,CAApC;AAEA,IAAMC,iBAAiB,GAAGC,qCAAU,CAAC,UAAAC,KAAK;AAAA,SAAK;AAC3CC,SAAK,EAAE;AACHC,WAAK,EAAEF,KAAK,CAACG,OAAN,CAAcC,KAAd,CAAoBC;AADxB,KADoC;AAI3CC,WAAO,EAAE;AACLC,qBAAe,EAAEP,KAAK,CAACG,OAAN,CAAcC,KAAd,CAAoBC,IADhC;AAELH,WAAK,EAAEF,KAAK,CAACG,OAAN,CAAcK,MAAd,CAAqBC,KAFvB;AAGLC,eAAS,EAAEV,KAAK,CAACW,OAAN,CAAc,CAAd,CAHN;AAILhC,cAAQ,EAA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","file":"component---src-pages-tools-service-editor-tsx-0403a71d932b4f7b7950.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z\"\n}), 'Check');\n\nexports.default = _default;","import React, { Fragment } from \"react\"\nimport { serviceSpecificationFromClassIdentifier } from \"../../jacdac-ts/src/jdom/spec\"\nimport { Chip } from \"@material-ui/core\"\n\nexport default function EnumSpecification(props: { serviceClass: number }) {\n    const { serviceClass } = props\n    const spec = serviceSpecificationFromClassIdentifier(serviceClass)\n    const enums = Object.values(spec?.enums || {}).filter(en => !en.derived)\n    if (!enums.length)\n        return <></>\n\n    return <Fragment>\n        <h2>Enums</h2>\n        {enums.map(e => <Fragment key={e.name}>\n            <h3>{e.name} {e.isFlags && <Chip label=\"flags\" size=\"small\" />}</h3>\n            <ul>\n                {Object.keys(e.members).map(en => <li key={en}>{en}: <code>0x{e.members[en].toString(16)}</code></li>)}\n            </ul>\n        </Fragment>)}\n    </Fragment>\n}\n","import { useContext, useEffect } from \"react\"\nimport {\n    addServiceProvider,\n    serviceProviderDefinitionFromServiceClass,\n} from \"../../../jacdac-ts/src/servers/servers\"\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\"\n\nexport default function useServiceProviderFromServiceClass(\n    serviceClass: number\n): void {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n\n    // run once\n    useEffect(() => {\n        const devices = bus.devices({ serviceClass })\n        const def =\n            !devices.length && serviceProviderDefinitionFromServiceClass(serviceClass)\n        const provider = def && addServiceProvider(bus, def)\n        return () => bus.removeServiceProvider(provider)\n    }, [serviceClass])\n}\n","import React, { Fragment, useContext } from \"react\"\nimport { Link } from \"gatsby-theme-material-ui\"\nimport {\n    serviceSpecificationFromName,\n    isRegister,\n    isEvent,\n    isCommand,\n    isPipeReport,\n    isReportOf,\n    isPipeReportOf,\n} from \"../../jacdac-ts/src/jdom/spec\"\nimport PacketSpecification from \"../components/PacketSpecification\"\nimport IDChip from \"./IDChip\"\nimport Markdown from \"./ui/Markdown\"\nimport EnumSpecification from \"./EnumSpecification\"\nimport { Box, Grid } from \"@material-ui/core\"\nimport ServiceSpecificationStatusAlert from \"./ServiceSpecificationStatusAlert\"\nimport useServiceProviderFromServiceClass from \"./hooks/useServiceProviderFromServiceClass\"\nimport JacdacContext, { JacdacContextProps } from \"../jacdac/Context\"\nimport useChange from \"../jacdac/useChange\"\nimport DashbardDeviceItem from \"./dashboard/DashboardDeviceItem\"\n\nfunction DashboardServiceDevices(props: { serviceClass: number }) {\n    const { serviceClass } = props\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const devices = useChange(bus, b => b.devices({ serviceClass }))\n    return (\n        <Grid container spacing={2}>\n            {devices.map(device => (\n                <DashbardDeviceItem\n                    key={device.id}\n                    device={device}\n                    showAvatar={true}\n                    showHeader={true}\n                />\n            ))}\n        </Grid>\n    )\n}\n\nexport default function ServiceSpecification(props: {\n    service: jdspec.ServiceSpec\n    showSource?: boolean\n    showDevices?: boolean\n    showDerived?: boolean\n}) {\n    const { service: node, showSource, showDevices, showDerived } = props\n    const { shortId, name, classIdentifier } = node\n    const packets = node.packets.filter(pkt => showDerived || !pkt.derived)\n    const registers = packets.filter(isRegister)\n    const events = packets.filter(isEvent)\n    const commands = packets.filter(isCommand)\n    const reports = packets.filter(r => r.secondary)\n    const pipeReports = packets.filter(isPipeReport)\n    const others = packets.filter(\n        r =>\n            registers.indexOf(r) < 0 &&\n            events.indexOf(r) < 0 &&\n            commands.indexOf(r) < 0 &&\n            reports.indexOf(r) < 0 &&\n            pipeReports.indexOf(r) < 0\n    )\n    // spin up host on demand\n    useServiceProviderFromServiceClass(node.classIdentifier)\n\n    const reportOf = (pkt: jdspec.PacketInfo) =>\n        reports.find(rep => isReportOf(pkt, rep))\n    const pipeReportOf = (pkt: jdspec.PacketInfo) =>\n        pipeReports.find(rep => isPipeReportOf(pkt, rep))\n\n    return (\n        <Fragment key={`servicespec${shortId}`}>\n            <h1 key=\"title\">\n                {name}\n                <Box ml={1} component=\"span\">\n                    <IDChip\n                        id={node.classIdentifier}\n                        filter={`srv:${shortId}`}\n                    />\n                </Box>\n            </h1>\n            <ServiceSpecificationStatusAlert specification={node} />\n            <Markdown key=\"notesshort\" source={node.notes.short} />\n            {!!node.extends?.length && (\n                <p key=\"extends\">\n                    <span>Extends </span>\n                    {node.extends.map((extend, i) => (\n                        <Fragment key={`extend${extend}`}>\n                            {i > 0 && <span>, </span>}\n                            <Link\n                                key={`extend${extend}`}\n                                to={`/services/${extend}/`}\n                            >\n                                {serviceSpecificationFromName(extend).name}\n                            </Link>\n                        </Fragment>\n                    ))}\n                    .\n                </p>\n            )}\n            <Markdown key=\"noteslong\" source={node.notes.long || \"\"} />\n            <DashboardServiceDevices serviceClass={classIdentifier} />\n            <EnumSpecification key=\"enums\" serviceClass={classIdentifier} />\n            {[\n                {\n                    name: \"Registers\",\n                    packets: registers,\n                    note: node.notes[\"registers\"],\n                },\n                { name: \"Events\", packets: events, note: node.notes[\"events\"] },\n                {\n                    name: \"Commands\",\n                    packets: commands,\n                    note: node.notes[\"commands\"],\n                },\n                { name: \"Others\", packets: others, note: node.notes[\"others\"] },\n            ]\n                .filter(group => group.packets.length)\n                .map(group => (\n                    <Fragment key={`group${group.name}`}>\n                        <h2>{group.name}</h2>\n                        {group.note && (\n                            <Markdown\n                                key={`node${group.name}`}\n                                source={group.note}\n                            />\n                        )}\n                        {group.packets\n                            .sort(\n                                (l, r) =>\n                                    (l.derived ? 1 : -1) - (r.derived ? 1 : -1)\n                            )\n                            .map((pkt, i) => (\n                                <PacketSpecification\n                                    key={`pkt${pkt.name}`}\n                                    serviceClass={node.classIdentifier}\n                                    packetInfo={pkt}\n                                    reportInfo={reportOf(pkt)}\n                                    pipeReportInfo={pipeReportOf(pkt)}\n                                    showDevices={true}\n                                />\n                            ))}\n                    </Fragment>\n                ))}\n        </Fragment>\n    )\n}\n","import React, { useMemo } from \"react\"\nimport { Grid } from \"@material-ui/core\"\nimport { parseServiceSpecificationMarkdownToJSON } from \"../../../jacdac-ts/jacdac-spec/spectool/jdspec\"\nimport { serviceMap } from \"../../../jacdac-ts/src/jdom/spec\"\nimport RandomGenerator from \"../RandomGenerator\"\nimport useLocalStorage from \"../useLocalStorage\"\nimport HighlightTextField from \"../ui/HighlightTextField\"\nimport ServiceSpecification from \"../ServiceSpecification\"\n\nconst SERVICE_SPECIFICATION_STORAGE_KEY =\n    \"jacdac:servicespecificationeditorsource\"\n\nexport default function ServiceSpecificationEditor() {\n    const [source, setSource] = useLocalStorage(\n        SERVICE_SPECIFICATION_STORAGE_KEY,\n        \"\"\n    )\n    const json = useMemo(\n        () => parseServiceSpecificationMarkdownToJSON(source, serviceMap()),\n        [source]\n    )\n    const servicePath =\n        json &&\n        `services/${(\n            json.camelName ||\n            json.shortId ||\n            `0x${json.classIdentifier.toString(16)}`\n        ).toLowerCase()}`\n    return (\n        <Grid spacing={1} container>\n            <Grid item xs={12}>\n                <HighlightTextField\n                    code={source}\n                    language={\"markdown\"}\n                    onChange={setSource}\n                    annotations={json?.errors}\n                    pullRequestTitle={json && `Service: ${json.name}`}\n                    pullRequestPath={servicePath}\n                    pullRequestDescription={`This pull request defines a new service.`}\n                />\n            </Grid>\n            <Grid item>\n                <RandomGenerator device={false} />\n                {json && <ServiceSpecification service={json} />}\n            </Grid>\n        </Grid>\n    )\n}\n","import { Link } from \"gatsby-theme-material-ui\"\nimport React from \"react\"\nimport ServiceSpecificationEditor from '../../components/tools/ServiceSpecificationEditor'\n\nexport default function Page() {\n    return <>\n        <h1>Service Specification Editor</h1>\n        <p>\n\n            Read the <Link to=\"/reference/service-specification\">service specifiation</Link> documentation.\nUse the packet console to monitor packets from your devices.\n        </p>\n        <ServiceSpecificationEditor />\n    </>\n}","import { Grid } from \"@material-ui/core\";\nimport React, { useContext } from \"react\";\nimport { JDDevice } from \"../../../jacdac-ts/src/jdom/device\";\nimport DashboardDevice from \"./DashboardDevice\";\nimport { GridBreakpoints } from \"../useGridBreakpoints\";\nimport { DashboardDeviceProps } from \"./Dashboard\";\nimport useChange from \"../../jacdac/useChange\";\nimport { dashboardServiceWeight } from \"./DashboardServiceWidget\";\nimport AppContext, { DrawerType } from \"../AppContext\";\n\nexport default function DashboardDeviceItem(props: {\n    device: JDDevice,\n    expanded?: boolean,\n    toggleExpanded?: () => void,\n    variant?: \"icon\" | \"\"\n} & DashboardDeviceProps) {\n    const { device, expanded, toggleExpanded, variant, ...other } = props;\n    const { drawerType } = useContext(AppContext)\n    const breakpoints: GridBreakpoints = useChange(device, () => {\n        const breakpointWeight = device.services()\n            .map(srv => {\n                return dashboardServiceWeight(srv)\n                    || (srv.readingRegister || srv.valueRegister || srv.intensityRegister ? 1 : 0)\n            })\n            .reduce((c: number, v) => c + v, 0);\n\n        if (breakpointWeight > 3 || drawerType !== DrawerType.None)\n            return { xs: 12, sm: 12, md: 12, lg: 6, xl: 6 };\n        else if (breakpointWeight == 3)\n            return { xs: 12, sm: 12, md: 4, lg: 4, xl: 4 };\n        else if (breakpointWeight == 2)\n            return { xs: 12, sm: 6, md: 4, lg: 3, xl: 4 };\n        else\n            return { xs: expanded ? 12 : 6, sm: 4, md: 3, lg: 2, xl: \"auto\" };\n    }, [expanded, drawerType]);\n\n    // based on size, expanded or reduce widget size\n    return <Grid item {...breakpoints}>\n        <DashboardDevice\n            device={device}\n            expanded={expanded}\n            toggleExpanded={toggleExpanded}\n            variant={variant}\n            {...other}\n        />\n    </Grid>\n}","import React, { useState } from \"react\"\nimport { cryptoRandomUint32 } from \"../../jacdac-ts/src/jdom/utils\"\nimport {\n    deviceSpecificationFromFirmwareIdentifier,\n    serviceSpecificationFromClassIdentifier,\n} from \"../../jacdac-ts/src/jdom/spec\"\nimport {\n    Card,\n    makeStyles,\n    CardContent,\n    CardActions,\n    Typography,\n    createStyles,\n    Input,\n} from \"@material-ui/core\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport CheckIcon from \"@material-ui/icons/Check\"\n// tslint:disable-next-line: no-submodule-imports\nimport Alert from \"./ui/Alert\"\nimport { Button } from \"gatsby-theme-material-ui\"\nimport { NoSsr } from \"@material-ui/core\"\nimport { useId } from \"react-use-id-hook\"\n\nfunction looksRandom(n: number) {\n    const s = n.toString(16)\n    const h = \"0123456789abcdef\"\n    for (let i = 0; i < h.length; ++i) {\n        const hh = h[i]\n        if (s.indexOf(hh + hh + hh) >= 0) return false\n    }\n    if (/f00d|dead|deaf|beef/.test(s)) return false\n    return true\n}\n\nfunction genServId() {\n    const n = cryptoRandomUint32(1)\n    if (n === undefined) return undefined\n    return (n[0] & 0xfff_ffff) | 0x1000_0000\n}\n\nfunction genFirmwareId() {\n    const n = cryptoRandomUint32(1)\n    if (n === undefined) return undefined\n    return (n[0] & 0xfff_ffff) | 0x3000_0000\n}\n\nfunction toFullHex(n: number[]) {\n    return (\n        \"0x\" + n.map(id => (\"000000000\" + id.toString(16)).slice(-8)).join(\"\")\n    )\n}\n\nexport function uniqueServiceId() {\n    let id = genServId()\n    while (\n        id !== undefined &&\n        (!looksRandom(id) || serviceSpecificationFromClassIdentifier(id))\n    ) {\n        id = genServId()\n    }\n    return id !== undefined && toFullHex([id])\n}\n\nexport function uniqueDeviceId() {\n    const n = cryptoRandomUint32(2)\n    return n !== undefined && toFullHex([n[0], n[1]])\n}\n\nexport function uniqueFirmwareId() {\n    let id = genFirmwareId()\n    while (\n        id !== undefined &&\n        (!looksRandom(id) || deviceSpecificationFromFirmwareIdentifier(id))\n    ) {\n        id = genFirmwareId()\n    }\n    return id !== undefined && toFullHex([id])\n}\n\nconst useStyles = makeStyles(\n    createStyles({\n        root: {\n            minWidth: 275,\n            marginBottom: \"1rem\",\n        },\n        title: {\n            fontSize: 14,\n        },\n    })\n)\n\nexport default function RandomGenerator(props: {\n    device?: boolean\n    firmware?: boolean\n}) {\n    const { device, firmware } = props\n    const labelId = useId()\n    const fieldId = useId()\n    const classes = useStyles()\n    const [value, setValue] = useState(\n        device ? uniqueDeviceId() : uniqueServiceId()\n    )\n    const [copySuccess, setCopySuccess] = useState(false)\n\n    const handleRegenerate = () => {\n        const v = device\n            ? uniqueDeviceId()\n            : firmware\n            ? uniqueFirmwareId()\n            : uniqueServiceId()\n        setValue(v)\n        setCopySuccess(false)\n    }\n    const handleCopy = async () => {\n        try {\n            await navigator.clipboard.writeText(value)\n            setCopySuccess(true)\n        } catch (err) {\n            setCopySuccess(false)\n        }\n    }\n    const title = device\n        ? \"Random Device Identifier\"\n        : firmware\n        ? \"Random Firmware Identifier\"\n        : \"Random Service Identifier\"\n    return (\n        <NoSsr>\n            <Card className={classes.root}>\n                <CardContent>\n                    <Typography\n                        id={labelId}\n                        className={classes.title}\n                        color=\"textSecondary\"\n                        gutterBottom\n                    >\n                        {title}\n                    </Typography>\n                    {value !== undefined && (\n                        <Typography variant=\"h5\" component=\"h2\">\n                            <Input\n                                id={fieldId}\n                                value={value}\n                                readOnly={true}\n                                inputProps={{\n                                    \"aria-labelledby\": labelId,\n                                }}\n                            />\n                            {copySuccess && <CheckIcon />}\n                        </Typography>\n                    )}\n                    {value === undefined && (\n                        <Alert severity=\"error\">\n                            Oops, unable to generate a strong random number.\n                        </Alert>\n                    )}\n                </CardContent>\n                <CardActions>\n                    <Button\n                        aria-label=\"copy random number to clipboard\"\n                        size=\"small\"\n                        variant=\"contained\"\n                        onClick={handleCopy}\n                    >\n                        Copy\n                    </Button>\n                    <Button\n                        aria-label=\"regenerate random number\"\n                        size=\"small\"\n                        variant=\"contained\"\n                        color=\"primary\"\n                        onClick={handleRegenerate}\n                    >\n                        Regenerate\n                    </Button>\n                </CardActions>\n            </Card>\n        </NoSsr>\n    )\n}\n","import { useState, useCallback, useLayoutEffect } from \"react\";\nvar m = {\n  characterData: !0,\n  characterDataOldValue: !0,\n  childList: !0,\n  subtree: !0\n};\n\nfunction p(a) {\n  a = [a.firstChild];\n\n  for (var d, c = \"\"; d = a.pop();) {\n    d.nodeType === Node.TEXT_NODE ? c += d.textContent : d.nodeType === Node.ELEMENT_NODE && \"BR\" === d.nodeName && (c += \"\\n\"), d.nextSibling && a.push(d.nextSibling), d.firstChild && a.push(d.firstChild);\n  }\n\n  \"\\n\" !== c[c.length - 1] && (c += \"\\n\");\n  return c;\n}\n\nfunction r(a) {\n  var c = window.getSelection();\n  a = [a.firstChild];\n  var d = c.focusNode;\n  c = c.focusOffset;\n  d && d.nodeType !== Node.TEXT_NODE && (c <= d.childNodes.length - 1 && (d = d.childNodes[c]), c = 0);\n\n  for (var h, k = 0, l = 0, g = \"\"; h = a.pop();) {\n    if (h.nodeType === Node.TEXT_NODE) {\n      var e = h.textContent;\n      h === d && (e = e.slice(0, c));\n      k += e.length;\n      g += e;\n\n      for (var f, n = /\\n/g; f = n.exec(e);) {\n        g = e.slice(f.index + 1), l++;\n      }\n\n      if (h === d) {\n        break;\n      }\n    } else {\n      h.nodeType === Node.ELEMENT_NODE && \"BR\" === h.nodeName && (g = \"\", l++, k++);\n    }\n\n    h.nextSibling && h !== d && a.push(h.nextSibling);\n    h.firstChild && a.push(h.firstChild);\n  }\n\n  return {\n    position: k,\n    content: g,\n    line: l\n  };\n}\n\nfunction t(a, c) {\n  for (var d = window.getSelection(), k = document.createRange(), l = [a.firstChild], g = 0; a = l.pop();) {\n    if (a.nodeType === Node.TEXT_NODE) {\n      var h = a.textContent.length;\n\n      if (g + h >= c) {\n        (c -= g) === h ? k.setStartAfter(a) : k.setStart(a, c);\n        break;\n      }\n\n      g += a.textContent.length;\n    } else if (a.nodeType === Node.ELEMENT_NODE && \"BR\" === a.nodeName) {\n      if (g + 1 >= c) {\n        k.setStartAfter(a);\n        break;\n      }\n\n      g++;\n    }\n\n    a.nextSibling && l.push(a.nextSibling);\n    a.firstChild && l.push(a.firstChild);\n  }\n\n  d.empty();\n  d.addRange(k);\n}\n\nfunction B(a) {\n  var c = window.getSelection(),\n      d = window.getSelection().getRangeAt(0);\n  a = document.createTextNode(a);\n  c.getRangeAt(0).deleteContents();\n  d.insertNode(a);\n  (d = document.createRange()).setStartAfter(a);\n  c.empty();\n  c.addRange(d);\n}\n\nexport function useEditable(a, c, d) {\n  function k() {\n    e[0].disconnect();\n  }\n\n  function l() {\n    e[0].disconnect();\n    e[1] = !0;\n  }\n\n  function g() {\n    e[6] = -1;\n  }\n\n  d || (d = {});\n  var h = useState([])[1],\n      e = useState(function () {\n    var a = [null, !1, c, [], [], -1, -1];\n    \"undefined\" != typeof MutationObserver && (a[0] = new MutationObserver(function e(e) {\n      var d;\n      (d = a[3]).push.apply(d, e);\n    }));\n    return a;\n  })[0],\n      n = useCallback(function (d) {\n    var f = a.current;\n\n    if (f) {\n      var c = r(f);\n      f = p(f);\n      e[6] = c.position + (d.length - f.length);\n      e[2](d, c);\n    }\n  }, []);\n\n  if (\"object\" != typeof navigator) {\n    return n;\n  }\n\n  useLayoutEffect(function () {\n    e[2] = c;\n\n    if (a.current && !d.disabled) {\n      return e[1] = !1, e[0].observe(a.current, m), 0 <= e[6] && t(a.current, e[6]), k;\n    }\n  });\n  useLayoutEffect(function () {\n    if (!a.current || d.disabled) {\n      e[4].length = 0, e[5] = -1;\n    } else {\n      var f = a.current;\n      -1 < e[6] && (f.focus(), t(f, e[6]));\n      var c = f.style.whiteSpace,\n          k = f.contentEditable,\n          u = !0;\n\n      try {\n        f.contentEditable = \"plaintext-only\";\n      } catch (b) {\n        f.contentEditable = \"true\", u = !1;\n      }\n\n      \"pre\" !== c && (f.style.whiteSpace = \"pre-wrap\");\n      d.indentation && (f.style.tabSize = f.style.MozTabSize = \"\" + d.indentation);\n\n      var v,\n          C = new RegExp(\"^(?:\" + \" \".repeat(d.indentation || 0) + \"|\\\\t)\"),\n          q = function q(b) {\n        if (a.current && -1 !== e[6]) {\n          var d = e[4],\n              c = p(f),\n              h = r(f),\n              g = new Date().valueOf(),\n              k = d[e[5]];\n          !b && 500 > g - v || k && k[1] === c ? v = g : (d[b = ++e[5]] = [h, c], d.splice(b + 1), 500 < b && (e[5]--, d.shift()));\n        }\n      },\n          w = function w() {\n        var b;\n        (b = e[3]).push.apply(b, e[0].takeRecords());\n\n        if (e[3].length) {\n          l();\n          b = p(f);\n          var d = r(f);\n          e[6] = d.position;\n\n          for (var a, c; a = e[3].pop();) {\n            null !== a.oldValue && (a.target.textContent = a.oldValue);\n\n            for (c = a.removedNodes.length - 1; 0 <= c; c--) {\n              a.target.insertBefore(a.removedNodes[c], a.nextSibling);\n            }\n\n            for (c = a.addedNodes.length - 1; 0 <= c; c--) {\n              a.addedNodes[c].parentNode && a.target.removeChild(a.addedNodes[c]);\n            }\n          }\n\n          e[2](b, d);\n        }\n      },\n          x = function x(b) {\n        if (!b.defaultPrevented && b.target === f) {\n          if (e[1]) {\n            return b.preventDefault(), h([]);\n          }\n\n          if ((b.metaKey || b.ctrlKey) && \"KeyZ\" === b.code) {\n            b.preventDefault(), b.shiftKey ? (b = ++e[5], (b = e[4][b]) || (e[5] = e[4].length - 1)) : (b = --e[5], (b = e[4][b]) || (e[5] = 0)), b && (l(), e[6] = b[0].position, e[2](b[1], b[0]));\n          } else if (q(), \"Enter\" === b.key) {\n            b.preventDefault();\n            b = r(f);\n            var a = /\\S/g.exec(b.content);\n            B(b = \"\\n\" + b.content.slice(0, a ? a.index : b.content.length));\n          } else if (!u && \"Backspace\" === b.key) {\n            b.preventDefault(), (b = window.getSelection().getRangeAt(0)).startContainer !== b.endContainer || b.startOffset !== b.endOffset ? b.deleteContents() : (l(), b = r(f), b = Math.max(0, b.position - 1), a = p(f), n(a.slice(0, b) + a.slice(b + 1)));\n          } else if (d.indentation && \"Tab\" === b.key) {\n            b.preventDefault();\n            var c = (a = r(f)).position - a.content.length,\n                g = p(f);\n            b = b.shiftKey ? g.slice(0, c) + a.content.replace(C, \"\") + g.slice(c + a.content.length) : g.slice(0, c) + \"\\t\" + g.slice(c);\n            n(b);\n          }\n        }\n      },\n          y = function y(a) {\n        a.defaultPrevented || a.isComposing || ((a.metaKey || a.ctrlKey) && \"KeyZ\" === a.code || q(), w(), f.focus());\n      },\n          z = function z() {\n        e[6] = r(f).position;\n      },\n          A = function A(a) {\n        a.preventDefault();\n        q(!0);\n        B(a.clipboardData.getData(\"text/plain\"));\n        q(!0);\n        w();\n      };\n\n      window.addEventListener(\"keydown\", x);\n      f.addEventListener(\"focus\", z);\n      f.addEventListener(\"blur\", g);\n      f.addEventListener(\"paste\", A);\n      f.addEventListener(\"keyup\", y);\n      return function () {\n        window.removeEventListener(\"keydown\", x);\n        f.removeEventListener(\"focus\", z);\n        f.removeEventListener(\"blur\", g);\n        f.removeEventListener(\"paste\", A);\n        f.removeEventListener(\"keyup\", y);\n        f.style.whiteSpace = c;\n        f.contentEditable = k;\n      };\n    }\n  }, [a.current, d.disabled, d.indentation]);\n  return n;\n}","/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable react/jsx-key */\nimport React, { useContext, useRef, lazy } from \"react\"\nimport Highlight, {\n    defaultProps,\n    Language,\n    PrismTheme,\n} from \"prism-react-renderer\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport LIGHT_THEME from \"prism-react-renderer/themes/github\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport DARK_THEME from \"prism-react-renderer/themes/vsDark\"\nimport DarkModeContext from \"./DarkModeContext\"\nimport { useEditable } from \"use-editable\"\nimport { Alert } from \"@material-ui/lab\"\nimport { Grid, Tooltip, withStyles } from \"@material-ui/core\"\nimport Suspense from \"../ui/Suspense\";\nconst GithubPullRequestButton = lazy(() => import('../GithubPullRequestButton'));\n\nconst AnnotationTooltip = withStyles(theme => ({\n    arrow: {\n        color: theme.palette.error.main,\n    },\n    tooltip: {\n        backgroundColor: theme.palette.error.main,\n        color: theme.palette.common.white,\n        boxShadow: theme.shadows[1],\n        fontSize: theme.typography.body2.fontSize,\n    },\n}))(Tooltip)\n\nexport default function HighlightTextField(props: {\n    language: string\n    code: string\n    onChange: (newValue: string) => void\n    annotations?: jdspec.Diagnostic[]\n    pullRequestTitle?: string\n    pullRequestPath?: string\n    pullRequestDescription?: string\n}) {\n    const {\n        code,\n        onChange,\n        language,\n        annotations,\n        pullRequestTitle,\n        pullRequestPath,\n        pullRequestDescription,\n    } = props\n    const { darkMode } = useContext(DarkModeContext)\n    const theme = (darkMode === \"dark\" ? DARK_THEME : LIGHT_THEME) as PrismTheme\n    const editorRef = useRef(null)\n\n    useEditable(editorRef, onChange, {\n        disabled: false,\n        indentation: 4,\n    })\n    return (\n        <Grid container spacing={1} direction=\"row\">\n            <Grid item xs={12}>\n                <Highlight\n                    {...defaultProps}\n                    code={code}\n                    language={language as Language}\n                    theme={theme}\n                >\n                    {({ className, style, tokens, getTokenProps }) => (\n                        <pre\n                            ref={editorRef}\n                            className={className}\n                            spellCheck={false}\n                            style={{\n                                ...style,\n                                ...{\n                                    minHeight: \"12rem\",\n                                    whiteSpace: \"pre-wrap\",\n                                },\n                            }}\n                        >\n                            {tokens.map((line, i) => {\n                                const annotation = annotations?.find(\n                                    a => a.line === i + 1\n                                )\n                                const title = annotation?.message\n                                const el = (\n                                    <span\n                                        key={i}\n                                        style={\n                                            annotation && {\n                                                borderBottom: \"dashed 1px red\",\n                                            }\n                                        }\n                                    >\n                                        {line\n                                            .filter(token => !token.empty)\n                                            .map((token, key) => (\n                                                <span\n                                                    {...getTokenProps({\n                                                        token,\n                                                        key,\n                                                    })}\n                                                />\n                                            ))}\n                                        {i < tokens.length - 1 ? \"\\n\" : null}\n                                    </span>\n                                )\n                                return title ? (\n                                    <AnnotationTooltip\n                                        title={title}\n                                        arrow\n                                        key={i}\n                                    >\n                                        {el}\n                                    </AnnotationTooltip>\n                                ) : (\n                                    el\n                                )\n                            })}\n                        </pre>\n                    )}\n                </Highlight>\n            </Grid>\n            {!!annotations?.length && (\n                <Grid item xs={12}>\n                    <Alert severity=\"error\">\n                        <ul>\n                            {annotations.map((a, i) => (\n                                <li key={i}>\n                                    line {a.line}: {a.message}\n                                </li>\n                            ))}\n                        </ul>\n                    </Alert>\n                </Grid>\n            )}\n            {pullRequestTitle && pullRequestPath && (\n                <Grid item>\n                    <Suspense>\n                        <GithubPullRequestButton\n                            title={pullRequestTitle}\n                            head={pullRequestPath}\n                            description={pullRequestDescription}\n                            files={{\n                                [pullRequestPath + \".md\"]: code,\n                            }}\n                        />\n                    </Suspense>\n                </Grid>\n            )}\n        </Grid>\n    )\n}\n"],"sourceRoot":""}